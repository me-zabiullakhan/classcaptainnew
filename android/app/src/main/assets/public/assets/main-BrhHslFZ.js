const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BXD1Insn.js","assets/index.esm-BSiObraZ.js","assets/web-D9GhCGBN.js","assets/web-B75wbKe-.js","assets/index.es-DDP51_M_.js"])))=>i.map(i=>d[i]);
import{f as Ko,g as Kw,a as qw,e as zw,T as Lt,j as s,r as q,R as be,q as ui,c as Bn,w as fi,b as Qa,d as Xe,h as Sn,o as si,s as hA,u as qr,i as iA,k as Jr,l as pr,m as Ea,n as qo,p as zo,t as fh,v as Qd,x as hh,y as gh,z as Jw}from"./index.esm-BSiObraZ.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const Ww=t=>{const e=new Map;e.set("web",{name:"web"});const n=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},r=(i,A)=>{n.platforms.set(i,A)},a=i=>{n.platforms.has(i)&&(n.currentPlatform=n.platforms.get(i))};return n.addPlatform=r,n.setPlatform=a,n},Yw=t=>t.CapacitorPlatforms=Ww(t),Sm=Yw(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Sm.addPlatform;Sm.setPlatform;var BA;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(BA||(BA={}));class Ld extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const $w=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Xw=t=>{var e,n,r,a,i;const A=t.CapacitorCustomPlatform||null,o=t.Capacitor||{},l=o.Plugins=o.Plugins||{},c=t.CapacitorPlatforms,d=()=>A!==null?A.name:$w(t),h=((e=c==null?void 0:c.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||d,p=()=>h()!=="web",m=((n=c==null?void 0:c.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||p,B=D=>{const U=E.get(D);return!!(U!=null&&U.platforms.has(h())||C(D))},y=((r=c==null?void 0:c.currentPlatform)===null||r===void 0?void 0:r.isPluginAvailable)||B,b=D=>{var U;return(U=o.PluginHeaders)===null||U===void 0?void 0:U.find(j=>j.name===D)},C=((a=c==null?void 0:c.currentPlatform)===null||a===void 0?void 0:a.getPluginHeader)||b,N=D=>t.console.error(D),k=(D,U,j)=>Promise.reject(`${j} does not have an implementation of "${U}".`),E=new Map,_=(D,U={})=>{const j=E.get(D);if(j)return console.warn(`Capacitor plugin "${D}" already registered. Cannot register plugins twice.`),j.proxy;const O=h(),F=C(D);let I;const P=async()=>(!I&&O in U?I=typeof U[O]=="function"?I=await U[O]():I=U[O]:A!==null&&!I&&"web"in U&&(I=typeof U.web=="function"?I=await U.web():I=U.web),I),V=(ue,Ce)=>{var Q,z;if(F){const W=F==null?void 0:F.methods.find(Z=>Ce===Z.name);if(W)return W.rtype==="promise"?Z=>o.nativePromise(D,Ce.toString(),Z):(Z,ne)=>o.nativeCallback(D,Ce.toString(),Z,ne);if(ue)return(Q=ue[Ce])===null||Q===void 0?void 0:Q.bind(ue)}else{if(ue)return(z=ue[Ce])===null||z===void 0?void 0:z.bind(ue);throw new Ld(`"${D}" plugin is not implemented on ${O}`,BA.Unimplemented)}},ee=ue=>{let Ce;const Q=(...z)=>{const W=P().then(Z=>{const ne=V(Z,ue);if(ne){const fe=ne(...z);return Ce=fe==null?void 0:fe.remove,fe}else throw new Ld(`"${D}.${ue}()" is not implemented on ${O}`,BA.Unimplemented)});return ue==="addListener"&&(W.remove=async()=>Ce()),W};return Q.toString=()=>`${ue.toString()}() { [capacitor code] }`,Object.defineProperty(Q,"name",{value:ue,writable:!1,configurable:!1}),Q},X=ee("addListener"),le=ee("removeListener"),ae=(ue,Ce)=>{const Q=X({eventName:ue},Ce),z=async()=>{const Z=await Q;le({eventName:ue,callbackId:Z},Ce)},W=new Promise(Z=>Q.then(()=>Z({remove:z})));return W.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await z()},W},de=new Proxy({},{get(ue,Ce){switch(Ce){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return F?ae:X;case"removeListener":return le;default:return ee(Ce)}}});return l[D]=de,E.set(D,{name:D,proxy:de,platforms:new Set([...Object.keys(U),...F?[O]:[]])}),de},M=((i=c==null?void 0:c.currentPlatform)===null||i===void 0?void 0:i.registerPlugin)||_;return o.convertFileSrc||(o.convertFileSrc=D=>D),o.getPlatform=h,o.handleError=N,o.isNativePlatform=m,o.isPluginAvailable=y,o.pluginMethodNoop=k,o.registerPlugin=M,o.Exception=Ld,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},Zw=t=>t.Capacitor=Xw(t),CA=Zw(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),FA=CA.registerPlugin;CA.Plugins;class Im{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const A=async()=>this.removeListener(e,n);return Promise.resolve({remove:A})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const a=this.listeners[e];if(!a){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(n))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new CA.Exception(e,BA.Unimplemented)}unavailable(e="not available"){return new CA.Exception(e,BA.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const a=r.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const mh=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ph=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class e1 extends Im{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=ph(a).trim(),i=ph(i).trim(),n[a]=i}),n}async setCookie(e){try{const n=mh(e.key),r=mh(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),A=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${a}; path=${i}; ${A};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}FA("CapacitorCookies",{web:()=>new e1});const t1=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>n(a),r.readAsDataURL(t)}),n1=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,i,A)=>(a[i]=t[e[A]],a),{})},r1=(t,e=!0)=>t?Object.entries(t).reduce((r,a)=>{const[i,A]=a;let o,l;return Array.isArray(A)?(l="",A.forEach(c=>{o=e?encodeURIComponent(c):c,l+=`${i}=${o}&`}),l.slice(0,-1)):(o=e?encodeURIComponent(A):A,l=`${i}=${o}`),`${r}&${l}`},"").substr(1):null,s1=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=n1(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[A,o]of Object.entries(t.data||{}))i.set(A,o);n.body=i.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((o,l)=>{i.append(l,o)});else for(const o of Object.keys(t.data))i.append(o,t.data[o]);n.body=i;const A=new Headers(n.headers);A.delete("content-type"),n.headers=A}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class a1 extends Im{async request(e){const n=s1(e,e.webFetchExtra),r=r1(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,i=await fetch(a,n),A=i.headers.get("content-type")||"";let{responseType:o="text"}=i.ok?e:{};A.includes("application/json")&&(o="json");let l,c;switch(o){case"arraybuffer":case"blob":c=await i.blob(),l=await t1(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const d={};return i.headers.forEach((h,p)=>{d[p]=h}),{data:l,headers:d,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}FA("CapacitorHttp",{web:()=>new a1});const i1="modulepreload",A1=function(t){return"/"+t},xh={},NA=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const A=document.querySelector("meta[property=csp-nonce]"),o=(A==null?void 0:A.nonce)||(A==null?void 0:A.getAttribute("nonce"));a=Promise.allSettled(n.map(l=>{if(l=A1(l),l in xh)return;xh[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":i1,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(A){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=A,window.dispatchEvent(o),!o.defaultPrevented)throw A}return a.then(A=>{for(const o of A||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},o1=FA("SplashScreen",{web:()=>NA(()=>import("./web-BXD1Insn.js"),__vite__mapDeps([0,1])).then(t=>new t.SplashScreenWeb)});var fu;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(fu||(fu={}));var wh;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(wh||(wh={}));const l1=FA("StatusBar"),Fm={apiKey:"AIzaSyA_Nvv_zzZP-15Xaw0qsddKu5eahac-OvY",authDomain:"class-captain-01.firebaseapp.com",projectId:"class-captain-01",storageBucket:"class-captain-01.firebasestorage.app",messagingSenderId:"877432208495",appId:"1:877432208495:web:a49973bd04c8734526619a",measurementId:"G-D1J5FWWC8G"};Ko.initializeApp(Fm);const Te=Kw(),ka=qw(),Cn=Ko.auth();Cn.setPersistence(Ko.auth.Auth.Persistence.SESSION).catch(t=>{console.error("Firebase Auth: Could not set session persistence.",t)});zw(Te).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore persistence could not be enabled. This is likely because the app is open in multiple tabs."):t.code==="unimplemented"&&console.warn("Firestore persistence is not supported in this browser.")});const c1=[{id:"demo-batch-1",name:"Morning Physics - Grade 12",location:"Room 101",teacher:"Dr. Evelyn Reed",time:"08:00",days:["Mon","Wed","Fri"],maxSlots:20,currentStudents:3,batchFeeAmount:500,batchFeeType:"Monthly",isActive:!0},{id:"demo-batch-2",name:"Evening Maths - Grade 11",location:"Room 203",teacher:"Mr. Alan Grant",time:"17:30",days:["Tue","Thu"],maxSlots:15,currentStudents:4,batchFeeAmount:400,batchFeeType:"Monthly",isActive:!0}],Em=[{id:"demo-student-1",rollNumber:"S001",name:"Alice Johnson",fatherName:"Robert Johnson",motherName:"Mary Johnson",dob:"2006-05-15",mobile1:"9876543210",gender:"Female",address:"123 Maple Street",admissionDate:"2023-04-01",batches:["Morning Physics - Grade 12"],schoolOrCollege:"Springfield High",transport:"NO_TRANSPORT_USE",isActive:!0,feeAmount:500,feeType:"Monthly"},{id:"demo-student-2",rollNumber:"S002",name:"Bob Williams",fatherName:"James Williams",motherName:"Patricia Williams",dob:"2006-08-22",mobile1:"9876543211",gender:"Male",address:"456 Oak Avenue",admissionDate:"2023-04-02",batches:["Morning Physics - Grade 12","Evening Maths - Grade 11"],schoolOrCollege:"Shelbyville High",transport:"USE_TRANSPORT",transportRouteId:"demo-route-1",transportFee:800,isActive:!0,feeAmount:900,feeType:"Monthly"},{id:"demo-student-3",rollNumber:"S003",name:"Charlie Brown",fatherName:"Charles Brown Sr.",motherName:"Jennifer Brown",dob:"2007-02-10",mobile1:"9876543212",gender:"Male",address:"789 Pine Lane",admissionDate:"2023-04-03",batches:["Evening Maths - Grade 11"],schoolOrCollege:"Demo Public School",transport:"NO_TRANSPORT_USE",isActive:!0,feeAmount:400,feeType:"Monthly"},{id:"demo-student-4",rollNumber:"S004",name:"Diana Miller",fatherName:"Michael Miller",motherName:"Linda Miller",dob:"2006-11-30",mobile1:"9876543213",gender:"Female",address:"101 Birch Road",admissionDate:"2023-04-05",batches:["Morning Physics - Grade 12"],schoolOrCollege:"Springfield High",transport:"NO_TRANSPORT_USE",isActive:!0,feeAmount:500,feeType:"Monthly"},{id:"demo-student-5",rollNumber:"S005",name:"Ethan Davis",fatherName:"David Davis",motherName:"Susan Davis",dob:"2007-01-20",mobile1:"9876543214",gender:"Male",address:"212 Cedar Street",admissionDate:"2023-04-06",batches:["Evening Maths - Grade 11"],schoolOrCollege:"Demo Public School",transport:"USE_TRANSPORT",isActive:!0,feeAmount:400,feeType:"Monthly"},{id:"demo-student-6",rollNumber:"S006",name:"Fiona Garcia",fatherName:"Richard Garcia",motherName:"Karen Garcia",dob:"2007-03-12",mobile1:"9876543215",gender:"Female",address:"333 Elm Drive",admissionDate:"2023-04-10",batches:["Evening Maths - Grade 11"],schoolOrCollege:"Shelbyville High",transport:"NO_TRANSPORT_USE",isActive:!0,feeAmount:400,feeType:"Monthly"}],km=[{id:"demo-staff-1",staffId:"T01",name:"Alan Grant",dob:"1970-03-15",mobile:"9876543219",email:"alangrant@example.com",gender:"Male",address:"Demo City, USA",joiningDate:"2022-09-01",photo:"",batchAccess:{"demo-batch-1":{attendance:!0,editStudents:!0},"demo-batch-2":{attendance:!0,fees:!0}},isActive:!0},{id:"demo-staff-2",staffId:"T02",name:"Dr. Evelyn Reed",dob:"1982-11-22",mobile:"9876543221",email:"evelynreed@example.com",gender:"Female",address:"Demo City, USA",joiningDate:"2021-08-15",photo:"",batchAccess:{"demo-batch-1":{attendance:!0,exams:!0}},isActive:!0}],d1=[{id:"demo-sa-1",staffId:"demo-staff-2",staffName:"Dr. Evelyn Reed",date:Lt.fromMillis(Date.now()-86400*2*1e3),batchId:"demo-batch-1",batchName:"Morning Physics - Grade 12",subject:"Physics",startTime:"08:00",endTime:"09:00",durationMinutes:60},{id:"demo-sa-2",staffId:"demo-staff-1",staffName:"Alan Grant",date:Lt.fromMillis(Date.now()-86400*1*1e3),batchId:"demo-batch-2",batchName:"Evening Maths - Grade 11",subject:"Maths",startTime:"17:30",endTime:"19:00",durationMinutes:90}],u1=[{id:"demo-tx-1",type:"Income",category:"Stationery Sales",amount:1500,paymentMethod:"Cash",description:"Sold 10 notebooks and 20 pens",date:Lt.fromMillis(Date.now()-86400*5*1e3),createdAt:Lt.fromMillis(Date.now()-86400*5*1e3)},{id:"demo-tx-2",type:"Expense",category:"Rent",amount:1e4,paymentMethod:"Bank Transfer",description:"Monthly rent for premises",date:Lt.fromMillis(Date.now()-86400*2*1e3),createdAt:Lt.fromMillis(Date.now()-86400*2*1e3)},{id:"demo-tx-3",type:"Expense",category:"Electricity Bill",amount:2500,paymentMethod:"UPI",description:"Bill for last month",date:Lt.fromMillis(Date.now()-86400*10*1e3),createdAt:Lt.fromMillis(Date.now()-86400*10*1e3)}],f1=[{id:"demo-enquiry-1",studentName:"Laura Palmer",mobile:"5550101",interestedBatch:"Morning Physics - Grade 12",referenceSource:"Referral",followUpDate:Lt.fromMillis(Date.now()+86400*2*1e3),status:"New",createdAt:Lt.fromMillis(Date.now()-86400*1*1e3)},{id:"demo-enquiry-2",studentName:"Dale Cooper",mobile:"5550102",email:"coop@fbi.gov",interestedBatch:"Evening Maths - Grade 11",referenceSource:"Google",status:"Follow-up",notes:"Called once, needs a callback next week.",createdAt:Lt.fromMillis(Date.now()-86400*5*1e3)}],h1=[{id:"demo-route-1",routeName:"City Center Route",vehicleNumber:"KA-01-AB-1234",driverName:"John Doe",driverContact:"9988776655",points:"Main Square, Central Mall, Library Corner",monthlyFee:800}],Gn=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),Mc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-16.512A8.967 8.967 0 0118 3.75c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-16.512v16.5"})}),Um=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M21.71,6.29,12.71,2.29a2,2,0,0,0-1.42,0L2.29,6.29a2,2,0,0,0-1,1.72V14a2,2,0,0,0,1,1.72l8.29,4a2,2,0,0,0,1.42,0l8.29-4a2,2,0,0,0,1-1.72V8A2,2,0,0,0,21.71,6.29ZM4,13.24V8.76L11,12.25v4Zm15,0-7-3.49V8.25L19,5.76V13a1,1,0,0,0,.5.87l.18.09Z"})}),yh=[Gn,Mc,Um],Ar=({message:t="Loading..."})=>{const[e,n]=q.useState(0);return q.useEffect(()=>{const r=setInterval(()=>{n(a=>(a+1)%yh.length)},700);return()=>clearInterval(r)},[]),s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-10",children:[s.jsx("div",{className:"relative w-12 h-12",children:yh.map((r,a)=>s.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-opacity duration-300 ${e===a?"opacity-100":"opacity-0"}`,children:s.jsx(r,{className:"w-12 h-12 text-indigo-500 dark:text-indigo-400"})},a))}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:t})]})};function g1(){return s.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-gray-900",children:s.jsx(Ar,{message:"Loading App..."})})}const m1="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUwIiBoZWlnaHQ9IjEzMCIgdmlld0JveD0iMCAwIDI1MCAxMzAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA0LCAxMCkgc2NhbGUoMS44KSI+PHBhdGggZD0iTTEwIDEyIEgxOCBWMTUgSDIyIFYyMSBINiBWMTUgSDEwIFYxMiBaIiBmaWxsPSIjRDUwMDAwIi8+PHBhdGggZD0iTTggNSBIMjAgTDE4IDExIEgxMCBaIiBmaWxsPSIjRDUwMDAwIi8+PC9nPjx0ZXh0IHg9IjEyNSIgeT0iOTAiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBPeHlnZW4sIFVidW50dSwgQ2FudGFyZWxsLCAnT3BlbiBTYW5zJywgJ0hlbHZldGljYSBOZXVlJywgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyOCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiMwNTMwNkMiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkNMQVNTIENBUFRBSU48L3RleHQ+PHRleHQgeD0iMTI1IiB5PSIxMTAiIGZvbnQtZmFtaWx5PSJzeXN0ZW0tdWksIC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBPeHlnZW4sIFVidW50dSwgQ2FudGFyZWxsLCAnT3BlbiBTYW5zJywgJ0hlbHZldGljYSBOZXVlJywgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZmlsbD0iIzNDNDA0MyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgbGV0dGVyLXNwYWNpbmc9IjIiPkdFVCBPUkdBTklTRUQ8L3RleHQ+PC9zdmc+",p1="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCAyOCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTAgMTIgSDE4IFYxNSBIMjIgVjIxIEg2IFYxNSBIMTAgVjEyIFoiIGZpbGw9IiNENUwMDAwIi8+PHBhdGggZD0iTTggNSBIMjAgTDE4IDExIEgxMCBaIiBmaWxsPSIjRDUwMDAwIi8+PC9zdmc+",x1=t=>{const{className:e,...n}=t;return s.jsx("img",{src:m1,alt:"Class Captain Logo",className:e,...n})},hi=t=>{const{className:e,...n}=t;return s.jsx("img",{src:p1,alt:"Class Captain Logo",className:e,...n})},Ge=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),Dc=({title:t,subtitle:e,children:n,onBack:r})=>s.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center px-4 py-4 bg-gradient-to-br from-purple-50 to-slate-100 dark:from-indigo-900 dark:to-gray-900",children:[r&&s.jsx("div",{className:"absolute top-5 left-5",children:s.jsx("button",{onClick:r,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700",children:s.jsx(Ge,{className:"w-6 h-6"})})}),s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx(x1,{className:"w-64"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:t}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:e})]}),s.jsx("div",{className:"w-full max-w-sm",children:n})]}),of=({children:t})=>s.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg",children:t}),Zn=be.forwardRef(({icon:t,label:e,...n},r)=>s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:n.id||n.name,className:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:e}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-400",children:t}),s.jsx("input",{id:n.id||n.name,className:"w-full bg-white dark:bg-gray-700 text-black dark:text-white pl-10 pr-3 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none transition",...n,ref:r})]})]}));Zn.displayName="FormInput";const w1=({children:t})=>s.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-900/40 border-l-4 border-indigo-300 dark:border-indigo-600 p-4 rounded-r-lg mt-6",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("span",{className:"text-lg",children:"ðŸ“"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-bold text-indigo-800 dark:text-indigo-300",children:"Note:"}),s.jsx("p",{className:"text-sm text-indigo-700 dark:text-indigo-200 mt-1",children:t})]})]})}),y1="ðŸ‘¨â€ðŸ«",b1="ðŸ‘©â€ðŸ«",v1="ðŸ‘©â€ðŸŽ“",_d=({emoji:t,label:e,onClick:n})=>s.jsxs("button",{onClick:n,className:"w-full flex flex-col items-center gap-2 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-900 focus:ring-indigo-500",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-2xl shadow-lg",children:s.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center w-24 h-24",children:s.jsx("span",{className:"text-5xl",children:t})})}),s.jsx("span",{className:"bg-indigo-600 text-white font-semibold px-8 py-1.5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors",children:e})]}),B1=({onSelectRole:t,onBack:e})=>s.jsxs(Dc,{title:"Select an option",subtitle:"Choose your role to continue",onBack:e,children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx(_d,{emoji:y1,label:"Admin Login",onClick:()=>t("academy")}),s.jsx(_d,{emoji:b1,label:"Teacher Login",onClick:()=>t("staff")}),s.jsx(_d,{emoji:v1,label:"Student Login",onClick:()=>t("student")})]}),s.jsxs("div",{className:"text-center mt-4 text-xs text-gray-500 dark:text-gray-400",children:[s.jsx("p",{children:"By signing in you agree to our"}),s.jsx("a",{href:"#",className:"underline hover:text-indigo-600 dark:hover:text-indigo-400",children:"Privacy Policy"})]})]}),ks=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6h1.5m-1.5 3h1.5m-1.5 3h1.5M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})}),SA=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})}),hu=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H4.5a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})}),Pc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),jm=t=>s.jsxs("svg",{...t,viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"}),s.jsx("path",{fill:"#FF3D00",d:"M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"}),s.jsx("path",{fill:"#4CAF50",d:"M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.223 0-9.657-3.357-11.303-8H2.394v8.008C5.807 40.01 14.464 44 24 44z"}),s.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.16-4.082 5.571l6.19 5.238C42.01 35.638 44 30.138 44 24c0-1.341-.138-2.65-.389-3.917z"})]}),Us=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 12.75h.008v.008H12v-.008zm0 3h.008v.008H12v-.008zm-3-3h.008v.008H9v-.008zm0 3h.008v.008H9v-.008zm-3-3h.008v.008H6v-.008zm0 3h.008v.008H6v-.008zm6 3h.008v.008H12v-.008zm-3 0h.008v.008H9v-.008zm6-3h.008v.008h-.008v-.008zm-6 0h.008v.008H9v-.008zm6 0h.008v.008h-.008v-.008z"})}),C1=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Tm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a2.25 2.25 0 01-2.25 2.25h-1.5a2.25 2.25 0 01-2.25-2.25v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})}),bh=`rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // By default, deny all reads and writes
    match /{document=**} {
      allow read, write: if false;
    }
    
    // Helper function: Checks if the requesting user is the admin of the academy
    function isOwner(academyId) {
      return request.auth.uid == get(/databases/$(database)/documents/academies/$(academyId)).data.adminUid;
    }
    
    // Allow users to be created and read their own user mapping doc
    match /users/{userId} {
      allow read, create: if request.auth.uid == userId;
    }

    // Allow academy creation and lookup by any authenticated user
    match /academies/{academyId} {
      allow get, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if isOwner(academyId);

      // --- Academy Sub-collections ---

      // Admin-only write access for most sub-collections.
      // Specific sub-collections like 'leaveRequests' have their own rules below.
      match /(students|staff|fees|transactions|enquiries|studyMaterial|homework|quizzes|tasks|notices|transportRoutes|staffAttendance)/{docId} {
        allow read: if request.auth != null;
        allow write: if isOwner(academyId);
      }
      
      // Batches can be written by admin
      match /batches/{batchId} {
        allow read, write: if isOwner(academyId);

        // Attendance can be written by anyone authenticated (staff)
        match /attendance/{date} {
           allow read, write: if request.auth != null;
        }
      }

      // Exams can be written by admin
      match /exams/{examId} {
        allow read, write: if isOwner(academyId);

        // Marks can be written by anyone authenticated (staff)
        match /marks/{studentId} {
           allow read, write: if request.auth != null;
        }
      }
      
      // Quiz Submissions (students can write)
      match /quizzes/{quizId}/submissions/{studentId} {
         allow read, write: if request.auth != null;
      }
      
      // Homework Submissions (students can write)
      match /homework/{homeworkId}/submissions/{studentId} {
        allow read, write: if request.auth != null;
      }

      // Leave Requests (students/staff can create, admin/staff can update)
      match /leaveRequests/{leaveId} {
          // Allow read, create, and update for any authenticated user (permissive, but consistent with app model).
          allow read, create, update: if request.auth != null;
          // Only Admins should delete.
          allow delete: if isOwner(academyId);
      }
    }
  }
}`;function N1({onClose:t}){const[e,n]=be.useState(!1),r=()=>{navigator.clipboard.writeText(bh).then(()=>{n(!0),setTimeout(()=>n(!1),2e3)})};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg w-full max-w-lg mx-auto text-left animate-fade-in-up max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/40",children:s.jsx(C1,{className:"h-7 w-7 text-red-600 dark:text-red-400"})}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Login Failed: Configuration Required"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"The student/staff login requires specific settings in your Firebase project. Please complete the one-time setup steps below."})]})]}),s.jsxs("div",{className:"space-y-4 overflow-y-auto pr-2 flex-grow",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg",children:[s.jsxs("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:[s.jsx("span",{className:"font-mono bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 rounded-full text-sm w-6 h-6 inline-flex items-center justify-center mr-2",children:"1"}),"Enable Anonymous Sign-In"]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"This allows the app to temporarily get read-only access to verify student/staff details without a password."}),s.jsxs("ol",{className:"list-decimal list-inside text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1 pl-2",children:[s.jsxs("li",{children:["Go to your ",s.jsx("a",{href:"https://console.firebase.google.com/",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 dark:text-indigo-400 hover:underline",children:"Firebase Console"}),"."]}),s.jsxs("li",{children:["Navigate to ",s.jsx("span",{className:"font-semibold",children:"Authentication"})," â†’ ",s.jsx("span",{className:"font-semibold",children:"Sign-in method"}),"."]}),s.jsxs("li",{children:["Click ",s.jsx("span",{className:"font-semibold",children:"Add new provider"})," and select ",s.jsx("span",{className:"font-semibold",children:"Anonymous"}),"."]}),s.jsx("li",{children:"Enable the provider and click Save."})]})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"font-bold text-gray-800 dark:text-gray-200",children:[s.jsx("span",{className:"font-mono bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 rounded-full text-sm w-6 h-6 inline-flex items-center justify-center mr-2",children:"2"}),"Set Firestore Security Rules"]}),s.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 px-2 py-1 text-xs font-semibold bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",children:[s.jsx(Tm,{className:"w-4 h-4"}),e?"Copied!":"Copy Rules"]})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"These rules allow read access for login, while restricting all write operations to the academy admin."}),s.jsxs("ol",{className:"list-decimal list-inside text-sm text-gray-600 dark:text-gray-400 mt-2 space-y-1 pl-2",children:[s.jsxs("li",{children:["Go to ",s.jsx("span",{className:"font-semibold",children:"Firestore Database"})," â†’ ",s.jsx("span",{className:"font-semibold",children:"Rules"})," tab."]}),s.jsx("li",{children:"Replace the entire content with the code below."})]}),s.jsx("pre",{className:"mt-2 text-xs bg-black text-white p-3 rounded-md overflow-x-auto",children:s.jsx("code",{children:bh})})]})]}),s.jsx("div",{className:"mt-6 flex-shrink-0",children:s.jsx("button",{onClick:t,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"I've completed the steps, Try Again"})})]})})}const S1=({activeRole:t,onRoleChange:e})=>{const n=[{id:"academy",name:"Academy",icon:s.jsx(ks,{className:"w-5 h-5"})},{id:"student",name:"Student",icon:s.jsx(Pc,{className:"w-5 h-5"})},{id:"staff",name:"Teacher/Staff",icon:s.jsx(Mc,{className:"w-5 h-5"})}];return s.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-1 rounded-lg flex justify-between gap-1 mb-6",children:n.map(({id:r,name:a,icon:i})=>s.jsxs("button",{onClick:()=>e(r),className:`w-full flex items-center justify-center gap-2 py-2.5 rounded-md text-sm font-semibold transition-colors ${t===r?"bg-white dark:bg-gray-800 text-indigo-600 dark:text-indigo-400 shadow-sm":"text-gray-500 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[i,a]},r))})},I1=({onCancel:t,onRegister:e})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:s.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg max-w-sm mx-4 text-center",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Account Not Found"}),s.jsx("p",{className:"text-gray-600 mt-2 mb-6",children:"We couldn't find an academy account for that email. Please check for typos or register a new academy."}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("button",{onClick:e,className:"w-full bg-indigo-600 text-white font-bold py-2.5 rounded-lg hover:bg-indigo-700 transition-colors",children:"Register Academy"}),s.jsx("button",{onClick:t,className:"w-full bg-gray-200 text-gray-800 font-bold py-2.5 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})]})}),lf=({credentials:t})=>s.jsxs("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700/50 p-3 rounded-lg border dark:border-gray-600",children:[s.jsx("p",{className:"font-bold text-center mb-1 text-gray-600 dark:text-gray-300",children:"For Demo"}),Object.entries(t).map(([e,n])=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{className:"font-semibold",children:[e,":"]}),s.jsx("span",{className:"font-mono",children:n})]},e))]}),F1=({setIsLoading:t,setError:e,onLoginFailed:n,onLogin:r})=>{const[a,i]=be.useState("");be.useEffect(()=>{const c=sessionStorage.getItem("registration_email");c&&i(c)},[]);const A=c=>{const d=c.target.value;i(d),sessionStorage.setItem("registration_email",d)},o=async()=>{e(""),t(!0);const c=new Ko.auth.GoogleAuthProvider;try{await Cn.signInWithPopup(c)}catch(d){console.error("Google Login Popup Error:",d),e(d.message||"Failed to sign in with Google."),t(!1)}},l=async c=>{c.preventDefault(),e(""),t(!0);const h=c.target.elements.namedItem("password"),p=a,m=h.value;if(p==="demo@classcaptain.com"&&m==="demo123"){r({role:"admin",data:{id:"demo-academy-id",academyId:"DEMO",name:"Demo Academy",adminUid:"demo-admin-uid",adminEmail:"demo@classcaptain.com",status:"active"}}),t(!1);return}try{await Cn.signInWithEmailAndPassword(p,m)}catch(B){B.code==="auth/invalid-credential"||B.code==="auth/user-not-found"||B.code==="auth/wrong-password"?(await Cn.fetchSignInMethodsForEmail(p).catch(()=>[])).length===0?n():e("Incorrect password. Please try again."):(console.error("Login Error:",B),e(B.message||"An error occurred during login.")),t(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:l,children:[s.jsx(Zn,{icon:s.jsx(SA,{className:"w-5 h-5"}),label:"Email Address",type:"email",name:"email",placeholder:"Enter your email",required:!0,value:a,onChange:A}),s.jsx(Zn,{icon:s.jsx(hu,{className:"w-5 h-5"}),label:"Password",type:"password",name:"password",placeholder:"Enter your password",required:!0}),s.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md mt-4",children:"Sign in"}),s.jsx(lf,{credentials:{Email:"demo@classcaptain.com",Password:"demo123"}})]}),s.jsxs("div",{className:"relative my-4",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"OR"})})]}),s.jsxs("button",{type:"button",onClick:o,className:"w-full flex items-center justify-center gap-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 font-semibold py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors shadow-sm",children:[s.jsx(jm,{className:"w-5 h-5"}),"Sign in with Google"]})]})},Qm=async(t,e,{setIsLoading:n,setError:r,onLogin:a,setShowConfigError:i})=>{t.preventDefault(),r(""),n(!0);const A=t.target,o=A.elements.namedItem("academyId").value.trim().toUpperCase(),l=A.elements.namedItem(e==="student"?"rollNumber":"staffId").value.trim().toUpperCase(),c=A.elements.namedItem("dob").value,d=e==="student"?"students":"staff",h=e==="student"?"rollNumber":"staffId",p=e==="student"?Em:km;if(o==="DEMO"){const y=p.find(b=>b[h]===l&&b.dob===c);y?a({role:e,data:y,academyId:o,academyName:"Demo Academy"}):r("Invalid demo credentials."),n(!1);return}let m=!1,B=!1;try{(!Cn.currentUser||!Cn.currentUser.isAnonymous)&&await Cn.signInAnonymously();const y=ui(Bn(Te,"academies"),fi("academyId","==",o)),b=await Qa(y);if(b.empty)r(`Academy with ID ${o} not found.`);else{const C=b.docs[0],N=C.id,k=C.data().name,E=ui(Bn(Te,`academies/${N}/${d}`),fi(h,"==",l)),_=await Qa(E);if(_.empty)r(`${e.charAt(0).toUpperCase()+e.slice(1)} not found with that ID.`);else{const M=_.docs[0],D={id:M.id,...M.data()};D.dob===c?(B=!0,a({role:e,data:D,academyId:N,academyName:k})):r("Incorrect Date of Birth.")}}}catch(y){console.error(y),y.code==="auth/operation-not-allowed"||y.code==="auth/admin-restricted-operation"||y.code==="permission-denied"||y.code==="missing-permission"?(i(!0),m=!0):r("An error occurred during login. Please try again.")}finally{!m&&!B&&n(!1)}},E1=t=>{const e=n=>Qm(n,"student",t);return s.jsxs("form",{onSubmit:e,children:[s.jsx(Zn,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Academy ID",type:"text",name:"academyId",placeholder:"e.g. SUNSHINE",required:!0,autoCapitalize:"characters"}),s.jsx(Zn,{icon:s.jsx(Pc,{className:"w-5 h-5"}),label:"Roll Number",type:"text",name:"rollNumber",placeholder:"e.g. S001",required:!0,autoCapitalize:"characters"}),s.jsx(Zn,{icon:s.jsx(Us,{className:"w-5 h-5"}),label:"Date of Birth",type:"date",name:"dob",required:!0}),s.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md mt-4",children:"Sign in"}),s.jsx(lf,{credentials:{"Academy ID":"DEMO","Roll Number":"S001","Date of Birth":"2006-05-15"}})]})},k1=t=>{const e=n=>Qm(n,"staff",t);return s.jsxs("form",{onSubmit:e,children:[s.jsx(Zn,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Academy ID",type:"text",name:"academyId",placeholder:"e.g. SUNSHINE",required:!0,autoCapitalize:"characters"}),s.jsx(Zn,{icon:s.jsx(Mc,{className:"w-5 h-5"}),label:"Staff ID",type:"text",name:"staffId",placeholder:"e.g. ALAN",required:!0,autoCapitalize:"characters"}),s.jsx(Zn,{icon:s.jsx(Us,{className:"w-5 h-5"}),label:"Date of Birth",type:"date",name:"dob",required:!0}),s.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md mt-4",children:"Sign in"}),s.jsx(lf,{credentials:{"Academy ID":"DEMO","Staff ID":"T01","Date of Birth":"1970-03-15"}})]})};function vh({onLogin:t,onNavigateToRegister:e,externalError:n,clearExternalError:r,initialRole:a,onGoBack:i}){const[A,o]=be.useState(a),[l,c]=be.useState(!1),[d,h]=be.useState(""),[p,m]=be.useState(!1),[B,y]=be.useState(!1);be.useEffect(()=>{o(a)},[a]),be.useEffect(()=>{n&&h(n)},[n]);const b=k=>{r(),h(k)},C=k=>{o(k),h(""),r()},N={setIsLoading:c,setError:b,onLogin:t,setShowConfigError:y};return s.jsxs(s.Fragment,{children:[B&&s.jsx(N1,{onClose:()=>{y(!1),c(!1)}}),s.jsxs(Dc,{title:"Welcome Back!",subtitle:"Please sign in to continue",onBack:i,children:[s.jsxs(of,{children:[s.jsx(S1,{activeRole:A,onRoleChange:C}),A==="academy"&&s.jsx(F1,{setIsLoading:c,setError:b,onLoginFailed:()=>m(!0),onLogin:t}),A==="student"&&s.jsx(E1,{...N}),A==="staff"&&s.jsx(k1,{...N}),d&&s.jsx("p",{className:"text-red-500 text-sm text-center mt-4",children:d}),l&&s.jsx("div",{className:"absolute inset-0 bg-white/50 dark:bg-gray-800/50 flex justify-center items-center rounded-2xl",children:s.jsx(Ar,{})})]}),s.jsxs("div",{className:"text-center mt-6 space-y-2",children:[A==="academy"&&s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Don't have an account?"," ",s.jsx("button",{onClick:e,className:"font-medium text-indigo-600 dark:text-indigo-400 hover:underline",children:"Register here"})]}),s.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700 mt-4",children:s.jsx("a",{href:"/superadmin/",className:"text-xs text-gray-400 hover:text-indigo-500 transition-colors",children:"Super Admin Portal"})})]}),p&&s.jsx(I1,{onCancel:()=>m(!1),onRegister:()=>{m(!1),e()}})]})]})}const cf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.181-3.183m-11.664-5.25v4.992m0 0h-4.992m4.992 0l-3.181-3.183a8.25 8.25 0 0111.664 0l-3.181 3.183"})}),cs=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Lm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),U1=(t,e)=>{const[n,r]=be.useState(t);return be.useEffect(()=>{const a=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(a)}},[t,e]),n};function j1({onNavigateToLogin:t}){const[e,n]=be.useState(""),[r,a]=be.useState(!1),[i,A]=be.useState(""),[o,l]=be.useState(""),[c,d]=be.useState(""),[h,p]=be.useState(""),[m,B]=be.useState("idle"),y=U1(h,200);be.useEffect(()=>{const k=sessionStorage.getItem("registration_email");k&&A(k)},[]),be.useEffect(()=>{if(o&&!h){const k=o.split(" ").map(E=>E.replace(/[^a-zA-Z0-9]/g,"")).join("").substring(0,10).toUpperCase();k&&p(k)}},[o]),be.useEffect(()=>{if(y.length<3){B("idle");return}(async()=>{B("checking");const E=ui(Bn(Te,"academies"),fi("academyId","==",y)),_=await Qa(E);B(_.empty?"available":"taken")})()},[y]);const b=async()=>{if(n(""),!o.trim()||!h.trim()||!c.trim()){n("Please enter your name, institute's name, and choose an Academy ID.");return}if(m!=="available"){n("Please choose an available Academy ID.");return}a(!0);try{sessionStorage.setItem("google_reg_flow","true"),sessionStorage.setItem("google_reg_institute_name",o),sessionStorage.setItem("google_reg_academy_id",h),sessionStorage.setItem("google_reg_admin_name",c);const k=new Ko.auth.GoogleAuthProvider;await Cn.signInWithPopup(k)}catch(k){console.error("Google Registration Popup Error:",k),n(k.message||"Failed to start sign up with Google."),a(!1)}},C=async k=>{if(k.preventDefault(),n(""),m!=="available"||!c.trim()){n("Please enter your name and choose an available Academy ID.");return}a(!0);const E=k.target,_=E.elements.namedItem("password").value,M=E.elements.namedItem("confirmPassword").value;if(_!==M){n("Passwords do not match."),a(!1);return}try{sessionStorage.setItem("registration_institute_name",o),sessionStorage.setItem("registration_academy_id",h),sessionStorage.setItem("registration_admin_name",c),await Cn.createUserWithEmailAndPassword(i,_)}catch(D){D.code==="auth/email-already-in-use"?n("This email address is already registered. Please try logging in."):(console.error("Registration Error:",D),n(D.message||"An unexpected error occurred during registration.")),sessionStorage.removeItem("registration_institute_name"),sessionStorage.removeItem("registration_academy_id"),sessionStorage.removeItem("registration_admin_name"),a(!1)}},N=()=>{if(h.length>0&&h.length<3)return s.jsx("p",{className:"text-xs text-gray-500 mt-1 pl-1",children:"ID must be at least 3 characters."});if(h.length<3||m==="idle"&&y.length<3)return s.jsx("div",{className:"h-[20px] mt-1"});switch(m){case"checking":return s.jsxs("p",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1 pl-1",children:[s.jsx(cf,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"Checking availability..."})]});case"available":return s.jsxs("p",{className:"flex items-center gap-1 text-xs text-green-600 mt-1 pl-1",children:[s.jsx(cs,{className:"w-4 h-4"}),s.jsx("span",{children:"Available!"})]});case"taken":return s.jsxs("p",{className:"flex items-center gap-1 text-xs text-red-600 mt-1 pl-1",children:[s.jsx(Lm,{className:"w-4 h-4"}),s.jsx("span",{children:"This ID is already taken."})]});default:return s.jsx("div",{className:"h-[20px] mt-1"})}};return s.jsx(Dc,{title:"Create Your Account",subtitle:"Register your coaching institute with Class Captain",children:s.jsxs(of,{children:[s.jsxs("form",{onSubmit:C,className:"space-y-4",children:[s.jsx(Zn,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Institute Name",type:"text",name:"instituteName",placeholder:"Enter institute name",required:!0,value:o,onChange:k=>l(k.target.value)}),s.jsx(Zn,{icon:s.jsx(Pc,{className:"w-5 h-5"}),label:"Your Name",type:"text",name:"adminName",placeholder:"Enter your full name",required:!0,value:c,onChange:k=>d(k.target.value)}),s.jsxs("div",{children:[s.jsx(Zn,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Academy ID",type:"text",name:"academyId",placeholder:"e.g. SUNSHINE",required:!0,value:h,onChange:k=>p(k.target.value.toUpperCase().replace(/[^A-Z0-9]/g,""))}),N()]}),s.jsx(Zn,{icon:s.jsx(SA,{className:"w-5 h-5"}),label:"Email Address",type:"email",name:"email",placeholder:"Enter your email",required:!0,value:i,onChange:k=>A(k.target.value)}),s.jsx(Zn,{icon:s.jsx(hu,{className:"w-5 h-5"}),label:"Password",type:"password",name:"password",placeholder:"Create a password",required:!0}),s.jsx(Zn,{icon:s.jsx(hu,{className:"w-5 h-5"}),label:"Confirm Password",type:"password",name:"confirmPassword",placeholder:"Confirm your password",required:!0}),e&&s.jsx("p",{className:"text-red-500 text-sm text-center -mt-2 mb-2",children:e}),s.jsx("button",{type:"submit",disabled:r||m!=="available",className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:r?"Creating Account...":"Create Account"})]}),s.jsxs("div",{className:"relative my-4",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"OR"})})]}),s.jsxs("button",{type:"button",onClick:b,disabled:r||m!=="available",className:"w-full flex items-center justify-center gap-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 font-semibold py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors shadow-sm disabled:opacity-50",children:[s.jsx(jm,{className:"w-5 h-5"}),"Sign up with Google"]}),s.jsx("div",{className:"text-center mt-6",children:s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Already have an account?"," ",s.jsx("button",{onClick:t,className:"font-medium text-indigo-600 dark:text-indigo-400 hover:underline",children:"Sign in here"})]})}),s.jsx(w1,{children:"Your Academy ID is a unique, memorable code your students and staff will use to log in."})]})})}function T1({onComplete:t,onLogout:e,userEmail:n,externalError:r,clearExternalError:a}){const[i,A]=be.useState(""),[o,l]=be.useState(!1),[c,d]=be.useState("");q.useEffect(()=>{r&&d(r)},[r]);const h=m=>{a(),d(m)},p=async m=>{if(m.preventDefault(),h(""),!i.trim()){h("Institute name is required.");return}l(!0),await t(i)};return s.jsx(Dc,{title:"Complete Your Registration",subtitle:`Just one more step, ${n}`,children:s.jsxs(of,{children:[s.jsxs("form",{onSubmit:p,children:[s.jsx("p",{className:"text-sm text-center text-gray-600 dark:text-gray-300 mb-6",children:"It looks like your account was created but your institute details weren't saved. Please provide your institute's name to finish setup."}),s.jsx(Zn,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Institute Name",type:"text",name:"instituteName",placeholder:"Enter your institute's name",required:!0,value:i,onChange:m=>A(m.target.value)}),c&&s.jsx("p",{className:"text-red-500 text-sm text-center mt-4",children:c}),s.jsx("button",{type:"submit",disabled:o,className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md mt-4 disabled:bg-indigo-300",children:o?"Saving...":"Complete Registration"})]}),s.jsx("div",{className:"text-center mt-6",children:s.jsx("button",{onClick:e,className:"text-sm text-gray-500 dark:text-gray-400 hover:underline",children:"Not you? Logout"})})]})})}const Rc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})}),df=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"})}),uf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),ff=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})}),Q1=({trialEndsAt:t,onNavigate:e})=>{const[n,r]=be.useState(0);return be.useEffect(()=>{if(t){const a=t.toMillis(),i=Date.now(),A=Math.ceil((a-i)/(1e3*60*60*24));r(Math.max(0,A))}},[t]),n<=0?null:s.jsx("div",{className:"bg-yellow-400 text-yellow-900 text-sm font-bold text-center p-2",children:s.jsxs("button",{onClick:()=>e("subscription"),className:"w-full",children:["You have ",n," ",n===1?"day":"days"," left in your trial. Upgrade Now!"]})})};function L1({academy:t,onLogout:e,onToggleNav:n,onNavigate:r,theme:a,onToggleTheme:i,notificationCount:A}){const[o,l]=be.useState("");be.useEffect(()=>{const d=new Date().getHours();d<12?l("Good Morning"):d<17?l("Good Afternoon"):l("Good Evening")},[]);const c=t.adminName||t.name;return s.jsxs("header",{className:"bg-indigo-700 text-white shadow-md sticky top-0 z-30",children:[t.subscriptionStatus==="trialing"&&t.trialEndsAt&&s.jsx(Q1,{trialEndsAt:t.trialEndsAt,onNavigate:r}),s.jsxs("div",{className:"p-4 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[s.jsx("button",{onClick:n,className:"flex-shrink-0 text-indigo-200 hover:text-white transition-colors p-2 -ml-2 rounded-full","aria-label":"Open navigation menu",children:s.jsx(uf,{className:"w-6 h-6"})}),t.logoUrl&&s.jsx("img",{src:t.logoUrl,alt:"Academy Logo",className:"w-10 h-10 rounded-full object-cover flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("h1",{className:"text-base sm:text-lg md:text-xl font-bold truncate",children:[o,", ",c,"!"]}),s.jsxs("p",{className:"text-sm text-indigo-200 mt-1 truncate",children:["Academy ID: ",t.academyId]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:i,className:"text-indigo-200 hover:text-white transition-colors","aria-label":"Toggle dark mode",children:a==="light"?s.jsx(df,{className:"w-6 h-6"}):s.jsx(ff,{className:"w-6 h-6"})}),s.jsxs("button",{onClick:()=>r("notifications"),className:"relative text-indigo-200 hover:text-white transition-colors","aria-label":"Notifications",children:[s.jsx(Rc,{className:"w-6 h-6"}),A>0&&s.jsx("span",{className:"absolute -top-1 -right-2 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-indigo-700",children:A>9?"9+":A})]})]})]})]})}const _m=({name:t,Icon:e,color:n,onClick:r})=>{const a=!!r,i=A=>{r&&(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),r())};return s.jsxs("div",{className:`flex flex-col items-center justify-start group ${a?"cursor-pointer":""}`,onClick:r,onKeyDown:i,role:a?"button":void 0,tabIndex:a?0:void 0,"aria-label":a?t:void 0,children:[s.jsx("div",{className:`w-14 h-14 sm:w-16 sm:h-16 rounded-full flex items-center justify-center text-white shadow-lg transform group-hover:scale-110 transition-transform duration-200 ${n}`,children:s.jsx(e,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx("p",{className:"mt-2 text-xs font-medium text-gray-700 dark:text-gray-300",children:t})]})},Hc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),gi=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),Xs=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M9 12c2.21 0 4-1.79 4-4s-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4zm0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zM9 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm-6 4c.22-.72 3.31-2 6-2 2.7 0 5.8 1.29 6 2H3zm17.6-5.88l-2.12-2.12-1.41 1.41L18.07 16l-1.06 1.06 1.41 1.41 2.12-2.12c.39-.39.39-1.02 0-1.41z"})}),Jo=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:[s.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),s.jsx("path",{d:"M12 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm-2-3h4v2h-4v-2z"})]}),hf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2l-.01-12zM12 15l-4-4h3V9h2v2h3l-4 4z"})}),mi=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"})}),gf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),Oc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),mf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16H8v-2h4v2zm0-4H8v-2h4v2zm4-4h-4V3.5L18.5 9H12v5z"})}),Mm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"})}),Dm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4zm12 15H6c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h.5v10.5l3-2.25 3 2.25V3H18c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1z"})}),Pm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6zm8.41 9.41L15.59 12.24l-1.41-1.41L12 12.83l-1.17-1.17-1.41 1.41 1.41 1.41L12.41 15.41z"})}),Zs=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"})}),Rm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"m14 10.4-3.5 3.5-1.5-1.5L7.6 14l2.9 2.9.1.1 4.9-4.9-1.5-1.5zM19.5 3H18V1h-2v2H8V1H6v2H4.5C3.12 3 2 4.12 2 5.5v14C2 20.88 3.12 22 4.5 22h15c1.38 0 2.5-1.12 2.5-2.5v-14C22 4.12 20.88 3 19.5 3zM20 19.5c0 .28-.22.5-.5.5h-15a.5.5 0 0 1-.5-.5v-12c0-.28.22-.5.5-.5h15c.28 0 .5.22.5.5v12z"})}),EA=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})}),Gc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-5H3V6h14v7z"})}),Hm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})}),pi=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5h1.5v.75h-1.5v-.75zm.75 1.5v-1.5m0 0H3.75m0 0h1.5m1.5 0v1.5m0 0h-1.5m0 0h.008v.008H9v-.008zm.75 5.25h.008v.008h-.008v-.008zm-.75.75h.008v.008h-.008v-.008zm.75 2.25h.008v.008h-.008V18zm-.75.75h.008v.008h-.008v-.008zm.75 2.25h.008v.008h-.008V21zm-.75.75h.008v.008h-.008v-.008zM6 3.75c0-1.036.84-1.875 1.875-1.875h8.25c1.035 0 1.875.84 1.875 1.875v16.5c0 1.035-.84 1.875-1.875 1.875h-8.25A1.875 1.875 0 016 20.25V3.75z"})}),Ua=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),_1=[{name:"Batches",Icon:Hc,color:"bg-teal-500"},{name:"Students",Icon:gi,color:"bg-blue-600"},{name:"Timetable",Icon:pi,color:"bg-pink-500"},{name:"Attendance",Icon:Xs,color:"bg-purple-600"},{name:"Tuition Fees",Icon:Jo,color:"bg-emerald-500"},{name:"Income/Expenses",Icon:hf,color:"bg-orange-500"},{name:"Manage Exams",Icon:mi,color:"bg-lime-500"},{name:"Enquiry Manager",Icon:gf,color:"bg-cyan-500"},{name:"Staff Manager",Icon:Oc,color:"bg-sky-600"},{name:"Reports",Icon:mf,color:"bg-red-500"},{name:"Study Material",Icon:Mm,color:"bg-gray-700"},{name:"Homework",Icon:Dm,color:"bg-green-500"},{name:"Online Quiz",Icon:Pm,color:"bg-teal-600"},{name:"Leave Manager",Icon:Zs,color:"bg-blue-500"},{name:"To Do Task",Icon:Rm,color:"bg-slate-500"},{name:"Notice Board",Icon:EA,color:"bg-cyan-600"},{name:"Transport",Icon:Gc,color:"bg-amber-500"},{name:"Settings",Icon:Hm,color:"bg-red-600"}],Om=({title:t,total:e,active:n,inactive:r,Icon:a,onNavigate:i})=>s.jsxs("button",{onClick:i,className:"flex-1 bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md flex items-center gap-4 transition-transform transform hover:scale-105 w-full",children:[s.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/40 p-3 rounded-full",children:s.jsx(a,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t}),s.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:e}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n," Active / ",r," Inactive"]})]})]}),M1=({stats:t})=>{const[e,n]=q.useState(0),r=q.useRef(null),a=q.useRef(null),i=()=>{a.current&&clearTimeout(a.current)};return q.useEffect(()=>(i(),a.current=setTimeout(()=>n(A=>(A+1)%t.length),4e3),()=>{i()}),[e,t.length]),q.useEffect(()=>{if(r.current){const A=r.current.offsetWidth;r.current.scrollTo({left:e*A,behavior:"smooth"})}},[e]),s.jsxs("div",{className:"mt-8",children:[s.jsx("h3",{className:"text-base font-bold text-gray-800 dark:text-gray-100 mb-3 text-center",children:"Institute Stats"}),s.jsx("div",{ref:r,className:"flex overflow-x-auto snap-x snap-mandatory scroll-smooth scrollbar-hide -mx-2",children:t.map((A,o)=>s.jsx("div",{className:"flex-shrink-0 w-full snap-center px-2",children:s.jsx(Om,{...A})},o))}),s.jsx("div",{className:"flex justify-center items-center gap-2 mt-4",children:t.map((A,o)=>s.jsx("button",{onClick:()=>n(o),className:`w-2 h-2 rounded-full transition-all duration-300 ${e===o?"w-4 bg-indigo-600":"bg-gray-300 dark:bg-gray-600"}`,"aria-label":`Go to stat card ${o+1}`},o))})]})},D1=({transactions:t,onNavigate:e,viewMode:n,setViewMode:r})=>{const{totalIncome:a,totalExpenses:i}=q.useMemo(()=>{const c=new Date,d=c.getFullYear(),h=c.getMonth();return(n==="month"?t.filter(m=>{if(!m.date)return!1;const B=m.date&&typeof m.date.toDate=="function"?m.date.toDate():new Date(m.date);return isNaN(B.getTime())?!1:B.getFullYear()===d&&B.getMonth()===h}):t).reduce((m,B)=>(B.type==="Income"?m.totalIncome+=B.amount:m.totalExpenses+=B.amount,m),{totalIncome:0,totalExpenses:0})},[t,n]),A=a-i,o=a+i,l=o>0?a/o*100:0;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md mt-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-base font-bold text-gray-800 dark:text-gray-100",children:"Financial Overview"}),s.jsxs("div",{className:"bg-gray-200 dark:bg-gray-700 p-1 rounded-lg flex text-xs font-semibold",children:[s.jsx("button",{onClick:()=>r("month"),className:`px-3 py-1 rounded-md transition-all ${n==="month"?"bg-white dark:bg-gray-800 shadow text-indigo-600":"text-gray-600 dark:text-gray-300"}`,children:"This Month"}),s.jsx("button",{onClick:()=>r("overall"),className:`px-3 py-1 rounded-md transition-all ${n==="overall"?"bg-white dark:bg-gray-800 shadow text-indigo-600":"text-gray-600 dark:text-gray-300"}`,children:"Overall"})]})]}),s.jsx("div",{className:"w-full bg-red-200 dark:bg-red-900/40 rounded-full h-3 mb-4",children:s.jsx("div",{className:"bg-green-500 h-3 rounded-full",style:{width:`${l}%`},title:`Income: ${l.toFixed(1)}%`})}),s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Income"}),s.jsxs("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:["â‚¹",a.toLocaleString("en-IN")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-right",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Expenses"}),s.jsxs("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:["â‚¹",i.toLocaleString("en-IN")]})]}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"})]})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400",children:"Net Balance"}),s.jsxs("p",{className:`text-xl font-bold ${A>=0?"text-indigo-600 dark:text-indigo-400":"text-red-600 dark:text-red-400"}`,children:["â‚¹",A.toLocaleString("en-IN")]})]}),s.jsx("button",{onClick:()=>e("income-expenses"),className:"px-4 py-2 text-sm font-semibold text-indigo-600 bg-indigo-100 dark:bg-indigo-900/50 dark:text-indigo-300 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900",children:"View Details â†’"})]})]})};function Bh({onNavigate:t,academy:e,students:n,batches:r,staff:a,transactions:i,onShowDevPopup:A}){const[o,l]=q.useState("month"),c=N=>{switch(N){case"Batches":return()=>t("batches");case"Students":return()=>t("student-options");case"Timetable":return()=>t("schedule-classes");case"Tuition Fees":return()=>t("fees-options");case"Attendance":return()=>t("select-batch-attendance");case"Staff Manager":return()=>t("staff-options");case"Settings":return()=>t("settings");case"Income/Expenses":return()=>t("income-expenses");case"Manage Exams":return()=>t("manage-exams");case"Enquiry Manager":return()=>t("enquiry-manager");case"Reports":return()=>t("reports-options");case"Study Material":return()=>t("study-material");case"Homework":return()=>t("homework");case"Online Quiz":return()=>t("manage-quizzes");case"Leave Manager":return()=>t("leave-manager");case"To Do Task":return()=>t("todo-task");case"Notice Board":return()=>t("notice-board");case"Transport":return()=>t("transport-options");default:return()=>A(N)}},d=n.filter(N=>N.isActive).length,h=n.length-d,p=a.filter(N=>N.isActive).length,m=a.length-p,B=r.filter(N=>N.isActive).length,y=r.length-B,b=e.contactEmail||e.contactPhone||e.address,C=[{title:"Total Batches",total:r.length,active:B,inactive:y,Icon:Hc,onNavigate:()=>t("batches")},{title:"Total Students",total:n.length,active:d,inactive:h,Icon:gi,onNavigate:()=>t("student-options")},{title:"Total Staff",total:a.length,active:p,inactive:m,Icon:Oc,onNavigate:()=>t("staff-options")}];return s.jsxs("div",{className:"p-4 flex-grow pb-24 sm:pb-4",children:[s.jsxs("div",{className:"bg-indigo-600 text-white p-4 rounded-xl shadow-lg mb-6 flex items-center space-x-4",children:[s.jsx("div",{className:"bg-white/30 w-16 h-16 rounded-full flex items-center justify-center flex-shrink-0",children:e.logoUrl?s.jsx("img",{src:e.logoUrl,alt:"Academy Logo",className:"w-full h-full rounded-full object-cover"}):s.jsx(Um,{className:"w-9 h-9 text-white"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h2",{className:"text-xl font-bold truncate",children:e.name}),s.jsx("p",{className:"text-sm opacity-90 truncate",children:e.adminEmail}),s.jsxs("p",{className:"text-sm opacity-90",children:["Academy ID: ",e.academyId||"N/A"]})]})]}),b&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md mb-6 border border-gray-200 dark:border-gray-700",children:[s.jsx("h3",{className:"text-base font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Academy Details"}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[e.contactEmail&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(SA,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),s.jsx("span",{children:e.contactEmail})]}),e.contactPhone&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ua,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),s.jsx("span",{children:e.contactPhone})]}),e.address&&s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(ks,{className:"w-4 h-4 text-gray-400 dark:text-gray-500 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:e.address})]})]})]}),s.jsx("div",{className:"hidden sm:flex flex-col sm:flex-row gap-4 mb-8",children:C.map((N,k)=>s.jsx(Om,{...N},k))}),s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-y-6 gap-x-3 sm:gap-x-4 text-center",children:_1.map(N=>s.jsx(_m,{...N,onClick:c(N.name)},N.name))}),s.jsx("div",{className:"sm:hidden",children:s.jsx(M1,{stats:C})}),s.jsx(D1,{transactions:i,onNavigate:t,viewMode:o,setViewMode:l})]})}const P1=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"})}),pf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"none",children:s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})}),Gm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 01.778-.332 48.294 48.294 0 005.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})}),R1=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})});function H1({onNavigate:t,activePage:e,onOpenChatbot:n}){return s.jsx("footer",{className:"bg-white sticky bottom-0 w-full border-t border-gray-200 md:rounded-b-xl dark:bg-gray-800 dark:border-gray-700",children:s.jsxs("div",{className:"flex justify-around items-center h-16",children:[s.jsxs("button",{onClick:()=>t("dashboard"),className:`flex flex-col items-center font-semibold ${e==="dashboard"?"text-indigo-600 dark:text-indigo-400":"text-gray-500 dark:text-gray-400"}`,"aria-label":"Go to dashboard",children:[s.jsx(P1,{className:"w-6 h-6 mb-1"}),s.jsx("span",{className:"text-xs sm:text-sm",children:"Dashboard"})]}),s.jsx("div",{className:"relative -mt-12",children:s.jsx("button",{onClick:n,className:"w-16 h-16 rounded-full bg-indigo-600 text-white flex items-center justify-center shadow-lg border-4 border-white dark:border-gray-800","aria-label":"AI Chatbot",children:s.jsx(Gm,{className:"w-8 h-8"})})}),s.jsxs("button",{onClick:()=>t("my-account"),className:`flex flex-col items-center font-semibold ${e==="my-account"?"text-indigo-600 dark:text-indigo-400":"text-gray-500 dark:text-gray-400"}`,"aria-label":"Go to my account",children:[s.jsx(pf,{className:"w-6 h-6 mb-1"}),s.jsx("span",{className:"text-xs sm:text-sm",children:"My Account"})]})]})})}const In=t=>{const{strokeWidth:e=1.5,...n}=t;return s.jsx("svg",{...n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:e,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})},Wo=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),Vm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z"})}),O1=[{name:"Batches",Icon:Hc},{name:"Students",Icon:gi},{name:"Attendance",Icon:Xs},{name:"Timetable",Icon:pi},{name:"Tuition Fees",Icon:Jo},{name:"Subscription",Icon:Vm},{name:"Income/Expenses",Icon:hf},{name:"Manage Exams",Icon:mi},{name:"Enquiry Manager",Icon:gf},{name:"Staff Manager",Icon:Oc},{name:"Leave Manager",Icon:Zs},{name:"Reports",Icon:mf},{name:"Study Material",Icon:Mm},{name:"Homework",Icon:Dm},{name:"Online Quiz",Icon:Pm},{name:"To Do Task",Icon:Rm},{name:"Notice Board",Icon:EA},{name:"Transport",Icon:Gc},{name:"Settings",Icon:Hm}];function G1({isOpen:t,onClose:e,onNavigate:n,onLogout:r,onShowDevPopup:a}){const i=o=>{n(o),e()},A=o=>{switch(o){case"Batches":return()=>i("batches");case"Students":return()=>i("student-options");case"Timetable":return()=>i("schedule-classes");case"Tuition Fees":return()=>i("fees-options");case"Attendance":return()=>i("select-batch-attendance");case"Staff Manager":return()=>i("staff-options");case"Settings":return()=>i("settings");case"Subscription":return()=>i("subscription");case"Income/Expenses":return()=>i("income-expenses");case"Manage Exams":return()=>i("manage-exams");case"Enquiry Manager":return()=>i("enquiry-manager");case"Reports":return()=>i("reports-options");case"Study Material":return()=>i("study-material");case"Homework":return()=>i("homework");case"Online Quiz":return()=>i("manage-quizzes");case"Leave Manager":return()=>i("leave-manager");case"To Do Task":return()=>i("todo-task");case"Notice Board":return()=>i("notice-board");default:return()=>{a(o),e()}}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-30 transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true"}),s.jsx("aside",{className:`fixed top-0 left-0 h-full w-72 bg-white dark:bg-gray-800 shadow-xl z-40 transform transition-transform duration-300 ease-in-out ${t?"translate-x-0":"-translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidenav-title",children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hi,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"}),s.jsx("h2",{id:"sidenav-title",className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:"Class Captain"})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Close menu",children:s.jsx(In,{className:"w-6 h-6 text-gray-600 dark:text-gray-300"})})]}),s.jsx("nav",{className:"flex-grow overflow-y-auto py-4",children:s.jsx("ul",{children:O1.map(({name:o,Icon:l})=>s.jsx("li",{children:s.jsxs("button",{onClick:A(o),className:"w-full flex items-center px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-indigo-50 dark:hover:bg-gray-700 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",children:[s.jsx(l,{className:"w-6 h-6 mr-4 text-gray-400 dark:text-gray-500"}),s.jsx("span",{className:"font-medium",children:o})]})},o))})}),s.jsxs("footer",{className:"p-4 border-t dark:border-gray-700",children:[s.jsxs("button",{onClick:()=>i("my-account"),className:"w-full flex items-center px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-indigo-50 dark:hover:bg-gray-700 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors rounded-lg",children:[s.jsx(pf,{className:"w-6 h-6 mr-4 text-gray-400 dark:text-gray-500"}),s.jsx("span",{className:"font-medium",children:"My Account"})]}),s.jsxs("button",{onClick:r,className:"w-full flex items-center px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-red-50 dark:hover:bg-red-900/40 hover:text-red-600 dark:hover:text-red-400 transition-colors rounded-lg mt-2",children:[s.jsx(Wo,{className:"w-6 h-6 mr-4 text-gray-400 dark:text-gray-500"}),s.jsx("span",{className:"font-medium",children:"Logout"})]})]})]})})]})}const Lr=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),V1=t=>{if(!t)return"Unscheduled";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`},K1=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function q1({onBack:t,onCreate:e,batches:n,onViewStudents:r,onEditBatch:a}){return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Batches"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:n.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400 mb-4",children:"No batches have been created yet."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to add your first batch."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:n.map(i=>s.jsxs("div",{className:`bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 ${i.isActive?"border-indigo-500":"border-gray-400"} hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between`,children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:i.name}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:[i.teacher||"No Teacher"," Â· ",i.location||"No Location"]})]}),s.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[s.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded-full flex-shrink-0",children:V1(i.time)}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${i.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i.isActive?"Active":"Inactive"})]})]}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm text-gray-600 dark:text-gray-300",children:[s.jsxs("span",{className:"font-medium",children:[i.currentStudents," / ",i.maxSlots," Students"]}),s.jsx("div",{className:"flex space-x-1",children:K1.filter(A=>i.days.includes(A)).map(A=>s.jsx("span",{className:"text-xs font-semibold",children:A},A))})]})]}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-end space-x-2",children:[s.jsxs("button",{onClick:()=>a(i.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors","aria-label":`Edit batch ${i.name}`,children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>r(i.name),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors","aria-label":`View students in ${i.name}`,children:[s.jsx(gi,{className:"w-4 h-4"}),s.jsx("span",{children:"View Students"})]})]})]},i.id))})}),s.jsx("button",{onClick:e,className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Create New Batch",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}const Yo=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),mo=({label:t,id:e,icon:n,...r})=>s.jsxs("div",{className:"mb-6 relative",children:[s.jsx("label",{htmlFor:e,className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:t}),s.jsx("input",{id:e,className:"w-full bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-indigo-400 pb-2 text-lg text-gray-800 dark:text-gray-100 outline-none transition-colors",...r}),n&&s.jsx("label",{htmlFor:e,className:"absolute right-0 bottom-2 text-gray-400 cursor-pointer",children:n})]}),z1=({day:t,isSelected:e,onClick:n})=>s.jsx("button",{type:"button",onClick:n,className:`px-4 py-2 rounded-full border text-sm font-medium transition-colors ${e?"bg-indigo-600 border-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:t});function J1({onBack:t,onSave:e}){const[n,r]=be.useState(""),[a,i]=be.useState(""),[A,o]=be.useState(""),[l,c]=be.useState(""),[d,h]=be.useState(""),[p,m]=be.useState(new Set),[B,y]=be.useState(""),[b,C]=be.useState(void 0),N=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=_=>{m(M=>{const D=new Set(M);return D.has(_)?D.delete(_):D.add(_),D})},E=()=>{if(!n.trim()||!d.trim()){alert("Batch Name and Maximum Slots are required.");return}const _=B?parseInt(B,10):void 0,M={name:n.trim(),location:a,teacher:A,time:l,days:Array.from(p),maxSlots:parseInt(d,10)||0};if(_&&_>0&&b)M.batchFeeAmount=_,M.batchFeeType=b;else if(_&&!b){alert("Please select a fee type (Monthly/Yearly) for the batch fee.");return}e(M)};return s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to batches",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"New Batch"})]}),s.jsxs("form",{onSubmit:_=>{_.preventDefault(),E()},className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsx(mo,{id:"batchName",label:"Batch Name",value:n,onChange:_=>r(_.target.value),required:!0}),s.jsx(mo,{id:"batchLocation",label:"Batch Location",value:a,onChange:_=>i(_.target.value)}),s.jsx(mo,{id:"batchTeacher",label:"Batch Teacher",value:A,onChange:_=>o(_.target.value)}),s.jsx(mo,{id:"batchTime",label:"Batch Time",type:"time",value:l,onChange:_=>c(_.target.value),icon:s.jsx(Yo,{className:"w-6 h-6"})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-3",children:"Batch Fee (Optional)"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 text-lg",children:"â‚¹"}),s.jsx("input",{className:"w-full bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-indigo-400 pl-8 pr-2 pb-2 text-lg text-gray-800 dark:text-gray-100 outline-none transition-colors",type:"number",inputMode:"numeric",placeholder:"e.g. 500",value:B,onChange:_=>y(_.target.value)})]}),s.jsx("div",{className:"flex items-center justify-end gap-3 self-end mb-1",children:["Monthly","Yearly"].map(_=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"batchFeeType",value:_,checked:b===_,onChange:()=>C(_),className:"form-radio text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600",disabled:!B}),s.jsx("span",{children:_})]},_))})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-3",children:"Batch Days"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(_=>s.jsx(z1,{day:_,isSelected:p.has(_),onClick:()=>k(_)},_))})]}),s.jsx(mo,{id:"maxSlots",label:"Batch Maximum Slots",type:"number",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:_=>h(_.target.value),required:!0})]}),s.jsx("footer",{className:"p-4 flex-shrink-0 bg-slate-100 dark:bg-gray-900",children:s.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"SAVE BATCH"})})]})]})}const W1=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M5 13.18v4L12 21l4-2.18v-2.95L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V11.5h2V9L12 3z"}),s.jsx("path",{d:"M18 13c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm2.5 5.5h-2v2h-1v-2h-2v-1h2v-2h1v2h2v1z"})]}),Km=t=>s.jsx("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})}),gu=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12.01 16.5c-1.35 0-2.58-.59-3.41-1.5H2v6h20v-6h-6.59c-.83.91-2.06 1.5-3.4 1.5z",opacity:".3"}),s.jsx("path",{d:"M22 10V6c0-1.1-.9-2-2-2h-1.17c-.53-1.14-1.6-2-2.83-2s-2.3.86-2.83 2H8.83C8.3 2.86 7.23 2 6 2 4.83 2 3.76 2.86 3.23 4H2c-1.1 0-2 .9-2 2v4h6.01c.23-.8.64-1.52 1.18-2.11C9.64 7.37 10.74 7 12 7c1.26 0 2.36.37 3.24.89.54.59.95 1.31 1.18 2.11H22zm-6-5c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 5c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm14 11h-2v-4h2v4zm-4 0H8v-4h4v4zm10 4H2v-6h6.59c.83.91 2.06 1.5 3.41 1.5s2.58-.59 3.41-1.5H22v6z"})]}),Y1=t=>s.jsx("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M20,3H4A2,2,0,0,0,2,5v14a2,2,0,0,0,2,2H20a2,2,0,0,0,2-2V5A2,2,0,0,0,20,3z M8.5,8A1.5,1.5,0,1,1,7,9.5,1.5,1.5,0,0,1,8.5,8z M12,17H5v-1c0-1.67,3.33-2.5,5-2.5s5,0.83,5,2.5V17z M19,16h-5v-2h5V16z M19,12h-5V10h5V12z"})}),qm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:s.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})}),zm=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm-9-4c0-2.33 4.67-3.5 7-3.5s7 1.17 7 3.5V12H3v-2zM12 6c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3zm6.62 9.47L15.15 12 12 15.15 8.85 12 5.38 15.47a9.035 9.035 0 0 1 13.24 0z"}),s.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.78 16.22a.75.75 0 0 1 0 1.06l-1.06 1.06a.75.75 0 0 1-1.06 0L15.5 16.19l-2.12 2.12a.75.75 0 0 1-1.06 0L10.19 16.19l-2.12 2.12a.75.75 0 0 1-1.06 0L5.95 17.28a.75.75 0 0 1 0-1.06l2.12-2.12-2.12-2.12a.75.75 0 0 1 0-1.06l1.06-1.06a.75.75 0 0 1 1.06 0l2.12 2.12 2.12-2.12a.75.75 0 0 1 1.06 0l1.06 1.06a.75.75 0 0 1 0 1.06l-2.12 2.12 2.12 2.12z",opacity:"0.3"})]}),Ch=[{name:"New Admission",Icon:W1,key:"new-admission"},{name:"Active Students List",Icon:Km,key:"active-list"},{name:"Inactive Students List",Icon:zm,key:"inactive-list"},{name:"Student's Birthday",Icon:gu,key:"birthday"},{name:"Student's ID Card",Icon:Y1,key:"id-card"},{name:"Registration Forms",Icon:qm,key:"reg-forms"}];function $1({onBack:t,onNavigate:e,isStaffView:n,onShowDevPopup:r}){const a=A=>{switch(A){case"new-admission":e("new-student");break;case"active-list":e("active-students");break;case"inactive-list":e("inactive-students");break;case"birthday":e("birthday-list");break;case"reg-forms":e("registration-form-list");break;default:r("Student's ID Card");break}},i=n?Ch.filter(A=>A.key!=="new-admission"):Ch;return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Student Options"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:i.map(({name:A,Icon:o,key:l})=>s.jsxs("button",{onClick:()=>a(l),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 flex items-center space-x-4 text-left",children:[s.jsx("div",{className:"w-10 h-10 text-indigo-500",children:s.jsx(o,{})}),s.jsx("span",{className:"text-lg font-medium text-indigo-800",children:A})]},l))})})]})}const Vc=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),wc=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[s.jsx("path",{d:"M0 0h24v24H0z",fill:"none"}),s.jsx("path",{d:"M20 0H4v2h16V0zM4 24h16v-2H4v2zM20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 6c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V22z"})]});function xf({src:t,onSave:e,onCancel:n,aspectRatio:r=1,outputWidth:a=300}){const i=q.useRef(null),A=q.useRef(null),[o,l]=q.useState(1),[c,d]=q.useState({x:0,y:0}),[h,p]=q.useState(!1),[m,B]=q.useState({x:0,y:0}),[y,b]=q.useState(1),C=a/r,N=q.useCallback(()=>{const j=i.current;if(!j)return;const O=j.getContext("2d");if(!O)return;const F=A.current;if(!F||!F.complete||F.naturalWidth===0)return;O.fillStyle="#f0f0f0",O.fillRect(0,0,j.width,j.height);const I=F.width*o,P=F.height*o,V=Math.min(0,Math.max(c.x,j.width-I)),ee=Math.min(0,Math.max(c.y,j.height-P));O.drawImage(F,V,ee,I,P)},[o,c]);q.useEffect(()=>{A.current&&N()},[N]),q.useEffect(()=>{const j=new Image;j.crossOrigin="anonymous",j.src=t,j.onload=()=>{A.current=j;const O=i.current;if(!O)return;const F=j.width/j.height;let I;F>r?I=O.height/j.height:I=O.width/j.width,b(I),l(I),d({x:(O.width-j.width*I)/2,y:(O.height-j.height*I)/2})}},[t,r]);const k=j=>{const O=i.current;if(!O)return{x:0,y:0};const F=O.getBoundingClientRect();return"touches"in j.nativeEvent?{x:j.nativeEvent.touches[0].clientX-F.left,y:j.nativeEvent.touches[0].clientY-F.top}:{x:j.nativeEvent.offsetX,y:j.nativeEvent.offsetY}},E=j=>{j.preventDefault();const O=k(j);p(!0),B({x:O.x-c.x,y:O.y-c.y})},_=j=>{if(!h)return;j.preventDefault();const O=k(j);d({x:O.x-m.x,y:O.y-m.y})},M=()=>{p(!1)},D=j=>{j.preventDefault();const O=1-j.deltaY*.001;l(F=>Math.max(y,Math.min(F*O,5)))},U=()=>{const j=i.current;j&&e(j.toDataURL("image/jpeg",.9))};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-sm flex flex-col max-h-[90vh]",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:"Crop Image"}),s.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-500 dark:text-gray-300"})})]}),s.jsxs("main",{className:"p-4 flex-grow flex flex-col items-center",children:[s.jsx("canvas",{ref:i,width:a,height:C,className:"cursor-move border border-gray-300 touch-none",onMouseDown:E,onMouseMove:_,onMouseUp:M,onMouseLeave:M,onTouchStart:E,onTouchMove:_,onTouchEnd:M,onWheel:D}),s.jsxs("div",{className:"mt-4 w-full",children:[s.jsx("label",{htmlFor:"zoom",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Zoom"}),s.jsx("input",{id:"zoom",type:"range",min:y,max:"5",step:"0.01",value:o,onChange:j=>l(parseFloat(j.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]})]}),s.jsx("footer",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 border-t dark:border-gray-700",children:s.jsx("button",{onClick:U,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"Crop & Save"})})]})})}const X1=({student:t,academyId:e,onClose:n})=>{const[r,a]=be.useState(!1),i=()=>{const A=`Student Login Details:
Academy ID: ${e}
Roll Number: ${t.rollNumber}
Date of Birth: ${t.dob}`;navigator.clipboard.writeText(A).then(()=>{a(!0),setTimeout(()=>a(!1),2e3)})};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/40 mb-5",children:s.jsx(cs,{className:"h-9 w-9 text-green-600 dark:text-green-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Student Added Successfully!"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"The student can now log in using their Academy ID, Roll Number, and Date of Birth."}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-left space-y-2 mb-6 border border-gray-200 dark:border-gray-600",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400 text-sm",children:"Academy ID:"}),s.jsx("span",{className:"font-mono font-bold text-gray-800 dark:text-gray-100",children:e})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400 text-sm",children:"Roll Number:"}),s.jsx("span",{className:"font-mono font-bold text-gray-800 dark:text-gray-100",children:t.rollNumber})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400 text-sm",children:"Date of Birth:"}),s.jsx("span",{className:"font-mono font-bold text-gray-800 dark:text-gray-100",children:t.dob})]})]}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center gap-2 bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 font-bold py-3 px-4 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900 transition-colors",children:[s.jsx(Tm,{className:"w-5 h-5"}),s.jsx("span",{children:r?"Copied!":"Copy Details"})]}),s.jsx("button",{onClick:n,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"Done"})]})]})})},Ur=({label:t,id:e,children:n,containerClassName:r,...a})=>s.jsxs("div",{className:`relative bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-300 dark:border-gray-600 ${r}`,children:[s.jsx("label",{htmlFor:e,className:"absolute -top-2.5 left-3 bg-white dark:bg-gray-800 px-1 text-xs text-gray-500 dark:text-gray-400",children:t}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:e,className:"w-full text-gray-800 dark:text-gray-100 bg-transparent outline-none",...a}),n&&s.jsx("label",{htmlFor:e,className:"cursor-pointer",children:n})]})]});function Z1({onBack:t,onSave:e,batches:n,academyId:r,enquiryData:a,students:i}){const[A,o]=be.useState({rollNumber:"",name:"",fatherName:"",motherName:"",dob:"",mobile1:"",email:"",schoolOrCollege:"",gender:"Male",address:"",admissionDate:"",batches:[],transport:"NO_TRANSPORT_USE",feeType:"Monthly",feeAmount:"",photo:""}),[l,c]=be.useState(!1),[d,h]=be.useState(null),[p,m]=be.useState(null),[B,y]=be.useState(!1),[b,C]=be.useState(!1),[N,k]=be.useState(null),E=be.useRef(null),_=be.useRef(null),M=n.filter(I=>I.isActive);be.useEffect(()=>{if(i&&i.length>0){const P=i.reduce((ee,X)=>{const le=parseInt(X.rollNumber.replace(/\D/g,""),10);return isNaN(le)?ee:Math.max(ee,le)},0)+1,V=`S${String(P).padStart(4,"0")}`;o(ee=>({...ee,rollNumber:V}))}else o(I=>({...I,rollNumber:"S0001"}))},[i]),be.useEffect(()=>{a&&o(I=>({...I,name:a.studentName,mobile1:a.mobile,email:a.email||"",batches:a.interestedBatch?[a.interestedBatch]:[]}))},[a]),be.useEffect(()=>{let I=!1;if(A.batches.length>0)for(const P of A.batches){const V=n.find(ee=>ee.name===P);if(V&&V.batchFeeAmount&&V.batchFeeType){o(ee=>({...ee,feeType:V.batchFeeType,feeAmount:String(V.batchFeeAmount)})),h(`Auto-set from ${V.name}: â‚¹${V.batchFeeAmount}/${V.batchFeeType}`),I=!0;break}}I||h(null)},[A.batches,n]);const D=I=>{const{name:P,value:V}=I.target;o(ee=>({...ee,[P]:V}))},U=I=>{const{name:P,value:V}=I.target;P==="gender"?o(ee=>({...ee,gender:V})):P==="feeType"&&o(ee=>({...ee,feeType:V}))},j=I=>{if(I.target.files&&I.target.files[0]){const P=I.target.files[0],V=new FileReader;V.onloadend=()=>{k(V.result)},V.readAsDataURL(P)}C(!1),I.target.value=""},O=I=>{o(P=>{const V=new Set(P.batches);return V.has(I)?V.delete(I):V.add(I),{...P,batches:Array.from(V)}})},F=async()=>{if(!A.rollNumber.trim()||!A.name.trim()||!A.fatherName.trim()||!A.motherName.trim()||!A.dob||!A.mobile1||!A.address||!A.admissionDate){alert("Please fill all required fields.");return}if(A.batches.length===0){alert("Please select at least one batch.");return}if(!A.feeType||!A.feeAmount.trim()){alert("Please specify fee type and amount.");return}y(!0);const I=await e({...A,feeAmount:parseFloat(A.feeAmount)||0},a==null?void 0:a.id);y(!1),I&&m(I)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:a?"Convert Enquiry to Admission":"New Student"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsxs("form",{id:"new-student-form",onSubmit:I=>{I.preventDefault(),F()},className:"space-y-5",children:[s.jsxs("div",{className:"flex justify-center",children:[s.jsx("button",{type:"button",onClick:()=>C(!0),className:"w-24 h-24 rounded-full border-2 border-indigo-400 bg-white dark:bg-gray-800 flex items-center justify-center text-indigo-800 dark:text-indigo-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition overflow-hidden","aria-label":"Upload student photo",children:A.photo?s.jsx("img",{src:A.photo,alt:"Student Preview",className:"w-full h-full object-cover"}):s.jsx(Vc,{className:"w-12 h-12"})}),s.jsx("input",{type:"file",accept:"image/*",ref:E,onChange:j,className:"hidden"}),s.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:_,onChange:j,className:"hidden"})]}),s.jsx(Ur,{label:"Roll Number / Student ID",id:"rollNumber",name:"rollNumber",placeholder:"Unique ID for login",value:A.rollNumber,onChange:D,required:!0}),s.jsx(Ur,{label:"Student Name",id:"studentName",name:"name",value:A.name,onChange:D,required:!0,containerClassName:"border-indigo-500 border-2"}),s.jsx(Ur,{label:"Father Name",id:"fatherName",name:"fatherName",value:A.fatherName,onChange:D,required:!0}),s.jsx(Ur,{label:"Mother Name",id:"motherName",name:"motherName",value:A.motherName,onChange:D,required:!0}),s.jsx(Ur,{label:"School / College (Optional)",id:"schoolOrCollege",name:"schoolOrCollege",value:A.schoolOrCollege,onChange:D}),s.jsx(Ur,{label:"Date of birth",id:"dob",name:"dob",type:"date",value:A.dob,onChange:D,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})}),s.jsxs(Ur,{label:"Mobile Number",id:"mobile1",name:"mobile1",type:"tel",value:A.mobile1,onChange:D,required:!0,children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"+91"}),s.jsx(wc,{className:"w-6 h-6 text-indigo-600"})]}),s.jsx(Ur,{label:"Email Address (optional)",id:"email",name:"email",type:"email",value:A.email,onChange:D}),s.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-300 dark:border-gray-600",children:s.jsx("div",{className:"flex items-center justify-around",children:["Male","Female","Other"].map(I=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"gender",value:I,checked:A.gender===I,onChange:U,className:"form-radio text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-500"}),s.jsx("span",{children:I})]},I))})}),s.jsx(Ur,{label:"Address",id:"address",name:"address",value:A.address,onChange:D,required:!0}),s.jsx(Ur,{label:"Admission Date",id:"admissionDate",name:"admissionDate",type:"date",value:A.admissionDate,onChange:D,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("button",{type:"button",onClick:()=>c(!0),className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:A.batches.length>0?`Selected Batches (${A.batches.length})`:"SELECT BATCHES"}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-300 dark:border-gray-600",children:[s.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Fee Type"}),s.jsx("div",{className:"flex items-center justify-around",children:["Monthly","Yearly"].map(I=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"feeType",value:I,checked:A.feeType===I,onChange:U,className:"form-radio text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-500"}),s.jsx("span",{children:I})]},I))})]}),s.jsxs("div",{className:"relative bg-white dark:bg-gray-800 p-3 rounded-lg border border-indigo-500 border-2",children:[s.jsxs("label",{htmlFor:"feeAmount",className:"absolute -top-2.5 left-3 bg-white dark:bg-gray-800 px-1 text-xs text-gray-500 dark:text-gray-400",children:["Fee Amount",d&&s.jsx("span",{className:"ml-2 font-semibold text-indigo-600 dark:text-indigo-400",children:d})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-lg mr-2",children:"â‚¹"}),s.jsx("input",{id:"feeAmount",name:"feeAmount",type:"number",inputMode:"numeric",className:"w-full text-gray-800 dark:text-gray-100 bg-transparent outline-none",value:A.feeAmount,onChange:I=>o(P=>({...P,feeAmount:I.target.value})),required:!0,placeholder:"500"})]})]}),s.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-600",children:[s.jsxs("select",{id:"transport",name:"transport",value:A.transport,onChange:D,className:"w-full appearance-none bg-white dark:bg-gray-800 p-3 pr-8 rounded-lg text-gray-800 dark:text-gray-100 outline-none border-2 border-indigo-500",children:[s.jsx("option",{value:"NO_TRANSPORT_USE",children:"NO TRANSPORT USE"}),s.jsx("option",{value:"USE_TRANSPORT",children:"USE TRANSPORT"})]}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-indigo-500",children:s.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),s.jsx(Ur,{label:"ID Number(Optional)",id:"idNumber",name:"idNumber",value:A.idNumber,onChange:D}),s.jsx(Ur,{label:"Field 1(Optional)",id:"field1",name:"field1",value:A.field1,onChange:D}),s.jsx(Ur,{label:"Field 2(Optional)",id:"field2",name:"field2",value:A.field2,onChange:D})]})}),s.jsxs("footer",{className:"p-4 flex-shrink-0 bg-slate-100 dark:bg-gray-900 grid grid-cols-2 gap-4",children:[s.jsx("button",{type:"button",onClick:t,disabled:B,className:"w-full bg-red-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-600 transition-colors shadow-md disabled:bg-red-300 disabled:cursor-not-allowed",children:"CANCEL"}),s.jsx("button",{type:"submit",form:"new-student-form",disabled:B,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300 disabled:cursor-not-allowed",children:B?"SAVING...":"SAVE"})]})]}),l&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl m-4 w-full max-w-md flex flex-col max-h-[90vh]",children:[s.jsx("h3",{className:"text-lg font-bold p-4 border-b dark:border-gray-700 text-gray-800 dark:text-gray-100",children:"Select Batches"}),s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto",children:M.length>0?M.map(I=>s.jsxs("label",{className:"flex items-center p-3 rounded-lg hover:bg-slate-100 dark:hover:bg-gray-700 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600",checked:A.batches.includes(I.name),onChange:()=>O(I.name)}),s.jsx("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:I.name})]},I.id)):s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No active batches available. Please create an active batch first."})}),s.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:s.jsx("button",{onClick:()=>c(!1),className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Done"})})]})}),b&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl m-4 w-full max-w-xs flex flex-col",children:[s.jsx("h3",{className:"text-lg font-semibold p-4 border-b dark:border-gray-700 text-center",children:"Select Photo Source"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("button",{onClick:()=>{var I;return(I=E.current)==null?void 0:I.click()},className:"w-full bg-indigo-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Choose from Gallery"}),s.jsx("button",{onClick:()=>{var I;return(I=_.current)==null?void 0:I.click()},className:"w-full bg-sky-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-sky-700 transition-colors",children:"Take Photo"}),s.jsx("button",{onClick:()=>C(!1),className:"w-full bg-gray-200 text-gray-800 font-bold py-2.5 px-4 rounded-lg hover:bg-gray-300 transition-colors mt-2 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",children:"Cancel"})]})]})}),N&&s.jsx(xf,{src:N,onSave:I=>{o(P=>({...P,photo:I})),k(null)},onCancel:()=>k(null)}),p&&s.jsx(X1,{student:p,academyId:r,onClose:t})]})}const ds=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),ey=t=>{if(!t)return"";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`},ty=({batch:t,onSelect:e,counts:n})=>s.jsxs("button",{onClick:e,className:"w-full bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 text-left",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h3",{className:"font-bold text-indigo-800 dark:text-gray-100 text-base",children:t.name}),s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:ey(t.time)})]}),s.jsxs("div",{className:"grid grid-cols-3 text-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-green-500",children:"Present"}),s.jsx("p",{className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:n.present})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-red-500",children:"Absent"}),s.jsx("p",{className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:n.absent})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-orange-500",children:"Leave"}),s.jsx("p",{className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:n.leave})]})]})]});function ny({onBack:t,batches:e,onSelectBatch:n,staffPermissions:r,academyId:a}){const[i,A]=q.useState({}),[o,l]=q.useState(!0),c=e.filter(d=>{var h;return d.isActive?r?!!((h=r[d.id])!=null&&h.attendance):!0:!1});return q.useEffect(()=>{const d=p=>{const m=p.getFullYear(),B=String(p.getMonth()+1).padStart(2,"0"),y=String(p.getDate()).padStart(2,"0");return`${m}-${B}-${y}`},h=async()=>{l(!0);const p=d(new Date),m={};await Promise.all(c.map(async B=>{const y=Xe(Te,`academies/${a}/batches/${B.id}/attendance`,p);try{const b=await Sn(y);let C=0,N=0,k=0;if(b.exists()){const E=b.data();Object.values(E).forEach(_=>{_==="Present"?C++:_==="Absent"?N++:_==="Leave"&&k++})}m[B.id]={present:C,absent:N,leave:k}}catch(b){console.error(`Failed to fetch attendance for batch ${B.id}:`,b),m[B.id]={present:0,absent:0,leave:0}}})),A(m),l(!1)};a&&c.length>0?h():l(!1)},[e,a,r]),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Select Batch"})]}),s.jsx("button",{className:"p-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Search batches",children:s.jsx(ds,{className:"w-6 h-6"})})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:o?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx(Ar,{message:"Loading attendance data..."})}):c.length>0?s.jsx("div",{className:"space-y-3",children:c.map(d=>s.jsx(ty,{batch:d,onSelect:()=>n(d.id),counts:i[d.id]||{present:0,absent:0,leave:0}},d.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No batches assigned for attendance."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Admin needs to grant you attendance permission for one or more batches."})]})})]})}const wf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})}),Jm=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8.25V8.25"})]}),Wm=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),Kc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12.04 2C6.58 2 2.13 6.45 2.13 12c0 1.77.46 3.45 1.28 4.95L2 22l5.25-1.38c1.45.77 3.06 1.18 4.79 1.18 5.46 0 9.91-4.45 9.91-9.91S17.5 2 12.04 2zM12 20.15c-1.49 0-2.92-.39-4.18-1.12l-.3-.18-3.11.82.83-3.04-.2-.31C4.44 15.12 4.13 13.6 4.13 12c0-4.34 3.52-7.87 7.87-7.87s7.87 3.53 7.87 7.87-3.53 7.87-7.87 7.87zm4.55-6.15c-.23-.11-1.34-.66-1.55-.73-.21-.07-.36-.11-.52.11-.15.23-.59.73-.72.88-.13.15-.26.17-.49.06-.23-.11-1-.37-1.89-1.16-.69-.59-1.16-1.32-1.3-1.55-.13-.23-.01-.36.1-.47.1-.1.23-.26.34-.39.11-.13.15-.23.23-.38.07-.15.04-.28-.01-.39-.06-.11-.52-1.25-.71-1.71-.19-.46-.39-.4-.52-.4h-.48c-.16 0-.42.06-.64.3-.23.26-.87.85-.87 2.07 0 1.22.89 2.4 1.01 2.56.12.15 1.76 2.68 4.27 3.75 2.51 1.07 2.51.72 2.96.69.45-.03 1.34-.55 1.53-1.07.19-.53.19-1 .13-1.07-.06-.07-.21-.12-.44-.23z"})}),qc=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})}),ry="attendance",sy=`Student : [STUDENT_NAME]([BATCH_NAME]) is *[STATUS]* for today's class Date : [DATE]
Regards,
[ACADEMY_NAME] ~`,ay=["Present","Absent","Leave","Holiday"];function iy({onClose:t,students:e,attendance:n,batch:r,academy:a,date:i}){const[A,o]=q.useState("Absent"),[l,c]=q.useState("select_list"),[d,h]=q.useState(null),[p,m]=q.useState(0),B=q.useMemo(()=>e.filter(k=>n[k.id]===A),[e,n,A]),y=k=>{h(k),m(0),c("sending_in_progress")},b=q.useCallback(()=>{c("select_list"),h(null)},[]),C=q.useCallback(()=>{var F;if(p>=B.length){c("sending_complete");return}const k=B[p],E=n[k.id],_=i.toLocaleDateString("en-GB"),D=(((F=a.smsTemplates)==null?void 0:F[ry])||sy).replace(/\[STUDENT_NAME\]/g,k.name).replace(/\[BATCH_NAME\]/g,r.name).replace(/\[STATUS\]/g,E).replace(/\[DATE\]/g,_).replace(/\[ACADEMY_NAME\]/g,a.name),U=k.mobile1.replace(/[^0-9]/g,""),j=encodeURIComponent(D);let O="";d==="whatsapp"?O=`https://wa.me/${U.startsWith("91")?U:`91${U}`}?text=${j}`:O=`sms:${U}?body=${j}`,window.open(O,"_blank")},[p,B,n,i,a,r,d]);q.useEffect(()=>{const k=()=>{document.visibilityState==="visible"&&l==="sending_in_progress"&&setTimeout(()=>{m(E=>E+1)},500)};return l==="sending_in_progress"&&(C(),document.addEventListener("visibilitychange",k)),()=>{document.removeEventListener("visibilitychange",k)}},[l,p,C]);const N=()=>{switch(l){case"sending_in_progress":const k=B[p];return s.jsxs("div",{className:"text-center p-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"Preparing Message..."}),s.jsxs("p",{children:["Sending to: ",s.jsx("span",{className:"font-semibold",children:k==null?void 0:k.name})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["(",p+1," of ",B.length,")"]}),s.jsxs("p",{className:"text-xs mt-4 text-gray-500",children:["You will be redirected to ",d,". After sending, return to this app to continue."]}),s.jsx("button",{onClick:b,className:"mt-6 bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-lg text-sm",children:"Cancel Sending"})]});case"sending_complete":return s.jsxs("div",{className:"text-center p-8",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"All Done!"}),s.jsx("p",{className:"text-gray-600",children:"All messages have been prepared for sending."}),s.jsx("button",{onClick:t,className:"mt-6 bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg w-full",children:"Finish"})]});case"select_app":return s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:"Choose App"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>y("whatsapp"),className:"w-full flex items-center justify-center gap-3 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors",children:[s.jsx(Kc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via WhatsApp"})]}),s.jsxs("button",{onClick:()=>y("sms"),className:"w-full flex items-center justify-center gap-3 bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600 transition-colors",children:[s.jsx(qc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via SMS"})]})]})]});case"select_list":default:return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-900 rounded-lg flex justify-around mb-4",children:ay.map(E=>s.jsx("button",{onClick:()=>o(E),className:`px-3 py-1.5 text-sm font-semibold rounded-md flex-grow transition-colors ${A===E?"bg-indigo-600 text-white shadow":"text-gray-600 dark:text-gray-300"}`,children:E},E))}),s.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 pr-2",children:B.length>0?B.map(E=>s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-2 rounded-md flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm flex-shrink-0",children:E.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:E.name}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:E.rollNumber})]})]},E.id)):s.jsxs("p",{className:"text-center text-gray-500 pt-10",children:['No students with status "',A,'".']})}),s.jsx("div",{className:"pt-4 mt-auto",children:s.jsxs("button",{onClick:()=>c("select_app"),disabled:B.length===0,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300",children:["Send Message (",B.length,")"]})})]})}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg w-full max-w-sm flex flex-col max-h-[90vh] relative",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Send Attendance SMS"}),s.jsx("button",{onClick:l==="sending_in_progress"?b:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-500"})})]}),s.jsx("div",{className:"flex flex-col flex-grow overflow-hidden p-4",children:N()})]})})}const Ay=({student:t,onClose:e,onShowImage:n})=>{const r=t.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(t.name)}`;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",onClick:e,children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 pt-14 p-6 rounded-2xl shadow-lg w-full max-w-sm mx-auto text-left relative",onClick:a=>a.stopPropagation(),children:[s.jsx("button",{onClick:e,className:"absolute top-3 right-3 p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Close",children:s.jsx(In,{className:"w-6 h-6"})}),s.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2",children:s.jsx("button",{onClick:()=>n(r),className:"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 rounded-full",children:s.jsx("img",{src:r,alt:t.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white dark:border-gray-800 shadow-lg bg-gray-200"})})}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mt-3",children:t.name}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Student ID: ",t.rollNumber]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[s.jsx(Pc,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Father's Name"}),s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:t.fatherName})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[s.jsx(Ua,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Contact Number"}),s.jsx("a",{href:`tel:${t.mobile1}`,className:"font-semibold text-indigo-600 dark:text-indigo-400 hover:underline",children:t.mobile1})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[s.jsx(Hc,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Batches"}),s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:t.batches.join(", ")})]})]})]})]})})},Ym=["Present","Absent","Leave","Holiday"],$m=({status:t,isActive:e,onClick:n})=>{const r=(a,i)=>{const A="px-3 py-1 text-xs rounded-full font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 shadow-sm flex-grow text-center";switch(a){case"Present":return i?`${A} bg-green-600 text-white focus:ring-green-500`:`${A} bg-green-100 text-green-800 hover:bg-green-200 focus:ring-green-500`;case"Absent":return i?`${A} bg-red-600 text-white focus:ring-red-500`:`${A} bg-red-100 text-red-800 hover:bg-red-200 focus:ring-red-500`;case"Leave":return i?`${A} bg-yellow-500 text-white focus:ring-yellow-400`:`${A} bg-yellow-100 text-yellow-800 hover:bg-yellow-200 focus:ring-yellow-400`;case"Holiday":return i?`${A} bg-purple-600 text-white focus:ring-purple-500`:`${A} bg-purple-100 text-purple-800 hover:bg-purple-200 focus:ring-purple-500`;case"Not Set":default:return i?`${A} bg-gray-600 text-white focus:ring-gray-500`:`${A} bg-gray-200 text-gray-700 hover:bg-gray-300 focus:ring-gray-500`}};return s.jsx("button",{onClick:n,className:r(t,e),children:t})},oy=({student:t,batch:e,status:n,onStatusChange:r,onShowInfo:a})=>s.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-indigo-700 font-semibold truncate",children:t.rollNumber||t.id}),s.jsx("p",{className:"text-base font-bold text-gray-800 truncate",children:t.name}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.name})]}),s.jsx("button",{onClick:()=>a(t),className:"text-indigo-600 hover:text-indigo-800 transition-colors p-1 ml-2 rounded-full flex-shrink-0",children:s.jsx(Jm,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"flex space-x-1.5",children:Ym.map(i=>s.jsx($m,{status:i,isActive:n===i,onClick:()=>r(t.id,i)},i))})]});function ly({onBack:t,batch:e,students:n,academy:r,isDemoMode:a,onShowImage:i}){const[A,o]=be.useState(new Date),[l,c]=be.useState({}),[d,h]=be.useState(!0),[p,m]=be.useState(null),[B,y]=be.useState(null),[b,C]=be.useState(0),[N,k]=be.useState(null),[E,_]=be.useState(!1),M=be.useMemo(()=>n.filter(X=>X.isActive&&Array.isArray(X.batches)&&X.batches.some(le=>le.trim()===e.name.trim())),[n,e.name]),D=X=>{const le=X.getFullYear(),ae=String(X.getMonth()+1).padStart(2,"0"),de=String(X.getDate()).padStart(2,"0");return`${le}-${ae}-${de}`},U=new Date().setHours(0,0,0,0),O=new Date(A).setHours(0,0,0,0)>=U;be.useEffect(()=>{if(a){const de={};M.forEach(ue=>{de[ue.id]="Not Set"}),c(de),h(!1);return}if(!r.id||!e.id)return;h(!0),m(null),y(null);const X=D(A),le=Xe(Te,`academies/${r.id}/batches/${e.id}/attendance`,X),ae=si(le,de=>{const ue=de.data()||{},Ce={};M.forEach(Q=>{Ce[Q.id]=ue[Q.id]||"Not Set"}),c(Ce),h(!1)},de=>{console.error("Error fetching attendance:",de),de.code==="unavailable"?m("You seem to be offline. Please check your connection."):m("Could not load attendance data. Please try again."),h(!1)});return()=>ae()},[A,e.id,r.id,M,a,b]);const F=X=>{o(le=>{const ae=new Date(le);return ae.setDate(ae.getDate()+(X==="next"?1:-1)),ae})},I=async(X,le)=>{y(null);const ae=l[X];if(c(de=>({...de,[X]:le})),!a)try{const de=D(A),ue=Xe(Te,`academies/${r.id}/batches/${e.id}/attendance`,de);await hA(ue,{[X]:le},{merge:!0})}catch(de){console.error("Failed to save attendance:",de),c(ue=>({...ue,[X]:ae})),y("Failed to save. Check your connection."),setTimeout(()=>y(null),3e3)}},P=async X=>{y(null);const le={...l},ae={};if(M.forEach(de=>{ae[de.id]=X}),c(ae),!a)try{const de=D(A),ue=Xe(Te,`academies/${r.id}/batches/${e.id}/attendance`,de);await hA(ue,ae,{merge:!0})}catch(de){console.error("Failed to set all attendance:",de),c(le),y("Failed to save. Check your connection."),setTimeout(()=>y(null),3e3)}},V=()=>{C(X=>X+1)},ee=A.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});return s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-10",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Take Attendance"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>_(!0),className:"text-sm font-medium p-2 rounded-md hover:bg-indigo-800",children:"SMS"}),s.jsx("button",{className:"p-1 rounded-full hover:bg-indigo-800",children:s.jsx(Wm,{className:"w-6 h-6"})})]})]}),s.jsxs("div",{className:"bg-indigo-900 text-white p-2 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>F("prev"),className:"p-2 rounded-full hover:bg-indigo-800",children:s.jsx(Ge,{className:"w-5 h-5"})}),s.jsx("span",{className:"font-bold text-lg",children:ee}),s.jsx("button",{onClick:()=>F("next"),className:"p-2 rounded-full hover:bg-indigo-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:O,children:s.jsx(wf,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"p-2 text-center flex-shrink-0",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Click to set all students"}),s.jsx("div",{className:"flex space-x-1.5 justify-center",children:Ym.map(X=>s.jsx($m,{status:X,isActive:!1,onClick:()=>P(X)},X))})]}),s.jsxs("main",{className:"flex-grow p-2 sm:p-3 overflow-y-auto relative",children:[B&&s.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-red-600 text-white text-sm font-semibold py-2 px-4 rounded-lg shadow-lg animate-fade-in z-10 flex items-center space-x-2",children:[s.jsx(Lm,{className:"w-5 h-5"}),s.jsx("span",{children:B})]}),d?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(Ar,{message:"Loading attendance..."})}):p?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-red-600 font-semibold",children:p}),s.jsx("button",{onClick:V,className:"mt-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition-colors",children:"Retry"})]}):M.length>0?s.jsx("div",{className:"space-y-3 pb-4",children:M.map(X=>s.jsx(oy,{student:X,batch:e,status:l[X.id]||"Not Set",onStatusChange:I,onShowInfo:k},X.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No active students found in this batch."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Add students to this batch to take attendance."})]})]}),N&&s.jsx(Ay,{student:N,onClose:()=>k(null),onShowImage:i}),E&&s.jsx(iy,{onClose:()=>_(!1),students:M,attendance:l,batch:e,academy:r,date:A})]})}const cy=({checked:t,onChange:e})=>s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${t?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"}`,onClick:e,"aria-pressed":t,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${t?"translate-x-6":"translate-x-1"}`})}),dy=({student:t,batches:e,onToggleStatus:n,onEditStudent:r,onViewStudent:a,staffPermissions:i})=>{const A=be.useMemo(()=>i?e.filter(c=>t.batches.includes(c.name)).some(c=>{var d;return(d=i[c.id])==null?void 0:d.editStudents}):!0,[t.batches,e,i]),o=t.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(t.name)}`;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-indigo-500 flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:o,alt:t.name,className:"w-12 h-12 rounded-full object-cover bg-gray-200"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.name}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.rollNumber||t.id})]})]}),s.jsx("div",{className:"flex flex-col items-end",children:A?s.jsxs(s.Fragment,{children:[s.jsx(cy,{checked:t.isActive,onChange:()=>n(t.id)}),s.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:t.isActive?"Active":"Inactive"})]}):s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})})]}),s.jsxs("div",{className:"mt-3 text-xs text-gray-600 dark:text-gray-300",children:["Batches: ",t.batches.join(", ")||"None"]}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-3 pt-3 flex justify-end space-x-2",children:[A&&s.jsxs("button",{onClick:()=>r(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors","aria-label":`Edit details for ${t.name}`,children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>a(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors","aria-label":`View details for ${t.name}`,children:[s.jsx(qm,{className:"w-4 h-4"}),s.jsx("span",{children:"View Details"})]})]})]})};function uy({onBack:t,students:e,batches:n,onToggleStudentStatus:r,onEditStudent:a,onViewStudent:i,initialFilter:A="all",staffPermissions:o}){const[l,c]=be.useState(A),[d,h]=be.useState(""),m=e.filter(B=>B.isActive).filter(B=>l==="all"||B.batches.includes(l)).filter(B=>B.name.toLowerCase().includes(d.toLowerCase())||B.rollNumber&&B.rollNumber.toLowerCase().includes(d.toLowerCase()));return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Active Students"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[s.jsxs("div",{className:"relative flex-grow",children:[s.jsx("input",{type:"text",placeholder:"Search by name or roll no...",value:d,onChange:B=>h(B.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsxs("select",{value:l,onChange:B=>c(B.target.value),className:"w-full sm:w-auto px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[s.jsx("option",{value:"all",children:"All Batches"}),n.filter(B=>B.isActive).map(B=>s.jsx("option",{value:B.name,children:B.name},B.id))]})]}),s.jsx("div",{className:"space-y-4 pb-4",children:m.length>0?m.map(B=>s.jsx(dy,{student:B,batches:n,onToggleStatus:r,onEditStudent:a,onViewStudent:i,staffPermissions:o},B.id)):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No active students found."}),s.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Try adjusting your filters or adding a new student."})]})})]})]})}function fy({onBack:t,students:e}){const n=new Date,r=`${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`,a=e.filter(A=>A.dob.substring(5)===r&&A.isActive),i=n.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Today's Birthdays"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsx("div",{className:"text-center mb-6 p-4 bg-indigo-50 rounded-lg",children:s.jsx("p",{className:"font-semibold text-indigo-800",children:i})}),a.length>0?s.jsx("div",{className:"space-y-3",children:a.map(A=>s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex items-center space-x-4",children:[s.jsx(gu,{className:"w-10 h-10 text-indigo-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-gray-800 text-lg",children:A.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Batch: ",A.batches.join(", ")]})]})]},A.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx(gu,{className:"w-24 h-24 text-indigo-300 mx-auto"}),s.jsx("p",{className:"text-lg text-gray-500 mt-4",children:"No birthdays today."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Come back tomorrow to check again!"})]})]})]})}function hy({onBack:t,students:e,onSelectStudent:n}){return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Select Student for Form"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:e.length>0?s.jsx("div",{className:"space-y-3 pb-4",children:e.map(r=>s.jsxs("button",{onClick:()=>n(r.id),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 text-left flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-indigo-800",children:r.name}),s.jsx("p",{className:"text-sm text-gray-500",children:r.id})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.isActive?"Active":"Inactive"})]},r.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No students found."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Add a student to view their registration form."})]})})]})}const gy=FA("Share",{web:()=>NA(()=>import("./web-D9GhCGBN.js"),__vite__mapDeps([2,1])).then(t=>new t.ShareWeb)});var mu;(function(t){t.Documents="DOCUMENTS",t.Data="DATA",t.Library="LIBRARY",t.Cache="CACHE",t.External="EXTERNAL",t.ExternalStorage="EXTERNAL_STORAGE"})(mu||(mu={}));var Nh;(function(t){t.UTF8="utf8",t.ASCII="ascii",t.UTF16="utf16"})(Nh||(Nh={}));const my=FA("Filesystem",{web:()=>NA(()=>import("./web-B75wbKe-.js"),__vite__mapDeps([3,1])).then(t=>new t.FilesystemWeb)});function _t(t){"@babel/helpers - typeof";return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(t)}var er=Uint8Array,Qr=Uint16Array,yf=Int32Array,zc=new er([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jc=new er([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pu=new er([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xm=function(t,e){for(var n=new Qr(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var a=new yf(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)a[i]=i-n[r]<<5|r;return{b:n,r:a}},Zm=Xm(zc,2),ep=Zm.b,xu=Zm.r;ep[28]=258,xu[258]=28;var tp=Xm(Jc,0),py=tp.b,Sh=tp.r,wu=new Qr(32768);for(var Jt=0;Jt<32768;++Jt){var ya=(Jt&43690)>>1|(Jt&21845)<<1;ya=(ya&52428)>>2|(ya&13107)<<2,ya=(ya&61680)>>4|(ya&3855)<<4,wu[Jt]=((ya&65280)>>8|(ya&255)<<8)>>1}var Es=function(t,e,n){for(var r=t.length,a=0,i=new Qr(e);a<r;++a)t[a]&&++i[t[a]-1];var A=new Qr(e);for(a=1;a<e;++a)A[a]=A[a-1]+i[a-1]<<1;var o;if(n){o=new Qr(1<<e);var l=15-e;for(a=0;a<r;++a)if(t[a])for(var c=a<<4|t[a],d=e-t[a],h=A[t[a]-1]++<<d,p=h|(1<<d)-1;h<=p;++h)o[wu[h]>>l]=c}else for(o=new Qr(r),a=0;a<r;++a)t[a]&&(o[a]=wu[A[t[a]-1]++]>>15-t[a]);return o},La=new er(288);for(var Jt=0;Jt<144;++Jt)La[Jt]=8;for(var Jt=144;Jt<256;++Jt)La[Jt]=9;for(var Jt=256;Jt<280;++Jt)La[Jt]=7;for(var Jt=280;Jt<288;++Jt)La[Jt]=8;var Ho=new er(32);for(var Jt=0;Jt<32;++Jt)Ho[Jt]=5;var xy=Es(La,9,0),wy=Es(La,9,1),yy=Es(Ho,5,0),by=Es(Ho,5,1),Md=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},is=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},Dd=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},bf=function(t){return(t+7)/8|0},np=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new er(t.subarray(e,n))},vy=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ls=function(t,e,n){var r=new Error(e||vy[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,ls),!n)throw r;return r},By=function(t,e,n,r){var a=t.length,i=0;if(!a||e.f&&!e.l)return n||new er(0);var A=!n,o=A||e.i!=2,l=e.i;A&&(n=new er(a*3));var c=function(je){var Me=n.length;if(je>Me){var De=new er(Math.max(Me*2,je));De.set(n),n=De}},d=e.f||0,h=e.p||0,p=e.b||0,m=e.l,B=e.d,y=e.m,b=e.n,C=a*8;do{if(!m){d=is(t,h,1);var N=is(t,h+1,3);if(h+=3,N)if(N==1)m=wy,B=by,y=9,b=5;else if(N==2){var M=is(t,h,31)+257,D=is(t,h+10,15)+4,U=M+is(t,h+5,31)+1;h+=14;for(var j=new er(U),O=new er(19),F=0;F<D;++F)O[pu[F]]=is(t,h+F*3,7);h+=D*3;for(var I=Md(O),P=(1<<I)-1,V=Es(O,I,1),F=0;F<U;){var ee=V[is(t,h,P)];h+=ee&15;var k=ee>>4;if(k<16)j[F++]=k;else{var X=0,le=0;for(k==16?(le=3+is(t,h,3),h+=2,X=j[F-1]):k==17?(le=3+is(t,h,7),h+=3):k==18&&(le=11+is(t,h,127),h+=7);le--;)j[F++]=X}}var ae=j.subarray(0,M),de=j.subarray(M);y=Md(ae),b=Md(de),m=Es(ae,y,1),B=Es(de,b,1)}else ls(1);else{var k=bf(h)+4,E=t[k-4]|t[k-3]<<8,_=k+E;if(_>a){l&&ls(0);break}o&&c(p+E),n.set(t.subarray(k,_),p),e.b=p+=E,e.p=h=_*8,e.f=d;continue}if(h>C){l&&ls(0);break}}o&&c(p+131072);for(var ue=(1<<y)-1,Ce=(1<<b)-1,Q=h;;Q=h){var X=m[Dd(t,h)&ue],z=X>>4;if(h+=X&15,h>C){l&&ls(0);break}if(X||ls(2),z<256)n[p++]=z;else if(z==256){Q=h,m=null;break}else{var W=z-254;if(z>264){var F=z-257,Z=zc[F];W=is(t,h,(1<<Z)-1)+ep[F],h+=Z}var ne=B[Dd(t,h)&Ce],fe=ne>>4;ne||ls(3),h+=ne&15;var de=py[fe];if(fe>3){var Z=Jc[fe];de+=Dd(t,h)&(1<<Z)-1,h+=Z}if(h>C){l&&ls(0);break}o&&c(p+131072);var xe=p+W;if(p<de){var we=i-de,Qe=Math.min(de,xe);for(we+p<0&&ls(3);p<Qe;++p)n[p]=r[we+p]}for(;p<xe;++p)n[p]=n[p-de]}}e.l=m,e.p=Q,e.b=p,e.f=d,m&&(d=1,e.m=y,e.d=B,e.n=b)}while(!d);return p!=n.length&&A?np(n,0,p):n.subarray(0,p)},qs=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},po=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},Pd=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var a=n.length,i=n.slice();if(!a)return{t:sp,l:0};if(a==1){var A=new er(n[0].s+1);return A[n[0].s]=1,{t:A,l:1}}n.sort(function(_,M){return _.f-M.f}),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,d=1,h=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};d!=a-1;)o=n[n[c].f<n[h].f?c++:h++],l=n[c!=d&&n[c].f<n[h].f?c++:h++],n[d++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,r=1;r<a;++r)i[r].s>p&&(p=i[r].s);var m=new Qr(p+1),B=yu(n[d-1],m,0);if(B>e){var r=0,y=0,b=B-e,C=1<<b;for(i.sort(function(M,D){return m[D.s]-m[M.s]||M.f-D.f});r<a;++r){var N=i[r].s;if(m[N]>e)y+=C-(1<<B-m[N]),m[N]=e;else break}for(y>>=b;y>0;){var k=i[r].s;m[k]<e?y-=1<<e-m[k]++-1:++r}for(;r>=0&&y;--r){var E=i[r].s;m[E]==e&&(--m[E],++y)}B=e}return{t:new er(m),l:B}},yu=function(t,e,n){return t.s==-1?Math.max(yu(t.l,e,n+1),yu(t.r,e,n+1)):e[t.s]=n},Ih=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Qr(++e),r=0,a=t[0],i=1,A=function(l){n[r++]=l},o=1;o<=e;++o)if(t[o]==a&&o!=e)++i;else{if(!a&&i>2){for(;i>138;i-=138)A(32754);i>2&&(A(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(A(a),--i;i>6;i-=6)A(8304);i>2&&(A(i-3<<5|8208),i=0)}for(;i--;)A(a);i=1,a=t[o]}return{c:n.subarray(0,r),n:e}},xo=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},rp=function(t,e,n){var r=n.length,a=bf(e+2);t[a]=r&255,t[a+1]=r>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var i=0;i<r;++i)t[a+i+4]=n[i];return(a+4+r)*8},Fh=function(t,e,n,r,a,i,A,o,l,c,d){qs(e,d++,n),++a[256];for(var h=Pd(a,15),p=h.t,m=h.l,B=Pd(i,15),y=B.t,b=B.l,C=Ih(p),N=C.c,k=C.n,E=Ih(y),_=E.c,M=E.n,D=new Qr(19),U=0;U<N.length;++U)++D[N[U]&31];for(var U=0;U<_.length;++U)++D[_[U]&31];for(var j=Pd(D,7),O=j.t,F=j.l,I=19;I>4&&!O[pu[I-1]];--I);var P=c+5<<3,V=xo(a,La)+xo(i,Ho)+A,ee=xo(a,p)+xo(i,y)+A+14+3*I+xo(D,O)+2*D[16]+3*D[17]+7*D[18];if(l>=0&&P<=V&&P<=ee)return rp(e,d,t.subarray(l,l+c));var X,le,ae,de;if(qs(e,d,1+(ee<V)),d+=2,ee<V){X=Es(p,m,0),le=p,ae=Es(y,b,0),de=y;var ue=Es(O,F,0);qs(e,d,k-257),qs(e,d+5,M-1),qs(e,d+10,I-4),d+=14;for(var U=0;U<I;++U)qs(e,d+3*U,O[pu[U]]);d+=3*I;for(var Ce=[N,_],Q=0;Q<2;++Q)for(var z=Ce[Q],U=0;U<z.length;++U){var W=z[U]&31;qs(e,d,ue[W]),d+=O[W],W>15&&(qs(e,d,z[U]>>5&127),d+=z[U]>>12)}}else X=xy,le=La,ae=yy,de=Ho;for(var U=0;U<o;++U){var Z=r[U];if(Z>255){var W=Z>>18&31;po(e,d,X[W+257]),d+=le[W+257],W>7&&(qs(e,d,Z>>23&31),d+=zc[W]);var ne=Z&31;po(e,d,ae[ne]),d+=de[ne],ne>3&&(po(e,d,Z>>5&8191),d+=Jc[ne])}else po(e,d,X[Z]),d+=le[Z]}return po(e,d,X[256]),d+le[256]},Cy=new yf([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),sp=new er(0),Ny=function(t,e,n,r,a,i){var A=i.z||t.length,o=new er(r+A+5*(1+Math.ceil(A/7e3))+a),l=o.subarray(r,o.length-a),c=i.l,d=(i.r||0)&7;if(e){d&&(l[0]=i.r>>3);for(var h=Cy[e-1],p=h>>13,m=h&8191,B=(1<<n)-1,y=i.p||new Qr(32768),b=i.h||new Qr(B+1),C=Math.ceil(n/3),N=2*C,k=function(st){return(t[st]^t[st+1]<<C^t[st+2]<<N)&B},E=new yf(25e3),_=new Qr(288),M=new Qr(32),D=0,U=0,j=i.i||0,O=0,F=i.w||0,I=0;j+2<A;++j){var P=k(j),V=j&32767,ee=b[P];if(y[V]=ee,b[P]=V,F<=j){var X=A-j;if((D>7e3||O>24576)&&(X>423||!c)){d=Fh(t,l,0,E,_,M,U,O,I,j-I,d),O=D=U=0,I=j;for(var le=0;le<286;++le)_[le]=0;for(var le=0;le<30;++le)M[le]=0}var ae=2,de=0,ue=m,Ce=V-ee&32767;if(X>2&&P==k(j-Ce))for(var Q=Math.min(p,X)-1,z=Math.min(32767,j),W=Math.min(258,X);Ce<=z&&--ue&&V!=ee;){if(t[j+ae]==t[j+ae-Ce]){for(var Z=0;Z<W&&t[j+Z]==t[j+Z-Ce];++Z);if(Z>ae){if(ae=Z,de=Ce,Z>Q)break;for(var ne=Math.min(Ce,Z-2),fe=0,le=0;le<ne;++le){var xe=j-Ce+le&32767,we=y[xe],Qe=xe-we&32767;Qe>fe&&(fe=Qe,ee=xe)}}}V=ee,ee=y[V],Ce+=V-ee&32767}if(de){E[O++]=268435456|xu[ae]<<18|Sh[de];var je=xu[ae]&31,Me=Sh[de]&31;U+=zc[je]+Jc[Me],++_[257+je],++M[Me],F=j+ae,++D}else E[O++]=t[j],++_[t[j]]}}for(j=Math.max(j,F);j<A;++j)E[O++]=t[j],++_[t[j]];d=Fh(t,l,c,E,_,M,U,O,I,j-I,d),c||(i.r=d&7|l[d/8|0]<<3,d-=7,i.h=b,i.p=y,i.i=j,i.w=F)}else{for(var j=i.w||0;j<A+c;j+=65535){var De=j+65535;De>=A&&(l[d/8|0]=c,De=A),d=rp(l,d+1,t.subarray(j,De))}i.i=A}return np(o,0,r+bf(d)+a)},ap=function(){var t=1,e=0;return{p:function(n){for(var r=t,a=e,i=n.length|0,A=0;A!=i;){for(var o=Math.min(A+2655,i);A<o;++A)a+=r+=n[A];r=(r&65535)+15*(r>>16),a=(a&65535)+15*(a>>16)}t=r,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},Sy=function(t,e,n,r,a){if(!a&&(a={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),A=new er(i.length+t.length);A.set(i),A.set(t,i.length),t=A,a.w=i.length}return Ny(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,a)},ip=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},Iy=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=ap();a.p(e.dictionary),ip(t,2,a.d())}},Fy=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ls(6,"invalid zlib data"),(t[1]>>5&1)==1&&ls(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function bu(t,e){e||(e={});var n=ap();n.p(t);var r=Sy(t,e,e.dictionary?6:2,4);return Iy(r,e),ip(r,r.length-4,n.d()),r}function Ey(t,e){return By(t.subarray(Fy(t),-4),{i:2},e,e)}var ky=typeof TextDecoder<"u"&&new TextDecoder,Uy=0;try{ky.decode(sp,{stream:!0}),Uy=1}catch{}var lt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Rd(){lt.console&&typeof lt.console.log=="function"&&lt.console.log.apply(lt.console,arguments)}var Ht={log:Rd,warn:function(t){lt.console&&(typeof lt.console.warn=="function"?lt.console.warn.apply(lt.console,arguments):Rd.call(null,arguments))},error:function(t){lt.console&&(typeof lt.console.error=="function"?lt.console.error.apply(lt.console,arguments):Rd(t))}};function Hd(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){ri(r.response,e,n)},r.onerror=function(){Ht.error("could not download file")},r.send()}function Eh(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function kl(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Qo,vu,ri=lt.saveAs||((typeof window>"u"?"undefined":_t(window))!=="object"||window!==lt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=lt.URL||lt.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?Eh(a.href)?Hd(t,e,n):kl(a,a.target="_blank"):kl(a)):(a.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){kl(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(Eh(t))Hd(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){kl(r)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:_t(i)!=="object"&&(Ht.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return Hd(t,e,n);var a=t.type==="application/octet-stream",i=/constructor/i.test(lt.HTMLElement)||lt.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||a&&i)&&(typeof FileReader>"u"?"undefined":_t(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=A?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=d:location=d,r=null},o.readAsDataURL(t)}else{var l=lt.URL||lt.webkitURL,c=l.createObjectURL(t);r?r.location=c:location.href=c,r=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Ap(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],r=0;r<n.length;r++){var a=n[r].re,i=n[r].process,A=a.exec(t);A&&(e=i(A),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Od(t,e){var n=t[0],r=t[1],a=t[2],i=t[3];n=zn(n,r,a,i,e[0],7,-680876936),i=zn(i,n,r,a,e[1],12,-389564586),a=zn(a,i,n,r,e[2],17,606105819),r=zn(r,a,i,n,e[3],22,-1044525330),n=zn(n,r,a,i,e[4],7,-176418897),i=zn(i,n,r,a,e[5],12,1200080426),a=zn(a,i,n,r,e[6],17,-1473231341),r=zn(r,a,i,n,e[7],22,-45705983),n=zn(n,r,a,i,e[8],7,1770035416),i=zn(i,n,r,a,e[9],12,-1958414417),a=zn(a,i,n,r,e[10],17,-42063),r=zn(r,a,i,n,e[11],22,-1990404162),n=zn(n,r,a,i,e[12],7,1804603682),i=zn(i,n,r,a,e[13],12,-40341101),a=zn(a,i,n,r,e[14],17,-1502002290),n=Jn(n,r=zn(r,a,i,n,e[15],22,1236535329),a,i,e[1],5,-165796510),i=Jn(i,n,r,a,e[6],9,-1069501632),a=Jn(a,i,n,r,e[11],14,643717713),r=Jn(r,a,i,n,e[0],20,-373897302),n=Jn(n,r,a,i,e[5],5,-701558691),i=Jn(i,n,r,a,e[10],9,38016083),a=Jn(a,i,n,r,e[15],14,-660478335),r=Jn(r,a,i,n,e[4],20,-405537848),n=Jn(n,r,a,i,e[9],5,568446438),i=Jn(i,n,r,a,e[14],9,-1019803690),a=Jn(a,i,n,r,e[3],14,-187363961),r=Jn(r,a,i,n,e[8],20,1163531501),n=Jn(n,r,a,i,e[13],5,-1444681467),i=Jn(i,n,r,a,e[2],9,-51403784),a=Jn(a,i,n,r,e[7],14,1735328473),n=Wn(n,r=Jn(r,a,i,n,e[12],20,-1926607734),a,i,e[5],4,-378558),i=Wn(i,n,r,a,e[8],11,-2022574463),a=Wn(a,i,n,r,e[11],16,1839030562),r=Wn(r,a,i,n,e[14],23,-35309556),n=Wn(n,r,a,i,e[1],4,-1530992060),i=Wn(i,n,r,a,e[4],11,1272893353),a=Wn(a,i,n,r,e[7],16,-155497632),r=Wn(r,a,i,n,e[10],23,-1094730640),n=Wn(n,r,a,i,e[13],4,681279174),i=Wn(i,n,r,a,e[0],11,-358537222),a=Wn(a,i,n,r,e[3],16,-722521979),r=Wn(r,a,i,n,e[6],23,76029189),n=Wn(n,r,a,i,e[9],4,-640364487),i=Wn(i,n,r,a,e[12],11,-421815835),a=Wn(a,i,n,r,e[15],16,530742520),n=Yn(n,r=Wn(r,a,i,n,e[2],23,-995338651),a,i,e[0],6,-198630844),i=Yn(i,n,r,a,e[7],10,1126891415),a=Yn(a,i,n,r,e[14],15,-1416354905),r=Yn(r,a,i,n,e[5],21,-57434055),n=Yn(n,r,a,i,e[12],6,1700485571),i=Yn(i,n,r,a,e[3],10,-1894986606),a=Yn(a,i,n,r,e[10],15,-1051523),r=Yn(r,a,i,n,e[1],21,-2054922799),n=Yn(n,r,a,i,e[8],6,1873313359),i=Yn(i,n,r,a,e[15],10,-30611744),a=Yn(a,i,n,r,e[6],15,-1560198380),r=Yn(r,a,i,n,e[13],21,1309151649),n=Yn(n,r,a,i,e[4],6,-145523070),i=Yn(i,n,r,a,e[11],10,-1120210379),a=Yn(a,i,n,r,e[2],15,718787259),r=Yn(r,a,i,n,e[9],21,-343485551),t[0]=Na(n,t[0]),t[1]=Na(r,t[1]),t[2]=Na(a,t[2]),t[3]=Na(i,t[3])}function Wc(t,e,n,r,a,i){return e=Na(Na(e,t),Na(r,i)),Na(e<<a|e>>>32-a,n)}function zn(t,e,n,r,a,i,A){return Wc(e&n|~e&r,t,e,a,i,A)}function Jn(t,e,n,r,a,i,A){return Wc(e&r|n&~r,t,e,a,i,A)}function Wn(t,e,n,r,a,i,A){return Wc(e^n^r,t,e,a,i,A)}function Yn(t,e,n,r,a,i,A){return Wc(n^(e|~r),t,e,a,i,A)}function op(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Od(r,jy(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(Od(r,a),e=0;e<16;e++)a[e]=0;return a[14]=8*n,Od(r,a),r}function jy(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}Qo=lt.atob.bind(lt),vu=lt.btoa.bind(lt);var kh="0123456789abcdef".split("");function Ty(t){for(var e="",n=0;n<4;n++)e+=kh[t>>8*n+4&15]+kh[t>>8*n&15];return e}function Qy(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Bu(t){return op(t).map(Qy).join("")}var Ly=function(t){for(var e=0;e<t.length;e++)t[e]=Ty(t[e]);return t.join("")}(op("hello"))!="5d41402abc4b2a76b9719d911017c592";function Na(t,e){if(Ly){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Cu(t,e){var n,r,a,i;if(t!==n){for(var A=(a=t,i=1+(256/t.length>>0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var d=o[l];c=(c+d+A.charCodeAt(l))%256,o[l]=o[c],o[c]=d}n=t,r=o}else o=r;var h=e.length,p=0,m=0,B="";for(l=0;l<h;l++)m=(m+(d=o[p=(p+1)%256]))%256,o[p]=o[m],o[m]=d,A=o[(o[p]+o[m])%256],B+=String.fromCharCode(e.charCodeAt(l)^A);return B}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Uh={print:4,modify:8,copy:16,"annot-forms":32};function AA(t,e,n,r){this.v=1,this.r=2;var a=192;t.forEach(function(o){if(Uh.perm!==void 0)throw new Error("Invalid permission: "+o);a+=Uh[o]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var i=(e+this.padding).substr(0,32),A=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,A),this.P=-(1+(255^a)),this.encryptionKey=Bu(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Cu(this.encryptionKey,this.padding)}function oA(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var a=t.charCodeAt(r);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?e+="#"+("0"+a.toString(16)).slice(-2):e+=t[r]}return e}function jh(t){if(_t(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,a){if(a=a||!1,typeof n!="string"||typeof r!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var i=Math.random().toString(35);return e[n][i]=[r,!!a],i},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var i in e[n]){var A=e[n][i];try{A[0].apply(t,r)}catch(o){lt.console&&Ht.error("jsPDF PubSub Error",o.message,o)}A[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function yc(t){if(!(this instanceof yc))return new yc(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function lp(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function ai(t,e,n,r,a){if(!(this instanceof ai))return new ai(t,e,n,r,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,lp.call(this,r,a)}function dA(t,e,n,r,a){if(!(this instanceof dA))return new dA(t,e,n,r,a);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,lp.call(this,r,a)}function it(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],a=arguments[2],i=arguments[3],A=[],o=1,l=16,c="S",d=null;_t(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,a=t.format||a,i=t.compress||t.compressPdf||i,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),A=t.filters||(i===!0?["FlateEncode"]:A),r=r||"mm",n=(""+(n||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,p={},m={internal:{},__private__:{}};m.__private__.PubSub=jh;var B="1.3",y=m.__private__.getPdfVersion=function(){return B};m.__private__.setPdfVersion=function(w){B=w};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return b};var C=m.__private__.getPageFormat=function(w){return b[w]};a=a||"a4";var N={COMPAT:"compat",ADVANCED:"advanced"},k=N.COMPAT;function E(){this.saveGraphicsState(),$(new Ee(Ke,0,0,-Ke,0,oa()*Ke).toString()+" cm"),this.setFontSize(this.getFontSize()/Ke),c="n",k=N.ADVANCED}function _(){this.restoreGraphicsState(),c="S",k=N.COMPAT}var M=m.__private__.combineFontStyleAndFontWeight=function(w,L){if(w=="bold"&&L=="normal"||w=="bold"&&L==400||w=="normal"&&L=="italic"||w=="bold"&&L=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return L&&(w=L==400||L==="normal"?w==="italic"?"italic":"normal":L!=700&&L!=="bold"||w!=="normal"?(L==700?"bold":L)+""+w:"bold"),w};m.advancedAPI=function(w){var L=k===N.COMPAT;return L&&E.call(this),typeof w!="function"||(w(this),L&&_.call(this)),this},m.compatAPI=function(w){var L=k===N.ADVANCED;return L&&_.call(this),typeof w!="function"||(w(this),L&&E.call(this)),this},m.isAdvancedAPI=function(){return k===N.ADVANCED};var D,U=function(w){if(k!==N.ADVANCED)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},j=m.roundToPrecision=m.__private__.roundToPrecision=function(w,L){var Y=e||L;if(isNaN(w)||isNaN(Y))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(Y).replace(/0+$/,"")};D=m.hpf=m.__private__.hpf=typeof l=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return j(w,l)}:l==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return j(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return j(w,16)};var O=m.f2=m.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return j(w,2)},F=m.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return j(w,3)},I=m.scale=m.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return k===N.COMPAT?w*Ke:k===N.ADVANCED?w:void 0},P=function(w){return k===N.COMPAT?oa()-w:k===N.ADVANCED?w:void 0},V=function(w){return I(P(w))};m.__private__.setPrecision=m.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(e=parseInt(w,10))};var ee,X="00000000000000000000000000000000",le=m.__private__.getFileId=function(){return X},ae=m.__private__.setFileId=function(w){return X=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(bn=new AA(d.userPermissions,d.userPassword,d.ownerPassword,X)),X};m.setFileId=function(w){return ae(w),this},m.getFileId=function(){return le()};var de=m.__private__.convertDateToPDFDate=function(w){var L=w.getTimezoneOffset(),Y=L<0?"+":"-",te=Math.floor(Math.abs(L/60)),he=Math.abs(L%60),Be=[Y,W(te),"'",W(he),"'"].join("");return["D:",w.getFullYear(),W(w.getMonth()+1),W(w.getDate()),W(w.getHours()),W(w.getMinutes()),W(w.getSeconds()),Be].join("")},ue=m.__private__.convertPDFDateToDate=function(w){var L=parseInt(w.substr(2,4),10),Y=parseInt(w.substr(6,2),10)-1,te=parseInt(w.substr(8,2),10),he=parseInt(w.substr(10,2),10),Be=parseInt(w.substr(12,2),10),ke=parseInt(w.substr(14,2),10);return new Date(L,Y,te,he,Be,ke,0)},Ce=m.__private__.setCreationDate=function(w){var L;if(w===void 0&&(w=new Date),w instanceof Date)L=de(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");L=w}return ee=L},Q=m.__private__.getCreationDate=function(w){var L=ee;return w==="jsDate"&&(L=ue(ee)),L};m.setCreationDate=function(w){return Ce(w),this},m.getCreationDate=function(w){return Q(w)};var z,W=m.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},Z=m.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},ne=0,fe=[],xe=[],we=0,Qe=[],je=[],Me=!1,De=xe,st=function(){ne=0,we=0,xe=[],fe=[],Qe=[],Br=$t(),cr=$t()};m.__private__.setCustomOutputDestination=function(w){Me=!0,De=w};var ve=function(w){Me||(De=w)};m.__private__.resetCustomOutputDestination=function(){Me=!1,De=xe};var $=m.__private__.out=function(w){return w=w.toString(),we+=w.length+1,De.push(w),De},At=m.__private__.write=function(w){return $(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},et=m.__private__.getArrayBuffer=function(w){for(var L=w.length,Y=new ArrayBuffer(L),te=new Uint8Array(Y);L--;)te[L]=w.charCodeAt(L);return Y},Ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Ue};var Le=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(w){return Le=k===N.ADVANCED?w/Ke:w,this};var He,Oe=m.__private__.getFontSize=m.getFontSize=function(){return k===N.COMPAT?Le:Le*Ke},tt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(w){return tt=w,this},m.__private__.getR2L=m.getR2L=function(){return tt};var ut,mt=m.__private__.setZoomMode=function(w){var L=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))He=w;else if(isNaN(w)){if(L.indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');He=w}else He=parseInt(w,10)};m.__private__.getZoomMode=function(){return He};var wt,Bt=m.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');ut=w};m.__private__.getPageMode=function(){return ut};var kt=m.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');wt=w};m.__private__.getLayoutMode=function(){return wt},m.__private__.setDisplayMode=m.setDisplayMode=function(w,L,Y){return mt(w),kt(L),Bt(Y),this};var ot={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(w){if(Object.keys(ot).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ot[w]},m.__private__.getDocumentProperties=function(){return ot},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(w){for(var L in ot)ot.hasOwnProperty(L)&&w[L]&&(ot[L]=w[L]);return this},m.__private__.setDocumentProperty=function(w,L){if(Object.keys(ot).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ot[w]=L};var yt,Ke,An,Ct,yr,jt={},Ot={},_r=[],St={},br={},Wt={},or={},es=null,Yt=0,dt=[],ft=new jh(m),ms=t.hotfixes||[],on={},vr={},lr=[],Ee=function w(L,Y,te,he,Be,ke){if(!(this instanceof w))return new w(L,Y,te,he,Be,ke);isNaN(L)&&(L=1),isNaN(Y)&&(Y=0),isNaN(te)&&(te=0),isNaN(he)&&(he=1),isNaN(Be)&&(Be=0),isNaN(ke)&&(ke=0),this._matrix=[L,Y,te,he,Be,ke]};Object.defineProperty(Ee.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Ee.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Ee.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Ee.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Ee.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Ee.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Ee.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Ee.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Ee.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Ee.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Ee.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Ee.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Ee.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ee.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ee.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ee.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ee.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(D).join(w)},Ee.prototype.multiply=function(w){var L=w.sx*this.sx+w.shy*this.shx,Y=w.sx*this.shy+w.shy*this.sy,te=w.shx*this.sx+w.sy*this.shx,he=w.shx*this.shy+w.sy*this.sy,Be=w.tx*this.sx+w.ty*this.shx+this.tx,ke=w.tx*this.shy+w.ty*this.sy+this.ty;return new Ee(L,Y,te,he,Be,ke)},Ee.prototype.decompose=function(){var w=this.sx,L=this.shy,Y=this.shx,te=this.sy,he=this.tx,Be=this.ty,ke=Math.sqrt(w*w+L*L),Je=(w/=ke)*Y+(L/=ke)*te;Y-=w*Je,te-=L*Je;var nt=Math.sqrt(Y*Y+te*te);return Je/=nt,w*(te/=nt)<L*(Y/=nt)&&(w=-w,L=-L,Je=-Je,ke=-ke),{scale:new Ee(ke,0,0,nt,0,0),translate:new Ee(1,0,0,1,he,Be),rotate:new Ee(w,L,-L,w,0,0),skew:new Ee(1,0,Je,1,0,0)}},Ee.prototype.toString=function(w){return this.join(" ")},Ee.prototype.inversed=function(){var w=this.sx,L=this.shy,Y=this.shx,te=this.sy,he=this.tx,Be=this.ty,ke=1/(w*te-L*Y),Je=te*ke,nt=-L*ke,pt=-Y*ke,ht=w*ke;return new Ee(Je,nt,pt,ht,-Je*he-pt*Be,-nt*he-ht*Be)},Ee.prototype.applyToPoint=function(w){var L=w.x*this.sx+w.y*this.shx+this.tx,Y=w.x*this.shy+w.y*this.sy+this.ty;return new Qi(L,Y)},Ee.prototype.applyToRectangle=function(w){var L=this.applyToPoint(w),Y=this.applyToPoint(new Qi(w.x+w.w,w.y+w.h));return new WA(L.x,L.y,Y.x-L.x,Y.y-L.y)},Ee.prototype.clone=function(){var w=this.sx,L=this.shy,Y=this.shx,te=this.sy,he=this.tx,Be=this.ty;return new Ee(w,L,Y,te,he,Be)},m.Matrix=Ee;var Vn=m.matrixMult=function(w,L){return L.multiply(w)},Fn=new Ee(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Fn;var Ln=function(w,L){if(!br[w]){var Y=(L instanceof ai?"Sh":"P")+(Object.keys(St).length+1).toString(10);L.id=Y,br[w]=Y,St[Y]=L,ft.publish("addPattern",L)}};m.ShadingPattern=ai,m.TilingPattern=dA,m.addShadingPattern=function(w,L){return U("addShadingPattern()"),Ln(w,L),this},m.beginTilingPattern=function(w){U("beginTilingPattern()"),sl(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},m.endTilingPattern=function(w,L){U("endTilingPattern()"),L.stream=je[z].join(`
`),Ln(w,L),ft.publish("endTilingPattern",L),lr.pop().restore()};var en=m.__private__.newObject=function(){var w=$t();return _n(w,!0),w},$t=m.__private__.newObjectDeferred=function(){return ne++,fe[ne]=function(){return we},ne},_n=function(w,L){return L=typeof L=="boolean"&&L,fe[w]=we,L&&$(w+" 0 obj"),w},ps=m.__private__.newAdditionalObject=function(){var w={objId:$t(),content:""};return Qe.push(w),w},Br=$t(),cr=$t(),dr=m.__private__.decodeColorString=function(w){var L=w.split(" ");if(L.length!==2||L[1]!=="g"&&L[1]!=="G")L.length===5&&(L[4]==="k"||L[4]==="K")&&(L=[(1-L[0])*(1-L[3]),(1-L[1])*(1-L[3]),(1-L[2])*(1-L[3]),"r"]);else{var Y=parseFloat(L[0]);L=[Y,Y,Y,"r"]}for(var te="#",he=0;he<3;he++)te+=("0"+Math.floor(255*parseFloat(L[he])).toString(16)).slice(-2);return te},mn=m.__private__.encodeColorString=function(w){var L;typeof w=="string"&&(w={ch1:w});var Y=w.ch1,te=w.ch2,he=w.ch3,Be=w.ch4,ke=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Y=="string"&&Y.charAt(0)!=="#"){var Je=new Ap(Y);if(Je.ok)Y=Je.toHex();else if(!/^\d*\.?\d*$/.test(Y))throw new Error('Invalid color "'+Y+'" passed to jsPDF.encodeColorString.')}if(typeof Y=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Y)&&(Y="#"+Y[1]+Y[1]+Y[2]+Y[2]+Y[3]+Y[3]),typeof Y=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Y)){var nt=parseInt(Y.substr(1),16);Y=nt>>16&255,te=nt>>8&255,he=255&nt}if(te===void 0||Be===void 0&&Y===te&&te===he)if(typeof Y=="string")L=Y+" "+ke[0];else switch(w.precision){case 2:L=O(Y/255)+" "+ke[0];break;case 3:default:L=F(Y/255)+" "+ke[0]}else if(Be===void 0||_t(Be)==="object"){if(Be&&!isNaN(Be.a)&&Be.a===0)return L=["1.","1.","1.",ke[1]].join(" ");if(typeof Y=="string")L=[Y,te,he,ke[1]].join(" ");else switch(w.precision){case 2:L=[O(Y/255),O(te/255),O(he/255),ke[1]].join(" ");break;default:case 3:L=[F(Y/255),F(te/255),F(he/255),ke[1]].join(" ")}}else if(typeof Y=="string")L=[Y,te,he,Be,ke[2]].join(" ");else switch(w.precision){case 2:L=[O(Y),O(te),O(he),O(Be),ke[2]].join(" ");break;case 3:default:L=[F(Y),F(te),F(he),F(Be),ke[2]].join(" ")}return L},Mr=m.__private__.getFilters=function(){return A},qt=m.__private__.putStream=function(w){var L=(w=w||{}).data||"",Y=w.filters||Mr(),te=w.alreadyAppliedFilters||[],he=w.addLength1||!1,Be=L.length,ke=w.objectId,Je=function(qn){return qn};if(d!==null&&ke===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Je=bn.encryptor(ke,0));var nt={};Y===!0&&(Y=["FlateEncode"]);var pt=w.additionalKeyValues||[],ht=(nt=it.API.processDataByFilters!==void 0?it.API.processDataByFilters(L,Y):{data:L,reverseChain:[]}).reverseChain+(Array.isArray(te)?te.join(" "):te.toString());if(nt.data.length!==0&&(pt.push({key:"Length",value:nt.data.length}),he===!0&&pt.push({key:"Length1",value:Be})),ht.length!=0)if(ht.split("/").length-1==1)pt.push({key:"Filter",value:ht});else{pt.push({key:"Filter",value:"["+ht+"]"});for(var Nt=0;Nt<pt.length;Nt+=1)if(pt[Nt].key==="DecodeParms"){for(var tn=[],rn=0;rn<nt.reverseChain.split("/").length-1;rn+=1)tn.push("null");tn.push(pt[Nt].value),pt[Nt].value="["+tn.join(" ")+"]"}}$("<<");for(var pn=0;pn<pt.length;pn++)$("/"+pt[pn].key+" "+pt[pn].value);$(">>"),nt.data.length!==0&&($("stream"),$(Je(nt.data)),$("endstream"))},ur=m.__private__.putPage=function(w){var L=w.number,Y=w.data,te=w.objId,he=w.contentsObjId;_n(te,!0),$("<</Type /Page"),$("/Parent "+w.rootDictionaryObjId+" 0 R"),$("/Resources "+w.resourceDictionaryObjId+" 0 R"),$("/MediaBox ["+parseFloat(D(w.mediaBox.bottomLeftX))+" "+parseFloat(D(w.mediaBox.bottomLeftY))+" "+D(w.mediaBox.topRightX)+" "+D(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&$("/CropBox ["+D(w.cropBox.bottomLeftX)+" "+D(w.cropBox.bottomLeftY)+" "+D(w.cropBox.topRightX)+" "+D(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&$("/BleedBox ["+D(w.bleedBox.bottomLeftX)+" "+D(w.bleedBox.bottomLeftY)+" "+D(w.bleedBox.topRightX)+" "+D(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&$("/TrimBox ["+D(w.trimBox.bottomLeftX)+" "+D(w.trimBox.bottomLeftY)+" "+D(w.trimBox.topRightX)+" "+D(w.trimBox.topRightY)+"]"),w.artBox!==null&&$("/ArtBox ["+D(w.artBox.bottomLeftX)+" "+D(w.artBox.bottomLeftY)+" "+D(w.artBox.topRightX)+" "+D(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&$("/UserUnit "+w.userUnit),ft.publish("putPage",{objId:te,pageContext:dt[L],pageNumber:L,page:Y}),$("/Contents "+he+" 0 R"),$(">>"),$("endobj");var Be=Y.join(`
`);return k===N.ADVANCED&&(Be+=`
Q`),_n(he,!0),qt({data:Be,filters:Mr(),objectId:he}),$("endobj"),te},xs=m.__private__.putPages=function(){var w,L,Y=[];for(w=1;w<=Yt;w++)dt[w].objId=$t(),dt[w].contentsObjId=$t();for(w=1;w<=Yt;w++)Y.push(ur({number:w,data:je[w],objId:dt[w].objId,contentsObjId:dt[w].contentsObjId,mediaBox:dt[w].mediaBox,cropBox:dt[w].cropBox,bleedBox:dt[w].bleedBox,trimBox:dt[w].trimBox,artBox:dt[w].artBox,userUnit:dt[w].userUnit,rootDictionaryObjId:Br,resourceDictionaryObjId:cr}));_n(Br,!0),$("<</Type /Pages");var te="/Kids [";for(L=0;L<Yt;L++)te+=Y[L]+" 0 R ";$(te+"]"),$("/Count "+Yt),$(">>"),$("endobj"),ft.publish("postPutPages")},na=function(w){ft.publish("putFont",{font:w,out:$,newObject:en,putStream:qt}),w.isAlreadyPutted!==!0&&(w.objectNumber=en(),$("<<"),$("/Type /Font"),$("/BaseFont /"+oA(w.postScriptName)),$("/Subtype /Type1"),typeof w.encoding=="string"&&$("/Encoding /"+w.encoding),$("/FirstChar 32"),$("/LastChar 255"),$(">>"),$("endobj"))},ra=function(){for(var w in jt)jt.hasOwnProperty(w)&&(h===!1||h===!0&&p.hasOwnProperty(w))&&na(jt[w])},Ls=function(w){w.objectNumber=en();var L=[];L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Form"}),L.push({key:"BBox",value:"["+[D(w.x),D(w.y),D(w.x+w.width),D(w.y+w.height)].join(" ")+"]"}),L.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var Y=w.pages[1].join(`
`);qt({data:Y,additionalKeyValues:L,objectId:w.objectNumber}),$("endobj")},_s=function(){for(var w in on)on.hasOwnProperty(w)&&Ls(on[w])},yi=function(w,L){var Y,te=[],he=1/(L-1);for(Y=0;Y<1;Y+=he)te.push(Y);if(te.push(1),w[0].offset!=0){var Be={offset:0,color:w[0].color};w.unshift(Be)}if(w[w.length-1].offset!=1){var ke={offset:1,color:w[w.length-1].color};w.push(ke)}for(var Je="",nt=0,pt=0;pt<te.length;pt++){for(Y=te[pt];Y>w[nt+1].offset;)nt++;var ht=w[nt].offset,Nt=(Y-ht)/(w[nt+1].offset-ht),tn=w[nt].color,rn=w[nt+1].color;Je+=Z(Math.round((1-Nt)*tn[0]+Nt*rn[0]).toString(16))+Z(Math.round((1-Nt)*tn[1]+Nt*rn[1]).toString(16))+Z(Math.round((1-Nt)*tn[2]+Nt*rn[2]).toString(16))}return Je.trim()},LA=function(w,L){L||(L=21);var Y=en(),te=yi(w.colors,L),he=[];he.push({key:"FunctionType",value:"0"}),he.push({key:"Domain",value:"[0.0 1.0]"}),he.push({key:"Size",value:"["+L+"]"}),he.push({key:"BitsPerSample",value:"8"}),he.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),he.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qt({data:te,additionalKeyValues:he,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Y}),$("endobj"),w.objectNumber=en(),$("<< /ShadingType "+w.type),$("/ColorSpace /DeviceRGB");var Be="/Coords ["+D(parseFloat(w.coords[0]))+" "+D(parseFloat(w.coords[1]))+" ";w.type===2?Be+=D(parseFloat(w.coords[2]))+" "+D(parseFloat(w.coords[3])):Be+=D(parseFloat(w.coords[2]))+" "+D(parseFloat(w.coords[3]))+" "+D(parseFloat(w.coords[4]))+" "+D(parseFloat(w.coords[5])),$(Be+="]"),w.matrix&&$("/Matrix ["+w.matrix.toString()+"]"),$("/Function "+Y+" 0 R"),$("/Extend [true true]"),$(">>"),$("endobj")},_A=function(w,L){var Y=$t(),te=en();L.push({resourcesOid:Y,objectOid:te}),w.objectNumber=te;var he=[];he.push({key:"Type",value:"/Pattern"}),he.push({key:"PatternType",value:"1"}),he.push({key:"PaintType",value:"1"}),he.push({key:"TilingType",value:"1"}),he.push({key:"BBox",value:"["+w.boundingBox.map(D).join(" ")+"]"}),he.push({key:"XStep",value:D(w.xStep)}),he.push({key:"YStep",value:D(w.yStep)}),he.push({key:"Resources",value:Y+" 0 R"}),w.matrix&&he.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),qt({data:w.stream,additionalKeyValues:he,objectId:w.objectNumber}),$("endobj")},Ms=function(w){var L;for(L in St)St.hasOwnProperty(L)&&(St[L]instanceof ai?LA(St[L]):St[L]instanceof dA&&_A(St[L],w))},bi=function(w){for(var L in w.objectNumber=en(),$("<<"),w)switch(L){case"opacity":$("/ca "+O(w[L]));break;case"stroke-opacity":$("/CA "+O(w[L]))}$(">>"),$("endobj")},vi=function(){var w;for(w in Wt)Wt.hasOwnProperty(w)&&bi(Wt[w])},Pa=function(){for(var w in $("/XObject <<"),on)on.hasOwnProperty(w)&&on[w].objectNumber>=0&&$("/"+w+" "+on[w].objectNumber+" 0 R");ft.publish("putXobjectDict"),$(">>")},Bi=function(){bn.oid=en(),$("<<"),$("/Filter /Standard"),$("/V "+bn.v),$("/R "+bn.r),$("/U <"+bn.toHexString(bn.U)+">"),$("/O <"+bn.toHexString(bn.O)+">"),$("/P "+bn.P),$(">>"),$("endobj")},Ra=function(){for(var w in $("/Font <<"),jt)jt.hasOwnProperty(w)&&(h===!1||h===!0&&p.hasOwnProperty(w))&&$("/"+w+" "+jt[w].objectNumber+" 0 R");$(">>")},MA=function(){if(Object.keys(St).length>0){for(var w in $("/Shading <<"),St)St.hasOwnProperty(w)&&St[w]instanceof ai&&St[w].objectNumber>=0&&$("/"+w+" "+St[w].objectNumber+" 0 R");ft.publish("putShadingPatternDict"),$(">>")}},sa=function(w){if(Object.keys(St).length>0){for(var L in $("/Pattern <<"),St)St.hasOwnProperty(L)&&St[L]instanceof m.TilingPattern&&St[L].objectNumber>=0&&St[L].objectNumber<w&&$("/"+L+" "+St[L].objectNumber+" 0 R");ft.publish("putTilingPatternDict"),$(">>")}},DA=function(){if(Object.keys(Wt).length>0){var w;for(w in $("/ExtGState <<"),Wt)Wt.hasOwnProperty(w)&&Wt[w].objectNumber>=0&&$("/"+w+" "+Wt[w].objectNumber+" 0 R");ft.publish("putGStateDict"),$(">>")}},Xt=function(w){_n(w.resourcesOid,!0),$("<<"),$("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ra(),MA(),sa(w.objectOid),DA(),Pa(),$(">>"),$("endobj")},Ha=function(){var w=[];ra(),vi(),_s(),Ms(w),ft.publish("putResources"),w.forEach(Xt),Xt({resourcesOid:cr,objectOid:Number.MAX_SAFE_INTEGER}),ft.publish("postPutResources")},Ci=function(){ft.publish("putAdditionalObjects");for(var w=0;w<Qe.length;w++){var L=Qe[w];_n(L.objId,!0),$(L.content),$("endobj")}ft.publish("postPutAdditionalObjects")},Ni=function(w){Ot[w.fontName]=Ot[w.fontName]||{},Ot[w.fontName][w.fontStyle]=w.id},Oa=function(w,L,Y,te,he){var Be={id:"F"+(Object.keys(jt).length+1).toString(10),postScriptName:w,fontName:L,fontStyle:Y,encoding:te,isStandardFont:he||!1,metadata:{}};return ft.publish("addFont",{font:Be,instance:this}),jt[Be.id]=Be,Ni(Be),Be.id},PA=function(w){for(var L=0,Y=Ue.length;L<Y;L++){var te=Oa.call(this,w[L][0],w[L][1],w[L][2],Ue[L][3],!0);h===!1&&(p[te]=!0);var he=w[L][0].split("-");Ni({id:te,fontName:he[0],fontStyle:he[1]||""})}ft.publish("addFonts",{fonts:jt,dictionary:Ot})},Cr=function(w){return w.foo=function(){try{return w.apply(this,arguments)}catch(te){var L=te.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var Y="Error in function "+L.split(`
`)[0].split("<")[0]+": "+te.message;if(!lt.console)throw new Error(Y);lt.console.error(Y,te),lt.alert&&alert(Y)}},w.foo.bar=w,w.foo},aa=function(w,L){var Y,te,he,Be,ke,Je,nt,pt,ht;if(he=(L=L||{}).sourceEncoding||"Unicode",ke=L.outputEncoding,(L.autoencode||ke)&&jt[yt].metadata&&jt[yt].metadata[he]&&jt[yt].metadata[he].encoding&&(Be=jt[yt].metadata[he].encoding,!ke&&jt[yt].encoding&&(ke=jt[yt].encoding),!ke&&Be.codePages&&(ke=Be.codePages[0]),typeof ke=="string"&&(ke=Be[ke]),ke)){for(nt=!1,Je=[],Y=0,te=w.length;Y<te;Y++)(pt=ke[w.charCodeAt(Y)])?Je.push(String.fromCharCode(pt)):Je.push(w[Y]),Je[Y].charCodeAt(0)>>8&&(nt=!0);w=Je.join("")}for(Y=w.length;nt===void 0&&Y!==0;)w.charCodeAt(Y-1)>>8&&(nt=!0),Y--;if(!nt)return w;for(Je=L.noBOM?[]:[254,255],Y=0,te=w.length;Y<te;Y++){if((ht=(pt=w.charCodeAt(Y))>>8)>>8)throw new Error("Character at position "+Y+" of string '"+w+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Je.push(ht),Je.push(pt-(ht<<8))}return String.fromCharCode.apply(void 0,Je)},Kn=m.__private__.pdfEscape=m.pdfEscape=function(w,L){return aa(w,L).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ga=m.__private__.beginPage=function(w){je[++Yt]=[],dt[Yt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Ii(Yt),ve(je[z])},Si=function(w,L){var Y,te,he;switch(n=L||n,typeof w=="string"&&(Y=C(w.toLowerCase()),Array.isArray(Y)&&(te=Y[0],he=Y[1])),Array.isArray(w)&&(te=w[0]*Ke,he=w[1]*Ke),isNaN(te)&&(te=a[0],he=a[1]),(te>14400||he>14400)&&(Ht.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),te=Math.min(14400,te),he=Math.min(14400,he)),a=[te,he],n.substr(0,1)){case"l":he>te&&(a=[he,te]);break;case"p":te>he&&(a=[he,te])}Ga(a),Zo(KA),$(ns),zA!==0&&$(zA+" J"),JA!==0&&$(JA+" j"),ft.publish("addPage",{pageNumber:Yt})},RA=function(w){w>0&&w<=Yt&&(je.splice(w,1),dt.splice(w,1),Yt--,z>Yt&&(z=Yt),this.setPage(z))},Ii=function(w){w>0&&w<=Yt&&(z=w)},HA=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return je.length-1},Fi=function(w,L,Y){var te,he=void 0;return Y=Y||{},w=w!==void 0?w:jt[yt].fontName,L=L!==void 0?L:jt[yt].fontStyle,te=w.toLowerCase(),Ot[te]!==void 0&&Ot[te][L]!==void 0?he=Ot[te][L]:Ot[w]!==void 0&&Ot[w][L]!==void 0?he=Ot[w][L]:Y.disableWarning===!1&&Ht.warn("Unable to look up font label for font '"+w+"', '"+L+"'. Refer to getFontList() for available fonts."),he||Y.noFallback||(he=Ot.times[L])==null&&(he=Ot.times.normal),he},Ei=m.__private__.putInfo=function(){var w=en(),L=function(te){return te};for(var Y in d!==null&&(L=bn.encryptor(w,0)),$("<<"),$("/Producer ("+Kn(L("jsPDF "+it.version))+")"),ot)ot.hasOwnProperty(Y)&&ot[Y]&&$("/"+Y.substr(0,1).toUpperCase()+Y.substr(1)+" ("+Kn(L(ot[Y]))+")");$("/CreationDate ("+Kn(L(ee))+")"),$(">>"),$("endobj")},Va=m.__private__.putCatalog=function(w){var L=(w=w||{}).rootDictionaryObjId||Br;switch(en(),$("<<"),$("/Type /Catalog"),$("/Pages "+L+" 0 R"),He||(He="fullwidth"),He){case"fullwidth":$("/OpenAction [3 0 R /FitH null]");break;case"fullheight":$("/OpenAction [3 0 R /FitV null]");break;case"fullpage":$("/OpenAction [3 0 R /Fit]");break;case"original":$("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Y=""+He;Y.substr(Y.length-1)==="%"&&(He=parseInt(He)/100),typeof He=="number"&&$("/OpenAction [3 0 R /XYZ null null "+O(He)+"]")}switch(wt||(wt="continuous"),wt){case"continuous":$("/PageLayout /OneColumn");break;case"single":$("/PageLayout /SinglePage");break;case"two":case"twoleft":$("/PageLayout /TwoColumnLeft");break;case"tworight":$("/PageLayout /TwoColumnRight")}ut&&$("/PageMode /"+ut),ft.publish("putCatalog"),$(">>"),$("endobj")},OA=m.__private__.putTrailer=function(){$("trailer"),$("<<"),$("/Size "+(ne+1)),$("/Root "+ne+" 0 R"),$("/Info "+(ne-1)+" 0 R"),d!==null&&$("/Encrypt "+bn.oid+" 0 R"),$("/ID [ <"+X+"> <"+X+"> ]"),$(">>")},GA=m.__private__.putHeader=function(){$("%PDF-"+B),$("%ÂºÃŸÂ¬Ã ")},VA=m.__private__.putXRef=function(){var w="0000000000";$("xref"),$("0 "+(ne+1)),$("0000000000 65535 f ");for(var L=1;L<=ne;L++)typeof fe[L]=="function"?$((w+fe[L]()).slice(-10)+" 00000 n "):fe[L]!==void 0?$((w+fe[L]).slice(-10)+" 00000 n "):$("0000000000 00000 n ")},ts=m.__private__.buildDocument=function(){st(),ve(xe),ft.publish("buildDocument"),GA(),xs(),Ci(),Ha(),d!==null&&Bi(),Ei(),Va();var w=we;return VA(),OA(),$("startxref"),$(""+w),$("%%EOF"),ve(je[z]),xe.join(`
`)},nn=m.__private__.getBlob=function(w){return new Blob([et(w)],{type:"application/pdf"})},Nr=m.output=m.__private__.output=Cr(function(w,L){switch(typeof(L=L||{})=="string"?L={filename:L}:L.filename=L.filename||"generated.pdf",w){case void 0:return ts();case"save":m.save(L.filename);break;case"arraybuffer":return et(ts());case"blob":return nn(ts());case"bloburi":case"bloburl":if(lt.URL!==void 0&&typeof lt.URL.createObjectURL=="function")return lt.URL&&lt.URL.createObjectURL(nn(ts()))||void 0;Ht.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Y="",te=ts();try{Y=vu(te)}catch{Y=vu(unescape(encodeURIComponent(te)))}return"data:application/pdf;filename="+L.filename+";base64,"+Y;case"pdfobjectnewwindow":if(Object.prototype.toString.call(lt)==="[object Window]"){var he="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Be=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';L.pdfObjectUrl&&(he=L.pdfObjectUrl,Be="");var ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+he+'"'+Be+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(L)+");<\/script></body></html>",Je=lt.open();return Je!==null&&Je.document.write(ke),Je}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(lt)==="[object Window]"){var nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(L.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+L.filename+'" width="500px" height="400px" /></body></html>',pt=lt.open();if(pt!==null){pt.document.write(nt);var ht=this;pt.document.documentElement.querySelector("#pdfViewer").onload=function(){pt.document.title=L.filename,pt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ht.output("bloburl"))}}return pt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(lt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",L)+'"></iframe></body></html>',tn=lt.open();if(tn!==null&&(tn.document.write(Nt),tn.document.title=L.filename),tn||typeof safari>"u")return tn;break;case"datauri":case"dataurl":return lt.document.location.href=this.output("datauristring",L);default:return null}}),Sr=function(w){return Array.isArray(ms)===!0&&ms.indexOf(w)>-1};switch(r){case"pt":Ke=1;break;case"mm":Ke=72/25.4;break;case"cm":Ke=72/2.54;break;case"in":Ke=72;break;case"px":Ke=Sr("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ke=12;break;case"ex":Ke=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Ke=r}var bn=null;Ce(),ae();var ki=function(w){return d!==null?bn.encryptor(w,0):function(L){return L}},Ka=m.__private__.getPageInfo=m.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:dt[w].objId,pageNumber:w,pageContext:dt[w]}},ct=m.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var L in dt)if(dt[L].objId===w)break;return Ka(L)},ws=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:dt[z].objId,pageNumber:z,pageContext:dt[z]}};m.addPage=function(){return Si.apply(this,arguments),this},m.setPage=function(){return Ii.apply(this,arguments),ve.call(this,je[z]),this},m.insertPage=function(w){return this.addPage(),this.movePage(z,w),this},m.movePage=function(w,L){var Y,te;if(w>L){Y=je[w],te=dt[w];for(var he=w;he>L;he--)je[he]=je[he-1],dt[he]=dt[he-1];je[L]=Y,dt[L]=te,this.setPage(L)}else if(w<L){Y=je[w],te=dt[w];for(var Be=w;Be<L;Be++)je[Be]=je[Be+1],dt[Be]=dt[Be+1];je[L]=Y,dt[L]=te,this.setPage(L)}return this},m.deletePage=function(){return RA.apply(this,arguments),this},m.__private__.text=m.text=function(w,L,Y,te,he){var Be,ke,Je,nt,pt,ht,Nt,tn,rn,pn=(te=te||{}).scope||this;if(typeof w=="number"&&typeof L=="number"&&(typeof Y=="string"||Array.isArray(Y))){var qn=Y;Y=L,L=w,w=qn}if(arguments[3]instanceof Ee?(U("The transform parameter of text() with a Matrix value"),rn=he):(Je=arguments[4],nt=arguments[5],_t(Nt=arguments[3])==="object"&&Nt!==null||(typeof Je=="string"&&(nt=Je,Je=null),typeof Nt=="string"&&(nt=Nt,Nt=null),typeof Nt=="number"&&(Je=Nt,Nt=null),te={flags:Nt,angle:Je,align:nt})),isNaN(L)||isNaN(Y)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return pn;var En="",rs=!1,Ir=typeof te.lineHeightFactor=="number"?te.lineHeightFactor:bs,Bs=pn.internal.scaleFactor;function al(Gt){return Gt=Gt.split("	").join(Array(te.TabLen||9).join(" ")),Kn(Gt,Nt)}function ZA(Gt){for(var Vt,cn=Gt.concat(),vn=[],Os=cn.length;Os--;)typeof(Vt=cn.shift())=="string"?vn.push(Vt):Array.isArray(Gt)&&(Vt.length===1||Vt[1]===void 0&&Vt[2]===void 0)?vn.push(Vt[0]):vn.push([Vt[0],Vt[1],Vt[2]]);return vn}function eo(Gt,Vt){var cn;if(typeof Gt=="string")cn=Vt(Gt)[0];else if(Array.isArray(Gt)){for(var vn,Os,oo=Gt.concat(),Ki=[],cl=oo.length;cl--;)typeof(vn=oo.shift())=="string"?Ki.push(Vt(vn)[0]):Array.isArray(vn)&&typeof vn[0]=="string"&&(Os=Vt(vn[0],vn[1],vn[2]),Ki.push([Os[0],Os[1],Os[2]]));cn=Ki}return cn}var _i=!1,to=!0;if(typeof w=="string")_i=!0;else if(Array.isArray(w)){var no=w.concat();ke=[];for(var Mi,Mn=no.length;Mn--;)(typeof(Mi=no.shift())!="string"||Array.isArray(Mi)&&typeof Mi[0]!="string")&&(to=!1);_i=to}if(_i===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var Di=Le/pn.internal.scaleFactor,Pi=Di*(Ir-1);switch(te.baseline){case"bottom":Y-=Pi;break;case"top":Y+=Di-Pi;break;case"hanging":Y+=Di-2*Pi;break;case"middle":Y+=Di/2-Pi}if((ht=te.maxWidth||0)>0&&(typeof w=="string"?w=pn.splitTextToSize(w,ht):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(Gt,Vt){return Gt.concat(pn.splitTextToSize(Vt,ht))},[]))),Be={text:w,x:L,y:Y,options:te,mutex:{pdfEscape:Kn,activeFontKey:yt,fonts:jt,activeFontSize:Le}},ft.publish("preProcessText",Be),w=Be.text,Je=(te=Be.options).angle,!(rn instanceof Ee)&&Je&&typeof Je=="number"){Je*=Math.PI/180,te.rotationDirection===0&&(Je=-Je),k===N.ADVANCED&&(Je=-Je);var Ri=Math.cos(Je),ro=Math.sin(Je);rn=new Ee(Ri,ro,-ro,Ri,0,0)}else Je&&Je instanceof Ee&&(rn=Je);k!==N.ADVANCED||rn||(rn=Fn),(pt=te.charSpace||Ti)!==void 0&&(En+=D(I(pt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(tn=te.horizontalScale)!==void 0&&(En+=D(100*tn)+` Tz
`),te.lang;var fr=-1,md=te.renderingMode!==void 0?te.renderingMode:te.stroke,so=pn.internal.getCurrentPageInfo().pageContext;switch(md){case 0:case!1:case"fill":fr=0;break;case 1:case!0:case"stroke":fr=1;break;case 2:case"fillThenStroke":fr=2;break;case 3:case"invisible":fr=3;break;case 4:case"fillAndAddForClipping":fr=4;break;case 5:case"strokeAndAddPathForClipping":fr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fr=6;break;case 7:case"addToPathForClipping":fr=7}var il=so.usedRenderingMode!==void 0?so.usedRenderingMode:-1;fr!==-1?En+=fr+` Tr
`:il!==-1&&(En+=`0 Tr
`),fr!==-1&&(so.usedRenderingMode=fr),nt=te.align||"left";var Pr,Hi=Le*Ir,Al=pn.internal.pageSize.getWidth(),ol=jt[yt];pt=te.charSpace||Ti,ht=te.maxWidth||0,Nt=Object.assign({autoencode:!0,noBOM:!0},te.flags);var la=[],Wa=function(Gt){return pn.getStringUnitWidth(Gt,{font:ol,charSpace:pt,fontSize:Le,doKerning:!1})*Le/Bs};if(Object.prototype.toString.call(w)==="[object Array]"){var hr;ke=ZA(w),nt!=="left"&&(Pr=ke.map(Wa));var nr,ca=0;if(nt==="right"){L-=Pr[0],w=[],Mn=ke.length;for(var Ps=0;Ps<Mn;Ps++)Ps===0?(nr=vs(L),hr=Ds(Y)):(nr=I(ca-Pr[Ps]),hr=-Hi),w.push([ke[Ps],nr,hr]),ca=Pr[Ps]}else if(nt==="center"){L-=Pr[0]/2,w=[],Mn=ke.length;for(var Rs=0;Rs<Mn;Rs++)Rs===0?(nr=vs(L),hr=Ds(Y)):(nr=I((ca-Pr[Rs])/2),hr=-Hi),w.push([ke[Rs],nr,hr]),ca=Pr[Rs]}else if(nt==="left"){w=[],Mn=ke.length;for(var Oi=0;Oi<Mn;Oi++)w.push(ke[Oi])}else if(nt==="justify"&&ol.encoding==="Identity-H"){w=[],Mn=ke.length,ht=ht!==0?ht:Al;for(var Hs=0,ln=0;ln<Mn;ln++)if(hr=ln===0?Ds(Y):-Hi,nr=ln===0?vs(L):Hs,ln<Mn-1){var ao=I((ht-Pr[ln])/(ke[ln].split(" ").length-1)),rr=ke[ln].split(" ");w.push([rr[0]+" ",nr,hr]),Hs=0;for(var Rr=1;Rr<rr.length;Rr++){var Gi=(Wa(rr[Rr-1]+" "+rr[Rr])-Wa(rr[Rr]))*Bs+ao;Rr==rr.length-1?w.push([rr[Rr],Gi,0]):w.push([rr[Rr]+" ",Gi,0]),Hs-=Gi}}else w.push([ke[ln],nr,hr]);w.push(["",Hs,0])}else{if(nt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],Mn=ke.length,ht=ht!==0?ht:Al,ln=0;ln<Mn;ln++)hr=ln===0?Ds(Y):-Hi,nr=ln===0?vs(L):0,ln<Mn-1?la.push(D(I((ht-Pr[ln])/(ke[ln].split(" ").length-1)))):la.push(0),w.push([ke[ln],nr,hr])}}var ll=typeof te.R2L=="boolean"?te.R2L:tt;ll===!0&&(w=eo(w,function(Gt,Vt,cn){return[Gt.split("").reverse().join(""),Vt,cn]})),Be={text:w,x:L,y:Y,options:te,mutex:{pdfEscape:Kn,activeFontKey:yt,fonts:jt,activeFontSize:Le}},ft.publish("postProcessText",Be),w=Be.text,rs=Be.mutex.isHex||!1;var io=jt[yt].encoding;io!=="WinAnsiEncoding"&&io!=="StandardEncoding"||(w=eo(w,function(Gt,Vt,cn){return[al(Gt),Vt,cn]})),ke=ZA(w),w=[];for(var Ya,$a,da,Xa=0,Vi=1,Za=Array.isArray(ke[0])?Vi:Xa,ua="",Ao=function(Gt,Vt,cn){var vn="";return cn instanceof Ee?(cn=typeof te.angle=="number"?Vn(cn,new Ee(1,0,0,1,Gt,Vt)):Vn(new Ee(1,0,0,1,Gt,Vt),cn),k===N.ADVANCED&&(cn=Vn(new Ee(1,0,0,-1,0,0),cn)),vn=cn.join(" ")+` Tm
`):vn=D(Gt)+" "+D(Vt)+` Td
`,vn},Hr=0;Hr<ke.length;Hr++){switch(ua="",Za){case Vi:da=(rs?"<":"(")+ke[Hr][0]+(rs?">":")"),Ya=parseFloat(ke[Hr][1]),$a=parseFloat(ke[Hr][2]);break;case Xa:da=(rs?"<":"(")+ke[Hr]+(rs?">":")"),Ya=vs(L),$a=Ds(Y)}la!==void 0&&la[Hr]!==void 0&&(ua=la[Hr]+` Tw
`),Hr===0?w.push(ua+Ao(Ya,$a,rn)+da):Za===Xa?w.push(ua+da):Za===Vi&&w.push(ua+Ao(Ya,$a,rn)+da)}w=Za===Xa?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Or=`BT
/`;return Or+=yt+" "+Le+` Tf
`,Or+=D(Le*Ir)+` TL
`,Or+=za+`
`,Or+=En,Or+=w,$(Or+="ET"),p[yt]=!0,pn};var ia=m.__private__.clip=m.clip=function(w){return $(w==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return ia("evenodd")},m.__private__.discardPath=m.discardPath=function(){return $("n"),this};var Dr=m.__private__.isValidStyle=function(w){var L=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(L=!0),L};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(w){return Dr(w)&&(c=w),this};var Ui=m.__private__.getStyle=m.getStyle=function(w){var L=c;switch(w){case"D":case"S":L="S";break;case"F":L="f";break;case"FD":case"DF":L="B";break;case"f":case"f*":case"B":case"B*":L=w}return L},qa=m.close=function(){return $("h"),this};m.stroke=function(){return $("S"),this},m.fill=function(w){return oe("f",w),this},m.fillEvenOdd=function(w){return oe("f*",w),this},m.fillStroke=function(w){return oe("B",w),this},m.fillStrokeEvenOdd=function(w){return oe("B*",w),this};var oe=function(w,L){_t(L)==="object"?_e(L,w):$(w)},ie=function(w){w===null||k===N.ADVANCED&&w===void 0||(w=Ui(w),$(w))};function ge(w,L,Y,te,he){var Be=new dA(L||this.boundingBox,Y||this.xStep,te||this.yStep,this.gState,he||this.matrix);Be.stream=this.stream;var ke=w+"$$"+this.cloneIndex+++"$$";return Ln(ke,Be),Be}var _e=function(w,L){var Y=br[w.key],te=St[Y];if(te instanceof ai)$("q"),$(Re(L)),te.gState&&m.setGState(te.gState),$(w.matrix.toString()+" cm"),$("/"+Y+" sh"),$("Q");else if(te instanceof dA){var he=new Ee(1,0,0,-1,0,oa());w.matrix&&(he=he.multiply(w.matrix||Fn),Y=ge.call(te,w.key,w.boundingBox,w.xStep,w.yStep,he).id),$("q"),$("/Pattern cs"),$("/"+Y+" scn"),te.gState&&m.setGState(te.gState),$(L),$("Q")}},Re=function(w){switch(w){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ye=m.moveTo=function(w,L){return $(D(I(w))+" "+D(V(L))+" m"),this},rt=m.lineTo=function(w,L){return $(D(I(w))+" "+D(V(L))+" l"),this},Pt=m.curveTo=function(w,L,Y,te,he,Be){return $([D(I(w)),D(V(L)),D(I(Y)),D(V(te)),D(I(he)),D(V(Be)),"c"].join(" ")),this};m.__private__.line=m.line=function(w,L,Y,te,he){if(isNaN(w)||isNaN(L)||isNaN(Y)||isNaN(te)||!Dr(he))throw new Error("Invalid arguments passed to jsPDF.line");return k===N.COMPAT?this.lines([[Y-w,te-L]],w,L,[1,1],he||"S"):this.lines([[Y-w,te-L]],w,L,[1,1]).stroke()},m.__private__.lines=m.lines=function(w,L,Y,te,he,Be){var ke,Je,nt,pt,ht,Nt,tn,rn,pn,qn,En,rs;if(typeof w=="number"&&(rs=Y,Y=L,L=w,w=rs),te=te||[1,1],Be=Be||!1,isNaN(L)||isNaN(Y)||!Array.isArray(w)||!Array.isArray(te)||!Dr(he)||typeof Be!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ye(L,Y),ke=te[0],Je=te[1],pt=w.length,qn=L,En=Y,nt=0;nt<pt;nt++)(ht=w[nt]).length===2?(qn=ht[0]*ke+qn,En=ht[1]*Je+En,rt(qn,En)):(Nt=ht[0]*ke+qn,tn=ht[1]*Je+En,rn=ht[2]*ke+qn,pn=ht[3]*Je+En,qn=ht[4]*ke+qn,En=ht[5]*Je+En,Pt(Nt,tn,rn,pn,qn,En));return Be&&qa(),ie(he),this},m.path=function(w){for(var L=0;L<w.length;L++){var Y=w[L],te=Y.c;switch(Y.op){case"m":Ye(te[0],te[1]);break;case"l":rt(te[0],te[1]);break;case"c":Pt.apply(this,te);break;case"h":qa()}}return this},m.__private__.rect=m.rect=function(w,L,Y,te,he){if(isNaN(w)||isNaN(L)||isNaN(Y)||isNaN(te)||!Dr(he))throw new Error("Invalid arguments passed to jsPDF.rect");return k===N.COMPAT&&(te=-te),$([D(I(w)),D(V(L)),D(I(Y)),D(I(te)),"re"].join(" ")),ie(he),this},m.__private__.triangle=m.triangle=function(w,L,Y,te,he,Be,ke){if(isNaN(w)||isNaN(L)||isNaN(Y)||isNaN(te)||isNaN(he)||isNaN(Be)||!Dr(ke))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Y-w,te-L],[he-Y,Be-te],[w-he,L-Be]],w,L,[1,1],ke,!0),this},m.__private__.roundedRect=m.roundedRect=function(w,L,Y,te,he,Be,ke){if(isNaN(w)||isNaN(L)||isNaN(Y)||isNaN(te)||isNaN(he)||isNaN(Be)||!Dr(ke))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Je=4/3*(Math.SQRT2-1);return he=Math.min(he,.5*Y),Be=Math.min(Be,.5*te),this.lines([[Y-2*he,0],[he*Je,0,he,Be-Be*Je,he,Be],[0,te-2*Be],[0,Be*Je,-he*Je,Be,-he,Be],[2*he-Y,0],[-he*Je,0,-he,-Be*Je,-he,-Be],[0,2*Be-te],[0,-Be*Je,he*Je,-Be,he,-Be]],w+he,L,[1,1],ke,!0),this},m.__private__.ellipse=m.ellipse=function(w,L,Y,te,he){if(isNaN(w)||isNaN(L)||isNaN(Y)||isNaN(te)||!Dr(he))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Be=4/3*(Math.SQRT2-1)*Y,ke=4/3*(Math.SQRT2-1)*te;return Ye(w+Y,L),Pt(w+Y,L-ke,w+Be,L-te,w,L-te),Pt(w-Be,L-te,w-Y,L-ke,w-Y,L),Pt(w-Y,L+ke,w-Be,L+te,w,L+te),Pt(w+Be,L+te,w+Y,L+ke,w+Y,L),ie(he),this},m.__private__.circle=m.circle=function(w,L,Y,te){if(isNaN(w)||isNaN(L)||isNaN(Y)||!Dr(te))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,L,Y,Y,te)},m.setFont=function(w,L,Y){return Y&&(L=M(L,Y)),yt=Fi(w,L,{disableWarning:!1}),this};var ys=m.__private__.getFont=m.getFont=function(){return jt[Fi.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var w,L,Y={};for(w in Ot)if(Ot.hasOwnProperty(w))for(L in Y[w]=[],Ot[w])Ot[w].hasOwnProperty(L)&&Y[w].push(L);return Y},m.addFont=function(w,L,Y,te,he){var Be=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Be.indexOf(arguments[3])!==-1?he=arguments[3]:arguments[3]&&Be.indexOf(arguments[3])==-1&&(Y=M(Y,te)),he=he||"Identity-H",Oa.call(this,w,L,Y,he)};var bs,KA=t.lineWidth||.200025,ji=m.__private__.getLineWidth=m.getLineWidth=function(){return KA},Zo=m.__private__.setLineWidth=m.setLineWidth=function(w){return KA=w,$(D(I(w))+" w"),this};m.__private__.setLineDash=it.API.setLineDash=it.API.setLineDashPattern=function(w,L){if(w=w||[],L=L||0,isNaN(L)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(Y){return D(I(Y))}).join(" "),L=D(I(L)),$("["+w+"] "+L+" d"),this};var el=m.__private__.getLineHeight=m.getLineHeight=function(){return Le*bs};m.__private__.getLineHeight=m.getLineHeight=function(){return Le*bs};var tl=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(bs=w),this},nl=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return bs};tl(t.lineHeight);var vs=m.__private__.getHorizontalCoordinate=function(w){return I(w)},Ds=m.__private__.getVerticalCoordinate=function(w){return k===N.ADVANCED?w:dt[z].mediaBox.topRightY-dt[z].mediaBox.bottomLeftY-I(w)},ud=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(w){return D(vs(w))},Aa=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(w){return D(Ds(w))},ns=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return dr(ns)},m.__private__.setStrokeColor=m.setDrawColor=function(w,L,Y,te){return ns=mn({ch1:w,ch2:L,ch3:Y,ch4:te,pdfColorType:"draw",precision:2}),$(ns),this};var qA=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return dr(qA)},m.__private__.setFillColor=m.setFillColor=function(w,L,Y,te){return qA=mn({ch1:w,ch2:L,ch3:Y,ch4:te,pdfColorType:"fill",precision:2}),$(qA),this};var za=t.textColor||"0 g",fd=m.__private__.getTextColor=m.getTextColor=function(){return dr(za)};m.__private__.setTextColor=m.setTextColor=function(w,L,Y,te){return za=mn({ch1:w,ch2:L,ch3:Y,ch4:te,pdfColorType:"text",precision:3}),this};var Ti=t.charSpace,hd=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Ti||0)};m.__private__.setCharSpace=m.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ti=w,this};var zA=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(w){var L=m.CapJoinStyles[w];if(L===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zA=L,$(L+" J"),this};var JA=0;m.__private__.setLineJoin=m.setLineJoin=function(w){var L=m.CapJoinStyles[w];if(L===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return JA=L,$(L+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return $(D(I(w))+" M"),this},m.GState=yc,m.setGState=function(w){(w=typeof w=="string"?Wt[or[w]]:rl(null,w)).equals(es)||($("/"+w.id+" gs"),es=w)};var rl=function(w,L){if(!w||!or[w]){var Y=!1;for(var te in Wt)if(Wt.hasOwnProperty(te)&&Wt[te].equals(L)){Y=!0;break}if(Y)L=Wt[te];else{var he="GS"+(Object.keys(Wt).length+1).toString(10);Wt[he]=L,L.id=he}return w&&(or[w]=L.id),ft.publish("addGState",L),L}};m.addGState=function(w,L){return rl(w,L),this},m.saveGraphicsState=function(){return $("q"),_r.push({key:yt,size:Le,color:za}),this},m.restoreGraphicsState=function(){$("Q");var w=_r.pop();return yt=w.key,Le=w.size,za=w.color,es=null,this},m.setCurrentTransformationMatrix=function(w){return $(w.toString()+" cm"),this},m.comment=function(w){return $("#"+w),this};var Qi=function(w,L){var Y=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Y},set:function(Be){isNaN(Be)||(Y=parseFloat(Be))}});var te=L||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return te},set:function(Be){isNaN(Be)||(te=parseFloat(Be))}});var he="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return he},set:function(Be){he=Be.toString()}}),this},WA=function(w,L,Y,te){Qi.call(this,w,L),this.type="rect";var he=Y||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return he},set:function(ke){isNaN(ke)||(he=parseFloat(ke))}});var Be=te||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Be},set:function(ke){isNaN(ke)||(Be=parseFloat(ke))}}),this},YA=function(){this.page=Yt,this.currentPage=z,this.pages=je.slice(0),this.pagesContext=dt.slice(0),this.x=An,this.y=Ct,this.matrix=yr,this.width=Ja(z),this.height=oa(z),this.outputDestination=De,this.id="",this.objectNumber=-1};YA.prototype.restore=function(){Yt=this.page,z=this.currentPage,dt=this.pagesContext,je=this.pages,An=this.x,Ct=this.y,yr=this.matrix,$A(z,this.width),XA(z,this.height),De=this.outputDestination};var sl=function(w,L,Y,te,he){lr.push(new YA),Yt=z=0,je=[],An=w,Ct=L,yr=he,Ga([Y,te])},gd=function(w){if(vr[w])lr.pop().restore();else{var L=new YA,Y="Xo"+(Object.keys(on).length+1).toString(10);L.id=Y,vr[w]=Y,on[Y]=L,ft.publish("addFormObject",L),lr.pop().restore()}};for(var Li in m.beginFormObject=function(w,L,Y,te,he){return sl(w,L,Y,te,he),this},m.endFormObject=function(w){return gd(w),this},m.doFormObject=function(w,L){var Y=on[vr[w]];return $("q"),$(L.toString()+" cm"),$("/"+Y.id+" Do"),$("Q"),this},m.getFormObject=function(w){var L=on[vr[w]];return{x:L.x,y:L.y,width:L.width,height:L.height,matrix:L.matrix}},m.save=function(w,L){return w=w||"generated.pdf",(L=L||{}).returnPromise=L.returnPromise||!1,L.returnPromise===!1?(ri(nn(ts()),w),typeof ri.unload=="function"&&lt.setTimeout&&setTimeout(ri.unload,911),this):new Promise(function(Y,te){try{var he=ri(nn(ts()),w);typeof ri.unload=="function"&&lt.setTimeout&&setTimeout(ri.unload,911),Y(he)}catch(Be){te(Be.message)}})},it.API)it.API.hasOwnProperty(Li)&&(Li==="events"&&it.API.events.length?function(w,L){var Y,te,he;for(he=L.length-1;he!==-1;he--)Y=L[he][0],te=L[he][1],w.subscribe.apply(w,[Y].concat(typeof te=="function"?[te]:te))}(ft,it.API.events):m[Li]=it.API[Li]);var Ja=m.getPageWidth=function(w){return(dt[w=w||z].mediaBox.topRightX-dt[w].mediaBox.bottomLeftX)/Ke},$A=m.setPageWidth=function(w,L){dt[w].mediaBox.topRightX=L*Ke+dt[w].mediaBox.bottomLeftX},oa=m.getPageHeight=function(w){return(dt[w=w||z].mediaBox.topRightY-dt[w].mediaBox.bottomLeftY)/Ke},XA=m.setPageHeight=function(w,L){dt[w].mediaBox.topRightY=L*Ke+dt[w].mediaBox.bottomLeftY};return m.internal={pdfEscape:Kn,getStyle:Ui,getFont:ys,getFontSize:Oe,getCharSpace:hd,getTextColor:fd,getLineHeight:el,getLineHeightFactor:nl,getLineWidth:ji,write:At,getHorizontalCoordinate:vs,getVerticalCoordinate:Ds,getCoordinateString:ud,getVerticalCoordinateString:Aa,collections:{},newObject:en,newAdditionalObject:ps,newObjectDeferred:$t,newObjectDeferredBegin:_n,getFilters:Mr,putStream:qt,events:ft,scaleFactor:Ke,pageSize:{getWidth:function(){return Ja(z)},setWidth:function(w){$A(z,w)},getHeight:function(){return oa(z)},setHeight:function(w){XA(z,w)}},encryptionOptions:d,encryption:bn,getEncryptor:ki,output:Nr,getNumberOfPages:HA,pages:je,out:$,f2:O,f3:F,getPageInfo:Ka,getPageInfoByObjId:ct,getCurrentPageInfo:ws,getPDFVersion:y,Point:Qi,Rectangle:WA,Matrix:Ee,hasHotfix:Sr},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Ja(z)},set:function(w){$A(z,w)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return oa(z)},set:function(w){XA(z,w)},enumerable:!0,configurable:!0}),PA.call(m,Ue),yt="F1",Si(a,n),ft.publish("initialized"),m}AA.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},AA.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},AA.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},AA.prototype.processOwnerPassword=function(t,e){return Cu(Bu(e).substr(0,5),t)},AA.prototype.encryptor=function(t,e){var n=Bu(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Cu(n,r)}},yc.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||_t(t)!==_t(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},it.API={events:[]},it.version="2.5.2";var an=it.API,vf=1,xi=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Yi=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},gt=function(t){return t.toFixed(2)},ba=function(t){return t.toFixed(5)};an.__acroform__={};var wr=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Th=function(t){return t*vf},Is=function(t){var e=new dp,n=Ze.internal.getHeight(t)||0,r=Ze.internal.getWidth(t)||0;return e.BBox=[0,0,Number(gt(r)),Number(gt(n))],e},_y=an.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},My=an.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},Dy=an.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},fn=an.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Dy(t,e-1)},hn=an.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return _y(t,e-1)},gn=an.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return My(t,e-1)},Py=an.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,a=t[0],i=t[1],A=t[2],o=t[3],l={};return l.lowerLeft_X=n(a)||0,l.lowerLeft_Y=r(i+o)||0,l.upperRight_X=n(a+A)||0,l.upperRight_Y=r(i)||0,[Number(gt(l.lowerLeft_X)),Number(gt(l.lowerLeft_Y)),Number(gt(l.upperRight_X)),Number(gt(l.upperRight_Y))]},Ry=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=Nu(t,n),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+gt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Is(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},Nu=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(F){return F.split(`
`)}):a.map(function(F){return[F]});var i=n,A=Ze.internal.getHeight(t)||0;A=A<0?-A:A;var o=Ze.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(F,I,P){if(F+1<a.length){var V=I+" "+a[F+1][0];return Ul(V,t,P).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var c,d,h=Ul("3",t,i).height,p=t.multiline?A-i:(A-h)/2,m=p+=2,B=0,y=0,b=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Ul(e,t,i=12).width+", FieldWidth:"+o+`
`;break}for(var C="",N=0,k=0;k<a.length;k++)if(a.hasOwnProperty(k)){var E=!1;if(a[k].length!==1&&b!==a[k].length-1){if((h+2)*(N+2)+2>A)continue e;C+=a[k][b],E=!0,y=k,k--}else{C=(C+=a[k][b]+" ").substr(C.length-1)==" "?C.substr(0,C.length-1):C;var _=parseInt(k),M=l(_,C,i),D=k>=a.length-1;if(M&&!D){C+=" ",b=0;continue}if(M||D){if(D)y=_;else if(t.multiline&&(h+2)*(N+2)+2>A)continue e}else{if(!t.multiline||(h+2)*(N+2)+2>A)continue e;y=_}}for(var U="",j=B;j<=y;j++){var O=a[j];if(t.multiline){if(j===y){U+=O[b]+" ",b=(b+1)%O.length;continue}if(j===B){U+=O[O.length-1]+" ";continue}}U+=O[0]+" "}switch(U=U.substr(U.length-1)==" "?U.substr(0,U.length-1):U,d=Ul(U,t,i).width,t.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;case"left":default:c=2}e+=gt(c)+" "+gt(m)+` Td
`,e+="("+xi(U)+`) Tj
`,e+=-gt(c)+` 0 Td
`,m=-(i+2),d=0,B=E?y:y+1,N++,C=""}break}return r.text=e,r.fontSize=i,r},Ul=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},Hy={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Oy=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},Gy=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=n,a=t[n];e.internal.newObjectDeferredBegin(a.objId,!0),_t(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete t[r]}},Vy=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(us.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Hy)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vf=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new up,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in r)if(r.hasOwnProperty(a)){var i=r[a];i.objId=void 0,i.hasAnnotation&&Oy(i,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,a){var i=!r;for(var A in r||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(A)){var o=r[A],l=[],c=o.Rect;if(o.Rect&&(o.Rect=Py(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Ze.createDefaultAppearanceStream(o),_t(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=Ry(o);l.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var m=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var A in m)if(m.hasOwnProperty(A)){var B=m[A];typeof B=="function"&&(B=B.call(a,o)),h+="/"+A+" "+B+" ",a.internal.acroformPlugin.xForms.indexOf(B)>=0||a.internal.acroformPlugin.xForms.push(B)}}else typeof(B=m)=="function"&&(B=B.call(a,o)),h+="/"+A+" "+B,a.internal.acroformPlugin.xForms.indexOf(B)>=0||a.internal.acroformPlugin.xForms.push(B);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&Gy(a.internal.acroformPlugin.xForms,a)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},cp=an.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(A){return A};if(Array.isArray(t)){for(var a="[",i=0;i<t.length;i++)switch(i!==0&&(a+=" "),_t(t[i])){case"boolean":case"number":case"object":a+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),a+="("+xi(r(t[i].toString()))+")"):a+=t[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Gd=function(t,e,n){var r=function(a){return a};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),t="("+xi(r(t))+")"},Fs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Fs.prototype.toString=function(){return this.objId+" 0 R"},Fs.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Fs.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],a=this[r];a&&(Array.isArray(a)?t.push({key:r,value:cp(a,this.objId,this.scope)}):a instanceof Fs?(a.scope=this.scope,t.push({key:r,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:r,value:a}))}return t};var dp=function(){Fs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};wr(dp,Fs);var up=function(){Fs.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+xi(n(t))+")"}},set:function(n){t=n}})};wr(up,Fs);var us=function t(){Fs.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute F supplied.');e=C}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fn(e,3)},set:function(C){C?this.F=hn(e,3):this.F=gn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute Ff supplied.');n=C}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(C){r=C!==void 0?C:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(C){r[0]=C}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(C){r[1]=C}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(C){r[2]=C}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(C){r[3]=C}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(C){switch(C){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=C;break;default:throw new Error('Invalid value "'+C+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof bc)return;i="FieldObject"+t.FieldNum++}var C=function(N){return N};return this.scope&&(C=this.scope.internal.getEncryptor(this.objId)),"("+xi(C(i))+")"},set:function(C){i=C.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(C){i=C}});var A="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return A},set:function(C){A=C}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(C){o=C}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(C){l=C}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/vf:c},set:function(C){c=C}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(C){d=C}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof bc||this instanceof oi))return Gd(h,this.objId,this.scope)},set:function(C){C=C.toString(),h=C}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Tn?p:Gd(p,this.objId,this.scope)},set:function(C){C=C.toString(),p=this instanceof Tn?C:C.substr(0,1)==="("?Yi(C.substr(1,C.length-2)):Yi(C)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Tn?Yi(p.substr(1,p.length-1)):p},set:function(C){C=C.toString(),p=this instanceof Tn?"/"+C:C}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(C){this.V=C}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Tn?m:Gd(m,this.objId,this.scope)},set:function(C){C=C.toString(),m=this instanceof Tn?C:C.substr(0,1)==="("?Yi(C.substr(1,C.length-2)):Yi(C)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Tn?Yi(m.substr(1,m.length-1)):m},set:function(C){C=C.toString(),m=this instanceof Tn?"/"+C:C}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var B,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(C){C=!!C,y=C}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(B)return B},set:function(C){B=C}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,1)},set:function(C){C?this.Ff=hn(this.Ff,1):this.Ff=gn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,2)},set:function(C){C?this.Ff=hn(this.Ff,2):this.Ff=gn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,3)},set:function(C){C?this.Ff=hn(this.Ff,3):this.Ff=gn(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(C){if([0,1,2].indexOf(C)===-1)throw new Error('Invalid value "'+C+'" for attribute Q supplied.');b=C}}),Object.defineProperty(this,"textAlign",{get:function(){var C;switch(b){case 0:default:C="left";break;case 1:C="center";break;case 2:C="right"}return C},configurable:!0,enumerable:!0,set:function(C){switch(C){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};wr(us,Fs);var gA=function(){us.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return cp(e,this.objId,this.scope)},set:function(n){var r,a;a=[],typeof(r=n)=="string"&&(a=function(i,A,o){o||(o=1);for(var l,c=[];l=A.exec(i);)c.push(l[o]);return c}(r,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,18)},set:function(n){n?this.Ff=hn(this.Ff,18):this.Ff=gn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=hn(this.Ff,19):this.Ff=gn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,20)},set:function(n){n?(this.Ff=hn(this.Ff,20),e.sort()):this.Ff=gn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,22)},set:function(n){n?this.Ff=hn(this.Ff,22):this.Ff=gn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(n){n?this.Ff=hn(this.Ff,23):this.Ff=gn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,27)},set:function(n){n?this.Ff=hn(this.Ff,27):this.Ff=gn(this.Ff,27)}}),this.hasAppearanceStream=!1};wr(gA,us);var mA=function(){gA.call(this),this.fontName="helvetica",this.combo=!1};wr(mA,gA);var pA=function(){mA.call(this),this.combo=!0};wr(pA,mA);var lc=function(){pA.call(this),this.edit=!0};wr(lc,pA);var Tn=function(){us.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,15)},set:function(n){n?this.Ff=hn(this.Ff,15):this.Ff=gn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,16)},set:function(n){n?this.Ff=hn(this.Ff,16):this.Ff=gn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,17)},set:function(n){n?this.Ff=hn(this.Ff,17):this.Ff=gn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(n){n?this.Ff=hn(this.Ff,26):this.Ff=gn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,a=[];for(r in a.push("<<"),e)a.push("/"+r+" ("+xi(n(e[r]))+")");return a.push(">>"),a.join(`
`)}},set:function(n){_t(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};wr(Tn,us);var cc=function(){Tn.call(this),this.pushButton=!0};wr(cc,Tn);var xA=function(){Tn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};wr(xA,Tn);var bc=function(){var t,e;us.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,A=[];for(i in A.push("<<"),r)A.push("/"+i+" ("+xi(a(r[i]))+")");return A.push(">>"),A.join(`
`)},set:function(a){_t(a)==="object"&&(r=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(a){typeof a=="string"&&(r.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(a){n=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(a){n="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ze.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};wr(bc,us),xA.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},xA.prototype.createOption=function(t){var e=new bc;return e.Parent=this,e.optionName=t,this.Kids.push(e),Ky.call(this.scope,e),e};var dc=function(){Tn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ze.CheckBox.createAppearanceStream()};wr(dc,Tn);var oi=function(){us.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,13)},set:function(e){e?this.Ff=hn(this.Ff,13):this.Ff=gn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,21)},set:function(e){e?this.Ff=hn(this.Ff,21):this.Ff=gn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(e){e?this.Ff=hn(this.Ff,23):this.Ff=gn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,24)},set:function(e){e?this.Ff=hn(this.Ff,24):this.Ff=gn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,25)},set:function(e){e?this.Ff=hn(this.Ff,25):this.Ff=gn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(e){e?this.Ff=hn(this.Ff,26):this.Ff=gn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};wr(oi,us);var uc=function(){oi.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,14)},set:function(t){t?this.Ff=hn(this.Ff,14):this.Ff=gn(this.Ff,14)}}),this.password=!0};wr(uc,oi);var Ze={CheckBox:{createAppearanceStream:function(){return{N:{On:Ze.CheckBox.YesNormal},D:{On:Ze.CheckBox.YesPushDown,Off:Ze.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),i=Nu(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+gt(Ze.internal.getWidth(t))+" "+gt(Ze.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+gt(i.fontSize)+" Tf "+a),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Is(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),a=[],i=Ze.internal.getHeight(t),A=Ze.internal.getWidth(t),o=Nu(t,t.caption);return a.push("1 g"),a.push("0 0 "+gt(A)+" "+gt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+gt(A-1)+" "+gt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+gt(o.fontSize)+" Tf "+r),a.push(o.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gt(Ze.internal.getWidth(t))+" "+gt(Ze.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Ze.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Ze.RadioButton.Circle.YesNormal,e.D[t]=Ze.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Is(t);e.scope=t.scope;var n=[],r=Ze.internal.getWidth(t)<=Ze.internal.getHeight(t)?Ze.internal.getWidth(t)/4:Ze.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Ze.internal.Bezier_C,i=Number((r*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+ba(Ze.internal.getWidth(t)/2)+" "+ba(Ze.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=[],r=Ze.internal.getWidth(t)<=Ze.internal.getHeight(t)?Ze.internal.getWidth(t)/4:Ze.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*Ze.internal.Bezier_C).toFixed(5)),A=Number((r*Ze.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+ba(Ze.internal.getWidth(t)/2)+" "+ba(Ze.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+ba(Ze.internal.getWidth(t)/2)+" "+ba(Ze.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+A+" "+A+" "+r+" 0 "+r+" c"),n.push("-"+A+" "+r+" -"+r+" "+A+" -"+r+" 0 c"),n.push("-"+r+" -"+A+" -"+A+" -"+r+" 0 -"+r+" c"),n.push(A+" -"+r+" "+r+" -"+A+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=[],r=Ze.internal.getWidth(t)<=Ze.internal.getHeight(t)?Ze.internal.getWidth(t)/4:Ze.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*Ze.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+ba(Ze.internal.getWidth(t)/2)+" "+ba(Ze.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Ze.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Ze.RadioButton.Cross.YesNormal,e.D[t]=Ze.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Is(t);e.scope=t.scope;var n=[],r=Ze.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+gt(Ze.internal.getWidth(t)-2)+" "+gt(Ze.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(gt(r.x1.x)+" "+gt(r.x1.y)+" m"),n.push(gt(r.x2.x)+" "+gt(r.x2.y)+" l"),n.push(gt(r.x4.x)+" "+gt(r.x4.y)+" m"),n.push(gt(r.x3.x)+" "+gt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=Ze.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+gt(Ze.internal.getWidth(t))+" "+gt(Ze.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+gt(Ze.internal.getWidth(t)-2)+" "+gt(Ze.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(gt(n.x1.x)+" "+gt(n.x1.y)+" m"),r.push(gt(n.x2.x)+" "+gt(n.x2.y)+" l"),r.push(gt(n.x4.x)+" "+gt(n.x4.y)+" m"),r.push(gt(n.x3.x)+" "+gt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Is(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gt(Ze.internal.getWidth(t))+" "+gt(Ze.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Ze.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Ze.internal.getWidth(t),n=Ze.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Ze.internal.getWidth=function(t){var e=0;return _t(t)==="object"&&(e=Th(t.Rect[2])),e},Ze.internal.getHeight=function(t){var e=0;return _t(t)==="object"&&(e=Th(t.Rect[3])),e};var Ky=an.addField=function(t){if(Vy(this,t),!(t instanceof us))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};an.AcroFormChoiceField=gA,an.AcroFormListBox=mA,an.AcroFormComboBox=pA,an.AcroFormEditBox=lc,an.AcroFormButton=Tn,an.AcroFormPushButton=cc,an.AcroFormRadioButton=xA,an.AcroFormCheckBox=dc,an.AcroFormTextField=oi,an.AcroFormPasswordField=uc,an.AcroFormAppearance=Ze,an.AcroForm={ChoiceField:gA,ListBox:mA,ComboBox:pA,EditBox:lc,Button:Tn,PushButton:cc,RadioButton:xA,CheckBox:dc,TextField:oi,PasswordField:uc,Appearance:Ze},it.AcroForm={ChoiceField:gA,ListBox:mA,ComboBox:pA,EditBox:lc,Button:Tn,PushButton:cc,RadioButton:xA,CheckBox:dc,TextField:oi,PasswordField:uc,Appearance:Ze};it.AcroForm;function fp(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(F,I){var P,V,ee,X,le,ae=e;if((I=I||e)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(M(F))for(le in n)for(ee=n[le],P=0;P<ee.length;P+=1){for(X=!0,V=0;V<ee[P].length;V+=1)if(ee[P][V]!==void 0&&ee[P][V]!==F[V]){X=!1;break}if(X===!0){ae=le;break}}else for(le in n)for(ee=n[le],P=0;P<ee.length;P+=1){for(X=!0,V=0;V<ee[P].length;V+=1)if(ee[P][V]!==void 0&&ee[P][V]!==F.charCodeAt(V)){X=!1;break}if(X===!0){ae=le;break}}return ae===e&&I!==e&&(ae=I),ae},a=function F(I){for(var P=this.internal.write,V=this.internal.putStream,ee=(0,this.internal.getFilters)();ee.indexOf("FlateEncode")!==-1;)ee.splice(ee.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:I.width}),X.push({key:"Height",value:I.height}),I.colorSpace===b.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===b.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)){for(var le="",ae=0,de=I.transparency.length;ae<de;ae++)le+=I.transparency[ae]+" "+I.transparency[ae]+" ";X.push({key:"Mask",value:"["+le+"]"})}I.sMask!==void 0&&X.push({key:"SMask",value:I.objectId+1+" 0 R"});var ue=I.filter!==void 0?["/"+I.filter]:void 0;if(V({data:I.data,additionalKeyValues:X,alreadyAppliedFilters:ue,objectId:I.objectId}),P("endobj"),"sMask"in I&&I.sMask!==void 0){var Ce="/Predictor "+I.predictor+" /Colors 1 /BitsPerComponent "+I.bitsPerComponent+" /Columns "+I.width,Q={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:I.bitsPerComponent,decodeParameters:Ce,data:I.sMask};"filter"in I&&(Q.filter=I.filter),F.call(this,Q)}if(I.colorSpace===b.INDEXED){var z=this.internal.newObject();V({data:U(new Uint8Array(I.palette)),objectId:z}),P("endobj")}},i=function(){var F=this.internal.collections.addImage_images;for(var I in F)a.call(this,F[I])},A=function(){var F,I=this.internal.collections.addImage_images,P=this.internal.write;for(var V in I)P("/I"+(F=I[V]).index,F.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",A))},l=function(){var F=this.internal.collections.addImage_images;return o.call(this),F},c=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(F){return typeof t["process"+F.toUpperCase()]=="function"},h=function(F){return _t(F)==="object"&&F.nodeType===1},p=function(F,I){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var P=""+F.getAttribute("src");if(P.indexOf("data:image/")===0)return Qo(unescape(P).split("base64,").pop());var V=t.loadFile(P,!0);if(V!==void 0)return V}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var ee;switch(I){case"PNG":ee="image/png";break;case"WEBP":ee="image/webp";break;case"JPEG":case"JPG":default:ee="image/jpeg"}return Qo(F.toDataURL(ee,1).split("base64,").pop())}},m=function(F){var I=this.internal.collections.addImage_images;if(I){for(var P in I)if(F===I[P].alias)return I[P]}},B=function(F,I,P){return F||I||(F=-96,I=-96),F<0&&(F=-1*P.width*72/F/this.internal.scaleFactor),I<0&&(I=-1*P.height*72/I/this.internal.scaleFactor),F===0&&(F=I*P.width/P.height),I===0&&(I=F*P.height/P.width),[F,I]},y=function(F,I,P,V,ee,X){var le=B.call(this,P,V,ee),ae=this.internal.getCoordinateString,de=this.internal.getVerticalCoordinateString,ue=l.call(this);if(P=le[0],V=le[1],ue[ee.index]=ee,X){X*=Math.PI/180;var Ce=Math.cos(X),Q=Math.sin(X),z=function(Z){return Z.toFixed(4)},W=[z(Ce),z(Q),z(-1*Q),z(Ce),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,ae(F),de(I+V),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([ae(P),"0","0",ae(V),"0","0","cm"].join(" "))):this.internal.write([ae(P),"0","0",ae(V),ae(F),de(I+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ee.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(F){var I,P,V=0;if(typeof F=="string")for(P=F.length,I=0;I<P;I++)V=(V<<5)-V+F.charCodeAt(I),V|=0;else if(M(F))for(P=F.byteLength/2,I=0;I<P;I++)V=(V<<5)-V+F[I],V|=0;return V},k=t.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var I=!0;return F.length===0&&(I=!1),F.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(I=!1),I},E=t.__addimage__.extractImageFromDataUrl=function(F){var I=(F=F||"").split("base64,"),P=null;if(I.length===2){var V=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(I[0]);Array.isArray(V)&&(P={mimeType:V[1],charset:V[2],data:I[1]})}return P},_=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(F){return _()&&F instanceof ArrayBuffer};var M=t.__addimage__.isArrayBufferView=function(F){return _()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},D=t.__addimage__.binaryStringToUint8Array=function(F){for(var I=F.length,P=new Uint8Array(I),V=0;V<I;V++)P[V]=F.charCodeAt(V);return P},U=t.__addimage__.arrayBufferToBinaryString=function(F){for(var I="",P=M(F)?F:new Uint8Array(F),V=0;V<P.length;V+=8192)I+=String.fromCharCode.apply(null,P.subarray(V,V+8192));return I};t.addImage=function(){var F,I,P,V,ee,X,le,ae,de;if(typeof arguments[1]=="number"?(I=e,P=arguments[1],V=arguments[2],ee=arguments[3],X=arguments[4],le=arguments[5],ae=arguments[6],de=arguments[7]):(I=arguments[1],P=arguments[2],V=arguments[3],ee=arguments[4],X=arguments[5],le=arguments[6],ae=arguments[7],de=arguments[8]),_t(F=arguments[0])==="object"&&!h(F)&&"imageData"in F){var ue=F;F=ue.imageData,I=ue.format||I||e,P=ue.x||P||0,V=ue.y||V||0,ee=ue.w||ue.width||ee,X=ue.h||ue.height||X,le=ue.alias||le,ae=ue.compression||ae,de=ue.rotation||ue.angle||de}var Ce=this.internal.getFilters();if(ae===void 0&&Ce.indexOf("FlateEncode")!==-1&&(ae="SLOW"),isNaN(P)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var Q=j.call(this,F,I,le,ae);return y.call(this,P,V,ee,X,Q,de),this};var j=function(F,I,P,V){var ee,X,le;if(typeof F=="string"&&r(F)===e){F=unescape(F);var ae=O(F,!1);(ae!==""||(ae=t.loadFile(F,!0))!==void 0)&&(F=ae)}if(h(F)&&(F=p(F,I)),I=r(F,I),!d(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((le=P)==null||le.length===0)&&(P=function(de){return typeof de=="string"||M(de)?N(de):M(de.data)?N(de.data):null}(F)),(ee=m.call(this,P))||(_()&&(F instanceof Uint8Array||I==="RGBA"||(X=F,F=D(F))),ee=this["process"+I.toUpperCase()](F,c.call(this),P,function(de){return de&&typeof de=="string"&&(de=de.toUpperCase()),de in t.image_compression?de:C.NONE}(V),X)),!ee)throw new Error("An unknown error occurred whilst processing the image.");return ee},O=t.__addimage__.convertBase64ToBinaryString=function(F,I){var P;I=typeof I!="boolean"||I;var V,ee="";if(typeof F=="string"){V=(P=E(F))!==null?P.data:F;try{ee=Qo(V)}catch(X){if(I)throw k(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ee};t.getImageProperties=function(F){var I,P,V="";if(h(F)&&(F=p(F)),typeof F=="string"&&r(F)===e&&((V=O(F,!1))===""&&(V=t.loadFile(F)||""),F=V),P=r(F),!d(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(!_()||F instanceof Uint8Array||(F=D(F)),!(I=this["process"+P.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=P,I}})(it.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};it.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,a,i,A=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,d=!1,h=0;h<c.length&&!d;h++)switch((r=c[h]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){r=c[p];var m=this.internal.pdfEscape,B=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),C=this.internal.getEncryptor(y.objId),N=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+A(r.bounds.x)+" "+o(r.bounds.y+r.bounds.h)+" "+A(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y)+"] ")+"/Contents ("+m(C(r.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+m(C(N))+") >>",y.content=i;var k=y.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+A(r.bounds.x+30)+" "+o(r.bounds.y+r.bounds.h)+" "+A(r.bounds.x+r.bounds.w+30)+" "+o(r.bounds.y)+"] ")+" /Parent "+k,r.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(y.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+A(r.bounds.x)+" "+o(r.bounds.y)+" "+A(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y+r.bounds.h)+"] ";var E=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+m(B(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var _=this.annotations._nameMap[r.options.name];r.options.pageNumber=_.page,r.options.top=_.y}else r.options.top||(r.options.top=0);if(a="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+m(B(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var M=o(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+M+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,a,i,A){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(n),y:c(r),w:l(n+a),h:c(r+i)},options:A,type:"link"})},t.textWithLink=function(n,r,a,i){var A,o,l=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var d=this.splitTextToSize(n,o).length;A=Math.ceil(c*d)}else o=l,A=c;return this.text(n,r,a,i),a+=.2*c,i.align==="center"&&(r-=l/2),i.align==="right"&&(r-=l),this.link(r,a-c,o,A,i),l},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(it.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},A=t.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},o=t.__arabicParser__.isArabicEndLetter=function(y){return A(y)&&i(y)&&e[y.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(y){return A(y)&&a.indexOf(y.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return A(y)&&i(y)&&e[y.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(y){return A(y)&&i(y)&&e[y.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(y){return A(y)&&i(y)&&e[y.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(y){return A(y)&&i(y)&&e[y.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(y){var b=0,C=n,N="",k=0;for(b=0;b<y.length;b+=1)C[y.charCodeAt(b)]!==void 0?(k++,typeof(C=C[y.charCodeAt(b)])=="number"&&(N+=String.fromCharCode(C),C=n,k=0),b===y.length-1&&(C=n,N+=y.charAt(b-(k-1)),b-=k-1,k=0)):(C=n,N+=y.charAt(b-k),b-=k,k=0);return N};t.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&r[y.charCodeAt(0)]!==void 0};var p=t.__arabicParser__.getCorrectForm=function(y,b,C){return A(y)?i(y)===!1?-1:!c(y)||!A(b)&&!A(C)||!A(C)&&o(b)||o(y)&&!A(b)||o(y)&&l(b)||o(y)&&o(b)?0:d(y)&&A(b)&&!o(b)&&A(C)&&c(C)?3:o(y)||!A(C)?1:2:-1},m=function(y){var b=0,C=0,N=0,k="",E="",_="",M=(y=y||"").split("\\s+"),D=[];for(b=0;b<M.length;b+=1){for(D.push(""),C=0;C<M[b].length;C+=1)k=M[b][C],E=M[b][C-1],_=M[b][C+1],A(k)?(N=p(k,E,_),D[b]+=N!==-1?String.fromCharCode(e[k.charCodeAt(0)][N]):k):D[b]+=k;D[b]=h(D[b])}return D.join(" ")},B=t.__arabicParser__.processArabic=t.processArabic=function(){var y,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,C=[];if(Array.isArray(b)){var N=0;for(C=[],N=0;N<b.length;N+=1)Array.isArray(b[N])?C.push([m(b[N][0]),b[N][1],b[N][2]]):C.push([m(b[N])]);y=C}else y=m(b);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};t.events.push(["preProcessText",B])}(it.API),it.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var A={};Object.defineProperty(this,"style",{get:function(){return A},set:function(o){A=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var a;if((n=n||"2d")!=="2d")return null;for(a in r)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=r[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(it.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(y){l=y}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(y){d=y}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var B=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return B},set:function(y){B=y}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return r.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){r.call(this);var d=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,m=0,B=0,y=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var C=c.maxWidth;C>0?typeof l=="string"?l=this.splitTextToSize(l,C):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(k,E){return k.concat(b.splitTextToSize(E,C))},[])):l=Array.isArray(l)?l:[l];for(var N=0;N<l.length;N++)m<(y=this.getStringUnitWidth(l[N],{font:h})*d)&&(m=y);return m!==0&&(B=l.length),{w:m/=p,h:Math.max((B*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var A=t.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var c=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,m&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,n===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-d,l.y+d,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+d,{align:"center",baseline:"top",maxWidth:l.width-d-d}):this.text(l.text,l.x+d,l.y+d,{align:"left",baseline:"top",maxWidth:l.width-d-d})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,d,h,p){if(r.call(this),!d)throw new Error("No data for PDF table.");var m,B,y,b,C=[],N=[],k=[],E={},_={},M=[],D=[],U=(p=p||{}).autoSize||!1,j=p.printHeaders!==!1,O=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,F=p.margins||Object.assign({width:this.getPageWidth()},e),I=typeof p.padding=="number"?p.padding:3,P=p.headerBackgroundColor||"#c8c8c8",V=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=V,this.setFontSize(O),h==null)N=C=Object.keys(d[0]),k=C.map(function(){return"left"});else if(Array.isArray(h)&&_t(h[0])==="object")for(C=h.map(function(ue){return ue.name}),N=h.map(function(ue){return ue.prompt||ue.name||""}),k=h.map(function(ue){return ue.align||"left"}),m=0;m<h.length;m+=1)_[h[m].name]=h[m].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(N=C=h,k=C.map(function(){return"left"}));if(U||Array.isArray(h)&&typeof h[0]=="string")for(m=0;m<C.length;m+=1){for(E[b=C[m]]=d.map(function(ue){return ue[b]}),this.setFont(void 0,"bold"),M.push(this.getTextDimensions(N[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),B=E[b],this.setFont(void 0,"normal"),y=0;y<B.length;y+=1)M.push(this.getTextDimensions(B[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[b]=Math.max.apply(null,M)+I+I,M=[]}if(j){var ee={};for(m=0;m<C.length;m+=1)ee[C[m]]={},ee[C[m]].text=N[m],ee[C[m]].align=k[m];var X=o.call(this,ee,_);D=C.map(function(ue){return new i(l,c,_[ue],X,ee[ue].text,void 0,ee[ue].align)}),this.setTableHeaderRow(D),this.printHeaderRow(1,!1)}var le=h.reduce(function(ue,Ce){return ue[Ce.name]=Ce.align,ue},{});for(m=0;m<d.length;m+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:m,data:d[m]},this);var ae=o.call(this,d[m],_);for(y=0;y<C.length;y+=1){var de=d[m][C[y]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:m,col:y,data:de},this),A.call(this,new i(l,c,_[C[y]],ae,de,m+2,le[C[y]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(m){var B=l[m];return this.splitTextToSize(B.hasOwnProperty("text")?B.text:B,c[m]-d-d)},this).map(function(m){return this.getLineHeightFactor()*m.length*h/p+d+d},this).reduce(function(m,B){return Math.max(m,B)},0)};t.setTableHeaderRow=function(l){r.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){d=this.internal.__cell__.tableHeaderRow[m].clone(),c&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=l;var B=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),A.call(this,d),this.setTextColor(B)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),n=!1}}(it.API);var hp={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gp=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Su=fp(gp),mp=[100,200,300,400,500,600,700,800,900],qy=fp(mp);function Iu(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return hp[i=i||"normal"]?i:"normal"}(t.style),r=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(t.weight),a=function(i){return typeof Su[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,n,r].join(" ")}}}function Qh(t,e,n,r){var a;for(a=n;a>=0&&a<e.length;a+=r)if(t[e[a]])return t[e[a]];for(a=n;a>=0&&a<e.length;a-=r)if(t[e[a]])return t[e[a]]}var zy={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Lh={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function _h(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Jy(t,e,n){for(var r=(n=n||{}).defaultFontFamily||"times",a=Object.assign({},zy,n.genericFontFamilies||{}),i=null,A=null,o=0;o<e.length;++o)if(a[(i=Iu(e[o])).family]&&(i.family=a[i.family]),t.hasOwnProperty(i.family)){A=t[i.family];break}if(!(A=A||t[r]))throw new Error("Could not find a font-family for the rule '"+_h(i)+"' and default family '"+r+"'.");if(A=function(l,c){if(c[l])return c[l];var d=Su[l],h=d<=Su.normal?-1:1,p=Qh(c,gp,d,h);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(i.stretch,A),A=function(l,c){if(c[l])return c[l];for(var d=hp[l],h=0;h<d.length;++h)if(c[d[h]])return c[d[h]];throw new Error("Could not find a matching font-style for "+l)}(i.style,A),!(A=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var d=qy[l],h=Qh(c,mp,d,l<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+l);return h}(i.weight,A)))throw new Error("Failed to resolve a font for the rule '"+_h(i)+"'.");return A}function Mh(t){return t.trimLeft()}function Wy(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function Yy(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var jl,Dh,Ph,Vd=["times"];(function(t){var e,n,r,a,i,A,o,l,c,d=function(Q){return Q=Q||{},this.isStrokeTransparent=Q.isStrokeTransparent||!1,this.strokeOpacity=Q.strokeOpacity||1,this.strokeStyle=Q.strokeStyle||"#000000",this.fillStyle=Q.fillStyle||"#000000",this.isFillTransparent=Q.isFillTransparent||!1,this.fillOpacity=Q.fillOpacity||1,this.font=Q.font||"10px sans-serif",this.textBaseline=Q.textBaseline||"alphabetic",this.textAlign=Q.textAlign||"left",this.lineWidth=Q.lineWidth||1,this.lineJoin=Q.lineJoin||"miter",this.lineCap=Q.lineCap||"butt",this.path=Q.path||[],this.transform=Q.transform!==void 0?Q.transform.clone():new l,this.globalCompositeOperation=Q.globalCompositeOperation||"normal",this.globalAlpha=Q.globalAlpha||1,this.clip_path=Q.clip_path||[],this.currentPoint=Q.currentPoint||new A,this.miterLimit=Q.miterLimit||10,this.lastPoint=Q.lastPoint||new A,this.lineDashOffset=Q.lineDashOffset||0,this.lineDash=Q.lineDash||[],this.margin=Q.margin||[0,0,0,0],this.prevPageLastElemOffset=Q.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Q.ignoreClearRect!="boolean"||Q.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,A=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new d}]);var h=function(Q){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=Q;Object.defineProperty(this,"pdf",{get:function(){return z}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(ve){W=!!ve}});var Z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Z},set:function(ve){Z=!!ve}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(ve){isNaN(ve)||(ne=ve)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(ve){isNaN(ve)||(fe=ve)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(ve){var $;typeof ve=="number"?$=[ve,ve,ve,ve]:(($=new Array(4))[0]=ve[0],$[1]=ve.length>=2?ve[1]:$[0],$[2]=ve.length>=3?ve[2]:$[0],$[3]=ve.length>=4?ve[3]:$[1]),c.margin=$}});var xe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return xe},set:function(ve){xe=ve}});var we=0;Object.defineProperty(this,"lastBreak",{get:function(){return we},set:function(ve){we=ve}});var Qe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Qe},set:function(ve){Qe=ve}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(ve){ve instanceof d&&(c=ve)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(ve){c.path=ve}});var je=[];Object.defineProperty(this,"ctxStack",{get:function(){return je},set:function(ve){je=ve}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ve){var $;$=p(ve),this.ctx.fillStyle=$.style,this.ctx.isFillTransparent=$.a===0,this.ctx.fillOpacity=$.a,this.pdf.setFillColor($.r,$.g,$.b,{a:$.a}),this.pdf.setTextColor($.r,$.g,$.b,{a:$.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ve){var $=p(ve);this.ctx.strokeStyle=$.style,this.ctx.isStrokeTransparent=$.a===0,this.ctx.strokeOpacity=$.a,$.a===0?this.pdf.setDrawColor(255,255,255):($.a,this.pdf.setDrawColor($.r,$.g,$.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ve){["butt","round","square"].indexOf(ve)!==-1&&(this.ctx.lineCap=ve,this.pdf.setLineCap(ve))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ve){isNaN(ve)||(this.ctx.lineWidth=ve,this.pdf.setLineWidth(ve))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ve){["bevel","round","miter"].indexOf(ve)!==-1&&(this.ctx.lineJoin=ve,this.pdf.setLineJoin(ve))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ve){isNaN(ve)||(this.ctx.miterLimit=ve,this.pdf.setMiterLimit(ve))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ve){this.ctx.textBaseline=ve}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ve){["right","end","center","left","start"].indexOf(ve)!==-1&&(this.ctx.textAlign=ve)}});var Me=null;function De(ve,$){if(Me===null){var At=function(et){var Ue=[];return Object.keys(et).forEach(function(Le){et[Le].forEach(function(He){var Oe=null;switch(He){case"bold":Oe={family:Le,weight:"bold"};break;case"italic":Oe={family:Le,style:"italic"};break;case"bolditalic":Oe={family:Le,weight:"bold",style:"italic"};break;case"":case"normal":Oe={family:Le}}Oe!==null&&(Oe.ref={name:Le,style:He},Ue.push(Oe))})}),Ue}(ve.getFontList());Me=function(et){for(var Ue={},Le=0;Le<et.length;++Le){var He=Iu(et[Le]),Oe=He.family,tt=He.stretch,ut=He.style,mt=He.weight;Ue[Oe]=Ue[Oe]||{},Ue[Oe][tt]=Ue[Oe][tt]||{},Ue[Oe][tt][ut]=Ue[Oe][tt][ut]||{},Ue[Oe][tt][ut][mt]=He}return Ue}(At.concat($))}return Me}var st=null;Object.defineProperty(this,"fontFaces",{get:function(){return st},set:function(ve){Me=null,st=ve}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ve){var $;if(this.ctx.font=ve,($=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ve))!==null){var At=$[1],et=($[2],$[3]),Ue=$[4],Le=($[5],$[6]),He=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ue)[2];Ue=Math.floor(He==="px"?parseFloat(Ue)*this.pdf.internal.scaleFactor:He==="em"?parseFloat(Ue)*this.pdf.getFontSize():parseFloat(Ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ue);var Oe=function(ot){var yt,Ke,An=[],Ct=ot.trim();if(Ct==="")return Vd;if(Ct in Lh)return[Lh[Ct]];for(;Ct!=="";){switch(Ke=null,yt=(Ct=Mh(Ct)).charAt(0)){case'"':case"'":Ke=Wy(Ct.substring(1),yt);break;default:Ke=Yy(Ct)}if(Ke===null||(An.push(Ke[0]),(Ct=Mh(Ke[1]))!==""&&Ct.charAt(0)!==","))return Vd;Ct=Ct.replace(/^,/,"")}return An}(Le);if(this.fontFaces){var tt=Jy(De(this.pdf,this.fontFaces),Oe.map(function(ot){return{family:ot,stretch:"normal",weight:et,style:At}}));this.pdf.setFont(tt.ref.name,tt.ref.style)}else{var ut="";(et==="bold"||parseInt(et,10)>=700||At==="bold")&&(ut="bold"),At==="italic"&&(ut+="italic"),ut.length===0&&(ut="normal");for(var mt="",wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Bt=0;Bt<Oe.length;Bt++){if(this.pdf.internal.getFont(Oe[Bt],ut,{noFallback:!0,disableWarning:!0})!==void 0){mt=Oe[Bt];break}if(ut==="bolditalic"&&this.pdf.internal.getFont(Oe[Bt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)mt=Oe[Bt],ut="bold";else if(this.pdf.internal.getFont(Oe[Bt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){mt=Oe[Bt],ut="normal";break}}if(mt===""){for(var kt=0;kt<Oe.length;kt++)if(wt[Oe[kt]]){mt=wt[Oe[kt]];break}}mt=mt===""?"Times":mt,this.pdf.setFont(mt,ut)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ve){this.ctx.globalCompositeOperation=ve}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ve){this.ctx.globalAlpha=ve}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ve){this.ctx.lineDashOffset=ve,Ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ve){this.ctx.lineDash=ve,Ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ve){this.ctx.ignoreClearRect=!!ve}})};h.prototype.setLineDash=function(Q){this.lineDash=Q},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){E.call(this,"fill",!1)},h.prototype.stroke=function(){E.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(Q,z){if(isNaN(Q)||isNaN(z))throw Ht.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new A(Q,z));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new A(Q,z)},h.prototype.closePath=function(){var Q=new A(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&_t(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){Q=new A(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new A(Q.x,Q.y)},h.prototype.lineTo=function(Q,z){if(isNaN(Q)||isNaN(z))throw Ht.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new A(Q,z));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new A(W.x,W.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},h.prototype.quadraticCurveTo=function(Q,z,W,Z){if(isNaN(W)||isNaN(Z)||isNaN(Q)||isNaN(z))throw Ht.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new A(W,Z)),fe=this.ctx.transform.applyToPoint(new A(Q,z));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new A(ne.x,ne.y)},h.prototype.bezierCurveTo=function(Q,z,W,Z,ne,fe){if(isNaN(ne)||isNaN(fe)||isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z))throw Ht.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var xe=this.ctx.transform.applyToPoint(new A(ne,fe)),we=this.ctx.transform.applyToPoint(new A(Q,z)),Qe=this.ctx.transform.applyToPoint(new A(W,Z));this.path.push({type:"bct",x1:we.x,y1:we.y,x2:Qe.x,y2:Qe.y,x:xe.x,y:xe.y}),this.ctx.lastPoint=new A(xe.x,xe.y)},h.prototype.arc=function(Q,z,W,Z,ne,fe){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z)||isNaN(ne))throw Ht.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var xe=this.ctx.transform.applyToPoint(new A(Q,z));Q=xe.x,z=xe.y;var we=this.ctx.transform.applyToPoint(new A(0,W)),Qe=this.ctx.transform.applyToPoint(new A(0,0));W=Math.sqrt(Math.pow(we.x-Qe.x,2)+Math.pow(we.y-Qe.y,2))}Math.abs(ne-Z)>=2*Math.PI&&(Z=0,ne=2*Math.PI),this.path.push({type:"arc",x:Q,y:z,radius:W,startAngle:Z,endAngle:ne,counterclockwise:fe})},h.prototype.arcTo=function(Q,z,W,Z,ne){throw new Error("arcTo not implemented.")},h.prototype.rect=function(Q,z,W,Z){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z))throw Ht.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Q,z),this.lineTo(Q+W,z),this.lineTo(Q+W,z+Z),this.lineTo(Q,z+Z),this.lineTo(Q,z),this.lineTo(Q+W,z),this.lineTo(Q,z)},h.prototype.fillRect=function(Q,z,W,Z){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z))throw Ht.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Q,z,W,Z),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},h.prototype.strokeRect=function(Q,z,W,Z){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z))throw Ht.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");B.call(this)||(this.beginPath(),this.rect(Q,z,W,Z),this.stroke())},h.prototype.clearRect=function(Q,z,W,Z){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z))throw Ht.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Q,z,W,Z))},h.prototype.save=function(Q){Q=typeof Q!="boolean"||Q;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),Q){this.ctx.fontSize=this.pdf.internal.getFontSize();var Z=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Z}},h.prototype.restore=function(Q){Q=typeof Q!="boolean"||Q;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(z),Q&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(Q){var z,W,Z,ne;if(Q.isCanvasGradient===!0&&(Q=Q.getColor()),!Q)return{r:0,g:0,b:0,a:0,style:Q};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Q))z=0,W=0,Z=0,ne=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Q);if(fe!==null)z=parseInt(fe[1]),W=parseInt(fe[2]),Z=parseInt(fe[3]),ne=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Q))!==null)z=parseInt(fe[1]),W=parseInt(fe[2]),Z=parseInt(fe[3]),ne=parseFloat(fe[4]);else{if(ne=1,typeof Q=="string"&&Q.charAt(0)!=="#"){var xe=new Ap(Q);Q=xe.ok?xe.toHex():"#000000"}Q.length===4?(z=Q.substring(1,2),z+=z,W=Q.substring(2,3),W+=W,Z=Q.substring(3,4),Z+=Z):(z=Q.substring(1,3),W=Q.substring(3,5),Z=Q.substring(5,7)),z=parseInt(z,16),W=parseInt(W,16),Z=parseInt(Z,16)}}return{r:z,g:W,b:Z,a:ne,style:Q}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},B=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(Q,z,W,Z){if(isNaN(z)||isNaN(W)||typeof Q!="string")throw Ht.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Z=isNaN(Z)?void 0:Z,!m.call(this)){var ne=ae(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;I.call(this,{text:Q,x:z,y:W,scale:fe,angle:ne,align:this.textAlign,maxWidth:Z})}},h.prototype.strokeText=function(Q,z,W,Z){if(isNaN(z)||isNaN(W)||typeof Q!="string")throw Ht.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!B.call(this)){Z=isNaN(Z)?void 0:Z;var ne=ae(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;I.call(this,{text:Q,x:z,y:W,scale:fe,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:Z})}},h.prototype.measureText=function(Q){if(typeof Q!="string")throw Ht.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,W=this.pdf.internal.scaleFactor,Z=z.internal.getFontSize(),ne=z.getStringUnitWidth(Q)*Z/z.internal.scaleFactor,fe=function(xe){var we=(xe=xe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return we}}),this};return new fe({width:ne*=Math.round(96*W/72*1e4)/1e4})},h.prototype.scale=function(Q,z){if(isNaN(Q)||isNaN(z))throw Ht.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new l(Q,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},h.prototype.rotate=function(Q){if(isNaN(Q))throw Ht.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new l(Math.cos(Q),Math.sin(Q),-Math.sin(Q),Math.cos(Q),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},h.prototype.translate=function(Q,z){if(isNaN(Q)||isNaN(z))throw Ht.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new l(1,0,0,1,Q,z);this.ctx.transform=this.ctx.transform.multiply(W)},h.prototype.transform=function(Q,z,W,Z,ne,fe){if(isNaN(Q)||isNaN(z)||isNaN(W)||isNaN(Z)||isNaN(ne)||isNaN(fe))throw Ht.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var xe=new l(Q,z,W,Z,ne,fe);this.ctx.transform=this.ctx.transform.multiply(xe)},h.prototype.setTransform=function(Q,z,W,Z,ne,fe){Q=isNaN(Q)?1:Q,z=isNaN(z)?0:z,W=isNaN(W)?0:W,Z=isNaN(Z)?1:Z,ne=isNaN(ne)?0:ne,fe=isNaN(fe)?0:fe,this.ctx.transform=new l(Q,z,W,Z,ne,fe)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(Q,z,W,Z,ne,fe,xe,we,Qe){var je=this.pdf.getImageProperties(Q),Me=1,De=1,st=1,ve=1;Z!==void 0&&we!==void 0&&(st=we/Z,ve=Qe/ne,Me=je.width/Z*we/Z,De=je.height/ne*Qe/ne),fe===void 0&&(fe=z,xe=W,z=0,W=0),Z!==void 0&&we===void 0&&(we=Z,Qe=ne),Z===void 0&&we===void 0&&(we=je.width,Qe=je.height);for(var $,At=this.ctx.transform.decompose(),et=ae(At.rotate.shx),Ue=new l,Le=(Ue=(Ue=(Ue=Ue.multiply(At.translate)).multiply(At.skew)).multiply(At.scale)).applyToRectangle(new o(fe-z*st,xe-W*ve,Z*Me,ne*De)),He=b.call(this,Le),Oe=[],tt=0;tt<He.length;tt+=1)Oe.indexOf(He[tt])===-1&&Oe.push(He[tt]);if(k(Oe),this.autoPaging)for(var ut=Oe[0],mt=Oe[Oe.length-1],wt=ut;wt<mt+1;wt++){this.pdf.setPage(wt);var Bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],kt=wt===1?this.posY+this.margin[0]:this.margin[0],ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ke=wt===1?0:ot+(wt-2)*yt;if(this.ctx.clip_path.length!==0){var An=this.path;$=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N($,this.posX+this.margin[3],-Ke+kt+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=An}var Ct=JSON.parse(JSON.stringify(Le));Ct=N([Ct],this.posX+this.margin[3],-Ke+kt+this.ctx.prevPageLastElemOffset)[0];var yr=(wt>ut||wt<mt)&&y.call(this);yr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bt,yt,null).clip().discardPath()),this.pdf.addImage(Q,"JPEG",Ct.x,Ct.y,Ct.w,Ct.h,null,null,et),yr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Q,"JPEG",Le.x,Le.y,Le.w,Le.h,null,null,et)};var b=function(Q,z,W){var Z=[];z=z||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(Q.type){default:case"mt":case"lt":Z.push(Math.floor((Q.y+ne)/W)+1);break;case"arc":Z.push(Math.floor((Q.y+ne-Q.radius)/W)+1),Z.push(Math.floor((Q.y+ne+Q.radius)/W)+1);break;case"qct":var fe=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Q.x1,Q.y1,Q.x,Q.y);Z.push(Math.floor((fe.y+ne)/W)+1),Z.push(Math.floor((fe.y+fe.h+ne)/W)+1);break;case"bct":var xe=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Q.x1,Q.y1,Q.x2,Q.y2,Q.x,Q.y);Z.push(Math.floor((xe.y+ne)/W)+1),Z.push(Math.floor((xe.y+xe.h+ne)/W)+1);break;case"rect":Z.push(Math.floor((Q.y+ne)/W)+1),Z.push(Math.floor((Q.y+Q.h+ne)/W)+1)}for(var we=0;we<Z.length;we+=1)for(;this.pdf.internal.getNumberOfPages()<Z[we];)C.call(this);return Z},C=function(){var Q=this.fillStyle,z=this.strokeStyle,W=this.font,Z=this.lineCap,ne=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=Q,this.strokeStyle=z,this.font=W,this.lineCap=Z,this.lineWidth=ne,this.lineJoin=fe},N=function(Q,z,W){for(var Z=0;Z<Q.length;Z++)switch(Q[Z].type){case"bct":Q[Z].x2+=z,Q[Z].y2+=W;case"qct":Q[Z].x1+=z,Q[Z].y1+=W;case"mt":case"lt":case"arc":default:Q[Z].x+=z,Q[Z].y+=W}return Q},k=function(Q){return Q.sort(function(z,W){return z-W})},E=function(Q,z){for(var W,Z,ne=this.fillStyle,fe=this.strokeStyle,xe=this.lineCap,we=this.lineWidth,Qe=Math.abs(we*this.ctx.transform.scaleX),je=this.lineJoin,Me=JSON.parse(JSON.stringify(this.path)),De=JSON.parse(JSON.stringify(this.path)),st=[],ve=0;ve<De.length;ve++)if(De[ve].x!==void 0)for(var $=b.call(this,De[ve]),At=0;At<$.length;At+=1)st.indexOf($[At])===-1&&st.push($[At]);for(var et=0;et<st.length;et++)for(;this.pdf.internal.getNumberOfPages()<st[et];)C.call(this);if(k(st),this.autoPaging)for(var Ue=st[0],Le=st[st.length-1],He=Ue;He<Le+1;He++){this.pdf.setPage(He),this.fillStyle=ne,this.strokeStyle=fe,this.lineCap=xe,this.lineWidth=Qe,this.lineJoin=je;var Oe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],tt=He===1?this.posY+this.margin[0]:this.margin[0],ut=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=He===1?0:ut+(He-2)*mt;if(this.ctx.clip_path.length!==0){var Bt=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(W,this.posX+this.margin[3],-wt+tt+this.ctx.prevPageLastElemOffset),_.call(this,Q,!0),this.path=Bt}if(Z=JSON.parse(JSON.stringify(Me)),this.path=N(Z,this.posX+this.margin[3],-wt+tt+this.ctx.prevPageLastElemOffset),z===!1||He===0){var kt=(He>Ue||He<Le)&&y.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Oe,mt,null).clip().discardPath()),_.call(this,Q,z),kt&&this.pdf.restoreGraphicsState()}this.lineWidth=we}else this.lineWidth=Qe,_.call(this,Q,z),this.lineWidth=we;this.path=Me},_=function(Q,z){if((Q!=="stroke"||z||!B.call(this))&&(Q==="stroke"||z||!m.call(this))){for(var W,Z,ne=[],fe=this.path,xe=0;xe<fe.length;xe++){var we=fe[xe];switch(we.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:we,deltas:[],abs:[]});break;case"lt":var Qe=ne.length;if(fe[xe-1]&&!isNaN(fe[xe-1].x)&&(W=[we.x-fe[xe-1].x,we.y-fe[xe-1].y],Qe>0)){for(;Qe>=0;Qe--)if(ne[Qe-1].close!==!0&&ne[Qe-1].begin!==!0){ne[Qe-1].deltas.push(W),ne[Qe-1].abs.push(we);break}}break;case"bct":W=[we.x1-fe[xe-1].x,we.y1-fe[xe-1].y,we.x2-fe[xe-1].x,we.y2-fe[xe-1].y,we.x-fe[xe-1].x,we.y-fe[xe-1].y],ne[ne.length-1].deltas.push(W);break;case"qct":var je=fe[xe-1].x+2/3*(we.x1-fe[xe-1].x),Me=fe[xe-1].y+2/3*(we.y1-fe[xe-1].y),De=we.x+2/3*(we.x1-we.x),st=we.y+2/3*(we.y1-we.y),ve=we.x,$=we.y;W=[je-fe[xe-1].x,Me-fe[xe-1].y,De-fe[xe-1].x,st-fe[xe-1].y,ve-fe[xe-1].x,$-fe[xe-1].y],ne[ne.length-1].deltas.push(W);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(we)}}Z=z?null:Q==="stroke"?"stroke":"fill";for(var At=!1,et=0;et<ne.length;et++)if(ne[et].arc)for(var Ue=ne[et].abs,Le=0;Le<Ue.length;Le++){var He=Ue[Le];He.type==="arc"?U.call(this,He.x,He.y,He.radius,He.startAngle,He.endAngle,He.counterclockwise,void 0,z,!At):P.call(this,He.x,He.y),At=!0}else if(ne[et].close===!0)this.pdf.internal.out("h"),At=!1;else if(ne[et].begin!==!0){var Oe=ne[et].start.x,tt=ne[et].start.y;V.call(this,ne[et].deltas,Oe,tt),At=!0}Z&&j.call(this,Z),z&&O.call(this)}},M=function(Q){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Q-W;case"top":return Q+z-W;case"hanging":return Q+z-2*W;case"middle":return Q+z/2-W;case"ideographic":return Q;case"alphabetic":default:return Q}},D=function(Q){return Q+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var Q=function(){};return Q.colorStops=[],Q.addColorStop=function(z,W){this.colorStops.push([z,W])},Q.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Q.isCanvasGradient=!0,Q},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var U=function(Q,z,W,Z,ne,fe,xe,we,Qe){for(var je=X.call(this,W,Z,ne,fe),Me=0;Me<je.length;Me++){var De=je[Me];Me===0&&(Qe?F.call(this,De.x1+Q,De.y1+z):P.call(this,De.x1+Q,De.y1+z)),ee.call(this,Q,z,De.x2,De.y2,De.x3,De.y3,De.x4,De.y4)}we?O.call(this):j.call(this,xe)},j=function(Q){switch(Q){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(Q,z){this.pdf.internal.out(n(Q)+" "+r(z)+" m")},I=function(Q){var z;switch(Q.align){case"right":case"end":z="right";break;case"center":z="center";break;case"left":case"start":default:z="left"}var W=this.pdf.getTextDimensions(Q.text),Z=M.call(this,Q.y),ne=D.call(this,Z)-W.h,fe=this.ctx.transform.applyToPoint(new A(Q.x,Z)),xe=this.ctx.transform.decompose(),we=new l;we=(we=(we=we.multiply(xe.translate)).multiply(xe.skew)).multiply(xe.scale);for(var Qe,je,Me,De=this.ctx.transform.applyToRectangle(new o(Q.x,Z,W.w,W.h)),st=we.applyToRectangle(new o(Q.x,ne,W.w,W.h)),ve=b.call(this,st),$=[],At=0;At<ve.length;At+=1)$.indexOf(ve[At])===-1&&$.push(ve[At]);if(k($),this.autoPaging)for(var et=$[0],Ue=$[$.length-1],Le=et;Le<Ue+1;Le++){this.pdf.setPage(Le);var He=Le===1?this.posY+this.margin[0]:this.margin[0],Oe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tt=this.pdf.internal.pageSize.height-this.margin[2],ut=tt-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],wt=mt-this.margin[3],Bt=Le===1?0:Oe+(Le-2)*ut;if(this.ctx.clip_path.length!==0){var kt=this.path;Qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(Qe,this.posX+this.margin[3],-1*Bt+He),_.call(this,"fill",!0),this.path=kt}var ot=N([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-Bt+He+this.ctx.prevPageLastElemOffset)[0];Q.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*Q.scale),Me=this.lineWidth,this.lineWidth=Me*Q.scale);var yt=this.autoPaging!=="text";if(yt||ot.y+ot.h<=tt){if(yt||ot.y>=He&&ot.x<=mt){var Ke=yt?Q.text:this.pdf.splitTextToSize(Q.text,Q.maxWidth||mt-ot.x)[0],An=N([JSON.parse(JSON.stringify(De))],this.posX+this.margin[3],-Bt+He+this.ctx.prevPageLastElemOffset)[0],Ct=yt&&(Le>et||Le<Ue)&&y.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wt,ut,null).clip().discardPath()),this.pdf.text(Ke,An.x,An.y,{angle:Q.angle,align:z,renderingMode:Q.renderingMode}),Ct&&this.pdf.restoreGraphicsState()}}else ot.y<tt&&(this.ctx.prevPageLastElemOffset+=tt-ot.y);Q.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Me)}else Q.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*Q.scale),Me=this.lineWidth,this.lineWidth=Me*Q.scale),this.pdf.text(Q.text,fe.x+this.posX,fe.y+this.posY,{angle:Q.angle,align:z,renderingMode:Q.renderingMode,maxWidth:Q.maxWidth}),Q.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Me)},P=function(Q,z,W,Z){W=W||0,Z=Z||0,this.pdf.internal.out(n(Q+W)+" "+r(z+Z)+" l")},V=function(Q,z,W){return this.pdf.lines(Q,z,W,null,null)},ee=function(Q,z,W,Z,ne,fe,xe,we){this.pdf.internal.out([e(a(W+Q)),e(i(Z+z)),e(a(ne+Q)),e(i(fe+z)),e(a(xe+Q)),e(i(we+z)),"c"].join(" "))},X=function(Q,z,W,Z){for(var ne=2*Math.PI,fe=Math.PI/2;z>W;)z-=ne;var xe=Math.abs(W-z);xe<ne&&Z&&(xe=ne-xe);for(var we=[],Qe=Z?-1:1,je=z;xe>1e-5;){var Me=je+Qe*Math.min(xe,fe);we.push(le.call(this,Q,je,Me)),xe-=Math.abs(Me-je),je=Me}return we},le=function(Q,z,W){var Z=(W-z)/2,ne=Q*Math.cos(Z),fe=Q*Math.sin(Z),xe=ne,we=-fe,Qe=xe*xe+we*we,je=Qe+xe*ne+we*fe,Me=4/3*(Math.sqrt(2*Qe*je)-je)/(xe*fe-we*ne),De=xe-Me*we,st=we+Me*xe,ve=De,$=-st,At=Z+z,et=Math.cos(At),Ue=Math.sin(At);return{x1:Q*Math.cos(z),y1:Q*Math.sin(z),x2:De*et-st*Ue,y2:De*Ue+st*et,x3:ve*et-$*Ue,y3:ve*Ue+$*et,x4:Q*Math.cos(W),y4:Q*Math.sin(W)}},ae=function(Q){return 180*Q/Math.PI},de=function(Q,z,W,Z,ne,fe){var xe=Q+.5*(W-Q),we=z+.5*(Z-z),Qe=ne+.5*(W-ne),je=fe+.5*(Z-fe),Me=Math.min(Q,ne,xe,Qe),De=Math.max(Q,ne,xe,Qe),st=Math.min(z,fe,we,je),ve=Math.max(z,fe,we,je);return new o(Me,st,De-Me,ve-st)},ue=function(Q,z,W,Z,ne,fe,xe,we){var Qe,je,Me,De,st,ve,$,At,et,Ue,Le,He,Oe,tt,ut=W-Q,mt=Z-z,wt=ne-W,Bt=fe-Z,kt=xe-ne,ot=we-fe;for(je=0;je<41;je++)et=($=(Me=Q+(Qe=je/40)*ut)+Qe*((st=W+Qe*wt)-Me))+Qe*(st+Qe*(ne+Qe*kt-st)-$),Ue=(At=(De=z+Qe*mt)+Qe*((ve=Z+Qe*Bt)-De))+Qe*(ve+Qe*(fe+Qe*ot-ve)-At),je==0?(Le=et,He=Ue,Oe=et,tt=Ue):(Le=Math.min(Le,et),He=Math.min(He,Ue),Oe=Math.max(Oe,et),tt=Math.max(tt,Ue));return new o(Math.round(Le),Math.round(He),Math.round(Oe-Le),Math.round(tt-He))},Ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Q,z,W=(Q=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:Q,lineDashOffset:z}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(it.API),function(t){var e=function(i){var A,o,l,c,d,h,p,m,B,y;for(o=[],l=0,c=(i+=A="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(d=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(h=(d=((d=((d=((d=(d-(y=d%85))/85)-(B=d%85))/85)-(m=d%85))/85)-(p=d%85))/85)%85,o.push(h+33,p+33,m+33,B+33,y+33)):o.push(122);return function(b,C){for(var N=C;N>0;N--)b.pop()}(o,A.length),String.fromCharCode.apply(String,o)+"~>"},n=function(i){var A,o,l,c,d,h=String,p="length",m=255,B="charCodeAt",y="slice",b="replace";for(i[y](-2),i=i[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],c=0,d=(i+=A="uuuuu"[y](i[p]%5||5))[p];d>c;c+=5)o=52200625*(i[B](c)-33)+614125*(i[B](c+1)-33)+7225*(i[B](c+2)-33)+85*(i[B](c+3)-33)+(i[B](c+4)-33),l.push(m&o>>24,m&o>>16,m&o>>8,m&o);return function(C,N){for(var k=N;k>0;k--)C.pop()}(l,A[p]),h.fromCharCode.apply(h,l)},r=function(i){var A=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),A.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},a=function(i){for(var A=new Uint8Array(i.length),o=i.length;o--;)A[o]=i.charCodeAt(o);return i=(A=bu(A)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};t.processDataByFilters=function(i,A){var o=0,l=i||"",c=[];for(typeof(A=A||[])=="string"&&(A=[A]),o=0;o<A.length;o+=1)switch(A[o]){case"ASCII85Decode":case"/ASCII85Decode":l=n(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=r(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+A[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(it.API),function(t){t.loadFile=function(e,n,r){return function(a,i,A){i=i!==!1,A=typeof A=="function"?A:function(){};var o=void 0;try{o=function(l,c,d){var h=new XMLHttpRequest,p=0,m=function(B){var y=B.length,b=[],C=String.fromCharCode;for(p=0;p<y;p+=1)b.push(C(255&B.charCodeAt(p)));return b.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?d(m(this.responseText)):d(void 0)}),h.send(null),c&&h.status===200)return m(h.responseText)}(a,i,A)}catch{}return o}(e,n,r)},t.loadImageFile=t.loadFile}(it.API),function(t){function e(){return(lt.html2canvas?Promise.resolve(lt.html2canvas):NA(()=>Promise.resolve().then(()=>DC),void 0)).catch(function(A){return Promise.reject(new Error("Could not load html2canvas: "+A))}).then(function(A){return A.default?A.default:A})}function n(){return(lt.DOMPurify?Promise.resolve(lt.DOMPurify):NA(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load dompurify: "+A))}).then(function(A){return A.default?A.default:A})}var r=function(A){var o=_t(A);return o==="undefined"?"undefined":o==="string"||A instanceof String?"string":o==="number"||A instanceof Number?"number":o==="function"||A instanceof Function?"function":A&&A.constructor===Array?"array":A&&A.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(A,o){var l=document.createElement(A);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function A(o){var l=Object.assign(A.convert(Promise.resolve()),JSON.parse(JSON.stringify(A.template))),c=A.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,A,1,[A])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(A,o){return A.__proto__=o||i.prototype,A},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(A,o){return this.then(function(){switch(o=o||function(l){switch(r(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(A)){case"string":return this.then(n).then(function(l){return this.set({src:a("div",{innerHTML:A,dompurify:l})})});case"element":return this.set({src:A});case"canvas":return this.set({canvas:A});case"img":return this.set({img:A});default:return this.error("Unknown source type.")}})},i.prototype.to=function(A){switch(A){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var A={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,d){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(l(p,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(A.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:A}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var m=c[p],B=m.src.find(function(y){return y.format==="truetype"});B&&l.addFont(B.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,l.context2d.save(!0),o(this.prop.container,h)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var A=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=A})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(A,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(A,o):this.outputPdf(A,o)},i.prototype.outputPdf=function(A,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(A,o)})},i.prototype.outputImg=function(A){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(A){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+A+'" is not supported.'}})},i.prototype.save=function(A){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(A?{filename:A}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(A){if(r(A)!=="object")return this;var o=Object.keys(A||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=A[l]};switch(l){case"margin":return this.setMargin.bind(this,A.margin);case"jsPDF":return function(){return this.opt.jsPDF=A.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,A.pageSize);default:return function(){this.opt[l]=A[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(A,o){return this.then(function(){var l=A in i.template.prop?this.prop[A]:this.opt[A];return o?o(l):l})},i.prototype.setMargin=function(A){return this.then(function(){switch(r(A)){case"number":A=[A,A,A,A];case"array":if(A.length===2&&(A=[A[0],A[1],A[0],A[1]]),A.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=A}).then(this.setPageSize)},i.prototype.setPageSize=function(A){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(A=A||it.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(A.inner={width:A.width-this.opt.margin[1]-this.opt.margin[3],height:A.height-this.opt.margin[0]-this.opt.margin[2]},A.inner.px={width:o(A.inner.width,A.k),height:o(A.inner.height,A.k)},A.inner.ratio=A.inner.height/A.inner.width),this.prop.pageSize=A})},i.prototype.setProgress=function(A,o,l,c){return A!=null&&(this.progress.val=A),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(A,o,l,c){return this.setProgress(A?this.progress.val+A:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(A,o){var l=this;return this.thenCore(A,o,function(c,d){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(h){return l.updateProgress(null,c),h}).then(c,d).then(function(h){return l.updateProgress(1),h})})},i.prototype.thenCore=function(A,o,l){l=l||Promise.prototype.then,A&&(A=A.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=l.call(c,A,o);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(A,o){return Promise.prototype.then.call(this,A,o)},i.prototype.thenList=function(A){var o=this;return A.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(A){A&&(A=A.bind(this));var o=Promise.prototype.catch.call(this,A);return i.convert(o,this)},i.prototype.catchExternal=function(A){return Promise.prototype.catch.call(this,A)},i.prototype.error=function(A){return this.then(function(){throw new Error(A)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,it.getPageSize=function(A,o,l){if(_t(A)==="object"){var c=A;A=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",A=(""+(A||"P")).toLowerCase();var d,h=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+o}var m,B=0,y=0;if(p.hasOwnProperty(h))B=p[h][1]/d,y=p[h][0]/d;else try{B=l[1],y=l[0]}catch{throw new Error("Invalid format: "+l)}if(A==="p"||A==="portrait")A="p",y>B&&(m=y,y=B,B=m);else{if(A!=="l"&&A!=="landscape")throw"Invalid orientation: "+A;A="l",B>y&&(m=y,y=B,B=m)}return{width:y,height:B,unit:o,k:d,orientation:A}},t.html=function(A,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Iu):null;var l=new i(o);return o.worker?l:l.from(A).doCallback()}}(it.API),it.API.addJS=function(t){return Ph=t,this.internal.events.subscribe("postPutResources",function(){jl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(jl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Dh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ph+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){jl!==void 0&&Dh!==void 0&&this.internal.out("/Names <</JavaScript "+jl+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=n.outline.render().split(/\r\n/),i=0;i<a.length;i++){var A=a[i],o=r.exec(A);if(o!=null){var l=o[1];n.internal.newObjectDeferredBegin(l,!1)}n.internal.write(A)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,d=[];for(i=0;i<c;i++){var h=n.internal.newObject();d.push(h);var p=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<d.length;i++)n.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,a,i){var A={title:a,options:i,children:[]};return r==null&&(r=this.root),r.children.push(A),A},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var a=0;a<r.children.length;a++)this.genIds_r(r.children[a])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var A=r.children[i];this.objStart(A),this.line("/Title "+this.makeString(A.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),A.children.length>0&&(this.line("/First "+this.makeRef(A.children[0])),this.line("/Last "+this.makeRef(A.children[A.children.length-1])));var o=this.count=this.count_r({count:0},A);if(o>0&&this.line("/Count "+o),A.options&&A.options.pageNumber){var l=n.internal.getPageInfo(A.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<r.children.length;c++)this.renderItems(r.children[c])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,a){for(var i=0;i<a.children.length;i++)r.count++,this.count_r(r,a.children[i]);return r.count}}])}(it.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,a,i,A,o){var l,c=this.decode.DCT_DECODE,d=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=A||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(l=function(h){for(var p,m=256*h.charCodeAt(4)+h.charCodeAt(5),B=h.length,y={width:0,height:0,numcomponents:1},b=4;b<B;b+=2){if(b+=m,e.indexOf(h.charCodeAt(b+1))!==-1){p=256*h.charCodeAt(b+5)+h.charCodeAt(b+6),y={width:256*h.charCodeAt(b+7)+h.charCodeAt(b+8),height:p,numcomponents:h.charCodeAt(b+9)};break}m=256*h.charCodeAt(b+2)+h.charCodeAt(b+3)}return y}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:n,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:r,alias:a}}return d}}(it.API);var $i,Tl,Rh,Hh,Oh,$y=function(){var t,e,n;function r(i){var A,o,l,c,d,h,p,m,B,y,b,C,N,k;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(A=this.readUInt32(),B=(function(){var E,_;for(_=[],E=0;E<4;++E)_.push(String.fromCharCode(this.data[this.pos++]));return _}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(A);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),c=this.readUInt16()||100,h.delay=1e3*d/c,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(B==="fdAT"&&(this.pos+=4,A-=4),i=(h!=null?h.data:void 0)||this.imgData,C=0;0<=A?C<A:C>A;0<=A?++C:--C)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(A),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((y=l-this.transparency.indexed.length)>0)for(N=0;0<=y?N<y:N>y;0<=y?++N:--N)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case"tEXt":p=(b=this.read(A)).indexOf(0),m=String.fromCharCode.apply(String,b.slice(0,p)),this.text[m]=String.fromCharCode.apply(String,b.slice(p+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(k=this.colorType)===4||k===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=A}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(i){var A,o;for(o=[],A=0;0<=i?A<i:A>i;0<=i?++A:--A)o.push(this.data[this.pos++]);return o},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(i){var A=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*A),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(h,p,m,B){var y,b,C,N,k,E,_,M,D,U,j,O,F,I,P,V,ee,X,le,ae,de,ue=Math.ceil((c.width-h)/m),Ce=Math.ceil((c.height-p)/B),Q=c.width==ue&&c.height==Ce;for(I=A*ue,O=Q?o:new Uint8Array(I*Ce),E=i.length,F=0,b=0;F<Ce&&l<E;){switch(i[l++]){case 0:for(N=ee=0;ee<I;N=ee+=1)O[b++]=i[l++];break;case 1:for(N=X=0;X<I;N=X+=1)y=i[l++],k=N<A?0:O[b-A],O[b++]=(y+k)%256;break;case 2:for(N=le=0;le<I;N=le+=1)y=i[l++],C=(N-N%A)/A,P=F&&O[(F-1)*I+C*A+N%A],O[b++]=(P+y)%256;break;case 3:for(N=ae=0;ae<I;N=ae+=1)y=i[l++],C=(N-N%A)/A,k=N<A?0:O[b-A],P=F&&O[(F-1)*I+C*A+N%A],O[b++]=(y+Math.floor((k+P)/2))%256;break;case 4:for(N=de=0;de<I;N=de+=1)y=i[l++],C=(N-N%A)/A,k=N<A?0:O[b-A],F===0?P=V=0:(P=O[(F-1)*I+C*A+N%A],V=C&&O[(F-1)*I+(C-1)*A+N%A]),_=k+P-V,M=Math.abs(_-k),U=Math.abs(_-P),j=Math.abs(_-V),D=M<=U&&M<=j?k:U<=j?P:V,O[b++]=(y+D)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!Q){var z=((p+F*B)*c.width+h)*A,W=F*I;for(N=0;N<ue;N+=1){for(var Z=0;Z<A;Z+=1)o[z++]=O[W++];z+=(m-1)*A}}F++}}return i=Ey(i),c.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),o},r.prototype.decodePalette=function(){var i,A,o,l,c,d,h,p,m;for(o=this.palette,d=this.transparency.indexed||[],c=new Uint8Array((d.length||0)+o.length),l=0,i=0,A=h=0,p=o.length;h<p;A=h+=3)c[l++]=o[A],c[l++]=o[A+1],c[l++]=o[A+2],c[l++]=(m=d[i++])!=null?m:255;return c},r.prototype.copyToImageData=function(i,A){var o,l,c,d,h,p,m,B,y,b,C;if(l=this.colors,y=null,o=this.hasAlphaChannel,this.palette.length&&(y=(C=this._decodedPalette)!=null?C:this._decodedPalette=this.decodePalette(),l=4,o=!0),B=(c=i.data||i).length,h=y||A,d=p=0,l===1)for(;d<B;)m=y?4*A[d/4]:p,b=h[m++],c[d++]=b,c[d++]=b,c[d++]=b,c[d++]=o?h[m++]:255,p=m;else for(;d<B;)m=y?4*A[d/4]:p,c[d++]=h[m++],c[d++]=h[m++],c[d++]=h[m++],c[d++]=o?h[m++]:255,p=m},r.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(lt)==="[object Window]"){try{e=lt.document.createElement("canvas"),n=e.getContext("2d")}catch{return!1}return!0}return!1};return a(),t=function(i){var A;if(a()===!0)return n.width=i.width,n.height=i.height,n.clearRect(0,0,i.width,i.height),n.putImageData(i,0,0),(A=new Image).src=e.toDataURL(),A;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(i){var A,o,l,c,d,h,p,m;if(this.animation){for(m=[],o=d=0,h=(p=this.animation.frames).length;d<h;o=++d)A=p[o],l=i.createImageData(A.width,A.height),c=this.decodePixels(new Uint8Array(A.data)),this.copyToImageData(l,c),A.imageData=l,m.push(A.image=t(l));return m}},r.prototype.renderFrame=function(i,A){var o,l,c;return o=(l=this.animation.frames)[A],c=l[A-1],A===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},r.prototype.animate=function(i){var A,o,l,c,d,h,p=this;return o=0,h=this.animation,c=h.numFrames,l=h.frames,d=h.numPlays,(A=function(){var m,B;if(m=o++%c,B=l[m],p.renderFrame(i,m),c>1&&o/c<d)return p.animation._timeout=setTimeout(A,B.delay)})()},r.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},r.prototype.render=function(i){var A,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,A=i.getContext("2d"),this.animation?(this.decodeFrames(A),this.animate(A)):(o=A.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),A.putImageData(o,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Xy(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,a=t[e++],i=a>>7,A=1<<(7&a)+1;t[e++],t[e++];var o=null,l=null;i&&(o=e,l=A,e+=3*A);var c=!0,d=[],h=0,p=null,m=0,B=null;for(this.width=n,this.height=r;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,B=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=t[e++];h=t[e++]|t[e++]<<8,p=t[e++],!(1&y)&&(p=null),m=y>>2&7,e++;break;case 254:for(;;){if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var b=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,E=t[e++],_=E>>6&1,M=1<<(7&E)+1,D=o,U=l,j=!1;E>>7&&(j=!0,D=e,U=M,e+=3*M);var O=e;for(e++;;){var F;if(!((F=t[e++])>=0))throw Error("Invalid block size");if(F===0)break;e+=F}d.push({x:b,y:C,width:N,height:k,has_local_palette:j,palette_offset:D,palette_size:U,data_offset:O,data_length:e-O,transparent_index:p,interlaced:!!_,delay:h,disposal:m});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return B},this.frameInfo=function(I){if(I<0||I>=d.length)throw new Error("Frame index out of range.");return d[I]},this.decodeAndBlitFrameBGRA=function(I,P){var V=this.frameInfo(I),ee=V.width*V.height,X=new Uint8Array(ee);Gh(t,V.data_offset,X,ee);var le=V.palette_offset,ae=V.transparent_index;ae===null&&(ae=256);var de=V.width,ue=n-de,Ce=de,Q=4*(V.y*n+V.x),z=4*((V.y+V.height)*n+V.x),W=Q,Z=4*ue;V.interlaced===!0&&(Z+=4*n*7);for(var ne=8,fe=0,xe=X.length;fe<xe;++fe){var we=X[fe];if(Ce===0&&(Ce=de,(W+=Z)>=z&&(Z=4*ue+4*n*(ne-1),W=Q+(de+ue)*(ne<<1),ne>>=1)),we===ae)W+=4;else{var Qe=t[le+3*we],je=t[le+3*we+1],Me=t[le+3*we+2];P[W++]=Me,P[W++]=je,P[W++]=Qe,P[W++]=255}--Ce}},this.decodeAndBlitFrameRGBA=function(I,P){var V=this.frameInfo(I),ee=V.width*V.height,X=new Uint8Array(ee);Gh(t,V.data_offset,X,ee);var le=V.palette_offset,ae=V.transparent_index;ae===null&&(ae=256);var de=V.width,ue=n-de,Ce=de,Q=4*(V.y*n+V.x),z=4*((V.y+V.height)*n+V.x),W=Q,Z=4*ue;V.interlaced===!0&&(Z+=4*n*7);for(var ne=8,fe=0,xe=X.length;fe<xe;++fe){var we=X[fe];if(Ce===0&&(Ce=de,(W+=Z)>=z&&(Z=4*ue+4*n*(ne-1),W=Q+(de+ue)*(ne<<1),ne>>=1)),we===ae)W+=4;else{var Qe=t[le+3*we],je=t[le+3*we+1],Me=t[le+3*we+2];P[W++]=Qe,P[W++]=je,P[W++]=Me,P[W++]=255}--Ce}}}function Gh(t,e,n,r){for(var a=t[e++],i=1<<a,A=i+1,o=A+1,l=a+1,c=(1<<l)-1,d=0,h=0,p=0,m=t[e++],B=new Int32Array(4096),y=null;;){for(;d<16&&m!==0;)h|=t[e++]<<d,d+=8,m===1?m=t[e++]:--m;if(d<l)break;var b=h&c;if(h>>=l,d-=l,b!==i){if(b===A)break;for(var C=b<o?b:y,N=0,k=C;k>i;)k=B[k]>>8,++N;var E=k;if(p+N+(C!==b?1:0)>r)return void Ht.log("Warning, gif stream longer than expected.");n[p++]=E;var _=p+=N;for(C!==b&&(n[p++]=E),k=C;N--;)k=B[k],n[--_]=255&k,k>>=8;y!==null&&o<4096&&(B[o++]=y<<8|E,o>=c+1&&l<12&&(++l,c=c<<1|1)),y=b}else o=A+1,c=(1<<(l=a+1))-1,y=null}return p!==r&&Ht.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Kd(t){var e,n,r,a,i,A=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),d=new Array(64),h=new Array(65535),p=new Array(65535),m=new Array(64),B=new Array(64),y=[],b=0,C=7,N=new Array(64),k=new Array(64),E=new Array(64),_=new Array(256),M=new Array(2048),D=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],U=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ee=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(Q,z){for(var W=0,Z=0,ne=new Array,fe=1;fe<=16;fe++){for(var xe=1;xe<=Q[fe];xe++)ne[z[Z]]=[],ne[z[Z]][0]=W,ne[z[Z]][1]=fe,Z++,W++;W*=2}return ne}function le(Q){for(var z=Q[0],W=Q[1]-1;W>=0;)z&1<<W&&(b|=1<<C),W--,--C<0&&(b==255?(ae(255),ae(0)):ae(b),C=7,b=0)}function ae(Q){y.push(Q)}function de(Q){ae(Q>>8&255),ae(255&Q)}function ue(Q,z,W,Z,ne){for(var fe,xe=ne[0],we=ne[240],Qe=function(Ue,Le){var He,Oe,tt,ut,mt,wt,Bt,kt,ot,yt,Ke=0;for(ot=0;ot<8;++ot){He=Ue[Ke],Oe=Ue[Ke+1],tt=Ue[Ke+2],ut=Ue[Ke+3],mt=Ue[Ke+4],wt=Ue[Ke+5],Bt=Ue[Ke+6];var An=He+(kt=Ue[Ke+7]),Ct=He-kt,yr=Oe+Bt,jt=Oe-Bt,Ot=tt+wt,_r=tt-wt,St=ut+mt,br=ut-mt,Wt=An+St,or=An-St,es=yr+Ot,Yt=yr-Ot;Ue[Ke]=Wt+es,Ue[Ke+4]=Wt-es;var dt=.707106781*(Yt+or);Ue[Ke+2]=or+dt,Ue[Ke+6]=or-dt;var ft=.382683433*((Wt=br+_r)-(Yt=jt+Ct)),ms=.5411961*Wt+ft,on=1.306562965*Yt+ft,vr=.707106781*(es=_r+jt),lr=Ct+vr,Ee=Ct-vr;Ue[Ke+5]=Ee+ms,Ue[Ke+3]=Ee-ms,Ue[Ke+1]=lr+on,Ue[Ke+7]=lr-on,Ke+=8}for(Ke=0,ot=0;ot<8;++ot){He=Ue[Ke],Oe=Ue[Ke+8],tt=Ue[Ke+16],ut=Ue[Ke+24],mt=Ue[Ke+32],wt=Ue[Ke+40],Bt=Ue[Ke+48];var Vn=He+(kt=Ue[Ke+56]),Fn=He-kt,Ln=Oe+Bt,en=Oe-Bt,$t=tt+wt,_n=tt-wt,ps=ut+mt,Br=ut-mt,cr=Vn+ps,dr=Vn-ps,mn=Ln+$t,Mr=Ln-$t;Ue[Ke]=cr+mn,Ue[Ke+32]=cr-mn;var qt=.707106781*(Mr+dr);Ue[Ke+16]=dr+qt,Ue[Ke+48]=dr-qt;var ur=.382683433*((cr=Br+_n)-(Mr=en+Fn)),xs=.5411961*cr+ur,na=1.306562965*Mr+ur,ra=.707106781*(mn=_n+en),Ls=Fn+ra,_s=Fn-ra;Ue[Ke+40]=_s+xs,Ue[Ke+24]=_s-xs,Ue[Ke+8]=Ls+na,Ue[Ke+56]=Ls-na,Ke++}for(ot=0;ot<64;++ot)yt=Ue[ot]*Le[ot],m[ot]=yt>0?yt+.5|0:yt-.5|0;return m}(Q,z),je=0;je<64;++je)B[D[je]]=Qe[je];var Me=B[0]-W;W=B[0],Me==0?le(Z[0]):(le(Z[p[fe=32767+Me]]),le(h[fe]));for(var De=63;De>0&&B[De]==0;)De--;if(De==0)return le(xe),W;for(var st,ve=1;ve<=De;){for(var $=ve;B[ve]==0&&ve<=De;)++ve;var At=ve-$;if(At>=16){st=At>>4;for(var et=1;et<=st;++et)le(we);At&=15}fe=32767+B[ve],le(ne[(At<<4)+p[fe]]),le(h[fe]),ve++}return De!=63&&le(xe),W}function Ce(Q){Q=Math.min(Math.max(Q,1),100),i!=Q&&(function(z){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Z=0;Z<64;Z++){var ne=A((W[Z]*z+50)/100);ne=Math.min(Math.max(ne,1),255),o[D[Z]]=ne}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],xe=0;xe<64;xe++){var we=A((fe[xe]*z+50)/100);we=Math.min(Math.max(we,1),255),l[D[xe]]=we}for(var Qe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],je=0,Me=0;Me<8;Me++)for(var De=0;De<8;De++)c[je]=1/(o[D[je]]*Qe[Me]*Qe[De]*8),d[je]=1/(l[D[je]]*Qe[Me]*Qe[De]*8),je++}(Q<50?Math.floor(5e3/Q):Math.floor(200-2*Q)),i=Q)}this.encode=function(Q,z){z&&Ce(z),y=new Array,b=0,C=7,de(65496),de(65504),de(16),ae(74),ae(70),ae(73),ae(70),ae(0),ae(1),ae(1),ae(0),de(1),de(1),ae(0),ae(0),function(){de(65499),de(132),ae(0);for(var Oe=0;Oe<64;Oe++)ae(o[Oe]);ae(1);for(var tt=0;tt<64;tt++)ae(l[tt])}(),function(Oe,tt){de(65472),de(17),ae(8),de(tt),de(Oe),ae(3),ae(1),ae(17),ae(0),ae(2),ae(17),ae(1),ae(3),ae(17),ae(1)}(Q.width,Q.height),function(){de(65476),de(418),ae(0);for(var Oe=0;Oe<16;Oe++)ae(U[Oe+1]);for(var tt=0;tt<=11;tt++)ae(j[tt]);ae(16);for(var ut=0;ut<16;ut++)ae(O[ut+1]);for(var mt=0;mt<=161;mt++)ae(F[mt]);ae(1);for(var wt=0;wt<16;wt++)ae(I[wt+1]);for(var Bt=0;Bt<=11;Bt++)ae(P[Bt]);ae(17);for(var kt=0;kt<16;kt++)ae(V[kt+1]);for(var ot=0;ot<=161;ot++)ae(ee[ot])}(),de(65498),de(12),ae(3),ae(1),ae(0),ae(2),ae(17),ae(3),ae(17),ae(0),ae(63),ae(0);var W=0,Z=0,ne=0;b=0,C=7,this.encode.displayName="_encode_";for(var fe,xe,we,Qe,je,Me,De,st,ve,$=Q.data,At=Q.width,et=Q.height,Ue=4*At,Le=0;Le<et;){for(fe=0;fe<Ue;){for(je=Ue*Le+fe,De=-1,st=0,ve=0;ve<64;ve++)Me=je+(st=ve>>3)*Ue+(De=4*(7&ve)),Le+st>=et&&(Me-=Ue*(Le+1+st-et)),fe+De>=Ue&&(Me-=fe+De-Ue+4),xe=$[Me++],we=$[Me++],Qe=$[Me++],N[ve]=(M[xe]+M[we+256>>0]+M[Qe+512>>0]>>16)-128,k[ve]=(M[xe+768>>0]+M[we+1024>>0]+M[Qe+1280>>0]>>16)-128,E[ve]=(M[xe+1280>>0]+M[we+1536>>0]+M[Qe+1792>>0]>>16)-128;W=ue(N,c,W,e,r),Z=ue(k,d,Z,n,a),ne=ue(E,d,ne,n,a),fe+=32}Le+=8}if(C>=0){var He=[];He[1]=C+1,He[0]=(1<<C+1)-1,le(He)}return de(65497),new Uint8Array(y)},t=t||50,function(){for(var Q=String.fromCharCode,z=0;z<256;z++)_[z]=Q(z)}(),e=X(U,j),n=X(I,P),r=X(O,F),a=X(V,ee),function(){for(var Q=1,z=2,W=1;W<=15;W++){for(var Z=Q;Z<z;Z++)p[32767+Z]=W,h[32767+Z]=[],h[32767+Z][1]=W,h[32767+Z][0]=Z;for(var ne=-(z-1);ne<=-Q;ne++)p[32767+ne]=W,h[32767+ne]=[],h[32767+ne][1]=W,h[32767+ne][0]=z-1+ne;Q<<=1,z<<=1}}(),function(){for(var Q=0;Q<256;Q++)M[Q]=19595*Q,M[Q+256>>0]=38470*Q,M[Q+512>>0]=7471*Q+32768,M[Q+768>>0]=-11059*Q,M[Q+1024>>0]=-21709*Q,M[Q+1280>>0]=32768*Q+8421375,M[Q+1536>>0]=-27439*Q,M[Q+1792>>0]=-5329*Q}(),Ce(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function As(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Vh(t){function e(U){if(!U)throw Error("assert :P")}function n(U,j,O){for(var F=0;4>F;F++)if(U[j+F]!=O.charCodeAt(F))return!0;return!1}function r(U,j,O,F,I){for(var P=0;P<I;P++)U[j+P]=O[F+P]}function a(U,j,O,F){for(var I=0;I<F;I++)U[j+I]=O}function i(U){return new Int32Array(U)}function A(U,j){for(var O=[],F=0;F<U;F++)O.push(new j);return O}function o(U,j){var O=[];return function F(I,P,V){for(var ee=V[P],X=0;X<ee&&(I.push(V.length>P+1?[]:new j),!(V.length<P+1));X++)F(I[X],P+1,V)}(O,0,U),O}var l=function(){var U=this;function j(f,x){for(var v=1<<x-1>>>0;f&v;)v>>>=1;return v?(f&v-1)+v:f}function O(f,x,v,S,T){e(!(S%v));do f[x+(S-=v)]=T;while(0<S)}function F(f,x,v,S,T){if(e(2328>=T),512>=T)var R=i(512);else if((R=i(T))==null)return 0;return function(H,G,K,J,re,me){var pe,ce,Ie=G,ye=1<<K,se=i(16),Ae=i(16);for(e(re!=0),e(J!=null),e(H!=null),e(0<K),ce=0;ce<re;++ce){if(15<J[ce])return 0;++se[J[ce]]}if(se[0]==re)return 0;for(Ae[1]=0,pe=1;15>pe;++pe){if(se[pe]>1<<pe)return 0;Ae[pe+1]=Ae[pe]+se[pe]}for(ce=0;ce<re;++ce)pe=J[ce],0<J[ce]&&(me[Ae[pe]++]=ce);if(Ae[15]==1)return(J=new I).g=0,J.value=me[0],O(H,Ie,1,ye,J),ye;var Ne,Fe=-1,Se=ye-1,We=0,Pe=1,at=1,Ve=1<<K;for(ce=0,pe=1,re=2;pe<=K;++pe,re<<=1){if(Pe+=at<<=1,0>(at-=se[pe]))return 0;for(;0<se[pe];--se[pe])(J=new I).g=pe,J.value=me[ce++],O(H,Ie+We,re,Ve,J),We=j(We,pe)}for(pe=K+1,re=2;15>=pe;++pe,re<<=1){if(Pe+=at<<=1,0>(at-=se[pe]))return 0;for(;0<se[pe];--se[pe]){if(J=new I,(We&Se)!=Fe){for(Ie+=Ve,Ne=1<<(Fe=pe)-K;15>Fe&&!(0>=(Ne-=se[Fe]));)++Fe,Ne<<=1;ye+=Ve=1<<(Ne=Fe-K),H[G+(Fe=We&Se)].g=Ne+K,H[G+Fe].value=Ie-G-Fe}J.g=pe-K,J.value=me[ce++],O(H,Ie+(We>>K),re,Ve,J),We=j(We,pe)}}return Pe!=2*Ae[15]-1?0:ye}(f,x,v,S,T,R)}function I(){this.value=this.g=0}function P(){this.value=this.g=0}function V(){this.G=A(5,I),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=A(Mn,P)}function ee(f,x,v,S){e(f!=null),e(x!=null),e(2147483648>S),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=x,f.pa=v,f.Jd=x,f.Yc=v+S,f.Zc=4<=S?v+S-4+1:v,fe(f)}function X(f,x){for(var v=0;0<x--;)v|=we(f,128)<<x;return v}function le(f,x){var v=X(f,x);return xe(f)?-v:v}function ae(f,x,v,S){var T,R=0;for(e(f!=null),e(x!=null),e(4294967288>S),f.Sb=S,f.Ra=0,f.u=0,f.h=0,4<S&&(S=4),T=0;T<S;++T)R+=x[v+T]<<8*T;f.Ra=R,f.bb=S,f.oa=x,f.pa=v}function de(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Ri-8>>>0,++f.bb,f.u-=8;W(f)&&(f.h=1,f.u=0)}function ue(f,x){if(e(0<=x),!f.h&&x<=Pi){var v=z(f)&Di[x];return f.u+=x,de(f),v}return f.h=1,f.u=0}function Ce(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function z(f){return f.Ra>>>(f.u&Ri-1)>>>0}function W(f){return e(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Ri}function Z(f,x){f.u=x,f.h=W(f)}function ne(f){f.u>=ro&&(e(f.u>=ro),de(f))}function fe(f){e(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(e(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function xe(f){return X(f,1)}function we(f,x){var v=f.Ca;0>f.b&&fe(f);var S=f.b,T=v*x>>>8,R=(f.I>>>S>T)+0;for(R?(v-=T,f.I-=T+1<<S>>>0):v=T+1,S=v,T=0;256<=S;)T+=8,S>>=8;return S=7^T+fr[S],f.b-=S,f.Ca=(v<<S)-1,R}function Qe(f,x,v){f[x+0]=v>>24&255,f[x+1]=v>>16&255,f[x+2]=v>>8&255,f[x+3]=v>>0&255}function je(f,x){return f[x+0]<<0|f[x+1]<<8}function Me(f,x){return je(f,x)|f[x+2]<<16}function De(f,x){return je(f,x)|je(f,x+2)<<16}function st(f,x){var v=1<<x;return e(f!=null),e(0<x),f.X=i(v),f.X==null?0:(f.Mb=32-x,f.Xa=x,1)}function ve(f,x){e(f!=null),e(x!=null),e(f.Xa==x.Xa),r(x.X,0,f.X,0,1<<x.Xa)}function $(){this.X=[],this.Xa=this.Mb=0}function At(f,x,v,S){e(v!=null),e(S!=null);var T=v[0],R=S[0];return T==0&&(T=(f*R+x/2)/x),R==0&&(R=(x*T+f/2)/f),0>=T||0>=R?0:(v[0]=T,S[0]=R,1)}function et(f,x){return f+(1<<x)-1>>>x}function Ue(f,x){return((4278255360&f)+(4278255360&x)>>>0&4278255360)+((16711935&f)+(16711935&x)>>>0&16711935)>>>0}function Le(f,x){U[x]=function(v,S,T,R,H,G,K){var J;for(J=0;J<H;++J){var re=U[f](G[K+J-1],T,R+J);G[K+J]=Ue(v[S+J],re)}}}function He(){this.ud=this.hd=this.jd=0}function Oe(f,x){return((4278124286&(f^x))>>>1)+(f&x)>>>0}function tt(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function ut(f,x){return tt(f+(f-x+.5>>1))}function mt(f,x,v){return Math.abs(x-v)-Math.abs(f-v)}function wt(f,x,v,S,T,R,H){for(S=R[H-1],v=0;v<T;++v)R[H+v]=S=Ue(f[x+v],S)}function Bt(f,x,v,S,T){var R;for(R=0;R<v;++R){var H=f[x+R],G=H>>8&255,K=16711935&(K=(K=16711935&H)+((G<<16)+G));S[T+R]=(4278255360&H)+K>>>0}}function kt(f,x){x.jd=f>>0&255,x.hd=f>>8&255,x.ud=f>>16&255}function ot(f,x,v,S,T,R){var H;for(H=0;H<S;++H){var G=x[v+H],K=G>>>8,J=G,re=255&(re=(re=G>>>16)+((f.jd<<24>>24)*(K<<24>>24)>>>5));J=255&(J=(J=J+((f.hd<<24>>24)*(K<<24>>24)>>>5))+((f.ud<<24>>24)*(re<<24>>24)>>>5)),T[R+H]=(4278255360&G)+(re<<16)+J}}function yt(f,x,v,S,T){U[x]=function(R,H,G,K,J,re,me,pe,ce){for(K=me;K<pe;++K)for(me=0;me<ce;++me)J[re++]=T(G[S(R[H++])])},U[f]=function(R,H,G,K,J,re,me){var pe=8>>R.b,ce=R.Ea,Ie=R.K[0],ye=R.w;if(8>pe)for(R=(1<<R.b)-1,ye=(1<<pe)-1;H<G;++H){var se,Ae=0;for(se=0;se<ce;++se)se&R||(Ae=S(K[J++])),re[me++]=T(Ie[Ae&ye]),Ae>>=pe}else U["VP8LMapColor"+v](K,J,Ie,ye,re,me,H,G,ce)}}function Ke(f,x,v,S,T){for(v=x+v;x<v;){var R=f[x++];S[T++]=R>>16&255,S[T++]=R>>8&255,S[T++]=R>>0&255}}function An(f,x,v,S,T){for(v=x+v;x<v;){var R=f[x++];S[T++]=R>>16&255,S[T++]=R>>8&255,S[T++]=R>>0&255,S[T++]=R>>24&255}}function Ct(f,x,v,S,T){for(v=x+v;x<v;){var R=(H=f[x++])>>16&240|H>>12&15,H=H>>0&240|H>>28&15;S[T++]=R,S[T++]=H}}function yr(f,x,v,S,T){for(v=x+v;x<v;){var R=(H=f[x++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;S[T++]=R,S[T++]=H}}function jt(f,x,v,S,T){for(v=x+v;x<v;){var R=f[x++];S[T++]=R>>0&255,S[T++]=R>>8&255,S[T++]=R>>16&255}}function Ot(f,x,v,S,T,R){if(R==0)for(v=x+v;x<v;)Qe(S,((R=f[x++])[0]>>24|R[1]>>8&65280|R[2]<<8&16711680|R[3]<<24)>>>0),T+=32;else r(S,T,f,x,v)}function _r(f,x){U[x][0]=U[f+"0"],U[x][1]=U[f+"1"],U[x][2]=U[f+"2"],U[x][3]=U[f+"3"],U[x][4]=U[f+"4"],U[x][5]=U[f+"5"],U[x][6]=U[f+"6"],U[x][7]=U[f+"7"],U[x][8]=U[f+"8"],U[x][9]=U[f+"9"],U[x][10]=U[f+"10"],U[x][11]=U[f+"11"],U[x][12]=U[f+"12"],U[x][13]=U[f+"13"],U[x][14]=U[f+"0"],U[x][15]=U[f+"0"]}function St(f){return f==wd||f==yd||f==ml||f==bd}function br(){this.eb=[],this.size=this.A=this.fb=0}function Wt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function or(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new br,this.f.kb=new Wt,this.sd=null}function es(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Yt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function dt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function ft(f,x){var v=f.T,S=x.ba.f.RGBA,T=S.eb,R=S.fb+f.ka*S.A,H=Vr[x.ba.S],G=f.y,K=f.O,J=f.f,re=f.N,me=f.ea,pe=f.W,ce=x.cc,Ie=x.dc,ye=x.Mc,se=x.Nc,Ae=f.ka,Ne=f.ka+f.T,Fe=f.U,Se=Fe+1>>1;for(Ae==0?H(G,K,null,null,J,re,me,pe,J,re,me,pe,T,R,null,null,Fe):(H(x.ec,x.fc,G,K,ce,Ie,ye,se,J,re,me,pe,T,R-S.A,T,R,Fe),++v);Ae+2<Ne;Ae+=2)ce=J,Ie=re,ye=me,se=pe,re+=f.Rc,pe+=f.Rc,R+=2*S.A,H(G,(K+=2*f.fa)-f.fa,G,K,ce,Ie,ye,se,J,re,me,pe,T,R-S.A,T,R,Fe);return K+=f.fa,f.j+Ne<f.o?(r(x.ec,x.fc,G,K,Fe),r(x.cc,x.dc,J,re,Se),r(x.Mc,x.Nc,me,pe,Se),v--):1&Ne||H(G,K,null,null,J,re,me,pe,J,re,me,pe,T,R+S.A,null,null,Fe),v}function ms(f,x,v){var S=f.F,T=[f.J];if(S!=null){var R=f.U,H=x.ba.S,G=H==gl||H==ml;x=x.ba.f.RGBA;var K=[0],J=f.ka;K[0]=f.T,f.Kb&&(J==0?--K[0]:(--J,T[0]-=f.width),f.j+f.ka+f.T==f.o&&(K[0]=f.o-f.j-J));var re=x.eb;J=x.fb+J*x.A,f=Vt(S,T[0],f.width,R,K,re,J+(G?0:3),x.A),e(v==K),f&&St(H)&&Or(re,J,G,R,K,x.A)}return 0}function on(f){var x=f.ma,v=x.ba.S,S=11>v,T=v==fl||v==hl||v==gl||v==xd||v==12||St(v);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!to(x.Oa,f,T?11:12))return 0;if(T&&St(v)&&ke(),f.da)alert("todo:use_scaling");else{if(S){if(x.Ib=dt,f.Kb){if(v=f.U+1>>1,x.memory=i(f.U+2*v),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+f.U,x.Mc=x.cc,x.Nc=x.dc+v,x.Ib=ft,ke()}}else alert("todo:EmitYUV");T&&(x.Jb=ms,S&&he())}if(S&&!Wf){for(f=0;256>f;++f)Sw[f]=89858*(f-128)+xl>>pl,Ew[f]=-22014*(f-128)+xl,Fw[f]=-45773*(f-128),Iw[f]=113618*(f-128)+xl>>pl;for(f=co;f<Cd;++f)x=76283*(f-16)+xl>>pl,kw[f-co]=Ir(x,255),Uw[f-co]=Ir(x+8>>4,15);Wf=1}return 1}function vr(f){var x=f.ma,v=f.U,S=f.T;return e(!(1&f.ka)),0>=v||0>=S?0:(v=x.Ib(f,x),x.Jb!=null&&x.Jb(f,x,v),x.Dc+=v,1)}function lr(f){f.ma.memory=null}function Ee(f,x,v,S){return ue(f,8)!=47?0:(x[0]=ue(f,14)+1,v[0]=ue(f,14)+1,S[0]=ue(f,1),ue(f,3)!=0?0:!f.h)}function Vn(f,x){if(4>f)return f+1;var v=f-2>>1;return(2+(1&f)<<v)+ue(x,v)+1}function Fn(f,x){return 120<x?x-120:1<=(v=((v=uw[x-1])>>4)*f+(8-(15&v)))?v:1;var v}function Ln(f,x,v){var S=z(v),T=f[x+=255&S].g-8;return 0<T&&(Z(v,v.u+8),S=z(v),x+=f[x].value,x+=S&(1<<T)-1),Z(v,v.u+f[x].g),f[x].value}function en(f,x,v){return v.g+=f.g,v.value+=f.value<<x>>>0,e(8>=v.g),f.g}function $t(f,x,v){var S=f.xc;return e((x=S==0?0:f.vc[f.md*(v>>S)+(x>>S)])<f.Wb),f.Ya[x]}function _n(f,x,v,S){var T=f.ab,R=f.c*x,H=f.C;x=H+x;var G=v,K=S;for(S=f.Ta,v=f.Ua;0<T--;){var J=f.gc[T],re=H,me=x,pe=G,ce=K,Ie=(K=S,G=v,J.Ea);switch(e(re<me),e(me<=J.nc),J.hc){case 2:il(pe,ce,(me-re)*Ie,K,G);break;case 0:var ye=re,se=me,Ae=K,Ne=G,Fe=(Ve=J).Ea;ye==0&&(md(pe,ce,null,null,1,Ae,Ne),wt(pe,ce+1,0,0,Fe-1,Ae,Ne+1),ce+=Fe,Ne+=Fe,++ye);for(var Se=1<<Ve.b,We=Se-1,Pe=et(Fe,Ve.b),at=Ve.K,Ve=Ve.w+(ye>>Ve.b)*Pe;ye<se;){var Et=at,Tt=Ve,It=1;for(so(pe,ce,Ae,Ne-Fe,1,Ae,Ne);It<Fe;){var bt=(It&~We)+Se;bt>Fe&&(bt=Fe),(0,la[Et[Tt++]>>8&15])(pe,ce+ +It,Ae,Ne+It-Fe,bt-It,Ae,Ne+It),It=bt}ce+=Fe,Ne+=Fe,++ye&We||(Ve+=Pe)}me!=J.nc&&r(K,G-Ie,K,G+(me-re-1)*Ie,Ie);break;case 1:for(Ie=pe,se=ce,Fe=(pe=J.Ea)-(Ne=pe&~(Ae=(ce=1<<J.b)-1)),ye=et(pe,J.b),Se=J.K,J=J.w+(re>>J.b)*ye;re<me;){for(We=Se,Pe=J,at=new He,Ve=se+Ne,Et=se+pe;se<Ve;)kt(We[Pe++],at),Wa(at,Ie,se,ce,K,G),se+=ce,G+=ce;se<Et&&(kt(We[Pe++],at),Wa(at,Ie,se,Fe,K,G),se+=Fe,G+=Fe),++re&Ae||(J+=ye)}break;case 3:if(pe==K&&ce==G&&0<J.b){for(se=K,pe=Ie=G+(me-re)*Ie-(Ne=(me-re)*et(J.Ea,J.b)),ce=K,Ae=G,ye=[],Ne=(Fe=Ne)-1;0<=Ne;--Ne)ye[Ne]=ce[Ae+Ne];for(Ne=Fe-1;0<=Ne;--Ne)se[pe+Ne]=ye[Ne];Pr(J,re,me,K,Ie,K,G)}else Pr(J,re,me,pe,ce,K,G)}G=S,K=v}K!=v&&r(S,v,G,K,R)}function ps(f,x){var v=f.V,S=f.Ba+f.c*f.C,T=x-f.C;if(e(x<=f.l.o),e(16>=T),0<T){var R=f.l,H=f.Ta,G=f.Ua,K=R.width;if(_n(f,T,v,S),T=G=[G],e((v=f.C)<(S=x)),e(R.v<R.va),S>R.o&&(S=R.o),v<R.j){var J=R.j-v;v=R.j,T[0]+=J*K}if(v>=S?v=0:(T[0]+=4*R.v,R.ka=v-R.j,R.U=R.va-R.v,R.T=S-v,v=1),v){if(G=G[0],11>(v=f.ca).S){var re=v.f.RGBA,me=(S=v.S,T=R.U,R=R.T,J=re.eb,re.A),pe=R;for(re=re.fb+f.Ma*re.A;0<pe--;){var ce=H,Ie=G,ye=T,se=J,Ae=re;switch(S){case ul:hr(ce,Ie,ye,se,Ae);break;case fl:nr(ce,Ie,ye,se,Ae);break;case wd:nr(ce,Ie,ye,se,Ae),Or(se,Ae,0,ye,1,0);break;case Rf:Rs(ce,Ie,ye,se,Ae);break;case hl:Ot(ce,Ie,ye,se,Ae,1);break;case yd:Ot(ce,Ie,ye,se,Ae,1),Or(se,Ae,0,ye,1,0);break;case gl:Ot(ce,Ie,ye,se,Ae,0);break;case ml:Ot(ce,Ie,ye,se,Ae,0),Or(se,Ae,1,ye,1,0);break;case xd:ca(ce,Ie,ye,se,Ae);break;case bd:ca(ce,Ie,ye,se,Ae),Gt(se,Ae,ye,1,0);break;case Hf:Ps(ce,Ie,ye,se,Ae);break;default:e(0)}G+=K,re+=me}f.Ma+=R}else alert("todo:EmitRescaledRowsYUVA");e(f.Ma<=v.height)}}f.C=x,e(f.C<=f.i)}function Br(f){var x;if(0<f.ua)return 0;for(x=0;x<f.Wb;++x){var v=f.Ya[x].G,S=f.Ya[x].H;if(0<v[1][S[1]+0].g||0<v[2][S[2]+0].g||0<v[3][S[3]+0].g)return 0}return 1}function cr(f,x,v,S,T,R){if(f.Z!=0){var H=f.qd,G=f.rd;for(e(ha[f.Z]!=null);x<v;++x)ha[f.Z](H,G,S,T,S,T,R),H=S,G=T,T+=R;f.qd=H,f.rd=G}}function dr(f,x){var v=f.l.ma,S=v.Z==0||v.Z==1?f.l.j:f.C;if(S=f.C<S?S:f.C,e(x<=f.l.o),x>S){var T=f.l.width,R=v.ca,H=v.tb+T*S,G=f.V,K=f.Ba+f.c*S,J=f.gc;e(f.ab==1),e(J[0].hc==3),Al(J[0],S,x,G,K,R,H),cr(v,S,x,R,H,T)}f.C=f.Ma=x}function mn(f,x,v,S,T,R,H){var G=f.$/S,K=f.$%S,J=f.m,re=f.s,me=v+f.$,pe=me;T=v+S*T;var ce=v+S*R,Ie=280+re.ua,ye=f.Pb?G:16777216,se=0<re.ua?re.Wa:null,Ae=re.wc,Ne=me<ce?$t(re,K,G):null;e(f.C<R),e(ce<=T);var Fe=!1;e:for(;;){for(;Fe||me<ce;){var Se=0;if(G>=ye){var We=me-v;e((ye=f).Pb),ye.wd=ye.m,ye.xd=We,0<ye.s.ua&&ve(ye.s.Wa,ye.s.vb),ye=G+hw}if(K&Ae||(Ne=$t(re,K,G)),e(Ne!=null),Ne.Qb&&(x[me]=Ne.qb,Fe=!0),!Fe)if(ne(J),Ne.jc){Se=J,We=x;var Pe=me,at=Ne.pd[z(Se)&Mn-1];e(Ne.jc),256>at.g?(Z(Se,Se.u+at.g),We[Pe]=at.value,Se=0):(Z(Se,Se.u+at.g-256),e(256<=at.value),Se=at.value),Se==0&&(Fe=!0)}else Se=Ln(Ne.G[0],Ne.H[0],J);if(J.h)break;if(Fe||256>Se){if(!Fe)if(Ne.nd)x[me]=(Ne.qb|Se<<8)>>>0;else{if(ne(J),Fe=Ln(Ne.G[1],Ne.H[1],J),ne(J),We=Ln(Ne.G[2],Ne.H[2],J),Pe=Ln(Ne.G[3],Ne.H[3],J),J.h)break;x[me]=(Pe<<24|Fe<<16|Se<<8|We)>>>0}if(Fe=!1,++me,++K>=S&&(K=0,++G,H!=null&&G<=R&&!(G%16)&&H(f,G),se!=null))for(;pe<me;)Se=x[pe++],se.X[(506832829*Se&4294967295)>>>se.Mb]=Se}else if(280>Se){if(Se=Vn(Se-256,J),We=Ln(Ne.G[4],Ne.H[4],J),ne(J),We=Fn(S,We=Vn(We,J)),J.h)break;if(me-v<We||T-me<Se)break e;for(Pe=0;Pe<Se;++Pe)x[me+Pe]=x[me+Pe-We];for(me+=Se,K+=Se;K>=S;)K-=S,++G,H!=null&&G<=R&&!(G%16)&&H(f,G);if(e(me<=T),K&Ae&&(Ne=$t(re,K,G)),se!=null)for(;pe<me;)Se=x[pe++],se.X[(506832829*Se&4294967295)>>>se.Mb]=Se}else{if(!(Se<Ie))break e;for(Fe=Se-280,e(se!=null);pe<me;)Se=x[pe++],se.X[(506832829*Se&4294967295)>>>se.Mb]=Se;Se=me,e(!(Fe>>>(We=se).Xa)),x[Se]=We.X[Fe],Fe=!0}Fe||e(J.h==W(J))}if(f.Pb&&J.h&&me<T)e(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&ve(f.s.vb,f.s.Wa);else{if(J.h)break e;H!=null&&H(f,G>R?R:G),f.a=0,f.$=me-v}return 1}return f.a=3,0}function Mr(f){e(f!=null),f.vc=null,f.yc=null,f.Ya=null;var x=f.Wa;x!=null&&(x.X=null),f.vb=null,e(f!=null)}function qt(){var f=new gd;return f==null?null:(f.a=0,f.xb=Vf,_r("Predictor","VP8LPredictors"),_r("Predictor","VP8LPredictors_C"),_r("PredictorAdd","VP8LPredictorsAdd"),_r("PredictorAdd","VP8LPredictorsAdd_C"),il=Bt,Wa=ot,hr=Ke,nr=An,ca=Ct,Ps=yr,Rs=jt,U.VP8LMapColor32b=Hi,U.VP8LMapColor8b=ol,f)}function ur(f,x,v,S,T){var R=1,H=[f],G=[x],K=S.m,J=S.s,re=null,me=0;e:for(;;){if(v)for(;R&&ue(K,1);){var pe=H,ce=G,Ie=S,ye=1,se=Ie.m,Ae=Ie.gc[Ie.ab],Ne=ue(se,2);if(Ie.Oc&1<<Ne)R=0;else{switch(Ie.Oc|=1<<Ne,Ae.hc=Ne,Ae.Ea=pe[0],Ae.nc=ce[0],Ae.K=[null],++Ie.ab,e(4>=Ie.ab),Ne){case 0:case 1:Ae.b=ue(se,3)+2,ye=ur(et(Ae.Ea,Ae.b),et(Ae.nc,Ae.b),0,Ie,Ae.K),Ae.K=Ae.K[0];break;case 3:var Fe,Se=ue(se,8)+1,We=16<Se?0:4<Se?1:2<Se?2:3;if(pe[0]=et(Ae.Ea,We),Ae.b=We,Fe=ye=ur(Se,1,0,Ie,Ae.K)){var Pe,at=Se,Ve=Ae,Et=1<<(8>>Ve.b),Tt=i(Et);if(Tt==null)Fe=0;else{var It=Ve.K[0],bt=Ve.w;for(Tt[0]=Ve.K[0][0],Pe=1;Pe<1*at;++Pe)Tt[Pe]=Ue(It[bt+Pe],Tt[Pe-1]);for(;Pe<4*Et;++Pe)Tt[Pe]=0;Ve.K[0]=null,Ve.K[0]=Tt,Fe=1}}ye=Fe;break;case 2:break;default:e(0)}R=ye}}if(H=H[0],G=G[0],R&&ue(K,1)&&!(R=1<=(me=ue(K,4))&&11>=me)){S.a=3;break e}var Rt;if(Rt=R)t:{var Mt,xt,xn,gr=S,wn=H,mr=G,Qt=me,Er=v,kr=gr.m,kn=gr.s,Dn=[null],sr=1,Kr=0,Cs=fw[Qt];n:for(;;){if(Er&&ue(kr,1)){var Un=ue(kr,3)+2,Vs=et(wn,Un),ei=et(mr,Un),qi=Vs*ei;if(!ur(Vs,ei,0,gr,Dn))break n;for(Dn=Dn[0],kn.xc=Un,Mt=0;Mt<qi;++Mt){var ga=Dn[Mt]>>8&65535;Dn[Mt]=ga,ga>=sr&&(sr=ga+1)}}if(kr.h)break n;for(xt=0;5>xt;++xt){var sn=Of[xt];!xt&&0<Qt&&(sn+=1<<Qt),Kr<sn&&(Kr=sn)}var Nd=A(sr*Cs,I),Xf=sr,Zf=A(Xf,V);if(Zf==null)var yl=null;else e(65536>=Xf),yl=Zf;var uo=i(Kr);if(yl==null||uo==null||Nd==null){gr.a=1;break n}var bl=Nd;for(Mt=xn=0;Mt<sr;++Mt){var as=yl[Mt],zi=as.G,Ji=as.H,eh=0,vl=1,th=0;for(xt=0;5>xt;++xt){sn=Of[xt],zi[xt]=bl,Ji[xt]=xn,!xt&&0<Qt&&(sn+=1<<Qt);s:{var Bl,Sd=sn,Cl=gr,fo=uo,Qw=bl,Lw=xn,Id=0,ma=Cl.m,_w=ue(ma,1);if(a(fo,0,0,Sd),_w){var Mw=ue(ma,1)+1,Dw=ue(ma,1),nh=ue(ma,Dw==0?1:8);fo[nh]=1,Mw==2&&(fo[nh=ue(ma,8)]=1);var Nl=1}else{var rh=i(19),sh=ue(ma,4)+4;if(19<sh){Cl.a=3;var Sl=0;break s}for(Bl=0;Bl<sh;++Bl)rh[dw[Bl]]=ue(ma,3);var Fd=void 0,ho=void 0,ah=Cl,Pw=rh,Il=Sd,ih=fo,Ed=0,pa=ah.m,Ah=8,oh=A(128,I);r:for(;F(oh,0,7,Pw,19);){if(ue(pa,1)){var Rw=2+2*ue(pa,3);if((Fd=2+ue(pa,Rw))>Il)break r}else Fd=Il;for(ho=0;ho<Il&&Fd--;){ne(pa);var lh=oh[0+(127&z(pa))];Z(pa,pa.u+lh.g);var Wi=lh.value;if(16>Wi)ih[ho++]=Wi,Wi!=0&&(Ah=Wi);else{var Hw=Wi==16,ch=Wi-16,Ow=lw[ch],dh=ue(pa,ow[ch])+Ow;if(ho+dh>Il)break r;for(var Gw=Hw?Ah:0;0<dh--;)ih[ho++]=Gw}}Ed=1;break r}Ed||(ah.a=3),Nl=Ed}(Nl=Nl&&!ma.h)&&(Id=F(Qw,Lw,8,fo,Sd)),Nl&&Id!=0?Sl=Id:(Cl.a=3,Sl=0)}if(Sl==0)break n;if(vl&&cw[xt]==1&&(vl=bl[xn].g==0),eh+=bl[xn].g,xn+=Sl,3>=xt){var go,kd=uo[0];for(go=1;go<sn;++go)uo[go]>kd&&(kd=uo[go]);th+=kd}}if(as.nd=vl,as.Qb=0,vl&&(as.qb=(zi[3][Ji[3]+0].value<<24|zi[1][Ji[1]+0].value<<16|zi[2][Ji[2]+0].value)>>>0,eh==0&&256>zi[0][Ji[0]+0].value&&(as.Qb=1,as.qb+=zi[0][Ji[0]+0].value<<8)),as.jc=!as.Qb&&6>th,as.jc){var Fl,Ks=as;for(Fl=0;Fl<Mn;++Fl){var xa=Fl,wa=Ks.pd[xa],El=Ks.G[0][Ks.H[0]+xa];256<=El.value?(wa.g=El.g+256,wa.value=El.value):(wa.g=0,wa.value=0,xa>>=en(El,8,wa),xa>>=en(Ks.G[1][Ks.H[1]+xa],16,wa),xa>>=en(Ks.G[2][Ks.H[2]+xa],0,wa),en(Ks.G[3][Ks.H[3]+xa],24,wa))}}}kn.vc=Dn,kn.Wb=sr,kn.Ya=yl,kn.yc=Nd,Rt=1;break t}Rt=0}if(!(R=Rt)){S.a=3;break e}if(0<me){if(J.ua=1<<me,!st(J.Wa,me)){S.a=1,R=0;break e}}else J.ua=0;var Ud=S,uh=H,Vw=G,jd=Ud.s,Td=jd.xc;if(Ud.c=uh,Ud.i=Vw,jd.md=et(uh,Td),jd.wc=Td==0?-1:(1<<Td)-1,v){S.xb=bw;break e}if((re=i(H*G))==null){S.a=1,R=0;break e}R=(R=mn(S,re,0,H,G,G,null))&&!K.h;break e}return R?(T!=null?T[0]=re:(e(re==null),e(v)),S.$=0,v||Mr(J)):Mr(J),R}function xs(f,x){var v=f.c*f.i,S=v+x+16*x;return e(f.c<=x),f.V=i(S),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+v+x,1)}function na(f,x){var v=f.C,S=x-v,T=f.V,R=f.Ba+f.c*v;for(e(x<=f.l.o);0<S;){var H=16<S?16:S,G=f.l.ma,K=f.l.width,J=K*H,re=G.ca,me=G.tb+K*v,pe=f.Ta,ce=f.Ua;_n(f,H,T,R),cn(pe,ce,re,me,J),cr(G,v,v+H,re,me,K),S-=H,T+=H*f.c,v+=H}e(v==x),f.C=f.Ma=x}function ra(){this.ub=this.yd=this.td=this.Rb=0}function Ls(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function _s(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function yi(){this.Yb=function(){var f=[];return function x(v,S,T){for(var R=T[S],H=0;H<R&&(v.push(T.length>S+1?[]:0),!(T.length<S+1));H++)x(v[H],S+1,T)}(f,0,[3,11]),f}()}function LA(){this.jb=i(3),this.Wc=o([4,8],yi),this.Xc=o([4,17],yi)}function _A(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Ms(){this.ld=this.La=this.dd=this.tc=0}function bi(){this.Na=this.la=0}function vi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Pa(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Bi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ms),this.Y=0,this.ya=Array(new Pa),this.aa=0,this.l=new sa}function Ra(){this.y=i(16),this.f=i(8),this.ea=i(8)}function MA(){this.cb=this.a=0,this.sc="",this.m=new Ce,this.Od=new ra,this.Kc=new Ls,this.ed=new _A,this.Qa=new _s,this.Ic=this.$c=this.Aa=0,this.D=new Bi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=A(8,Ce),this.ia=0,this.pb=A(4,vi),this.Pa=new LA,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ra),this.Hd=0,this.rb=Array(new bi),this.sb=0,this.wa=Array(new Ms),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Pa),this.L=this.aa=0,this.gd=o([4,2],Ms),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function sa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function DA(){var f=new MA;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,lo||(lo=Ni)),f}function Xt(f,x,v){return f.a==0&&(f.a=x,f.sc=v,f.cb=0),0}function Ha(f,x,v){return 3<=v&&f[x+0]==157&&f[x+1]==1&&f[x+2]==42}function Ci(f,x){if(f==null)return 0;if(f.a=0,f.sc="OK",x==null)return Xt(f,2,"null VP8Io passed to VP8GetHeaders()");var v=x.data,S=x.w,T=x.ha;if(4>T)return Xt(f,7,"Truncated header.");var R=v[S+0]|v[S+1]<<8|v[S+2]<<16,H=f.Od;if(H.Rb=!(1&R),H.td=R>>1&7,H.yd=R>>4&1,H.ub=R>>5,3<H.td)return Xt(f,3,"Incorrect keyframe parameters.");if(!H.yd)return Xt(f,4,"Frame not displayable.");S+=3,T-=3;var G=f.Kc;if(H.Rb){if(7>T)return Xt(f,7,"cannot parse picture header");if(!Ha(v,S,T))return Xt(f,3,"Bad code word");G.c=16383&(v[S+4]<<8|v[S+3]),G.Td=v[S+4]>>6,G.i=16383&(v[S+6]<<8|v[S+5]),G.Ud=v[S+6]>>6,S+=7,T-=7,f.za=G.c+15>>4,f.Ub=G.i+15>>4,x.width=G.c,x.height=G.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,a((R=f.Pa).jb,0,255,R.jb.length),e((R=f.Qa)!=null),R.Cb=0,R.Bb=0,R.Fb=1,a(R.Zb,0,0,R.Zb.length),a(R.Lb,0,0,R.Lb)}if(H.ub>T)return Xt(f,7,"bad partition length");ee(R=f.m,v,S,H.ub),S+=H.ub,T-=H.ub,H.Rb&&(G.Ld=xe(R),G.Kd=xe(R)),G=f.Qa;var K,J=f.Pa;if(e(R!=null),e(G!=null),G.Cb=xe(R),G.Cb){if(G.Bb=xe(R),xe(R)){for(G.Fb=xe(R),K=0;4>K;++K)G.Zb[K]=xe(R)?le(R,7):0;for(K=0;4>K;++K)G.Lb[K]=xe(R)?le(R,6):0}if(G.Bb)for(K=0;3>K;++K)J.jb[K]=xe(R)?X(R,8):255}else G.Bb=0;if(R.Ka)return Xt(f,3,"cannot parse segment header");if((G=f.ed).zd=xe(R),G.Tb=X(R,6),G.wb=X(R,3),G.Pc=xe(R),G.Pc&&xe(R)){for(J=0;4>J;++J)xe(R)&&(G.vd[J]=le(R,6));for(J=0;4>J;++J)xe(R)&&(G.od[J]=le(R,6))}if(f.L=G.Tb==0?0:G.zd?1:2,R.Ka)return Xt(f,3,"cannot parse filter header");var re=T;if(T=K=S,S=K+re,G=re,f.Xb=(1<<X(f.m,2))-1,re<3*(J=f.Xb))v=7;else{for(K+=3*J,G-=3*J,re=0;re<J;++re){var me=v[T+0]|v[T+1]<<8|v[T+2]<<16;me>G&&(me=G),ee(f.Jc[+re],v,K,me),K+=me,G-=me,T+=3}ee(f.Jc[+J],v,K,G),v=K<S?0:5}if(v!=0)return Xt(f,v,"cannot parse partitions");for(v=X(K=f.m,7),T=xe(K)?le(K,4):0,S=xe(K)?le(K,4):0,G=xe(K)?le(K,4):0,J=xe(K)?le(K,4):0,K=xe(K)?le(K,4):0,re=f.Qa,me=0;4>me;++me){if(re.Cb){var pe=re.Zb[me];re.Fb||(pe+=v)}else{if(0<me){f.pb[me]=f.pb[0];continue}pe=v}var ce=f.pb[me];ce.Sc[0]=vd[Ir(pe+T,127)],ce.Sc[1]=Bd[Ir(pe+0,127)],ce.Eb[0]=2*vd[Ir(pe+S,127)],ce.Eb[1]=101581*Bd[Ir(pe+G,127)]>>16,8>ce.Eb[1]&&(ce.Eb[1]=8),ce.Qc[0]=vd[Ir(pe+J,117)],ce.Qc[1]=Bd[Ir(pe+K,127)],ce.lc=pe+K}if(!H.Rb)return Xt(f,4,"Not a key frame.");for(xe(R),H=f.Pa,v=0;4>v;++v){for(T=0;8>T;++T)for(S=0;3>S;++S)for(G=0;11>G;++G)J=we(R,ww[v][T][S][G])?X(R,8):pw[v][T][S][G],H.Wc[v][T].Yb[S][G]=J;for(T=0;17>T;++T)H.Xc[v][T]=H.Wc[v][yw[T]]}return f.kc=xe(R),f.kc&&(f.Bd=X(R,8)),f.cb=1}function Ni(f,x,v,S,T,R,H){var G=x[T].Yb[v];for(v=0;16>T;++T){if(!we(f,G[v+0]))return T;for(;!we(f,G[v+1]);)if(G=x[++T].Yb[0],v=0,T==16)return 16;var K=x[T+1].Yb;if(we(f,G[v+2])){var J=f,re=0;if(we(J,(pe=G)[(me=v)+3]))if(we(J,pe[me+6])){for(G=0,me=2*(re=we(J,pe[me+8]))+(pe=we(J,pe[me+9+re])),re=0,pe=gw[me];pe[G];++G)re+=re+we(J,pe[G]);re+=3+(8<<me)}else we(J,pe[me+7])?(re=7+2*we(J,165),re+=we(J,145)):re=5+we(J,159);else re=we(J,pe[me+4])?3+we(J,pe[me+5]):2;G=K[2]}else re=1,G=K[1];K=H+mw[T],0>(J=f).b&&fe(J);var me,pe=J.b,ce=(me=J.Ca>>1)-(J.I>>pe)>>31;--J.b,J.Ca+=ce,J.Ca|=1,J.I-=(me+1&ce)<<pe,R[K]=((re^ce)-ce)*S[(0<T)+0]}return 16}function Oa(f){var x=f.rb[f.sb-1];x.la=0,x.Na=0,a(f.zc,0,0,f.zc.length),f.ja=0}function PA(f,x){if(f==null)return 0;if(x==null)return Xt(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!Ci(f,x))return 0;if(e(f.cb),x.ac==null||x.ac(x)){x.ob&&(f.L=0);var v=wl[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=x.v-v>>4,f.zb=x.j-v>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=x.o+15+v>>4,f.Hb=x.va+15+v>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var S=f.ed;for(v=0;4>v;++v){var T;if(f.Qa.Cb){var R=f.Qa.Lb[v];f.Qa.Fb||(R+=S.Tb)}else R=S.Tb;for(T=0;1>=T;++T){var H=f.gd[v][T],G=R;if(S.Pc&&(G+=S.vd[0],T&&(G+=S.od[0])),0<(G=0>G?0:63<G?63:G)){var K=G;0<S.wb&&(K=4<S.wb?K>>2:K>>1)>9-S.wb&&(K=9-S.wb),1>K&&(K=1),H.dd=K,H.tc=2*G+K,H.ld=40<=G?2:15<=G?1:0}else H.tc=0;H.La=T}}}v=0}else Xt(f,6,"Frame setup failed"),v=f.a;if(v=v==0){if(v){f.$c=0,0<f.Aa||(f.Ic=Tw);e:{v=f.Ic,S=4*(K=f.za);var J=32*K,re=K+1,me=0<f.L?K*(0<f.Aa?2:1):0,pe=(f.Aa==2?2:1)*K;if((H=S+832+(T=3*(16*v+wl[f.L])/2*J)+(R=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=H)v=0;else{if(H>f.Vb){if(f.Vb=0,f.Ec=i(H),f.Fc=0,f.Ec==null){v=Xt(f,1,"no memory during frame initialization.");break e}f.Vb=H}H=f.Ec,G=f.Fc,f.Ac=H,f.Bc=G,G+=S,f.Gd=A(J,Ra),f.Hd=0,f.rb=A(re+1,bi),f.sb=1,f.wa=me?A(me,Ms):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=K),e(!0),f.oc=H,f.pc=G,G+=832,f.ya=A(pe,Pa),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=K),f.R=16*K,f.B=8*K,K=(J=wl[f.L])*f.R,J=J/2*f.B,f.sa=H,f.ta=G+K,f.qa=f.sa,f.ra=f.ta+16*v*f.R+J,f.Ha=f.qa,f.Ia=f.ra+8*v*f.B+J,f.$c=0,G+=T,f.mb=R?H:null,f.nb=R?G:null,e(G+R<=f.Fc+f.Vb),Oa(f),a(f.Ac,f.Bc,0,S),v=1}}if(v){if(x.ka=0,x.y=f.sa,x.O=f.ta,x.f=f.qa,x.N=f.ra,x.ea=f.Ha,x.Vd=f.Ia,x.fa=f.R,x.Rc=f.B,x.F=null,x.J=0,!cl){for(v=-255;255>=v;++v)vn[255+v]=0>v?-v:v;for(v=-1020;1020>=v;++v)Os[1020+v]=-128>v?-128:127<v?127:v;for(v=-112;112>=v;++v)oo[112+v]=-16>v?-16:15<v?15:v;for(v=-255;510>=v;++v)Ki[255+v]=0>v?0:255<v?255:v;cl=1}Oi=Ei,Hs=RA,ao=Ii,rr=HA,Rr=Fi,ln=Si,Gi=qA,ll=za,io=hd,Ya=zA,$a=fd,da=Ti,Xa=JA,Vi=rl,Za=nl,ua=vs,Ao=Ds,Hr=ud,ss[0]=Dr,ss[1]=OA,ss[2]=ws,ss[3]=ia,ss[4]=Ui,ss[5]=oe,ss[6]=qa,ss[7]=ie,ss[8]=_e,ss[9]=ge,fa[0]=Sr,fa[1]=VA,fa[2]=ts,fa[3]=nn,fa[4]=bn,fa[5]=ki,fa[6]=Ka,Gs[0]=Pt,Gs[1]=GA,Gs[2]=Re,Gs[3]=Ye,Gs[4]=bs,Gs[5]=ys,Gs[6]=KA,v=1}else v=0}v&&(v=function(ce,Ie){for(ce.M=0;ce.M<ce.Va;++ce.M){var ye,se=ce.Jc[ce.M&ce.Xb],Ae=ce.m,Ne=ce;for(ye=0;ye<Ne.za;++ye){var Fe=Ae,Se=Ne,We=Se.Ac,Pe=Se.Bc+4*ye,at=Se.zc,Ve=Se.ya[Se.aa+ye];if(Se.Qa.Bb?Ve.$b=we(Fe,Se.Pa.jb[0])?2+we(Fe,Se.Pa.jb[2]):we(Fe,Se.Pa.jb[1]):Ve.$b=0,Se.kc&&(Ve.Ad=we(Fe,Se.Bd)),Ve.Za=!we(Fe,145)+0,Ve.Za){var Et=Ve.Ob,Tt=0;for(Se=0;4>Se;++Se){var It,bt=at[0+Se];for(It=0;4>It;++It){bt=xw[We[Pe+It]][bt];for(var Rt=Gf[we(Fe,bt[0])];0<Rt;)Rt=Gf[2*Rt+we(Fe,bt[Rt])];bt=-Rt,We[Pe+It]=bt}r(Et,Tt,We,Pe,4),Tt+=4,at[0+Se]=bt}}else bt=we(Fe,156)?we(Fe,128)?1:3:we(Fe,163)?2:0,Ve.Ob[0]=bt,a(We,Pe,bt,4),a(at,0,bt,4);Ve.Dd=we(Fe,142)?we(Fe,114)?we(Fe,183)?1:3:2:0}if(Ne.m.Ka)return Xt(ce,7,"Premature end-of-partition0 encountered.");for(;ce.ja<ce.za;++ce.ja){if(Ne=se,Fe=(Ae=ce).rb[Ae.sb-1],We=Ae.rb[Ae.sb+Ae.ja],ye=Ae.ya[Ae.aa+Ae.ja],Pe=Ae.kc?ye.Ad:0)Fe.la=We.la=0,ye.Za||(Fe.Na=We.Na=0),ye.Hc=0,ye.Gc=0,ye.ia=0;else{var Mt,xt;if(Fe=We,We=Ne,Pe=Ae.Pa.Xc,at=Ae.ya[Ae.aa+Ae.ja],Ve=Ae.pb[at.$b],Se=at.ad,Et=0,Tt=Ae.rb[Ae.sb-1],bt=It=0,a(Se,Et,0,384),at.Za)var xn=0,gr=Pe[3];else{Rt=i(16);var wn=Fe.Na+Tt.Na;if(wn=lo(We,Pe[1],wn,Ve.Eb,0,Rt,0),Fe.Na=Tt.Na=(0<wn)+0,1<wn)Oi(Rt,0,Se,Et);else{var mr=Rt[0]+3>>3;for(Rt=0;256>Rt;Rt+=16)Se[Et+Rt]=mr}xn=1,gr=Pe[0]}var Qt=15&Fe.la,Er=15&Tt.la;for(Rt=0;4>Rt;++Rt){var kr=1&Er;for(mr=xt=0;4>mr;++mr)Qt=Qt>>1|(kr=(wn=lo(We,gr,wn=kr+(1&Qt),Ve.Sc,xn,Se,Et))>xn)<<7,xt=xt<<2|(3<wn?3:1<wn?2:Se[Et+0]!=0),Et+=16;Qt>>=4,Er=Er>>1|kr<<7,It=(It<<8|xt)>>>0}for(gr=Qt,xn=Er>>4,Mt=0;4>Mt;Mt+=2){for(xt=0,Qt=Fe.la>>4+Mt,Er=Tt.la>>4+Mt,Rt=0;2>Rt;++Rt){for(kr=1&Er,mr=0;2>mr;++mr)wn=kr+(1&Qt),Qt=Qt>>1|(kr=0<(wn=lo(We,Pe[2],wn,Ve.Qc,0,Se,Et)))<<3,xt=xt<<2|(3<wn?3:1<wn?2:Se[Et+0]!=0),Et+=16;Qt>>=2,Er=Er>>1|kr<<5}bt|=xt<<4*Mt,gr|=Qt<<4<<Mt,xn|=(240&Er)<<Mt}Fe.la=gr,Tt.la=xn,at.Hc=It,at.Gc=bt,at.ia=43690&bt?0:Ve.ia,Pe=!(It|bt)}if(0<Ae.L&&(Ae.wa[Ae.Y+Ae.ja]=Ae.gd[ye.$b][ye.Za],Ae.wa[Ae.Y+Ae.ja].La|=!Pe),Ne.Ka)return Xt(ce,7,"Premature end-of-file encountered.")}if(Oa(ce),Ae=Ie,Ne=1,ye=(se=ce).D,Fe=0<se.L&&se.M>=se.zb&&se.M<=se.Va,se.Aa==0)e:{if(ye.M=se.M,ye.uc=Fe,eo(se,ye),Ne=1,ye=(xt=se.D).Nb,Fe=(bt=wl[se.L])*se.R,We=bt/2*se.B,Rt=16*ye*se.R,mr=8*ye*se.B,Pe=se.sa,at=se.ta-Fe+Rt,Ve=se.qa,Se=se.ra-We+mr,Et=se.Ha,Tt=se.Ia-We+mr,Er=(Qt=xt.M)==0,It=Qt>=se.Va-1,se.Aa==2&&eo(se,xt),xt.uc)for(kr=(wn=se).D.M,e(wn.D.uc),xt=wn.yb;xt<wn.Hb;++xt){xn=xt,gr=kr;var kn=(Dn=(sn=wn).D).Nb;Mt=sn.R;var Dn=Dn.wa[Dn.Y+xn],sr=sn.sa,Kr=sn.ta+16*kn*Mt+16*xn,Cs=Dn.dd,Un=Dn.tc;if(Un!=0)if(e(3<=Un),sn.L==1)0<xn&&ua(sr,Kr,Mt,Un+4),Dn.La&&Hr(sr,Kr,Mt,Un),0<gr&&Za(sr,Kr,Mt,Un+4),Dn.La&&Ao(sr,Kr,Mt,Un);else{var Vs=sn.B,ei=sn.qa,qi=sn.ra+8*kn*Vs+8*xn,ga=sn.Ha,sn=sn.Ia+8*kn*Vs+8*xn;kn=Dn.ld,0<xn&&(ll(sr,Kr,Mt,Un+4,Cs,kn),Ya(ei,qi,ga,sn,Vs,Un+4,Cs,kn)),Dn.La&&(da(sr,Kr,Mt,Un,Cs,kn),Vi(ei,qi,ga,sn,Vs,Un,Cs,kn)),0<gr&&(Gi(sr,Kr,Mt,Un+4,Cs,kn),io(ei,qi,ga,sn,Vs,Un+4,Cs,kn)),Dn.La&&($a(sr,Kr,Mt,Un,Cs,kn),Xa(ei,qi,ga,sn,Vs,Un,Cs,kn))}}if(se.ia&&alert("todo:DitherRow"),Ae.put!=null){if(xt=16*Qt,Qt=16*(Qt+1),Er?(Ae.y=se.sa,Ae.O=se.ta+Rt,Ae.f=se.qa,Ae.N=se.ra+mr,Ae.ea=se.Ha,Ae.W=se.Ia+mr):(xt-=bt,Ae.y=Pe,Ae.O=at,Ae.f=Ve,Ae.N=Se,Ae.ea=Et,Ae.W=Tt),It||(Qt-=bt),Qt>Ae.o&&(Qt=Ae.o),Ae.F=null,Ae.J=null,se.Fa!=null&&0<se.Fa.length&&xt<Qt&&(Ae.J=XA(se,Ae,xt,Qt-xt),Ae.F=se.mb,Ae.F==null&&Ae.F.length==0)){Ne=Xt(se,3,"Could not decode alpha data.");break e}xt<Ae.j&&(bt=Ae.j-xt,xt=Ae.j,e(!(1&bt)),Ae.O+=se.R*bt,Ae.N+=se.B*(bt>>1),Ae.W+=se.B*(bt>>1),Ae.F!=null&&(Ae.J+=Ae.width*bt)),xt<Qt&&(Ae.O+=Ae.v,Ae.N+=Ae.v>>1,Ae.W+=Ae.v>>1,Ae.F!=null&&(Ae.J+=Ae.v),Ae.ka=xt-Ae.j,Ae.U=Ae.va-Ae.v,Ae.T=Qt-xt,Ne=Ae.put(Ae))}ye+1!=se.Ic||It||(r(se.sa,se.ta-Fe,Pe,at+16*se.R,Fe),r(se.qa,se.ra-We,Ve,Se+8*se.B,We),r(se.Ha,se.Ia-We,Et,Tt+8*se.B,We))}if(!Ne)return Xt(ce,6,"Output aborted.")}return 1}(f,x)),x.bc!=null&&x.bc(x),v&=1}return v?(f.cb=0,v):0}function Cr(f,x,v,S,T){T=f[x+v+32*S]+(T>>3),f[x+v+32*S]=-256&T?0>T?0:255:T}function aa(f,x,v,S,T,R){Cr(f,x,0,v,S+T),Cr(f,x,1,v,S+R),Cr(f,x,2,v,S-R),Cr(f,x,3,v,S-T)}function Kn(f){return(20091*f>>16)+f}function Ga(f,x,v,S){var T,R=0,H=i(16);for(T=0;4>T;++T){var G=f[x+0]+f[x+8],K=f[x+0]-f[x+8],J=(35468*f[x+4]>>16)-Kn(f[x+12]),re=Kn(f[x+4])+(35468*f[x+12]>>16);H[R+0]=G+re,H[R+1]=K+J,H[R+2]=K-J,H[R+3]=G-re,R+=4,x++}for(T=R=0;4>T;++T)G=(f=H[R+0]+4)+H[R+8],K=f-H[R+8],J=(35468*H[R+4]>>16)-Kn(H[R+12]),Cr(v,S,0,0,G+(re=Kn(H[R+4])+(35468*H[R+12]>>16))),Cr(v,S,1,0,K+J),Cr(v,S,2,0,K-J),Cr(v,S,3,0,G-re),R++,S+=32}function Si(f,x,v,S){var T=f[x+0]+4,R=35468*f[x+4]>>16,H=Kn(f[x+4]),G=35468*f[x+1]>>16;aa(v,S,0,T+H,f=Kn(f[x+1]),G),aa(v,S,1,T+R,f,G),aa(v,S,2,T-R,f,G),aa(v,S,3,T-H,f,G)}function RA(f,x,v,S,T){Ga(f,x,v,S),T&&Ga(f,x+16,v,S+4)}function Ii(f,x,v,S){Hs(f,x+0,v,S,1),Hs(f,x+32,v,S+128,1)}function HA(f,x,v,S){var T;for(f=f[x+0]+4,T=0;4>T;++T)for(x=0;4>x;++x)Cr(v,S,x,T,f)}function Fi(f,x,v,S){f[x+0]&&rr(f,x+0,v,S),f[x+16]&&rr(f,x+16,v,S+4),f[x+32]&&rr(f,x+32,v,S+128),f[x+48]&&rr(f,x+48,v,S+128+4)}function Ei(f,x,v,S){var T,R=i(16);for(T=0;4>T;++T){var H=f[x+0+T]+f[x+12+T],G=f[x+4+T]+f[x+8+T],K=f[x+4+T]-f[x+8+T],J=f[x+0+T]-f[x+12+T];R[0+T]=H+G,R[8+T]=H-G,R[4+T]=J+K,R[12+T]=J-K}for(T=0;4>T;++T)H=(f=R[0+4*T]+3)+R[3+4*T],G=R[1+4*T]+R[2+4*T],K=R[1+4*T]-R[2+4*T],J=f-R[3+4*T],v[S+0]=H+G>>3,v[S+16]=J+K>>3,v[S+32]=H-G>>3,v[S+48]=J-K>>3,S+=64}function Va(f,x,v){var S,T=x-32,R=Fr,H=255-f[T-1];for(S=0;S<v;++S){var G,K=R,J=H+f[x-1];for(G=0;G<v;++G)f[x+G]=K[J+f[T+G]];x+=32}}function OA(f,x){Va(f,x,4)}function GA(f,x){Va(f,x,8)}function VA(f,x){Va(f,x,16)}function ts(f,x){var v;for(v=0;16>v;++v)r(f,x+32*v,f,x-32,16)}function nn(f,x){var v;for(v=16;0<v;--v)a(f,x,f[x-1],16),x+=32}function Nr(f,x,v){var S;for(S=0;16>S;++S)a(x,v+32*S,f,16)}function Sr(f,x){var v,S=16;for(v=0;16>v;++v)S+=f[x-1+32*v]+f[x+v-32];Nr(S>>5,f,x)}function bn(f,x){var v,S=8;for(v=0;16>v;++v)S+=f[x-1+32*v];Nr(S>>4,f,x)}function ki(f,x){var v,S=8;for(v=0;16>v;++v)S+=f[x+v-32];Nr(S>>4,f,x)}function Ka(f,x){Nr(128,f,x)}function ct(f,x,v){return f+2*x+v+2>>2}function ws(f,x){var v,S=x-32;for(S=new Uint8Array([ct(f[S-1],f[S+0],f[S+1]),ct(f[S+0],f[S+1],f[S+2]),ct(f[S+1],f[S+2],f[S+3]),ct(f[S+2],f[S+3],f[S+4])]),v=0;4>v;++v)r(f,x+32*v,S,0,S.length)}function ia(f,x){var v=f[x-1],S=f[x-1+32],T=f[x-1+64],R=f[x-1+96];Qe(f,x+0,16843009*ct(f[x-1-32],v,S)),Qe(f,x+32,16843009*ct(v,S,T)),Qe(f,x+64,16843009*ct(S,T,R)),Qe(f,x+96,16843009*ct(T,R,R))}function Dr(f,x){var v,S=4;for(v=0;4>v;++v)S+=f[x+v-32]+f[x-1+32*v];for(S>>=3,v=0;4>v;++v)a(f,x+32*v,S,4)}function Ui(f,x){var v=f[x-1+0],S=f[x-1+32],T=f[x-1+64],R=f[x-1-32],H=f[x+0-32],G=f[x+1-32],K=f[x+2-32],J=f[x+3-32];f[x+0+96]=ct(S,T,f[x-1+96]),f[x+1+96]=f[x+0+64]=ct(v,S,T),f[x+2+96]=f[x+1+64]=f[x+0+32]=ct(R,v,S),f[x+3+96]=f[x+2+64]=f[x+1+32]=f[x+0+0]=ct(H,R,v),f[x+3+64]=f[x+2+32]=f[x+1+0]=ct(G,H,R),f[x+3+32]=f[x+2+0]=ct(K,G,H),f[x+3+0]=ct(J,K,G)}function qa(f,x){var v=f[x+1-32],S=f[x+2-32],T=f[x+3-32],R=f[x+4-32],H=f[x+5-32],G=f[x+6-32],K=f[x+7-32];f[x+0+0]=ct(f[x+0-32],v,S),f[x+1+0]=f[x+0+32]=ct(v,S,T),f[x+2+0]=f[x+1+32]=f[x+0+64]=ct(S,T,R),f[x+3+0]=f[x+2+32]=f[x+1+64]=f[x+0+96]=ct(T,R,H),f[x+3+32]=f[x+2+64]=f[x+1+96]=ct(R,H,G),f[x+3+64]=f[x+2+96]=ct(H,G,K),f[x+3+96]=ct(G,K,K)}function oe(f,x){var v=f[x-1+0],S=f[x-1+32],T=f[x-1+64],R=f[x-1-32],H=f[x+0-32],G=f[x+1-32],K=f[x+2-32],J=f[x+3-32];f[x+0+0]=f[x+1+64]=R+H+1>>1,f[x+1+0]=f[x+2+64]=H+G+1>>1,f[x+2+0]=f[x+3+64]=G+K+1>>1,f[x+3+0]=K+J+1>>1,f[x+0+96]=ct(T,S,v),f[x+0+64]=ct(S,v,R),f[x+0+32]=f[x+1+96]=ct(v,R,H),f[x+1+32]=f[x+2+96]=ct(R,H,G),f[x+2+32]=f[x+3+96]=ct(H,G,K),f[x+3+32]=ct(G,K,J)}function ie(f,x){var v=f[x+0-32],S=f[x+1-32],T=f[x+2-32],R=f[x+3-32],H=f[x+4-32],G=f[x+5-32],K=f[x+6-32],J=f[x+7-32];f[x+0+0]=v+S+1>>1,f[x+1+0]=f[x+0+64]=S+T+1>>1,f[x+2+0]=f[x+1+64]=T+R+1>>1,f[x+3+0]=f[x+2+64]=R+H+1>>1,f[x+0+32]=ct(v,S,T),f[x+1+32]=f[x+0+96]=ct(S,T,R),f[x+2+32]=f[x+1+96]=ct(T,R,H),f[x+3+32]=f[x+2+96]=ct(R,H,G),f[x+3+64]=ct(H,G,K),f[x+3+96]=ct(G,K,J)}function ge(f,x){var v=f[x-1+0],S=f[x-1+32],T=f[x-1+64],R=f[x-1+96];f[x+0+0]=v+S+1>>1,f[x+2+0]=f[x+0+32]=S+T+1>>1,f[x+2+32]=f[x+0+64]=T+R+1>>1,f[x+1+0]=ct(v,S,T),f[x+3+0]=f[x+1+32]=ct(S,T,R),f[x+3+32]=f[x+1+64]=ct(T,R,R),f[x+3+64]=f[x+2+64]=f[x+0+96]=f[x+1+96]=f[x+2+96]=f[x+3+96]=R}function _e(f,x){var v=f[x-1+0],S=f[x-1+32],T=f[x-1+64],R=f[x-1+96],H=f[x-1-32],G=f[x+0-32],K=f[x+1-32],J=f[x+2-32];f[x+0+0]=f[x+2+32]=v+H+1>>1,f[x+0+32]=f[x+2+64]=S+v+1>>1,f[x+0+64]=f[x+2+96]=T+S+1>>1,f[x+0+96]=R+T+1>>1,f[x+3+0]=ct(G,K,J),f[x+2+0]=ct(H,G,K),f[x+1+0]=f[x+3+32]=ct(v,H,G),f[x+1+32]=f[x+3+64]=ct(S,v,H),f[x+1+64]=f[x+3+96]=ct(T,S,v),f[x+1+96]=ct(R,T,S)}function Re(f,x){var v;for(v=0;8>v;++v)r(f,x+32*v,f,x-32,8)}function Ye(f,x){var v;for(v=0;8>v;++v)a(f,x,f[x-1],8),x+=32}function rt(f,x,v){var S;for(S=0;8>S;++S)a(x,v+32*S,f,8)}function Pt(f,x){var v,S=8;for(v=0;8>v;++v)S+=f[x+v-32]+f[x-1+32*v];rt(S>>4,f,x)}function ys(f,x){var v,S=4;for(v=0;8>v;++v)S+=f[x+v-32];rt(S>>3,f,x)}function bs(f,x){var v,S=4;for(v=0;8>v;++v)S+=f[x-1+32*v];rt(S>>3,f,x)}function KA(f,x){rt(128,f,x)}function ji(f,x,v){var S=f[x-v],T=f[x+0],R=3*(T-S)+pd[1020+f[x-2*v]-f[x+v]],H=dl[112+(R+4>>3)];f[x-v]=Fr[255+S+dl[112+(R+3>>3)]],f[x+0]=Fr[255+T-H]}function Zo(f,x,v,S){var T=f[x+0],R=f[x+v];return Gr[255+f[x-2*v]-f[x-v]]>S||Gr[255+R-T]>S}function el(f,x,v,S){return 4*Gr[255+f[x-v]-f[x+0]]+Gr[255+f[x-2*v]-f[x+v]]<=S}function tl(f,x,v,S,T){var R=f[x-3*v],H=f[x-2*v],G=f[x-v],K=f[x+0],J=f[x+v],re=f[x+2*v],me=f[x+3*v];return 4*Gr[255+G-K]+Gr[255+H-J]>S?0:Gr[255+f[x-4*v]-R]<=T&&Gr[255+R-H]<=T&&Gr[255+H-G]<=T&&Gr[255+me-re]<=T&&Gr[255+re-J]<=T&&Gr[255+J-K]<=T}function nl(f,x,v,S){var T=2*S+1;for(S=0;16>S;++S)el(f,x+S,v,T)&&ji(f,x+S,v)}function vs(f,x,v,S){var T=2*S+1;for(S=0;16>S;++S)el(f,x+S*v,1,T)&&ji(f,x+S*v,1)}function Ds(f,x,v,S){var T;for(T=3;0<T;--T)nl(f,x+=4*v,v,S)}function ud(f,x,v,S){var T;for(T=3;0<T;--T)vs(f,x+=4,v,S)}function Aa(f,x,v,S,T,R,H,G){for(R=2*R+1;0<T--;){if(tl(f,x,v,R,H))if(Zo(f,x,v,G))ji(f,x,v);else{var K=f,J=x,re=v,me=K[J-2*re],pe=K[J-re],ce=K[J+0],Ie=K[J+re],ye=K[J+2*re],se=27*(Ne=pd[1020+3*(ce-pe)+pd[1020+me-Ie]])+63>>7,Ae=18*Ne+63>>7,Ne=9*Ne+63>>7;K[J-3*re]=Fr[255+K[J-3*re]+Ne],K[J-2*re]=Fr[255+me+Ae],K[J-re]=Fr[255+pe+se],K[J+0]=Fr[255+ce-se],K[J+re]=Fr[255+Ie-Ae],K[J+2*re]=Fr[255+ye-Ne]}x+=S}}function ns(f,x,v,S,T,R,H,G){for(R=2*R+1;0<T--;){if(tl(f,x,v,R,H))if(Zo(f,x,v,G))ji(f,x,v);else{var K=f,J=x,re=v,me=K[J-re],pe=K[J+0],ce=K[J+re],Ie=dl[112+((ye=3*(pe-me))+4>>3)],ye=dl[112+(ye+3>>3)],se=Ie+1>>1;K[J-2*re]=Fr[255+K[J-2*re]+se],K[J-re]=Fr[255+me+ye],K[J+0]=Fr[255+pe-Ie],K[J+re]=Fr[255+ce-se]}x+=S}}function qA(f,x,v,S,T,R){Aa(f,x,v,1,16,S,T,R)}function za(f,x,v,S,T,R){Aa(f,x,1,v,16,S,T,R)}function fd(f,x,v,S,T,R){var H;for(H=3;0<H;--H)ns(f,x+=4*v,v,1,16,S,T,R)}function Ti(f,x,v,S,T,R){var H;for(H=3;0<H;--H)ns(f,x+=4,1,v,16,S,T,R)}function hd(f,x,v,S,T,R,H,G){Aa(f,x,T,1,8,R,H,G),Aa(v,S,T,1,8,R,H,G)}function zA(f,x,v,S,T,R,H,G){Aa(f,x,1,T,8,R,H,G),Aa(v,S,1,T,8,R,H,G)}function JA(f,x,v,S,T,R,H,G){ns(f,x+4*T,T,1,8,R,H,G),ns(v,S+4*T,T,1,8,R,H,G)}function rl(f,x,v,S,T,R,H,G){ns(f,x+4,1,T,8,R,H,G),ns(v,S+4,1,T,8,R,H,G)}function Qi(){this.ba=new or,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Yt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function WA(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function YA(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sl(){this.ua=0,this.Wa=new $,this.vb=new $,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new I}function gd(){this.xb=this.a=0,this.l=new sa,this.ca=new or,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Q,this.Pb=0,this.wd=new Q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sl,this.ab=0,this.gc=A(4,YA),this.Oc=0}function Li(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new sa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ja(f,x,v,S,T,R,H){for(f=f==null?0:f[x+0],x=0;x<H;++x)T[R+x]=f+v[S+x]&255,f=T[R+x]}function $A(f,x,v,S,T,R,H){var G;if(f==null)Ja(null,null,v,S,T,R,H);else for(G=0;G<H;++G)T[R+G]=f[x+G]+v[S+G]&255}function oa(f,x,v,S,T,R,H){if(f==null)Ja(null,null,v,S,T,R,H);else{var G,K=f[x+0],J=K,re=K;for(G=0;G<H;++G)J=re+(K=f[x+G])-J,re=v[S+G]+(-256&J?0>J?0:255:J)&255,J=K,T[R+G]=re}}function XA(f,x,v,S){var T=x.width,R=x.o;if(e(f!=null&&x!=null),0>v||0>=S||v+S>R)return null;if(!f.Cc){if(f.ga==null){var H;if(f.ga=new Li,(H=f.ga==null)||(H=x.width*x.o,e(f.Gb.length==0),f.Gb=i(H),f.Uc=0,f.Gb==null?H=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,H=1),H=!H),!H){H=f.ga;var G=f.Fa,K=f.P,J=f.qc,re=f.mb,me=f.nb,pe=K+1,ce=J-1,Ie=H.l;if(e(G!=null&&re!=null&&x!=null),ha[0]=null,ha[1]=Ja,ha[2]=$A,ha[3]=oa,H.ca=re,H.tb=me,H.c=x.width,H.i=x.height,e(0<H.c&&0<H.i),1>=J)x=0;else if(H.$a=G[K+0]>>0&3,H.Z=G[K+0]>>2&3,H.Lc=G[K+0]>>4&3,K=G[K+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||K)x=0;else if(Ie.put=vr,Ie.ac=on,Ie.bc=lr,Ie.ma=H,Ie.width=x.width,Ie.height=x.height,Ie.Da=x.Da,Ie.v=x.v,Ie.va=x.va,Ie.j=x.j,Ie.o=x.o,H.$a)e:{e(H.$a==1),x=qt();t:for(;;){if(x==null){x=0;break e}if(e(H!=null),H.mc=x,x.c=H.c,x.i=H.i,x.l=H.l,x.l.ma=H,x.l.width=H.c,x.l.height=H.i,x.a=0,ae(x.m,G,pe,ce),!ur(H.c,H.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&Br(x.s)?(H.ic=1,G=x.c*x.i,x.Ta=null,x.Ua=0,x.V=i(G),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(H.ic=0,x=xs(x,H.c)),!x))break t;x=1;break e}H.mc=null,x=0}else x=ce>=H.c*H.i;H=!x}if(H)return null;f.ga.Lc!=1?f.Ga=0:S=R-v}e(f.ga!=null),e(v+S<=R);e:{if(x=(G=f.ga).c,R=G.l.o,G.$a==0){if(pe=f.rc,ce=f.Vc,Ie=f.Fa,K=f.P+1+v*x,J=f.mb,re=f.nb+v*x,e(K<=f.P+f.qc),G.Z!=0)for(e(ha[G.Z]!=null),H=0;H<S;++H)ha[G.Z](pe,ce,Ie,K,J,re,x),pe=J,ce=re,re+=x,K+=x;else for(H=0;H<S;++H)r(J,re,Ie,K,x),pe=J,ce=re,re+=x,K+=x;f.rc=pe,f.Vc=ce}else{if(e(G.mc!=null),x=v+S,e((H=G.mc)!=null),e(x<=H.i),H.C>=x)x=1;else if(G.ic||he(),G.ic){G=H.V,pe=H.Ba,ce=H.c;var ye=H.i,se=(Ie=1,K=H.$/ce,J=H.$%ce,re=H.m,me=H.s,H.$),Ae=ce*ye,Ne=ce*x,Fe=me.wc,Se=se<Ne?$t(me,J,K):null;e(se<=Ae),e(x<=ye),e(Br(me));t:for(;;){for(;!re.h&&se<Ne;){if(J&Fe||(Se=$t(me,J,K)),e(Se!=null),ne(re),256>(ye=Ln(Se.G[0],Se.H[0],re)))G[pe+se]=ye,++se,++J>=ce&&(J=0,++K<=x&&!(K%16)&&dr(H,K));else{if(!(280>ye)){Ie=0;break t}ye=Vn(ye-256,re);var We,Pe=Ln(Se.G[4],Se.H[4],re);if(ne(re),!(se>=(Pe=Fn(ce,Pe=Vn(Pe,re)))&&Ae-se>=ye)){Ie=0;break t}for(We=0;We<ye;++We)G[pe+se+We]=G[pe+se+We-Pe];for(se+=ye,J+=ye;J>=ce;)J-=ce,++K<=x&&!(K%16)&&dr(H,K);se<Ne&&J&Fe&&(Se=$t(me,J,K))}e(re.h==W(re))}dr(H,K>x?x:K);break t}!Ie||re.h&&se<Ae?(Ie=0,H.a=re.h?5:3):H.$=se,x=Ie}else x=mn(H,H.V,H.Ba,H.c,H.i,x,na);if(!x){S=0;break e}}v+S>=R&&(f.Cc=1),S=1}if(!S)return null;if(f.Cc&&((S=f.ga)!=null&&(S.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+v*T}function w(f,x,v,S,T,R){for(;0<T--;){var H,G=f,K=x+(v?1:0),J=f,re=x+(v?0:3);for(H=0;H<S;++H){var me=J[re+4*H];me!=255&&(me*=32897,G[K+4*H+0]=G[K+4*H+0]*me>>23,G[K+4*H+1]=G[K+4*H+1]*me>>23,G[K+4*H+2]=G[K+4*H+2]*me>>23)}x+=R}}function L(f,x,v,S,T){for(;0<S--;){var R;for(R=0;R<v;++R){var H=f[x+2*R+0],G=15&(J=f[x+2*R+1]),K=4369*G,J=(240&J|J>>4)*K>>16;f[x+2*R+0]=(240&H|H>>4)*K>>16&240|(15&H|H<<4)*K>>16>>4&15,f[x+2*R+1]=240&J|G}x+=T}}function Y(f,x,v,S,T,R,H,G){var K,J,re=255;for(J=0;J<T;++J){for(K=0;K<S;++K){var me=f[x+K];R[H+4*K]=me,re&=me}x+=v,H+=G}return re!=255}function te(f,x,v,S,T){var R;for(R=0;R<T;++R)v[S+R]=f[x+R]>>8}function he(){Or=w,Gt=L,Vt=Y,cn=te}function Be(f,x,v){U[f]=function(S,T,R,H,G,K,J,re,me,pe,ce,Ie,ye,se,Ae,Ne,Fe){var Se,We=Fe-1>>1,Pe=G[K+0]|J[re+0]<<16,at=me[pe+0]|ce[Ie+0]<<16;e(S!=null);var Ve=3*Pe+at+131074>>2;for(x(S[T+0],255&Ve,Ve>>16,ye,se),R!=null&&(Ve=3*at+Pe+131074>>2,x(R[H+0],255&Ve,Ve>>16,Ae,Ne)),Se=1;Se<=We;++Se){var Et=G[K+Se]|J[re+Se]<<16,Tt=me[pe+Se]|ce[Ie+Se]<<16,It=Pe+Et+at+Tt+524296,bt=It+2*(Et+at)>>3;Ve=bt+Pe>>1,Pe=(It=It+2*(Pe+Tt)>>3)+Et>>1,x(S[T+2*Se-1],255&Ve,Ve>>16,ye,se+(2*Se-1)*v),x(S[T+2*Se-0],255&Pe,Pe>>16,ye,se+(2*Se-0)*v),R!=null&&(Ve=It+at>>1,Pe=bt+Tt>>1,x(R[H+2*Se-1],255&Ve,Ve>>16,Ae,Ne+(2*Se-1)*v),x(R[H+2*Se+0],255&Pe,Pe>>16,Ae,Ne+(2*Se+0)*v)),Pe=Et,at=Tt}1&Fe||(Ve=3*Pe+at+131074>>2,x(S[T+Fe-1],255&Ve,Ve>>16,ye,se+(Fe-1)*v),R!=null&&(Ve=3*at+Pe+131074>>2,x(R[H+Fe-1],255&Ve,Ve>>16,Ae,Ne+(Fe-1)*v)))}}function ke(){Vr[ul]=vw,Vr[fl]=Kf,Vr[Rf]=Bw,Vr[hl]=qf,Vr[gl]=zf,Vr[xd]=Jf,Vr[Hf]=Cw,Vr[wd]=Kf,Vr[yd]=qf,Vr[ml]=zf,Vr[bd]=Jf}function Je(f){return f&-16384?0>f?0:255:f>>Nw}function nt(f,x){return Je((19077*f>>8)+(26149*x>>8)-14234)}function pt(f,x,v){return Je((19077*f>>8)-(6419*x>>8)-(13320*v>>8)+8708)}function ht(f,x){return Je((19077*f>>8)+(33050*x>>8)-17685)}function Nt(f,x,v,S,T){S[T+0]=nt(f,v),S[T+1]=pt(f,x,v),S[T+2]=ht(f,x)}function tn(f,x,v,S,T){S[T+0]=ht(f,x),S[T+1]=pt(f,x,v),S[T+2]=nt(f,v)}function rn(f,x,v,S,T){var R=pt(f,x,v);x=R<<3&224|ht(f,x)>>3,S[T+0]=248&nt(f,v)|R>>5,S[T+1]=x}function pn(f,x,v,S,T){var R=240&ht(f,x)|15;S[T+0]=240&nt(f,v)|pt(f,x,v)>>4,S[T+1]=R}function qn(f,x,v,S,T){S[T+0]=255,Nt(f,x,v,S,T+1)}function En(f,x,v,S,T){tn(f,x,v,S,T),S[T+3]=255}function rs(f,x,v,S,T){Nt(f,x,v,S,T),S[T+3]=255}function Ir(f,x){return 0>f?0:f>x?x:f}function Bs(f,x,v){U[f]=function(S,T,R,H,G,K,J,re,me){for(var pe=re+(-2&me)*v;re!=pe;)x(S[T+0],R[H+0],G[K+0],J,re),x(S[T+1],R[H+0],G[K+0],J,re+v),T+=2,++H,++K,re+=2*v;1&me&&x(S[T+0],R[H+0],G[K+0],J,re)}}function al(f,x,v){return v==0?f==0?x==0?6:5:x==0?4:0:v}function ZA(f,x,v,S,T){switch(f>>>30){case 3:Hs(x,v,S,T,0);break;case 2:ln(x,v,S,T);break;case 1:rr(x,v,S,T)}}function eo(f,x){var v,S,T=x.M,R=x.Nb,H=f.oc,G=f.pc+40,K=f.oc,J=f.pc+584,re=f.oc,me=f.pc+600;for(v=0;16>v;++v)H[G+32*v-1]=129;for(v=0;8>v;++v)K[J+32*v-1]=129,re[me+32*v-1]=129;for(0<T?H[G-1-32]=K[J-1-32]=re[me-1-32]=129:(a(H,G-32-1,127,21),a(K,J-32-1,127,9),a(re,me-32-1,127,9)),S=0;S<f.za;++S){var pe=x.ya[x.aa+S];if(0<S){for(v=-1;16>v;++v)r(H,G+32*v-4,H,G+32*v+12,4);for(v=-1;8>v;++v)r(K,J+32*v-4,K,J+32*v+4,4),r(re,me+32*v-4,re,me+32*v+4,4)}var ce=f.Gd,Ie=f.Hd+S,ye=pe.ad,se=pe.Hc;if(0<T&&(r(H,G-32,ce[Ie].y,0,16),r(K,J-32,ce[Ie].f,0,8),r(re,me-32,ce[Ie].ea,0,8)),pe.Za){var Ae=H,Ne=G-32+16;for(0<T&&(S>=f.za-1?a(Ae,Ne,ce[Ie].y[15],4):r(Ae,Ne,ce[Ie+1].y,0,4)),v=0;4>v;v++)Ae[Ne+128+v]=Ae[Ne+256+v]=Ae[Ne+384+v]=Ae[Ne+0+v];for(v=0;16>v;++v,se<<=2)Ae=H,Ne=G+Yf[v],ss[pe.Ob[v]](Ae,Ne),ZA(se,ye,16*+v,Ae,Ne)}else if(Ae=al(S,T,pe.Ob[0]),fa[Ae](H,G),se!=0)for(v=0;16>v;++v,se<<=2)ZA(se,ye,16*+v,H,G+Yf[v]);for(v=pe.Gc,Ae=al(S,T,pe.Dd),Gs[Ae](K,J),Gs[Ae](re,me),se=ye,Ae=K,Ne=J,255&(pe=v>>0)&&(170&pe?ao(se,256,Ae,Ne):Rr(se,256,Ae,Ne)),pe=re,se=me,255&(v>>=8)&&(170&v?ao(ye,320,pe,se):Rr(ye,320,pe,se)),T<f.Ub-1&&(r(ce[Ie].y,0,H,G+480,16),r(ce[Ie].f,0,K,J+224,8),r(ce[Ie].ea,0,re,me+224,8)),v=8*R*f.B,ce=f.sa,Ie=f.ta+16*S+16*R*f.R,ye=f.qa,pe=f.ra+8*S+v,se=f.Ha,Ae=f.Ia+8*S+v,v=0;16>v;++v)r(ce,Ie+v*f.R,H,G+32*v,16);for(v=0;8>v;++v)r(ye,pe+v*f.B,K,J+32*v,8),r(se,Ae+v*f.B,re,me+32*v,8)}}function _i(f,x,v,S,T,R,H,G,K){var J=[0],re=[0],me=0,pe=K!=null?K.kd:0,ce=K??new WA;if(f==null||12>v)return 7;ce.data=f,ce.w=x,ce.ha=v,x=[x],v=[v],ce.gb=[ce.gb];e:{var Ie=x,ye=v,se=ce.gb;if(e(f!=null),e(ye!=null),e(se!=null),se[0]=0,12<=ye[0]&&!n(f,Ie[0],"RIFF")){if(n(f,Ie[0]+8,"WEBP")){se=3;break e}var Ae=De(f,Ie[0]+4);if(12>Ae||4294967286<Ae){se=3;break e}if(pe&&Ae>ye[0]-8){se=7;break e}se[0]=Ae,Ie[0]+=12,ye[0]-=12}se=0}if(se!=0)return se;for(Ae=0<ce.gb[0],v=v[0];;){e:{var Ne=f;ye=x,se=v;var Fe=J,Se=re,We=Ie=[0];if((Ve=me=[me])[0]=0,8>se[0])se=7;else{if(!n(Ne,ye[0],"VP8X")){if(De(Ne,ye[0]+4)!=10){se=3;break e}if(18>se[0]){se=7;break e}var Pe=De(Ne,ye[0]+8),at=1+Me(Ne,ye[0]+12);if(2147483648<=at*(Ne=1+Me(Ne,ye[0]+15))){se=3;break e}We!=null&&(We[0]=Pe),Fe!=null&&(Fe[0]=at),Se!=null&&(Se[0]=Ne),ye[0]+=18,se[0]-=18,Ve[0]=1}se=0}}if(me=me[0],Ie=Ie[0],se!=0)return se;if(ye=!!(2&Ie),!Ae&&me)return 3;if(R!=null&&(R[0]=!!(16&Ie)),H!=null&&(H[0]=ye),G!=null&&(G[0]=0),H=J[0],Ie=re[0],me&&ye&&K==null){se=0;break}if(4>v){se=7;break}if(Ae&&me||!Ae&&!me&&!n(f,x[0],"ALPH")){v=[v],ce.na=[ce.na],ce.P=[ce.P],ce.Sa=[ce.Sa];e:{Pe=f,se=x,Ae=v;var Ve=ce.gb;Fe=ce.na,Se=ce.P,We=ce.Sa,at=22,e(Pe!=null),e(Ae!=null),Ne=se[0];var Et=Ae[0];for(e(Fe!=null),e(We!=null),Fe[0]=null,Se[0]=null,We[0]=0;;){if(se[0]=Ne,Ae[0]=Et,8>Et){se=7;break e}var Tt=De(Pe,Ne+4);if(4294967286<Tt){se=3;break e}var It=8+Tt+1&-2;if(at+=It,0<Ve&&at>Ve){se=3;break e}if(!n(Pe,Ne,"VP8 ")||!n(Pe,Ne,"VP8L")){se=0;break e}if(Et[0]<It){se=7;break e}n(Pe,Ne,"ALPH")||(Fe[0]=Pe,Se[0]=Ne+8,We[0]=Tt),Ne+=It,Et-=It}}if(v=v[0],ce.na=ce.na[0],ce.P=ce.P[0],ce.Sa=ce.Sa[0],se!=0)break}v=[v],ce.Ja=[ce.Ja],ce.xa=[ce.xa];e:if(Ve=f,se=x,Ae=v,Fe=ce.gb[0],Se=ce.Ja,We=ce.xa,Pe=se[0],Ne=!n(Ve,Pe,"VP8 "),at=!n(Ve,Pe,"VP8L"),e(Ve!=null),e(Ae!=null),e(Se!=null),e(We!=null),8>Ae[0])se=7;else{if(Ne||at){if(Ve=De(Ve,Pe+4),12<=Fe&&Ve>Fe-12){se=3;break e}if(pe&&Ve>Ae[0]-8){se=7;break e}Se[0]=Ve,se[0]+=8,Ae[0]-=8,We[0]=at}else We[0]=5<=Ae[0]&&Ve[Pe+0]==47&&!(Ve[Pe+4]>>5),Se[0]=Ae[0];se=0}if(v=v[0],ce.Ja=ce.Ja[0],ce.xa=ce.xa[0],x=x[0],se!=0)break;if(4294967286<ce.Ja)return 3;if(G==null||ye||(G[0]=ce.xa?2:1),H=[H],Ie=[Ie],ce.xa){if(5>v){se=7;break}G=H,pe=Ie,ye=R,f==null||5>v?f=0:5<=v&&f[x+0]==47&&!(f[x+4]>>5)?(Ae=[0],Ve=[0],Fe=[0],ae(Se=new Q,f,x,v),Ee(Se,Ae,Ve,Fe)?(G!=null&&(G[0]=Ae[0]),pe!=null&&(pe[0]=Ve[0]),ye!=null&&(ye[0]=Fe[0]),f=1):f=0):f=0}else{if(10>v){se=7;break}G=Ie,f==null||10>v||!Ha(f,x+3,v-3)?f=0:(pe=f[x+0]|f[x+1]<<8|f[x+2]<<16,ye=16383&(f[x+7]<<8|f[x+6]),f=16383&(f[x+9]<<8|f[x+8]),1&pe||3<(pe>>1&7)||!(pe>>4&1)||pe>>5>=ce.Ja||!ye||!f?f=0:(H&&(H[0]=ye),G&&(G[0]=f),f=1))}if(!f||(H=H[0],Ie=Ie[0],me&&(J[0]!=H||re[0]!=Ie)))return 3;K!=null&&(K[0]=ce,K.offset=x-K.w,e(4294967286>x-K.w),e(K.offset==K.ha-v));break}return se==0||se==7&&me&&K==null?(R!=null&&(R[0]|=ce.na!=null&&0<ce.na.length),S!=null&&(S[0]=H),T!=null&&(T[0]=Ie),0):se}function to(f,x,v){var S=x.width,T=x.height,R=0,H=0,G=S,K=T;if(x.Da=f!=null&&0<f.Da,x.Da&&(G=f.cd,K=f.bd,R=f.v,H=f.j,11>v||(R&=-2,H&=-2),0>R||0>H||0>=G||0>=K||R+G>S||H+K>T))return 0;if(x.v=R,x.j=H,x.va=R+G,x.o=H+K,x.U=G,x.T=K,x.da=f!=null&&0<f.da,x.da){if(!At(G,K,v=[f.ib],R=[f.hb]))return 0;x.ib=v[0],x.hb=R[0]}return x.ob=f!=null&&f.ob,x.Kb=f==null||!f.Sd,x.da&&(x.ob=x.ib<3*S/4&&x.hb<3*T/4,x.Kb=0),1}function no(f){if(f==null)return 2;if(11>f.S){var x=f.f.RGBA;x.fb+=(f.height-1)*x.A,x.A=-x.A}else x=f.f.kb,f=f.height,x.O+=(f-1)*x.fa,x.fa=-x.fa,x.N+=(f-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(f-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(f-1)*x.lb,x.lb=-x.lb);return 0}function Mi(f,x,v,S){if(S==null||0>=f||0>=x)return 2;if(v!=null){if(v.Da){var T=v.cd,R=v.bd,H=-2&v.v,G=-2&v.j;if(0>H||0>G||0>=T||0>=R||H+T>f||G+R>x)return 2;f=T,x=R}if(v.da){if(!At(f,x,T=[v.ib],R=[v.hb]))return 2;f=T[0],x=R[0]}}S.width=f,S.height=x;e:{var K=S.width,J=S.height;if(f=S.S,0>=K||0>=J||!(f>=ul&&13>f))f=2;else{if(0>=S.Rd&&S.sd==null){H=R=T=x=0;var re=(G=K*$f[f])*J;if(11>f||(R=(J+1)/2*(x=(K+1)/2),f==12&&(H=(T=K)*J)),(J=i(re+2*R+H))==null){f=1;break e}S.sd=J,11>f?((K=S.f.RGBA).eb=J,K.fb=0,K.A=G,K.size=re):((K=S.f.kb).y=J,K.O=0,K.fa=G,K.Fd=re,K.f=J,K.N=0+re,K.Ab=x,K.Cd=R,K.ea=J,K.W=0+re+R,K.Db=x,K.Ed=R,f==12&&(K.F=J,K.J=0+re+2*R),K.Tc=H,K.lb=T)}if(x=1,T=S.S,R=S.width,H=S.height,T>=ul&&13>T)if(11>T)f=S.f.RGBA,x&=(G=Math.abs(f.A))*(H-1)+R<=f.size,x&=G>=R*$f[T],x&=f.eb!=null;else{f=S.f.kb,G=(R+1)/2,re=(H+1)/2,K=Math.abs(f.fa),J=Math.abs(f.Ab);var me=Math.abs(f.Db),pe=Math.abs(f.lb),ce=pe*(H-1)+R;x&=K*(H-1)+R<=f.Fd,x&=J*(re-1)+G<=f.Cd,x=(x&=me*(re-1)+G<=f.Ed)&K>=R&J>=G&me>=G,x&=f.y!=null,x&=f.f!=null,x&=f.ea!=null,T==12&&(x&=pe>=R,x&=ce<=f.Tc,x&=f.F!=null)}else x=0;f=x?0:2}}return f!=0||v!=null&&v.fd&&(f=no(S)),f}var Mn=64,Di=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Pi=24,Ri=32,ro=8,fr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Le("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(f){return f},U.Predictor2=function(f,x,v){return x[v+0]},U.Predictor3=function(f,x,v){return x[v+1]},U.Predictor4=function(f,x,v){return x[v-1]},U.Predictor5=function(f,x,v){return Oe(Oe(f,x[v+1]),x[v+0])},U.Predictor6=function(f,x,v){return Oe(f,x[v-1])},U.Predictor7=function(f,x,v){return Oe(f,x[v+0])},U.Predictor8=function(f,x,v){return Oe(x[v-1],x[v+0])},U.Predictor9=function(f,x,v){return Oe(x[v+0],x[v+1])},U.Predictor10=function(f,x,v){return Oe(Oe(f,x[v-1]),Oe(x[v+0],x[v+1]))},U.Predictor11=function(f,x,v){var S=x[v+0];return 0>=mt(S>>24&255,f>>24&255,(x=x[v-1])>>24&255)+mt(S>>16&255,f>>16&255,x>>16&255)+mt(S>>8&255,f>>8&255,x>>8&255)+mt(255&S,255&f,255&x)?S:f},U.Predictor12=function(f,x,v){var S=x[v+0];return(tt((f>>24&255)+(S>>24&255)-((x=x[v-1])>>24&255))<<24|tt((f>>16&255)+(S>>16&255)-(x>>16&255))<<16|tt((f>>8&255)+(S>>8&255)-(x>>8&255))<<8|tt((255&f)+(255&S)-(255&x)))>>>0},U.Predictor13=function(f,x,v){var S=x[v-1];return(ut((f=Oe(f,x[v+0]))>>24&255,S>>24&255)<<24|ut(f>>16&255,S>>16&255)<<16|ut(f>>8&255,S>>8&255)<<8|ut(f>>0&255,S>>0&255))>>>0};var md=U.PredictorAdd0;U.PredictorAdd1=wt,Le("Predictor2","PredictorAdd2"),Le("Predictor3","PredictorAdd3"),Le("Predictor4","PredictorAdd4"),Le("Predictor5","PredictorAdd5"),Le("Predictor6","PredictorAdd6"),Le("Predictor7","PredictorAdd7"),Le("Predictor8","PredictorAdd8"),Le("Predictor9","PredictorAdd9"),Le("Predictor10","PredictorAdd10"),Le("Predictor11","PredictorAdd11"),Le("Predictor12","PredictorAdd12"),Le("Predictor13","PredictorAdd13");var so=U.PredictorAdd2;yt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var il,Pr=U.ColorIndexInverseTransform,Hi=U.MapARGB,Al=U.VP8LColorIndexInverseTransformAlpha,ol=U.MapAlpha,la=U.VP8LPredictorsAdd=[];la.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var Wa,hr,nr,ca,Ps,Rs,Oi,Hs,ln,ao,rr,Rr,Gi,ll,io,Ya,$a,da,Xa,Vi,Za,ua,Ao,Hr,Or,Gt,Vt,cn,vn=i(511),Os=i(2041),oo=i(225),Ki=i(767),cl=0,pd=Os,dl=oo,Fr=Ki,Gr=vn,ul=0,fl=1,Rf=2,hl=3,gl=4,xd=5,Hf=6,wd=7,yd=8,ml=9,bd=10,ow=[2,3,7],lw=[3,3,11],Of=[280,256,256,256,40],cw=[0,1,1,1,0],dw=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],uw=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],fw=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hw=8,vd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Bd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],lo=null,gw=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],mw=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Gf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],pw=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],xw=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ww=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],yw=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],fa=[],ss=[],Gs=[],bw=1,Vf=2,ha=[],Vr=[];Be("UpsampleRgbLinePair",Nt,3),Be("UpsampleBgrLinePair",tn,3),Be("UpsampleRgbaLinePair",rs,4),Be("UpsampleBgraLinePair",En,4),Be("UpsampleArgbLinePair",qn,4),Be("UpsampleRgba4444LinePair",pn,2),Be("UpsampleRgb565LinePair",rn,2);var vw=U.UpsampleRgbLinePair,Bw=U.UpsampleBgrLinePair,Kf=U.UpsampleRgbaLinePair,qf=U.UpsampleBgraLinePair,zf=U.UpsampleArgbLinePair,Jf=U.UpsampleRgba4444LinePair,Cw=U.UpsampleRgb565LinePair,pl=16,xl=1<<pl-1,co=-227,Cd=482,Nw=6,Wf=0,Sw=i(256),Iw=i(256),Fw=i(256),Ew=i(256),kw=i(Cd-co),Uw=i(Cd-co);Bs("YuvToRgbRow",Nt,3),Bs("YuvToBgrRow",tn,3),Bs("YuvToRgbaRow",rs,4),Bs("YuvToBgraRow",En,4),Bs("YuvToArgbRow",qn,4),Bs("YuvToRgba4444Row",pn,2),Bs("YuvToRgb565Row",rn,2);var Yf=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],wl=[0,2,8],jw=[8,7,6,4,4,2,2,2,1,1,1,1],Tw=1;this.WebPDecodeRGBA=function(f,x,v,S,T){var R=fl,H=new Qi,G=new or;H.ba=G,G.S=R,G.width=[G.width],G.height=[G.height];var K=G.width,J=G.height,re=new es;if(re==null||f==null)var me=2;else e(re!=null),me=_i(f,x,v,re.width,re.height,re.Pd,re.Qd,re.format,null);if(me!=0?K=0:(K!=null&&(K[0]=re.width[0]),J!=null&&(J[0]=re.height[0]),K=1),K){G.width=G.width[0],G.height=G.height[0],S!=null&&(S[0]=G.width),T!=null&&(T[0]=G.height);e:{if(S=new sa,(T=new WA).data=f,T.w=x,T.ha=v,T.kd=1,x=[0],e(T!=null),((f=_i(T.data,T.w,T.ha,null,null,null,x,null,T))==0||f==7)&&x[0]&&(f=4),(x=f)==0){if(e(H!=null),S.data=T.data,S.w=T.w+T.offset,S.ha=T.ha-T.offset,S.put=vr,S.ac=on,S.bc=lr,S.ma=H,T.xa){if((f=qt())==null){H=1;break e}if(function(pe,ce){var Ie=[0],ye=[0],se=[0];t:for(;;){if(pe==null)return 0;if(ce==null)return pe.a=2,0;if(pe.l=ce,pe.a=0,ae(pe.m,ce.data,ce.w,ce.ha),!Ee(pe.m,Ie,ye,se)){pe.a=3;break t}if(pe.xb=Vf,ce.width=Ie[0],ce.height=ye[0],!ur(Ie[0],ye[0],1,pe,null))break t;return 1}return e(pe.a!=0),0}(f,S)){if(S=(x=Mi(S.width,S.height,H.Oa,H.ba))==0){t:{S=f;n:for(;;){if(S==null){S=0;break t}if(e(S.s.yc!=null),e(S.s.Ya!=null),e(0<S.s.Wb),e((v=S.l)!=null),e((T=v.ma)!=null),S.xb!=0){if(S.ca=T.ba,S.tb=T.tb,e(S.ca!=null),!to(T.Oa,v,hl)){S.a=2;break n}if(!xs(S,v.width)||v.da)break n;if((v.da||St(S.ca.S))&&he(),11>S.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),S.ca.f.kb.F!=null&&he()),S.Pb&&0<S.s.ua&&S.s.vb.X==null&&!st(S.s.vb,S.s.Wa.Xa)){S.a=1;break n}S.xb=0}if(!mn(S,S.V,S.Ba,S.c,S.i,v.o,ps))break n;T.Dc=S.Ma,S=1;break t}e(S.a!=0),S=0}S=!S}S&&(x=f.a)}else x=f.a}else{if((f=new DA)==null){H=1;break e}if(f.Fa=T.na,f.P=T.P,f.qc=T.Sa,Ci(f,S)){if((x=Mi(S.width,S.height,H.Oa,H.ba))==0){if(f.Aa=0,v=H.Oa,e((T=f)!=null),v!=null){if(0<(K=0>(K=v.Md)?0:100<K?255:255*K/100)){for(J=re=0;4>J;++J)12>(me=T.pb[J]).lc&&(me.ia=K*jw[0>me.lc?0:me.lc]>>3),re|=me.ia;re&&(alert("todo:VP8InitRandom"),T.ia=1)}T.Ga=v.Id,100<T.Ga?T.Ga=100:0>T.Ga&&(T.Ga=0)}PA(f,S)||(x=f.a)}}else x=f.a}x==0&&H.Oa!=null&&H.Oa.fd&&(x=no(H.ba))}H=x}R=H!=0?null:11>R?G.f.RGBA.eb:G.f.kb.y}else R=null;return R};var $f=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(U,j){for(var O="",F=0;F<4;F++)O+=String.fromCharCode(U[j++]);return O}function d(U,j){return(U[j+0]<<0|U[j+1]<<8|U[j+2]<<16)>>>0}function h(U,j){return(U[j+0]<<0|U[j+1]<<8|U[j+2]<<16|U[j+3]<<24)>>>0}new l;var p=[0],m=[0],B=[],y=new l,b=t,C=function(U,j){var O={},F=0,I=!1,P=0,V=0;if(O.frames=[],!function(z,W,Z,ne){for(var fe=0;fe<ne;fe++)if(z[W+fe]!=Z.charCodeAt(fe))return!0;return!1}(U,j,"RIFF",4)){var ee,X;for(h(U,j+=4),j+=8;j<U.length;){var le=c(U,j),ae=h(U,j+=4);j+=4;var de=ae+(1&ae);switch(le){case"VP8 ":case"VP8L":O.frames[F]===void 0&&(O.frames[F]={}),(Q=O.frames[F]).src_off=I?V:j-8,Q.src_size=P+ae+8,F++,I&&(I=!1,P=0,V=0);break;case"VP8X":(Q=O.header={}).feature_flags=U[j];var ue=j+4;Q.canvas_width=1+d(U,ue),ue+=3,Q.canvas_height=1+d(U,ue),ue+=3;break;case"ALPH":I=!0,P=de+8,V=j-8;break;case"ANIM":(Q=O.header).bgcolor=h(U,j),ue=j+4,Q.loop_count=(ee=U)[(X=ue)+0]<<0|ee[X+1]<<8,ue+=2;break;case"ANMF":var Ce,Q;(Q=O.frames[F]={}).offset_x=2*d(U,j),j+=3,Q.offset_y=2*d(U,j),j+=3,Q.width=1+d(U,j),j+=3,Q.height=1+d(U,j),j+=3,Q.duration=d(U,j),j+=3,Ce=U[j++],Q.dispose=1&Ce,Q.blend=Ce>>1&1}le!="ANMF"&&(j+=de)}return O}}(b,0);C.response=b,C.rgbaoutput=!0,C.dataurl=!1;var N=C.header?C.header:null,k=C.frames?C.frames:null;if(N){N.loop_counter=N.loop_count,p=[N.canvas_height],m=[N.canvas_width];for(var E=0;E<k.length&&k[E].blend!=0;E++);}var _=k[0],M=y.WebPDecodeRGBA(b,_.src_off,_.src_size,m,p);_.rgba=M,_.imgwidth=m[0],_.imgheight=p[0];for(var D=0;D<m[0]*p[0]*4;D++)B[D]=M[D];return this.width=m,this.height=p,this.data=B,this}(function(t){var e=function(){return typeof bu=="function"},n=function(p,m,B,y){var b=4,C=A;switch(y){case t.image_compression.FAST:b=1,C=i;break;case t.image_compression.MEDIUM:b=6,C=o;break;case t.image_compression.SLOW:b=9,C=l}p=r(p,m,B,C);var N=bu(p,{level:b});return t.__addimage__.arrayBufferToBinaryString(N)},r=function(p,m,B,y){for(var b,C,N,k=p.length/m,E=new Uint8Array(p.length+k),_=d(),M=0;M<k;M+=1){if(N=M*m,b=p.subarray(N,N+m),y)E.set(y(b,B,C),N+M);else{for(var D,U=_.length,j=[];D<U;D+=1)j[D]=_[D](b,B,C);var O=h(j.concat());E.set(j[O],N+M)}C=b}return E},a=function(p){var m=Array.apply([],p);return m.unshift(0),m},i=function(p,m){var B,y=[],b=p.length;y[0]=1;for(var C=0;C<b;C+=1)B=p[C-m]||0,y[C+1]=p[C]-B+256&255;return y},A=function(p,m,B){var y,b=[],C=p.length;b[0]=2;for(var N=0;N<C;N+=1)y=B&&B[N]||0,b[N+1]=p[N]-y+256&255;return b},o=function(p,m,B){var y,b,C=[],N=p.length;C[0]=3;for(var k=0;k<N;k+=1)y=p[k-m]||0,b=B&&B[k]||0,C[k+1]=p[k]+256-(y+b>>>1)&255;return C},l=function(p,m,B){var y,b,C,N,k=[],E=p.length;k[0]=4;for(var _=0;_<E;_+=1)y=p[_-m]||0,b=B&&B[_]||0,C=B&&B[_-m]||0,N=c(y,b,C),k[_+1]=p[_]-N+256&255;return k},c=function(p,m,B){if(p===m&&m===B)return p;var y=Math.abs(m-B),b=Math.abs(p-B),C=Math.abs(p+m-B-B);return y<=b&&y<=C?p:b<=C?m:B},d=function(){return[a,i,A,o,l]},h=function(p){var m=p.map(function(B){return B.reduce(function(y,b){return y+Math.abs(b)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(p,m,B,y){var b,C,N,k,E,_,M,D,U,j,O,F,I,P,V,ee=this.decode.FLATE_DECODE,X="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(N=new $y(p)).imgData,C=N.bits,b=N.colorSpace,E=N.colors,[4,6].indexOf(N.colorType)!==-1){if(N.bits===8){U=(D=N.pixelBitlength==32?new Uint32Array(N.decodePixels().buffer):N.pixelBitlength==16?new Uint16Array(N.decodePixels().buffer):new Uint8Array(N.decodePixels().buffer)).length,O=new Uint8Array(U*N.colors),j=new Uint8Array(U);var le,ae=N.pixelBitlength-N.bits;for(P=0,V=0;P<U;P++){for(I=D[P],le=0;le<ae;)O[V++]=I>>>le&255,le+=N.bits;j[P]=I>>>le&255}}if(N.bits===16){U=(D=new Uint32Array(N.decodePixels().buffer)).length,O=new Uint8Array(U*(32/N.pixelBitlength)*N.colors),j=new Uint8Array(U*(32/N.pixelBitlength)),F=N.colors>1,P=0,V=0;for(var de=0;P<U;)I=D[P++],O[V++]=I>>>0&255,F&&(O[V++]=I>>>16&255,I=D[P++],O[V++]=I>>>0&255),j[de++]=I>>>16&255;C=8}y!==t.image_compression.NONE&&e()?(p=n(O,N.width*N.colors,N.colors,y),M=n(j,N.width,1,y)):(p=O,M=j,ee=void 0)}if(N.colorType===3&&(b=this.color_spaces.INDEXED,_=N.palette,N.transparency.indexed)){var ue=N.transparency.indexed,Ce=0;for(P=0,U=ue.length;P<U;++P)Ce+=ue[P];if((Ce/=255)===U-1&&ue.indexOf(0)!==-1)k=[ue.indexOf(0)];else if(Ce!==U){for(D=N.decodePixels(),j=new Uint8Array(D.length),P=0,U=D.length;P<U;P++)j[P]=ue[D[P]];M=n(j,N.width,1)}}var Q=function(z){var W;switch(z){case t.image_compression.FAST:W=11;break;case t.image_compression.MEDIUM:W=13;break;case t.image_compression.SLOW:W=14;break;default:W=12}return W}(y);return ee===this.decode.FLATE_DECODE&&(X="/Predictor "+Q+" "),X+="/Colors "+E+" /BitsPerComponent "+C+" /Columns "+N.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(M&&this.__addimage__.isArrayBuffer(M)||this.__addimage__.isArrayBufferView(M))&&(M=this.__addimage__.arrayBufferToBinaryString(M)),{alias:B,data:p,index:m,filter:ee,decodeParameters:X,transparency:k,palette:_,sMask:M,predictor:Q,width:N.width,height:N.height,bitsPerComponent:C,colorSpace:b}}}})(it.API),function(t){t.processGIF89A=function(e,n,r,a){var i=new Xy(e),A=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:A,height:o},d=new Kd(100).encode(c,100);return t.processJPEG.call(this,d,n,r,a)},t.processGIF87A=t.processGIF89A}(it.API),As.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},As.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){Ht.log("bit decode error:"+n)}},As.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var i=this.datav.getUint8(this.pos++,!0),A=r*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[A+4*o]=l.blue,this.data[A+4*o+1]=l.green,this.data[A+4*o+2]=l.red,this.data[A+4*o+3]=255}n!==0&&(this.pos+=4-n)}},As.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<t;a++){var i=this.datav.getUint8(this.pos++,!0),A=r*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[A]=c.blue,this.data[A+1]=c.green,this.data[A+2]=c.red,this.data[A+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[A+4]=c.blue,this.data[A+4+1]=c.green,this.data[A+4+2]=c.red,this.data[A+4+3]=255}e!==0&&(this.pos+=4-e)}},As.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(a<this.palette.length){var A=this.palette[a];this.data[i]=A.red,this.data[i+1]=A.green,this.data[i+2]=A.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},As.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var A=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,l=(i>>10&e)/e*255|0,c=i>>15?255:0,d=r*this.width*4+4*a;this.data[d]=l,this.data[d+1]=o,this.data[d+2]=A,this.data[d+3]=c}this.pos+=t}},As.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var A=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(A&e)/e*255|0,l=(A>>5&n)/n*255|0,c=(A>>11)/e*255|0,d=a*this.width*4+4*i;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=255}this.pos+=t}},As.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),A=e*this.width*4+4*n;this.data[A]=i,this.data[A+1]=a,this.data[A+2]=r,this.data[A+3]=255}this.pos+=this.width%4}},As.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=r,this.data[o+3]=A}},As.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,a){var i=new As(e,!1),A=i.width,o=i.height,l={data:i.getData(),width:A,height:o},c=new Kd(100).encode(l,100);return t.processJPEG.call(this,c,n,r,a)}}(it.API),Vh.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,a){var i=new Vh(e),A=i.width,o=i.height,l={data:i.getData(),width:A,height:o},c=new Kd(100).encode(l,100);return t.processJPEG.call(this,c,n,r,a)}}(it.API),it.API.processRGBA=function(t,e,n){for(var r=t.data,a=r.length,i=new Uint8Array(a/4*3),A=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var d=r[c],h=r[c+1],p=r[c+2],m=r[c+3];i[o++]=d,i[o++]=h,i[o++]=p,A[l++]=m}var B=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(A),data:B,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},it.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},$i=it.API,Tl=$i.getCharWidthsArray=function(t,e){var n,r,a=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),A=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=c.fof?c.fof:1,h=e.doKerning!==!1,p=0,m=t.length,B=0,y=o[0]||l,b=[];for(n=0;n<m;n++)r=t.charCodeAt(n),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(r))+A*(1e3/i)||0)/1e3):(p=h&&_t(c[r])==="object"&&!isNaN(parseInt(c[r][B],10))?c[r][B]/d:0,b.push((o[r]||y)/l+p)),B=r;return b},Rh=$i.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return $i.processArabic&&(t=$i.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,a)/n:Tl.apply(this,arguments).reduce(function(i,A){return i+A},0)},Hh=function(t,e,n,r){for(var a=[],i=0,A=t.length,o=0;i!==A&&o+e[i]<n;)o+=e[i],i++;a.push(t.slice(0,i));var l=i;for(o=0;i!==A;)o+e[i]>r&&(a.push(t.slice(l,i)),o=0,l=i),o+=e[i],i++;return l!==i&&a.push(t.slice(l,i)),a},Oh=function(t,e,n){n||(n={});var r,a,i,A,o,l,c,d=[],h=[d],p=n.textIndent||0,m=0,B=0,y=t.split(" "),b=Tl.apply(this,[" ",n])[0];if(l=n.lineIndent===-1?y[0].length+2:n.lineIndent||0){var C=Array(l).join(" "),N=[];y.map(function(E){(E=E.split(/\s*\n/)).length>1?N=N.concat(E.map(function(_,M){return(M&&_.length?`
`:"")+_})):N.push(E[0])}),y=N,l=Rh.apply(this,[C,n])}for(i=0,A=y.length;i<A;i++){var k=0;if(r=y[i],l&&r[0]==`
`&&(r=r.substr(1),k=1),p+m+(B=(a=Tl.apply(this,[r,n])).reduce(function(E,_){return E+_},0))>e||k){if(B>e){for(o=Hh.apply(this,[r,a,e-(p+m),e]),d.push(o.shift()),d=[o.pop()];o.length;)h.push([o.shift()]);B=a.slice(r.length-(d[0]?d[0].length:0)).reduce(function(E,_){return E+_},0)}else d=[r];h.push(d),p=B+l,m=b}else d.push(r),p+=m+B,m=b}return c=l?function(E,_){return(_?C:"")+E.join(" ")}:function(E){return E.join(" ")},h.map(c)},$i.splitTextToSize=function(t,e,n){var r,a=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var A=1*this.internal.scaleFactor*e/a;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=r.length;o<l;o++)c=c.concat(Oh.apply(this,[r[o],A,i]));return c},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",n={},r={},a=0;a<e.length;a++)n[e[a]]="0123456789abcdef"[a],r["0123456789abcdef"[a]]=e[a];var i=function(h){return"0x"+parseInt(h,10).toString(16)},A=t.__fontmetrics__.compress=function(h){var p,m,B,y,b=["{"];for(var C in h){if(p=h[C],isNaN(parseInt(C,10))?m="'"+C+"'":(C=parseInt(C,10),m=(m=i(C).slice(2)).slice(0,-1)+r[m.slice(-1)]),typeof p=="number")p<0?(B=i(p).slice(3),y="-"):(B=i(p).slice(2),y=""),B=y+B.slice(0,-1)+r[B.slice(-1)];else{if(_t(p)!=="object")throw new Error("Don't know what to do with value type "+_t(p)+".");B=A(p)}b.push(m+B)}return b.push("}"),b.join("")},o=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,B,y,b={},C=1,N=b,k=[],E="",_="",M=h.length-1,D=1;D<M;D+=1)(y=h[D])=="'"?p?(B=p.join(""),p=void 0):p=[]:p?p.push(y):y=="{"?(k.push([N,B]),N={},B=void 0):y=="}"?((m=k.pop())[0][m[1]]=N,B=void 0,N=m[0]):y=="-"?C=-1:B===void 0?n.hasOwnProperty(y)?(E+=n[y],B=parseInt(E,16)*C,C=1,E=""):E+=y:n.hasOwnProperty(y)?(_+=n[y],N[B]=parseInt(_,16)*C,C=1,B=void 0,_=""):_+=y;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},d={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var p=h.font,m=d.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var B=c.Unicode[p.postScriptName];B&&(p.metadata.Unicode.encoding=B,p.encoding=B.codePages[0])}])}(it.API),function(t){var e=function(n){for(var r=n.length,a=new Uint8Array(r),i=0;i<r;i++)a[i]=n.charCodeAt(i);return a};t.API.events.push(["addFont",function(n){var r=void 0,a=n.font,i=n.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(r=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(A,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(Qo(o)),A.metadata=t.API.TTFFont.open(o),A.metadata.Unicode=A.metadata.Unicode||{encoding:{},kerning:{},widths:[]},A.metadata.glyIdsUsed=[0]})(a,r)}}])}(it),function(t){function e(){return(lt.canvg?Promise.resolve(lt.canvg):NA(()=>import("./index.es-DDP51_M_.js"),__vite__mapDeps([4,1]))).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}it.API.addSvgAsImage=function(n,r,a,i,A,o,l,c){if(isNaN(r)||isNaN(a))throw Ht.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(A))throw Ht.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=A;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(B){return B.fromString(h,n,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(B){return B.render(p)}).then(function(){m.addImage(d.toDataURL("image/jpeg",1),r,a,i,A,l,c)})}}(),it.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(e,n);return this},it.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,a,i,A={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(A),l=[],c=0,d=0,h=0;function p(B,y){var b,C=!1;for(b=0;b<B.length;b+=1)B[b]===y&&(C=!0);return C}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(A)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=o.length;for(h=0;h<m;h+=1)n[o[h]].value=n[o[h]].defaultValue,n[o[h]].explicitSet=!1}if(_t(t)==="object"){for(a in t)if(i=t[a],p(o,a)&&i!==void 0){if(n[a].type==="boolean"&&typeof i=="boolean")n[a].value=i;else if(n[a].type==="name"&&p(n[a].valueSet,i))n[a].value=i;else if(n[a].type==="integer"&&Number.isInteger(i))n[a].value=i;else if(n[a].type==="array"){for(c=0;c<i.length;c+=1)if(r=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(d=0;d<i[c].length;d+=1)typeof i[c][d]!="number"&&(r=!1);r===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}n[a].value="["+l.join(" ")+"]"}else n[a].value=n[a].defaultValue;n[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var B,y=[];for(B in n)n[B].explicitSet===!0&&(n[B].type==="name"?y.push("/"+B+" /"+n[B].value):y.push("/"+B+" "+n[B].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),A=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+A.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+A+o+l),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(it.API),function(t){var e=t.API,n=e.pdfEscape16=function(i,A){for(var o,l=A.metadata.Unicode.widths,c=["","0","00","000","0000"],d=[""],h=0,p=i.length;h<p;++h){if(o=A.metadata.characterToGlyph(i.charCodeAt(h)),A.metadata.glyIdsUsed.push(o),A.metadata.toUnicode[o]=i.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(A.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(c[4-o.length],o)}return d.join("")},r=function(i){var A,o,l,c,d,h,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,p=(o=Object.keys(i).sort(function(m,B){return m-B})).length;h<p;h++)A=o[h],l.length>=100&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[A]!==void 0&&i[A]!==null&&typeof i[A].toString=="function"&&(c=("0000"+i[A].toString(16)).slice(-4),A=("0000"+(+A).toString(16)).slice(-4),l.push("<"+A+"><"+c+">"));return l.length&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(A){var o=A.font,l=A.out,c=A.newObject,d=A.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),m="",B=0;B<p.length;B++)m+=String.fromCharCode(p[B]);var y=c();d({data:m,addLength1:!0,objectId:y}),l("endobj");var b=c();d({data:r(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var C=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+oA(o.fontName)),l("/FontFile2 "+y+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var N=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+oA(o.fontName)),l("/FontDescriptor "+C+" 0 R"),l("/W "+t.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+oA(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+N+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(A){var o=A.font,l=A.out,c=A.newObject,d=A.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",m=0;m<h.length;m++)p+=String.fromCharCode(h[m]);var B=c();d({data:p,addLength1:!0,objectId:B}),l("endobj");var y=c();d({data:r(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var b=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+B+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+oA(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var C=0;C<o.metadata.hmtx.widths.length;C++)o.metadata.hmtx.widths[C]=parseInt(o.metadata.hmtx.widths[C]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+oA(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var A,o=i.text||"",l=i.x,c=i.y,d=i.options||{},h=i.mutex||{},p=h.pdfEscape,m=h.activeFontKey,B=h.fonts,y=m,b="",C=0,N="",k=B[y].encoding;if(B[y].encoding!=="Identity-H")return{text:o,x:l,y:c,options:d,mutex:h};for(N=o,y=m,Array.isArray(o)&&(N=o[0]),C=0;C<N.length;C+=1)B[y].metadata.hasOwnProperty("cmap")&&(A=B[y].metadata.cmap.unicode.codeMap[N[C].charCodeAt(0)]),A||N[C].charCodeAt(0)<256&&B[y].metadata.hasOwnProperty("Unicode")?b+=N[C]:b+="";var E="";return parseInt(y.slice(1))<14||k==="WinAnsiEncoding"?E=p(b,y).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):k==="Identity-H"&&(E=n(b,B[y])),h.isHex=!0,{text:E,x:l,y:c,options:d,mutex:h}};e.events.push(["postProcessText",function(i){var A=i.text||"",o=[],l={text:A,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(A)){var c=0;for(c=0;c<A.length;c+=1)Array.isArray(A[c])&&A[c].length===3?o.push([a(Object.assign({},l,{text:A[c][0]})).text,A[c][1],A[c][2]]):o.push(a(Object.assign({},l,{text:A[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:A})).text}])}(it),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(it.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var a,i,A,o,l,c,d,h=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],B={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],C=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),N=!1,k=0;this.__bidiEngine__={};var E=function(F){var I=F.charCodeAt(),P=I>>8,V=y[P];return V!==void 0?h[256*V+(255&I)]:P===252||P===253?"AL":C.test(P)?"L":P===8?"R":"N"},_=function(F){for(var I,P=0;P<F.length;P++){if((I=E(F.charAt(P)))==="L")return!1;if(I==="R")return!0}return!1},M=function(F,I,P,V){var ee,X,le,ae,de=I[V];switch(de){case"L":case"R":N=!1;break;case"N":case"AN":break;case"EN":N&&(de="AN");break;case"AL":N=!0,de="R";break;case"WS":de="N";break;case"CS":V<1||V+1>=I.length||(ee=P[V-1])!=="EN"&&ee!=="AN"||(X=I[V+1])!=="EN"&&X!=="AN"?de="N":N&&(X="AN"),de=X===ee?X:"N";break;case"ES":de=(ee=V>0?P[V-1]:"B")==="EN"&&V+1<I.length&&I[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&P[V-1]==="EN"){de="EN";break}if(N){de="N";break}for(le=V+1,ae=I.length;le<ae&&I[le]==="ET";)le++;de=le<ae&&I[le]==="EN"?"EN":"N";break;case"NSM":if(A&&!o){for(ae=I.length,le=V+1;le<ae&&I[le]==="NSM";)le++;if(le<ae){var ue=F[V],Ce=ue>=1425&&ue<=2303||ue===64286;if(ee=I[le],Ce&&(ee==="R"||ee==="AL")){de="R";break}}}de=V<1||(ee=I[V-1])==="B"?"N":P[V-1];break;case"B":N=!1,a=!0,de=k;break;case"S":i=!0,de="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":N=!1;break;case"BN":de="N"}return de},D=function(F,I,P){var V=F.split("");return P&&U(V,P,{hiLevel:k}),V.reverse(),I&&I.reverse(),V.join("")},U=function(F,I,P){var V,ee,X,le,ae,de=-1,ue=F.length,Ce=0,Q=[],z=k?m:p,W=[];for(N=!1,a=!1,i=!1,ee=0;ee<ue;ee++)W[ee]=E(F[ee]);for(X=0;X<ue;X++){if(ae=Ce,Q[X]=M(F,W,Q,X),V=240&(Ce=z[ae][B[Q[X]]]),Ce&=15,I[X]=le=z[Ce][5],V>0)if(V===16){for(ee=de;ee<X;ee++)I[ee]=1;de=-1}else de=-1;if(z[Ce][6])de===-1&&(de=X);else if(de>-1){for(ee=de;ee<X;ee++)I[ee]=le;de=-1}W[X]==="B"&&(I[X]=0),P.hiLevel|=le}i&&function(Z,ne,fe){for(var xe=0;xe<fe;xe++)if(Z[xe]==="S"){ne[xe]=k;for(var we=xe-1;we>=0&&Z[we]==="WS";we--)ne[we]=k}}(W,I,ue)},j=function(F,I,P,V,ee){if(!(ee.hiLevel<F)){if(F===1&&k===1&&!a)return I.reverse(),void(P&&P.reverse());for(var X,le,ae,de,ue=I.length,Ce=0;Ce<ue;){if(V[Ce]>=F){for(ae=Ce+1;ae<ue&&V[ae]>=F;)ae++;for(de=Ce,le=ae-1;de<le;de++,le--)X=I[de],I[de]=I[le],I[le]=X,P&&(X=P[de],P[de]=P[le],P[le]=X);Ce=ae}Ce++}}},O=function(F,I,P){var V=F.split(""),ee={hiLevel:k};return P||(P=[]),U(V,P,ee),function(X,le,ae){if(ae.hiLevel!==0&&d)for(var de,ue=0;ue<X.length;ue++)le[ue]===1&&(de=b.indexOf(X[ue]))>=0&&(X[ue]=b[de+1])}(V,P,ee),j(2,V,I,P,ee),j(1,V,I,P,ee),V.join("")};return this.__bidiEngine__.doBidiReorder=function(F,I,P){if(function(ee,X){if(X)for(var le=0;le<ee.length;le++)X[le]=le;o===void 0&&(o=_(ee)),c===void 0&&(c=_(ee))}(F,I),A||!l||c)if(A&&l&&o^c)k=o?1:0,F=D(F,I,P);else if(!A&&l&&c)k=o?1:0,F=O(F,I,P),F=D(F,I);else if(!A||o||l||c){if(A&&!l&&o^c)F=D(F,I),o?(k=0,F=O(F,I,P)):(k=1,F=O(F,I,P),F=D(F,I));else if(A&&o&&!l&&c)k=1,F=O(F,I,P),F=D(F,I);else if(!A&&!l&&o^c){var V=d;o?(k=1,F=O(F,I,P),k=0,d=!1,F=O(F,I,P),d=V):(k=0,F=O(F,I,P),F=D(F,I),k=1,d=!1,F=O(F,I,P),d=V,F=D(F,I))}}else k=0,F=O(F,I,P);else k=o?1:0,F=O(F,I,P);return F},this.__bidiEngine__.setOptions=function(F){F&&(A=F.isInputVisual,l=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,d=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var a=r.text,i=(r.x,r.y,r.options||{}),A=(r.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(A=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?A.push([n.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):A.push([n.doBidiReorder(a[o])]);r.text=A}else r.text=n.doBidiReorder(a);n.setOptions({isInputVisual:!0})}])}(it),it.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new _a(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new f2(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Zy(this.contents),this.head=new t2(this),this.name=new i2(this),this.cmap=new pp(this),this.toUnicode={},this.hhea=new n2(this),this.maxp=new A2(this),this.hmtx=new o2(this),this.post=new s2(this),this.os2=new r2(this),this.loca=new u2(this),this.glyf=new l2(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var A,o,l,c;for(c=[],A=0,o=(l=this.bbox).length;A<o;A++)e=l[A],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(r=255&(a=this.post.italic_angle),32768&(n=a>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var a,i,A,o;for(A=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=e.charCodeAt(i),A+=this.widthOfGlyph(this.characterToGlyph(a))+r*(1e3/n)||0;return A*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var fs,_a=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,a;for(a=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)a.push(this.writeByte(e.charCodeAt(n)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,a,i,A,o,l;return e=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),i=this.readByte(),A=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^a)+16777216*(255^i)+65536*(255^A)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*a+16777216*i+65536*A+256*o+l},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,a,i;for(i=[],r=0,a=e.length;r<a;r++)n=e[r],i.push(this.writeByte(n));return i},t}(),Zy=function(){var t;function e(n){var r,a,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,a,i,A,o,l,c,d,h,p,m,B,y;for(y in m=Object.keys(n).length,l=Math.log(2),h=16*Math.floor(Math.log(m)/l),A=Math.floor(h/l),d=16*m-h,(a=new _a).writeInt(this.scalarType),a.writeShort(m),a.writeShort(h),a.writeShort(A),a.writeShort(d),i=16*m,c=a.pos+i,o=null,B=[],n)for(p=n[y],a.writeString(y),a.writeInt(t(p)),a.writeInt(c),a.writeInt(p.length),B=B.concat(p),y==="head"&&(o=c),c+=p.length;c%4;)B.push(0),c++;return a.write(B),r=2981146554-t(a.data),a.pos=o+8,a.writeUInt32(r),a.data},t=function(n){var r,a,i,A;for(n=xp.call(n);n.length%4;)n.push(0);for(i=new _a(n),a=0,r=0,A=n.length;r<A;r=r+=4)a+=i.readUInt32();return 4294967295&a},e}(),e2={}.hasOwnProperty,js=function(t,e){for(var n in e)e2.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};fs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var t2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="head",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},e.prototype.encode=function(n){var r;return(r=new _a).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},e}(),Kh=function(){function t(e,n){var r,a,i,A,o,l,c,d,h,p,m,B,y,b,C,N,k;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(m=e.readUInt16(),p=m/2,e.pos+=6,i=function(){var E,_;for(_=[],l=E=0;0<=p?E<p:E>p;l=0<=p?++E:--E)_.push(e.readUInt16());return _}(),e.pos+=2,y=function(){var E,_;for(_=[],l=E=0;0<=p?E<p:E>p;l=0<=p?++E:--E)_.push(e.readUInt16());return _}(),c=function(){var E,_;for(_=[],l=E=0;0<=p?E<p:E>p;l=0<=p?++E:--E)_.push(e.readUInt16());return _}(),d=function(){var E,_;for(_=[],l=E=0;0<=p?E<p:E>p;l=0<=p?++E:--E)_.push(e.readUInt16());return _}(),a=(this.length-e.pos+this.offset)/2,o=function(){var E,_;for(_=[],l=E=0;0<=a?E<a:E>a;l=0<=a?++E:--E)_.push(e.readUInt16());return _}(),l=C=0,k=i.length;C<k;l=++C)for(b=i[l],r=N=B=y[l];B<=b?N<=b:N>=b;r=B<=b?++N:--N)d[l]===0?A=r+c[l]:(A=o[d[l]/2+(r-B)-(p-l)]||0)!==0&&(A+=c[l]),this.codeMap[r]=65535&A}e.pos=h}return t.encode=function(e,n){var r,a,i,A,o,l,c,d,h,p,m,B,y,b,C,N,k,E,_,M,D,U,j,O,F,I,P,V,ee,X,le,ae,de,ue,Ce,Q,z,W,Z,ne,fe,xe,we,Qe,je,Me;switch(V=new _a,A=Object.keys(e).sort(function(De,st){return De-st}),n){case"macroman":for(y=0,b=function(){var De=[];for(B=0;B<256;++B)De.push(0);return De}(),N={0:0},i={},ee=0,de=A.length;ee<de;ee++)N[we=e[a=A[ee]]]==null&&(N[we]=++y),i[a]={old:e[a],new:N[e[a]]},b[a]=N[e[a]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(b),{charMap:i,subtable:V.data,maxGlyphID:y+1};case"unicode":for(I=[],h=[],k=0,N={},r={},C=c=null,X=0,ue=A.length;X<ue;X++)N[_=e[a=A[X]]]==null&&(N[_]=++k),r[a]={old:_,new:N[_]},o=N[_]-a,C!=null&&o===c||(C&&h.push(C),I.push(a),c=o),C=a;for(C&&h.push(C),h.push(65535),I.push(65535),O=2*(j=I.length),U=2*Math.pow(Math.log(j)/Math.LN2,2),p=Math.log(U/2)/Math.LN2,D=2*j-U,l=[],M=[],m=[],B=le=0,Ce=I.length;le<Ce;B=++le){if(F=I[B],d=h[B],F===65535){l.push(0),M.push(0);break}if(F-(P=r[F].new)>=32768)for(l.push(0),M.push(2*(m.length+j-B)),a=ae=F;F<=d?ae<=d:ae>=d;a=F<=d?++ae:--ae)m.push(r[a].new);else l.push(P-F),M.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*j+2*m.length),V.writeUInt16(0),V.writeUInt16(O),V.writeUInt16(U),V.writeUInt16(p),V.writeUInt16(D),fe=0,Q=h.length;fe<Q;fe++)a=h[fe],V.writeUInt16(a);for(V.writeUInt16(0),xe=0,z=I.length;xe<z;xe++)a=I[xe],V.writeUInt16(a);for(Qe=0,W=l.length;Qe<W;Qe++)o=l[Qe],V.writeUInt16(o);for(je=0,Z=M.length;je<Z;je++)E=M[je],V.writeUInt16(E);for(Me=0,ne=m.length;Me<ne;Me++)y=m[Me],V.writeUInt16(y);return{charMap:r,subtable:V.data,maxGlyphID:k+1}}},t}(),pp=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="cmap",e.prototype.parse=function(n){var r,a,i;for(n.pos=this.offset,this.version=n.readUInt16(),i=n.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)r=new Kh(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(n,r){var a,i;return r==null&&(r="macroman"),a=Kh.encode(n,r),(i=new _a).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},e}(),n2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="hhea",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},e}(),r2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="OS/2",e.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,a;for(a=[],r=0;r<10;++r)a.push(n.readByte());return a}(),this.charRange=function(){var r,a;for(a=[],r=0;r<4;++r)a.push(n.readInt());return a}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(n.readInt());return a}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},e}(),s2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="post",e.prototype.parse=function(n){var r,a,i;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var A;for(a=n.readUInt16(),this.glyphNameIndex=[],A=0;0<=a?A<a:A>a;A=0<=a?++A:--A)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],i=[];n.pos<this.offset+this.length;)r=n.readByte(),i.push(this.names.push(n.readString(r)));return i;case 151552:return a=n.readUInt16(),this.offsets=n.read(a);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],A=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;A=0<=l?++o:--o)c.push(n.readUInt32());return c}).call(this)}},e}(),a2=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},i2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="name",e.prototype.parse=function(n){var r,a,i,A,o,l,c,d,h,p,m;for(n.pos=this.offset,n.readShort(),r=n.readShort(),l=n.readShort(),a=[],A=0;0<=r?A<r:A>r;A=0<=r?++A:--A)a.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+l+n.readShort()});for(c={},A=h=0,p=a.length;h<p;A=++h)i=a[A],n.pos=i.offset,d=n.readString(i.length),o=new a2(d,i),c[m=i.nameID]==null&&(c[m]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),A2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="maxp",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},e}(),o2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="hmtx",e.prototype.parse=function(n){var r,a,i,A,o,l,c;for(n.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,h;for(h=[],r=d=0;0<=i?d<i:d>i;r=0<=i?++d:--d)h.push(n.readInt16());return h}(),this.widths=(function(){var d,h,p,m;for(m=[],d=0,h=(p=this.metrics).length;d<h;d++)A=p[d],m.push(A.advance);return m}).call(this),a=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(a));return c},e.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},e}(),xp=[].slice,l2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(n){var r,a,i,A,o,l,c,d,h,p;return n in this.cache?this.cache[n]:(A=this.file.loca,r=this.file.contents,a=A.indexOf(n),(i=A.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+a,o=(l=new _a(r.read(i))).readShort(),d=l.readShort(),p=l.readShort(),c=l.readShort(),h=l.readShort(),this.cache[n]=o===-1?new d2(l,d,p,c,h):new c2(l,o,d,p,c,h),this.cache[n]))},e.prototype.encode=function(n,r,a){var i,A,o,l,c;for(o=[],A=[],l=0,c=r.length;l<c;l++)i=n[r[l]],A.push(o.length),i&&(o=o.concat(i.encode(a)));return A.push(o.length),{table:o,offsets:A}},e}(),c2=function(){function t(e,n,r,a,i,A){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=a,this.xMax=i,this.yMax=A,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),d2=function(){function t(e,n,r,a,i){var A,o;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],A=this.raw;o=A.readShort(),this.glyphOffsets.push(A.pos),this.glyphIDs.push(A.readUInt16()),32&o;)A.pos+=1&o?4:2,128&o?A.pos+=8:64&o?A.pos+=4:8&o&&(A.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new _a(xp.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),u2=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return js(e,fs),e.prototype.tag="loca",e.prototype.parse=function(n){var r,a;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,A;for(A=[],a=0,i=this.length;a<i;a+=2)A.push(2*n.readUInt16());return A}).call(this):(function(){var i,A;for(A=[],a=0,i=this.length;a<i;a+=4)A.push(n.readUInt32());return A}).call(this)},e.prototype.indexOf=function(n){return this.offsets[n]},e.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},e.prototype.encode=function(n,r){for(var a=new Uint32Array(this.offsets.length),i=0,A=0,o=0;o<a.length;++o)if(a[o]=i,A<r.length&&r[A]==o){++A,a[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var d=new Array(4*a.length),h=0;h<a.length;++h)d[4*h+3]=255&a[h],d[4*h+2]=(65280&a[h])>>8,d[4*h+1]=(16711680&a[h])>>16,d[4*h]=(4278190080&a[h])>>24;return d},e}(),f2=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,a,i;for(n in a=this.font.cmap.tables[0].codeMap,e={},i=this.subset)r=i[n],e[n]=a[r];return e},t.prototype.glyphsFor=function(e){var n,r,a,i,A,o,l;for(a={},A=0,o=e.length;A<o;A++)a[i=e[A]]=this.font.glyf.glyphFor(i);for(i in n=[],a)(r=a[i])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(i in l=this.glyphsFor(n))r=l[i],a[i]=r;return a},t.prototype.encode=function(e,n){var r,a,i,A,o,l,c,d,h,p,m,B,y,b,C;for(a in r=pp.encode(this.generateCmap(),"unicode"),A=this.glyphsFor(e),m={0:0},C=r.charMap)m[(l=C[a]).old]=l.new;for(B in p=r.maxGlyphID,A)B in m||(m[B]=p++);return d=function(N){var k,E;for(k in E={},N)E[N[k]]=k;return E}(m),h=Object.keys(d).sort(function(N,k){return N-k}),y=function(){var N,k,E;for(E=[],N=0,k=h.length;N<k;N++)o=h[N],E.push(d[o]);return E}(),i=this.font.glyf.encode(A,y,m),c=this.font.loca.encode(i.offsets,y),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},t}();it.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,a,i,A;if(Array.isArray(n))return"["+function(){var o,l,c;for(c=[],o=0,l=n.length;o<l;o++)r=n[o],c.push(e.convert(r));return c}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(a in i=["<<"],n)A=n[a],i.push("/"+a+" "+e.convert(A));return i.push(">>"),i.join(`
`)}return""+n},e}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Fu=function(t,e){return Fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},Fu(t,e)};function hs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Fu(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Eu=function(){return Eu=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Eu.apply(this,arguments)};function ir(t,e,n,r){function a(i){return i instanceof n?i:new n(function(A){A(i)})}return new(n||(n=Promise))(function(i,A){function o(d){try{c(r.next(d))}catch(h){A(h)}}function l(d){try{c(r.throw(d))}catch(h){A(h)}}function c(d){d.done?i(d.value):a(d.value).then(o,l)}c((r=r.apply(t,[])).next())})}function $n(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,A;return A={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function o(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,a=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],a=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Ql(t,e,n){if(arguments.length===2)for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||e)}var Ys=function(){function t(e,n,r,a){this.left=e,this.top=n,this.width=r,this.height=a}return t.prototype.add=function(e,n,r,a){return new t(this.left+e,this.top+n,this.width+r,this.height+a)},t.fromClientRect=function(e,n){return new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height)},t.fromDOMRectList=function(e,n){var r=Array.from(n).find(function(a){return a.width!==0});return r?new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),Yc=function(t,e){return Ys.fromClientRect(t,e.getBoundingClientRect())},h2=function(t){var e=t.body,n=t.documentElement;if(!e||!n)throw new Error("Unable to get document size");var r=Math.max(Math.max(e.scrollWidth,n.scrollWidth),Math.max(e.offsetWidth,n.offsetWidth),Math.max(e.clientWidth,n.clientWidth)),a=Math.max(Math.max(e.scrollHeight,n.scrollHeight),Math.max(e.offsetHeight,n.offsetHeight),Math.max(e.clientHeight,n.clientHeight));return new Ys(0,0,r,a)},$c=function(t){for(var e=[],n=0,r=t.length;n<r;){var a=t.charCodeAt(n++);if(a>=55296&&a<=56319&&n<r){var i=t.charCodeAt(n++);(i&64512)===56320?e.push(((a&1023)<<10)+(i&1023)+65536):(e.push(a),n--)}else e.push(a)}return e},un=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var r=[],a=-1,i="";++a<n;){var A=t[a];A<=65535?r.push(A):(A-=65536,r.push((A>>10)+55296,A%1024+56320)),(a+1===n||r.length>16384)&&(i+=String.fromCharCode.apply(String,r),r.length=0)}return i},qh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g2=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Ll=0;Ll<qh.length;Ll++)g2[qh.charCodeAt(Ll)]=Ll;var zh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Io=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _l=0;_l<zh.length;_l++)Io[zh.charCodeAt(_l)]=_l;var m2=function(t){var e=t.length*.75,n=t.length,r,a=0,i,A,o,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var c=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(c)?c:new Uint8Array(c);for(r=0;r<n;r+=4)i=Io[t.charCodeAt(r)],A=Io[t.charCodeAt(r+1)],o=Io[t.charCodeAt(r+2)],l=Io[t.charCodeAt(r+3)],d[a++]=i<<2|A>>4,d[a++]=(A&15)<<4|o>>2,d[a++]=(o&3)<<6|l&63;return c},p2=function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n.push(t[r+1]<<8|t[r]);return n},x2=function(t){for(var e=t.length,n=[],r=0;r<e;r+=4)n.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return n},li=5,Bf=11,qd=2,w2=Bf-li,wp=65536>>li,y2=1<<li,zd=y2-1,b2=1024>>li,v2=wp+b2,B2=v2,C2=32,N2=B2+C2,S2=65536>>Bf,I2=1<<w2,F2=I2-1,Jh=function(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))},E2=function(t,e,n){return t.slice?t.slice(e,n):new Uint32Array(Array.prototype.slice.call(t,e,n))},k2=function(t,e){var n=m2(t),r=Array.isArray(n)?x2(n):new Uint32Array(n),a=Array.isArray(n)?p2(n):new Uint16Array(n),i=24,A=Jh(a,i/2,r[4]/2),o=r[5]===2?Jh(a,(i+r[4])/2):E2(r,Math.ceil((i+r[4])/4));return new U2(r[0],r[1],r[2],r[3],A,o)},U2=function(){function t(e,n,r,a,i,A){this.initialValue=e,this.errorValue=n,this.highStart=r,this.highValueIndex=a,this.index=i,this.data=A}return t.prototype.get=function(e){var n;if(e>=0){if(e<55296||e>56319&&e<=65535)return n=this.index[e>>li],n=(n<<qd)+(e&zd),this.data[n];if(e<=65535)return n=this.index[wp+(e-55296>>li)],n=(n<<qd)+(e&zd),this.data[n];if(e<this.highStart)return n=N2-S2+(e>>Bf),n=this.index[n],n+=e>>li&F2,n=this.index[n],n=(n<<qd)+(e&zd),this.data[n];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Wh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j2=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Ml=0;Ml<Wh.length;Ml++)j2[Wh.charCodeAt(Ml)]=Ml;var T2="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Yh=50,Q2=1,yp=2,bp=3,L2=4,_2=5,$h=7,vp=8,Xh=9,Sa=10,ku=11,Zh=12,Uu=13,M2=14,Fo=15,ju=16,Dl=17,wo=18,D2=19,eg=20,Tu=21,yo=22,Jd=23,Xi=24,Tr=25,Eo=26,ko=27,Zi=28,P2=29,ii=30,R2=31,Pl=32,Rl=33,Qu=34,Lu=35,_u=36,Oo=37,Mu=38,fc=39,hc=40,Wd=41,Bp=42,H2=43,O2=[9001,65288],Cp="!",vt="Ã—",Hl="Ã·",Du=k2(T2),zs=[ii,_u],Pu=[Q2,yp,bp,_2],Np=[Sa,vp],tg=[ko,Eo],G2=Pu.concat(Np),ng=[Mu,fc,hc,Qu,Lu],V2=[Fo,Uu],K2=function(t,e){e===void 0&&(e="strict");var n=[],r=[],a=[];return t.forEach(function(i,A){var o=Du.get(i);if(o>Yh?(a.push(!0),o-=Yh):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return r.push(A),n.push(ju);if(o===L2||o===ku){if(A===0)return r.push(A),n.push(ii);var l=n[A-1];return G2.indexOf(l)===-1?(r.push(r[A-1]),n.push(l)):(r.push(A),n.push(ii))}if(r.push(A),o===R2)return n.push(e==="strict"?Tu:Oo);if(o===Bp||o===P2)return n.push(ii);if(o===H2)return i>=131072&&i<=196605||i>=196608&&i<=262141?n.push(Oo):n.push(ii);n.push(o)}),[r,n,a]},Yd=function(t,e,n,r){var a=r[n];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var i=n;i<=r.length;){i++;var A=r[i];if(A===e)return!0;if(A!==Sa)break}if(a===Sa)for(var i=n;i>0;){i--;var o=r[i];if(Array.isArray(t)?t.indexOf(o)!==-1:t===o)for(var l=n;l<=r.length;){l++;var A=r[l];if(A===e)return!0;if(A!==Sa)break}if(o!==Sa)break}return!1},rg=function(t,e){for(var n=t;n>=0;){var r=e[n];if(r===Sa)n--;else return r}return 0},q2=function(t,e,n,r,a){if(n[r]===0)return vt;var i=r-1;if(Array.isArray(a)&&a[i]===!0)return vt;var A=i-1,o=i+1,l=e[i],c=A>=0?e[A]:0,d=e[o];if(l===yp&&d===bp)return vt;if(Pu.indexOf(l)!==-1)return Cp;if(Pu.indexOf(d)!==-1||Np.indexOf(d)!==-1)return vt;if(rg(i,e)===vp)return Hl;if(Du.get(t[i])===ku||(l===Pl||l===Rl)&&Du.get(t[o])===ku||l===$h||d===$h||l===Xh||[Sa,Uu,Fo].indexOf(l)===-1&&d===Xh||[Dl,wo,D2,Xi,Zi].indexOf(d)!==-1||rg(i,e)===yo||Yd(Jd,yo,i,e)||Yd([Dl,wo],Tu,i,e)||Yd(Zh,Zh,i,e))return vt;if(l===Sa)return Hl;if(l===Jd||d===Jd)return vt;if(d===ju||l===ju)return Hl;if([Uu,Fo,Tu].indexOf(d)!==-1||l===M2||c===_u&&V2.indexOf(l)!==-1||l===Zi&&d===_u||d===eg||zs.indexOf(d)!==-1&&l===Tr||zs.indexOf(l)!==-1&&d===Tr||l===ko&&[Oo,Pl,Rl].indexOf(d)!==-1||[Oo,Pl,Rl].indexOf(l)!==-1&&d===Eo||zs.indexOf(l)!==-1&&tg.indexOf(d)!==-1||tg.indexOf(l)!==-1&&zs.indexOf(d)!==-1||[ko,Eo].indexOf(l)!==-1&&(d===Tr||[yo,Fo].indexOf(d)!==-1&&e[o+1]===Tr)||[yo,Fo].indexOf(l)!==-1&&d===Tr||l===Tr&&[Tr,Zi,Xi].indexOf(d)!==-1)return vt;if([Tr,Zi,Xi,Dl,wo].indexOf(d)!==-1)for(var h=i;h>=0;){var p=e[h];if(p===Tr)return vt;if([Zi,Xi].indexOf(p)!==-1)h--;else break}if([ko,Eo].indexOf(d)!==-1)for(var h=[Dl,wo].indexOf(l)!==-1?A:i;h>=0;){var p=e[h];if(p===Tr)return vt;if([Zi,Xi].indexOf(p)!==-1)h--;else break}if(Mu===l&&[Mu,fc,Qu,Lu].indexOf(d)!==-1||[fc,Qu].indexOf(l)!==-1&&[fc,hc].indexOf(d)!==-1||[hc,Lu].indexOf(l)!==-1&&d===hc||ng.indexOf(l)!==-1&&[eg,Eo].indexOf(d)!==-1||ng.indexOf(d)!==-1&&l===ko||zs.indexOf(l)!==-1&&zs.indexOf(d)!==-1||l===Xi&&zs.indexOf(d)!==-1||zs.concat(Tr).indexOf(l)!==-1&&d===yo&&O2.indexOf(t[o])===-1||zs.concat(Tr).indexOf(d)!==-1&&l===wo)return vt;if(l===Wd&&d===Wd){for(var m=n[i],B=1;m>0&&(m--,e[m]===Wd);)B++;if(B%2!==0)return vt}return l===Pl&&d===Rl?vt:Hl},z2=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var n=K2(t,e.lineBreak),r=n[0],a=n[1],i=n[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(o){return[Tr,ii,Bp].indexOf(o)!==-1?Oo:o}));var A=e.wordBreak==="keep-all"?i.map(function(o,l){return o&&t[l]>=19968&&t[l]<=40959}):void 0;return[r,a,A]},J2=function(){function t(e,n,r,a){this.codePoints=e,this.required=n===Cp,this.start=r,this.end=a}return t.prototype.slice=function(){return un.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),W2=function(t,e){var n=$c(t),r=z2(n,e),a=r[0],i=r[1],A=r[2],o=n.length,l=0,c=0;return{next:function(){if(c>=o)return{done:!0,value:null};for(var d=vt;c<o&&(d=q2(n,i,a,++c,A))===vt;);if(d!==vt||c===o){var h=new J2(n,d,l,c);return l=c,{value:h,done:!1}}return{done:!0,value:null}}}},Y2=1,$2=2,$o=4,sg=8,vc=10,ag=47,Lo=92,X2=9,Z2=32,Ol=34,bo=61,eb=35,tb=36,nb=37,Gl=39,Vl=40,vo=41,rb=95,xr=45,sb=33,ab=60,ib=62,Ab=64,ob=91,lb=93,cb=61,db=123,Kl=63,ub=125,ig=124,fb=126,hb=128,Ag=65533,$d=42,Ai=43,gb=44,mb=58,pb=59,Go=46,xb=0,wb=8,yb=11,bb=14,vb=31,Bb=127,Ns=-1,Sp=48,Ip=97,Fp=101,Cb=102,Nb=117,Sb=122,Ep=65,kp=69,Up=70,Ib=85,Fb=90,Xn=function(t){return t>=Sp&&t<=57},Eb=function(t){return t>=55296&&t<=57343},eA=function(t){return Xn(t)||t>=Ep&&t<=Up||t>=Ip&&t<=Cb},kb=function(t){return t>=Ip&&t<=Sb},Ub=function(t){return t>=Ep&&t<=Fb},jb=function(t){return kb(t)||Ub(t)},Tb=function(t){return t>=hb},ql=function(t){return t===vc||t===X2||t===Z2},Bc=function(t){return jb(t)||Tb(t)||t===rb},og=function(t){return Bc(t)||Xn(t)||t===xr},Qb=function(t){return t>=xb&&t<=wb||t===yb||t>=bb&&t<=vb||t===Bb},Ca=function(t,e){return t!==Lo?!1:e!==vc},zl=function(t,e,n){return t===xr?Bc(e)||Ca(e,n):Bc(t)?!0:!!(t===Lo&&Ca(t,e))},Xd=function(t,e,n){return t===Ai||t===xr?Xn(e)?!0:e===Go&&Xn(n):Xn(t===Go?e:t)},Lb=function(t){var e=0,n=1;(t[e]===Ai||t[e]===xr)&&(t[e]===xr&&(n=-1),e++);for(var r=[];Xn(t[e]);)r.push(t[e++]);var a=r.length?parseInt(un.apply(void 0,r),10):0;t[e]===Go&&e++;for(var i=[];Xn(t[e]);)i.push(t[e++]);var A=i.length,o=A?parseInt(un.apply(void 0,i),10):0;(t[e]===kp||t[e]===Fp)&&e++;var l=1;(t[e]===Ai||t[e]===xr)&&(t[e]===xr&&(l=-1),e++);for(var c=[];Xn(t[e]);)c.push(t[e++]);var d=c.length?parseInt(un.apply(void 0,c),10):0;return n*(a+o*Math.pow(10,-A))*Math.pow(10,l*d)},_b={type:2},Mb={type:3},Db={type:4},Pb={type:13},Rb={type:8},Hb={type:21},Ob={type:9},Gb={type:10},Vb={type:11},Kb={type:12},qb={type:14},Jl={type:23},zb={type:1},Jb={type:25},Wb={type:24},Yb={type:26},$b={type:27},Xb={type:28},Zb={type:29},ev={type:31},Ru={type:32},jp=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat($c(e))},t.prototype.read=function(){for(var e=[],n=this.consumeToken();n!==Ru;)e.push(n),n=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Ol:return this.consumeStringToken(Ol);case eb:var n=this.peekCodePoint(0),r=this.peekCodePoint(1),a=this.peekCodePoint(2);if(og(n)||Ca(r,a)){var i=zl(n,r,a)?$2:Y2,A=this.consumeName();return{type:5,value:A,flags:i}}break;case tb:if(this.peekCodePoint(0)===bo)return this.consumeCodePoint(),Pb;break;case Gl:return this.consumeStringToken(Gl);case Vl:return _b;case vo:return Mb;case $d:if(this.peekCodePoint(0)===bo)return this.consumeCodePoint(),qb;break;case Ai:if(Xd(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case gb:return Db;case xr:var o=e,l=this.peekCodePoint(0),c=this.peekCodePoint(1);if(Xd(o,l,c))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(zl(o,l,c))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(l===xr&&c===ib)return this.consumeCodePoint(),this.consumeCodePoint(),Wb;break;case Go:if(Xd(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case ag:if(this.peekCodePoint(0)===$d)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===$d&&(d=this.consumeCodePoint(),d===ag))return this.consumeToken();if(d===Ns)return this.consumeToken()}break;case mb:return Yb;case pb:return $b;case ab:if(this.peekCodePoint(0)===sb&&this.peekCodePoint(1)===xr&&this.peekCodePoint(2)===xr)return this.consumeCodePoint(),this.consumeCodePoint(),Jb;break;case Ab:var h=this.peekCodePoint(0),p=this.peekCodePoint(1),m=this.peekCodePoint(2);if(zl(h,p,m)){var A=this.consumeName();return{type:7,value:A}}break;case ob:return Xb;case Lo:if(Ca(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case lb:return Zb;case cb:if(this.peekCodePoint(0)===bo)return this.consumeCodePoint(),Rb;break;case db:return Vb;case ub:return Kb;case Nb:case Ib:var B=this.peekCodePoint(0),y=this.peekCodePoint(1);return B===Ai&&(eA(y)||y===Kl)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case ig:if(this.peekCodePoint(0)===bo)return this.consumeCodePoint(),Ob;if(this.peekCodePoint(0)===ig)return this.consumeCodePoint(),Hb;break;case fb:if(this.peekCodePoint(0)===bo)return this.consumeCodePoint(),Gb;break;case Ns:return Ru}return ql(e)?(this.consumeWhiteSpace(),ev):Xn(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):Bc(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:un(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],n=this.consumeCodePoint();eA(n)&&e.length<6;)e.push(n),n=this.consumeCodePoint();for(var r=!1;n===Kl&&e.length<6;)e.push(n),n=this.consumeCodePoint(),r=!0;if(r){var a=parseInt(un.apply(void 0,e.map(function(l){return l===Kl?Sp:l})),16),i=parseInt(un.apply(void 0,e.map(function(l){return l===Kl?Up:l})),16);return{type:30,start:a,end:i}}var A=parseInt(un.apply(void 0,e),16);if(this.peekCodePoint(0)===xr&&eA(this.peekCodePoint(1))){this.consumeCodePoint(),n=this.consumeCodePoint();for(var o=[];eA(n)&&o.length<6;)o.push(n),n=this.consumeCodePoint();var i=parseInt(un.apply(void 0,o),16);return{type:30,start:A,end:i}}else return{type:30,start:A,end:A}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===Vl?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Vl?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ns)return{type:22,value:""};var n=this.peekCodePoint(0);if(n===Gl||n===Ol){var r=this.consumeStringToken(this.consumeCodePoint());return r.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ns||this.peekCodePoint(0)===vo)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),Jl)}for(;;){var a=this.consumeCodePoint();if(a===Ns||a===vo)return{type:22,value:un.apply(void 0,e)};if(ql(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Ns||this.peekCodePoint(0)===vo?(this.consumeCodePoint(),{type:22,value:un.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Jl);if(a===Ol||a===Gl||a===Vl||Qb(a))return this.consumeBadUrlRemnants(),Jl;if(a===Lo)if(Ca(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Jl;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;ql(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===vo||e===Ns)return;Ca(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var n=5e4,r="";e>0;){var a=Math.min(n,e);r+=un.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),r},t.prototype.consumeStringToken=function(e){var n="",r=0;do{var a=this._value[r];if(a===Ns||a===void 0||a===e)return n+=this.consumeStringSlice(r),{type:0,value:n};if(a===vc)return this._value.splice(0,r),zb;if(a===Lo){var i=this._value[r+1];i!==Ns&&i!==void 0&&(i===vc?(n+=this.consumeStringSlice(r),r=-1,this._value.shift()):Ca(a,i)&&(n+=this.consumeStringSlice(r),n+=un(this.consumeEscapedCodePoint()),r=-1))}r++}while(!0)},t.prototype.consumeNumber=function(){var e=[],n=$o,r=this.peekCodePoint(0);for((r===Ai||r===xr)&&e.push(this.consumeCodePoint());Xn(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(r===Go&&Xn(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),n=sg;Xn(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0),a=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((r===kp||r===Fp)&&((a===Ai||a===xr)&&Xn(i)||Xn(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),n=sg;Xn(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[Lb(e),n]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),n=e[0],r=e[1],a=this.peekCodePoint(0),i=this.peekCodePoint(1),A=this.peekCodePoint(2);if(zl(a,i,A)){var o=this.consumeName();return{type:15,number:n,flags:r,unit:o}}return a===nb?(this.consumeCodePoint(),{type:16,number:n,flags:r}):{type:17,number:n,flags:r}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(eA(e)){for(var n=un(e);eA(this.peekCodePoint(0))&&n.length<6;)n+=un(this.consumeCodePoint());ql(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(n,16);return r===0||Eb(r)||r>1114111?Ag:r}return e===Ns?Ag:e},t.prototype.consumeName=function(){for(var e="";;){var n=this.consumeCodePoint();if(og(n))e+=un(n);else if(Ca(n,this.peekCodePoint(0)))e+=un(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(n),e}},t}(),Tp=function(){function t(e){this._tokens=e}return t.create=function(e){var n=new jp;return n.write(e),new t(n.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var n=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return n;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var n=this.consumeComponentValue();if(n.type===32)return e;e.push(n),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var n={type:e,values:[]},r=this.consumeToken();;){if(r.type===32||nv(r,e))return n;this.reconsumeToken(r),n.values.push(this.consumeComponentValue()),r=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var n={name:e.value,values:[],type:18};;){var r=this.consumeToken();if(r.type===32||r.type===3)return n;this.reconsumeToken(r),n.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?Ru:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Xo=function(t){return t.type===15},kA=function(t){return t.type===17},Dt=function(t){return t.type===20},tv=function(t){return t.type===0},Hu=function(t,e){return Dt(t)&&t.value===e},Qp=function(t){return t.type!==31},IA=function(t){return t.type!==31&&t.type!==4},Ts=function(t){var e=[],n=[];return t.forEach(function(r){if(r.type===4){if(n.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(n),n=[];return}r.type!==31&&n.push(r)}),n.length&&e.push(n),e},nv=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},Ma=function(t){return t.type===17||t.type===15},yn=function(t){return t.type===16||Ma(t)},Lp=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Hn={type:17,number:0,flags:$o},Cf={type:16,number:50,flags:$o},Ia={type:16,number:100,flags:$o},Uo=function(t,e,n){var r=t[0],a=t[1];return[Kt(r,e),Kt(typeof a<"u"?a:r,n)]},Kt=function(t,e){if(t.type===16)return t.number/100*e;if(Xo(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},_p="deg",Mp="grad",Dp="rad",Pp="turn",Xc={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case _p:return Math.PI*e.number/180;case Mp:return Math.PI/200*e.number;case Dp:return e.number;case Pp:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},Rp=function(t){return t.type===15&&(t.unit===_p||t.unit===Mp||t.unit===Dp||t.unit===Pp)},Hp=function(t){var e=t.filter(Dt).map(function(n){return n.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Hn,Hn];case"to top":case"bottom":return Yr(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Hn,Ia];case"to right":case"left":return Yr(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ia,Ia];case"to bottom":case"top":return Yr(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ia,Hn];case"to left":case"right":return Yr(270)}return 0},Yr=function(t){return Math.PI*t/180},ja={name:"color",parse:function(t,e){if(e.type===18){var n=rv[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return n(t,e.values)}if(e.type===5){if(e.value.length===3){var r=e.value.substring(0,1),a=e.value.substring(1,2),i=e.value.substring(2,3);return Fa(parseInt(r+r,16),parseInt(a+a,16),parseInt(i+i,16),1)}if(e.value.length===4){var r=e.value.substring(0,1),a=e.value.substring(1,2),i=e.value.substring(2,3),A=e.value.substring(3,4);return Fa(parseInt(r+r,16),parseInt(a+a,16),parseInt(i+i,16),parseInt(A+A,16)/255)}if(e.value.length===6){var r=e.value.substring(0,2),a=e.value.substring(2,4),i=e.value.substring(4,6);return Fa(parseInt(r,16),parseInt(a,16),parseInt(i,16),1)}if(e.value.length===8){var r=e.value.substring(0,2),a=e.value.substring(2,4),i=e.value.substring(4,6),A=e.value.substring(6,8);return Fa(parseInt(r,16),parseInt(a,16),parseInt(i,16),parseInt(A,16)/255)}}if(e.type===20){var o=Ws[e.value.toUpperCase()];if(typeof o<"u")return o}return Ws.TRANSPARENT}},Ta=function(t){return(255&t)===0},jn=function(t){var e=255&t,n=255&t>>8,r=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+r+","+n+","+e/255+")":"rgb("+a+","+r+","+n+")"},Fa=function(t,e,n,r){return(t<<24|e<<16|n<<8|Math.round(r*255)<<0)>>>0},lg=function(t,e){if(t.type===17)return t.number;if(t.type===16){var n=e===3?1:255;return e===3?t.number/100*n:Math.round(t.number/100*n)}return 0},cg=function(t,e){var n=e.filter(IA);if(n.length===3){var r=n.map(lg),a=r[0],i=r[1],A=r[2];return Fa(a,i,A,1)}if(n.length===4){var o=n.map(lg),a=o[0],i=o[1],A=o[2],l=o[3];return Fa(a,i,A,l)}return 0};function Zd(t,e,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(e-t)*n*6+t:n<1/2?e:n<2/3?(e-t)*6*(2/3-n)+t:t}var dg=function(t,e){var n=e.filter(IA),r=n[0],a=n[1],i=n[2],A=n[3],o=(r.type===17?Yr(r.number):Xc.parse(t,r))/(Math.PI*2),l=yn(a)?a.number/100:0,c=yn(i)?i.number/100:0,d=typeof A<"u"&&yn(A)?Kt(A,1):1;if(l===0)return Fa(c*255,c*255,c*255,1);var h=c<=.5?c*(l+1):c+l-c*l,p=c*2-h,m=Zd(p,h,o+1/3),B=Zd(p,h,o),y=Zd(p,h,o-1/3);return Fa(m*255,B*255,y*255,d)},rv={hsl:dg,hsla:dg,rgb:cg,rgba:cg},_o=function(t,e){return ja.parse(t,Tp.create(e).parseComponentValue())},Ws={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},sv={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(n){if(Dt(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},av={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Zc=function(t,e){var n=ja.parse(t,e[0]),r=e[1];return r&&yn(r)?{color:n,stop:r}:{color:n,stop:null}},ug=function(t,e){var n=t[0],r=t[t.length-1];n.stop===null&&(n.stop=Hn),r.stop===null&&(r.stop=Ia);for(var a=[],i=0,A=0;A<t.length;A++){var o=t[A].stop;if(o!==null){var l=Kt(o,e);l>i?a.push(l):a.push(i),i=l}else a.push(null)}for(var c=null,A=0;A<a.length;A++){var d=a[A];if(d===null)c===null&&(c=A);else if(c!==null){for(var h=A-c,p=a[c-1],m=(d-p)/(h+1),B=1;B<=h;B++)a[c+B-1]=m*B;c=null}}return t.map(function(y,b){var C=y.color;return{color:C,stop:Math.max(Math.min(1,a[b]/e),0)}})},iv=function(t,e,n){var r=e/2,a=n/2,i=Kt(t[0],e)-r,A=a-Kt(t[1],n);return(Math.atan2(A,i)+Math.PI*2)%(Math.PI*2)},Av=function(t,e,n){var r=typeof t=="number"?t:iv(t,e,n),a=Math.abs(e*Math.sin(r))+Math.abs(n*Math.cos(r)),i=e/2,A=n/2,o=a/2,l=Math.sin(r-Math.PI/2)*o,c=Math.cos(r-Math.PI/2)*o;return[a,i-c,i+c,A-l,A+l]},os=function(t,e){return Math.sqrt(t*t+e*e)},fg=function(t,e,n,r,a){var i=[[0,0],[0,e],[t,0],[t,e]];return i.reduce(function(A,o){var l=o[0],c=o[1],d=os(n-l,r-c);return(a?d<A.optimumDistance:d>A.optimumDistance)?{optimumCorner:o,optimumDistance:d}:A},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},ov=function(t,e,n,r,a){var i=0,A=0;switch(t.size){case 0:t.shape===0?i=A=Math.min(Math.abs(e),Math.abs(e-r),Math.abs(n),Math.abs(n-a)):t.shape===1&&(i=Math.min(Math.abs(e),Math.abs(e-r)),A=Math.min(Math.abs(n),Math.abs(n-a)));break;case 2:if(t.shape===0)i=A=Math.min(os(e,n),os(e,n-a),os(e-r,n),os(e-r,n-a));else if(t.shape===1){var o=Math.min(Math.abs(n),Math.abs(n-a))/Math.min(Math.abs(e),Math.abs(e-r)),l=fg(r,a,e,n,!0),c=l[0],d=l[1];i=os(c-e,(d-n)/o),A=o*i}break;case 1:t.shape===0?i=A=Math.max(Math.abs(e),Math.abs(e-r),Math.abs(n),Math.abs(n-a)):t.shape===1&&(i=Math.max(Math.abs(e),Math.abs(e-r)),A=Math.max(Math.abs(n),Math.abs(n-a)));break;case 3:if(t.shape===0)i=A=Math.max(os(e,n),os(e,n-a),os(e-r,n),os(e-r,n-a));else if(t.shape===1){var o=Math.max(Math.abs(n),Math.abs(n-a))/Math.max(Math.abs(e),Math.abs(e-r)),h=fg(r,a,e,n,!1),c=h[0],d=h[1];i=os(c-e,(d-n)/o),A=o*i}break}return Array.isArray(t.size)&&(i=Kt(t.size[0],r),A=t.size.length===2?Kt(t.size[1],a):i),[i,A]},lv=function(t,e){var n=Yr(180),r=[];return Ts(e).forEach(function(a,i){if(i===0){var A=a[0];if(A.type===20&&A.value==="to"){n=Hp(a);return}else if(Rp(A)){n=Xc.parse(t,A);return}}var o=Zc(t,a);r.push(o)}),{angle:n,stops:r,type:1}},Wl=function(t,e){var n=Yr(180),r=[];return Ts(e).forEach(function(a,i){if(i===0){var A=a[0];if(A.type===20&&["top","left","right","bottom"].indexOf(A.value)!==-1){n=Hp(a);return}else if(Rp(A)){n=(Xc.parse(t,A)+Yr(270))%Yr(360);return}}var o=Zc(t,a);r.push(o)}),{angle:n,stops:r,type:1}},cv=function(t,e){var n=Yr(180),r=[],a=1,i=0,A=3,o=[];return Ts(e).forEach(function(l,c){var d=l[0];if(c===0){if(Dt(d)&&d.value==="linear"){a=1;return}else if(Dt(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var h=ja.parse(t,d.values[0]);r.push({stop:Hn,color:h})}else if(d.name==="to"){var h=ja.parse(t,d.values[0]);r.push({stop:Ia,color:h})}else if(d.name==="color-stop"){var p=d.values.filter(IA);if(p.length===2){var h=ja.parse(t,p[1]),m=p[0];kA(m)&&r.push({stop:{type:16,number:m.number*100,flags:m.flags},color:h})}}}}),a===1?{angle:(n+Yr(180))%Yr(360),stops:r,type:a}:{size:A,shape:i,stops:r,position:o,type:a}},Op="closest-side",Gp="farthest-side",Vp="closest-corner",Kp="farthest-corner",qp="circle",zp="ellipse",Jp="cover",Wp="contain",dv=function(t,e){var n=0,r=3,a=[],i=[];return Ts(e).forEach(function(A,o){var l=!0;if(o===0){var c=!1;l=A.reduce(function(h,p){if(c)if(Dt(p))switch(p.value){case"center":return i.push(Cf),h;case"top":case"left":return i.push(Hn),h;case"right":case"bottom":return i.push(Ia),h}else(yn(p)||Ma(p))&&i.push(p);else if(Dt(p))switch(p.value){case qp:return n=0,!1;case zp:return n=1,!1;case"at":return c=!0,!1;case Op:return r=0,!1;case Jp:case Gp:return r=1,!1;case Wp:case Vp:return r=2,!1;case Kp:return r=3,!1}else if(Ma(p)||yn(p))return Array.isArray(r)||(r=[]),r.push(p),!1;return h},l)}if(l){var d=Zc(t,A);a.push(d)}}),{size:r,shape:n,stops:a,position:i,type:2}},Yl=function(t,e){var n=0,r=3,a=[],i=[];return Ts(e).forEach(function(A,o){var l=!0;if(o===0?l=A.reduce(function(d,h){if(Dt(h))switch(h.value){case"center":return i.push(Cf),!1;case"top":case"left":return i.push(Hn),!1;case"right":case"bottom":return i.push(Ia),!1}else if(yn(h)||Ma(h))return i.push(h),!1;return d},l):o===1&&(l=A.reduce(function(d,h){if(Dt(h))switch(h.value){case qp:return n=0,!1;case zp:return n=1,!1;case Wp:case Op:return r=0,!1;case Gp:return r=1,!1;case Vp:return r=2,!1;case Jp:case Kp:return r=3,!1}else if(Ma(h)||yn(h))return Array.isArray(r)||(r=[]),r.push(h),!1;return d},l)),l){var c=Zc(t,A);a.push(c)}}),{size:r,shape:n,stops:a,position:i,type:2}},uv=function(t){return t.type===1},fv=function(t){return t.type===2},Nf={name:"image",parse:function(t,e){if(e.type===22){var n={url:e.value,type:0};return t.cache.addImage(e.value),n}if(e.type===18){var r=Yp[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return r(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function hv(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Yp[t.name])}var Yp={"linear-gradient":lv,"-moz-linear-gradient":Wl,"-ms-linear-gradient":Wl,"-o-linear-gradient":Wl,"-webkit-linear-gradient":Wl,"radial-gradient":dv,"-moz-radial-gradient":Yl,"-ms-radial-gradient":Yl,"-o-radial-gradient":Yl,"-webkit-radial-gradient":Yl,"-webkit-gradient":cv},gv={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var n=e[0];return n.type===20&&n.value==="none"?[]:e.filter(function(r){return IA(r)&&hv(r)}).map(function(r){return Nf.parse(t,r)})}},mv={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(n){if(Dt(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},pv={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Ts(e).map(function(n){return n.filter(yn)}).map(Lp)}},xv={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Ts(e).map(function(n){return n.filter(Dt).map(function(r){return r.value}).join(" ")}).map(wv)}},wv=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},wA;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(wA||(wA={}));var yv={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Ts(e).map(function(n){return n.filter(bv)})}},bv=function(t){return Dt(t)||yn(t)},ed=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},vv=ed("top"),Bv=ed("right"),Cv=ed("bottom"),Nv=ed("left"),td=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,n){return Lp(n.filter(yn))}}},Sv=td("top-left"),Iv=td("top-right"),Fv=td("bottom-right"),Ev=td("bottom-left"),nd=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,n){switch(n){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},kv=nd("top"),Uv=nd("right"),jv=nd("bottom"),Tv=nd("left"),rd=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,n){return Xo(n)?n.number:0}}},Qv=rd("top"),Lv=rd("right"),_v=rd("bottom"),Mv=rd("left"),Dv={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Pv={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Rv={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Dt).reduce(function(n,r){return n|Hv(r.value)},0)}},Hv=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Ov={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Gv={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},Cc;(function(t){t.NORMAL="normal",t.STRICT="strict"})(Cc||(Cc={}));var Vv={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return Cc.STRICT;case"normal":default:return Cc.NORMAL}}},Kv={name:"line-height",initialValue:"normal",prefix:!1,type:4},hg=function(t,e){return Dt(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:yn(t)?Kt(t,e):e},qv={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:Nf.parse(t,e)}},zv={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},Ou={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},sd=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Jv=sd("top"),Wv=sd("right"),Yv=sd("bottom"),$v=sd("left"),Xv={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Dt).map(function(n){switch(n.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Zv={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},ad=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},e5=ad("top"),t5=ad("right"),n5=ad("bottom"),r5=ad("left"),s5={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},a5={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},i5={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Hu(e[0],"none")?[]:Ts(e).map(function(n){for(var r={color:Ws.TRANSPARENT,offsetX:Hn,offsetY:Hn,blur:Hn},a=0,i=0;i<n.length;i++){var A=n[i];Ma(A)?(a===0?r.offsetX=A:a===1?r.offsetY=A:r.blur=A,a++):r.color=ja.parse(t,A)}return r})}},A5={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},o5={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var n=d5[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return n(e.values)}return null}},l5=function(t){var e=t.filter(function(n){return n.type===17}).map(function(n){return n.number});return e.length===6?e:null},c5=function(t){var e=t.filter(function(l){return l.type===17}).map(function(l){return l.number}),n=e[0],r=e[1];e[2],e[3];var a=e[4],i=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var A=e[12],o=e[13];return e[14],e[15],e.length===16?[n,r,a,i,A,o]:null},d5={matrix:l5,matrix3d:c5},gg={type:16,number:50,flags:$o},u5=[gg,gg],f5={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var n=e.filter(yn);return n.length!==2?u5:[n[0],n[1]]}},h5={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Mo;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Mo||(Mo={}));var g5={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Mo.BREAK_ALL;case"keep-all":return Mo.KEEP_ALL;case"normal":default:return Mo.NORMAL}}},m5={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(kA(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},$p={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},p5={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return kA(e)?e.number:1}},x5={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},w5={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Dt).map(function(n){switch(n.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(n){return n!==0})}},y5={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var n=[],r=[];return e.forEach(function(a){switch(a.type){case 20:case 0:n.push(a.value);break;case 17:n.push(a.number.toString());break;case 4:r.push(n.join(" ")),n.length=0;break}}),n.length&&r.push(n.join(" ")),r.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},b5={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},v5={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(kA(e))return e.number;if(Dt(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},B5={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Dt).map(function(n){return n.value})}},C5={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Nn=function(t,e){return(t&e)!==0},N5={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var n=e[0];return n.type===20&&n.value==="none"?[]:e}},S5={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var n=e[0];if(n.type===20&&n.value==="none")return null;for(var r=[],a=e.filter(Qp),i=0;i<a.length;i++){var A=a[i],o=a[i+1];if(A.type===20){var l=o&&kA(o)?o.number:1;r.push({counter:A.value,increment:l})}}return r}},I5={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var n=[],r=e.filter(Qp),a=0;a<r.length;a++){var i=r[a],A=r[a+1];if(Dt(i)&&i.value!=="none"){var o=A&&kA(A)?A.number:0;n.push({counter:i.value,reset:o})}}return n}},F5={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Xo).map(function(n){return $p.parse(t,n)})}},E5={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var n=e[0];if(n.type===20&&n.value==="none")return null;var r=[],a=e.filter(tv);if(a.length%2!==0)return null;for(var i=0;i<a.length;i+=2){var A=a[i].value,o=a[i+1].value;r.push({open:A,close:o})}return r}},mg=function(t,e,n){if(!t)return"";var r=t[Math.min(e,t.length-1)];return r?n?r.open:r.close:""},k5={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Hu(e[0],"none")?[]:Ts(e).map(function(n){for(var r={color:255,offsetX:Hn,offsetY:Hn,blur:Hn,spread:Hn,inset:!1},a=0,i=0;i<n.length;i++){var A=n[i];Hu(A,"inset")?r.inset=!0:Ma(A)?(a===0?r.offsetX=A:a===1?r.offsetY=A:a===2?r.blur=A:r.spread=A,a++):r.color=ja.parse(t,A)}return r})}},U5={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var n=[0,1,2],r=[];return e.filter(Dt).forEach(function(a){switch(a.value){case"stroke":r.push(1);break;case"fill":r.push(0);break;case"markers":r.push(2);break}}),n.forEach(function(a){r.indexOf(a)===-1&&r.push(a)}),r}},j5={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},T5={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Xo(e)?e.number:0}},Q5=function(){function t(e,n){var r,a;this.animationDuration=$e(e,F5,n.animationDuration),this.backgroundClip=$e(e,sv,n.backgroundClip),this.backgroundColor=$e(e,av,n.backgroundColor),this.backgroundImage=$e(e,gv,n.backgroundImage),this.backgroundOrigin=$e(e,mv,n.backgroundOrigin),this.backgroundPosition=$e(e,pv,n.backgroundPosition),this.backgroundRepeat=$e(e,xv,n.backgroundRepeat),this.backgroundSize=$e(e,yv,n.backgroundSize),this.borderTopColor=$e(e,vv,n.borderTopColor),this.borderRightColor=$e(e,Bv,n.borderRightColor),this.borderBottomColor=$e(e,Cv,n.borderBottomColor),this.borderLeftColor=$e(e,Nv,n.borderLeftColor),this.borderTopLeftRadius=$e(e,Sv,n.borderTopLeftRadius),this.borderTopRightRadius=$e(e,Iv,n.borderTopRightRadius),this.borderBottomRightRadius=$e(e,Fv,n.borderBottomRightRadius),this.borderBottomLeftRadius=$e(e,Ev,n.borderBottomLeftRadius),this.borderTopStyle=$e(e,kv,n.borderTopStyle),this.borderRightStyle=$e(e,Uv,n.borderRightStyle),this.borderBottomStyle=$e(e,jv,n.borderBottomStyle),this.borderLeftStyle=$e(e,Tv,n.borderLeftStyle),this.borderTopWidth=$e(e,Qv,n.borderTopWidth),this.borderRightWidth=$e(e,Lv,n.borderRightWidth),this.borderBottomWidth=$e(e,_v,n.borderBottomWidth),this.borderLeftWidth=$e(e,Mv,n.borderLeftWidth),this.boxShadow=$e(e,k5,n.boxShadow),this.color=$e(e,Dv,n.color),this.direction=$e(e,Pv,n.direction),this.display=$e(e,Rv,n.display),this.float=$e(e,Ov,n.cssFloat),this.fontFamily=$e(e,y5,n.fontFamily),this.fontSize=$e(e,b5,n.fontSize),this.fontStyle=$e(e,C5,n.fontStyle),this.fontVariant=$e(e,B5,n.fontVariant),this.fontWeight=$e(e,v5,n.fontWeight),this.letterSpacing=$e(e,Gv,n.letterSpacing),this.lineBreak=$e(e,Vv,n.lineBreak),this.lineHeight=$e(e,Kv,n.lineHeight),this.listStyleImage=$e(e,qv,n.listStyleImage),this.listStylePosition=$e(e,zv,n.listStylePosition),this.listStyleType=$e(e,Ou,n.listStyleType),this.marginTop=$e(e,Jv,n.marginTop),this.marginRight=$e(e,Wv,n.marginRight),this.marginBottom=$e(e,Yv,n.marginBottom),this.marginLeft=$e(e,$v,n.marginLeft),this.opacity=$e(e,p5,n.opacity);var i=$e(e,Xv,n.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=$e(e,Zv,n.overflowWrap),this.paddingTop=$e(e,e5,n.paddingTop),this.paddingRight=$e(e,t5,n.paddingRight),this.paddingBottom=$e(e,n5,n.paddingBottom),this.paddingLeft=$e(e,r5,n.paddingLeft),this.paintOrder=$e(e,U5,n.paintOrder),this.position=$e(e,a5,n.position),this.textAlign=$e(e,s5,n.textAlign),this.textDecorationColor=$e(e,x5,(r=n.textDecorationColor)!==null&&r!==void 0?r:n.color),this.textDecorationLine=$e(e,w5,(a=n.textDecorationLine)!==null&&a!==void 0?a:n.textDecoration),this.textShadow=$e(e,i5,n.textShadow),this.textTransform=$e(e,A5,n.textTransform),this.transform=$e(e,o5,n.transform),this.transformOrigin=$e(e,f5,n.transformOrigin),this.visibility=$e(e,h5,n.visibility),this.webkitTextStrokeColor=$e(e,j5,n.webkitTextStrokeColor),this.webkitTextStrokeWidth=$e(e,T5,n.webkitTextStrokeWidth),this.wordBreak=$e(e,g5,n.wordBreak),this.zIndex=$e(e,m5,n.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return Ta(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Nn(this.display,4)||Nn(this.display,33554432)||Nn(this.display,268435456)||Nn(this.display,536870912)||Nn(this.display,67108864)||Nn(this.display,134217728)},t}(),L5=function(){function t(e,n){this.content=$e(e,N5,n.content),this.quotes=$e(e,E5,n.quotes)}return t}(),pg=function(){function t(e,n){this.counterIncrement=$e(e,S5,n.counterIncrement),this.counterReset=$e(e,I5,n.counterReset)}return t}(),$e=function(t,e,n){var r=new jp,a=n!==null&&typeof n<"u"?n.toString():e.initialValue;r.write(a);var i=new Tp(r.read());switch(e.type){case 2:var A=i.parseComponentValue();return e.parse(t,Dt(A)?A.value:e.initialValue);case 0:return e.parse(t,i.parseComponentValue());case 1:return e.parse(t,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(e.format){case"angle":return Xc.parse(t,i.parseComponentValue());case"color":return ja.parse(t,i.parseComponentValue());case"image":return Nf.parse(t,i.parseComponentValue());case"length":var o=i.parseComponentValue();return Ma(o)?o:Hn;case"length-percentage":var l=i.parseComponentValue();return yn(l)?l:Hn;case"time":return $p.parse(t,i.parseComponentValue())}break}},_5="data-html2canvas-debug",M5=function(t){var e=t.getAttribute(_5);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Gu=function(t,e){var n=M5(t);return n===1||e===n},Qs=function(){function t(e,n){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,Gu(n,3))debugger;this.styles=new Q5(e,window.getComputedStyle(n,null)),qu(n)&&(this.styles.animationDuration.some(function(r){return r>0})&&(n.style.animationDuration="0s"),this.styles.transform!==null&&(n.style.transform="none")),this.bounds=Yc(this.context,n),Gu(n,4)&&(this.flags|=16)}return t}(),D5="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",xg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jo=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var $l=0;$l<xg.length;$l++)jo[xg.charCodeAt($l)]=$l;var P5=function(t){var e=t.length*.75,n=t.length,r,a=0,i,A,o,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var c=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(c)?c:new Uint8Array(c);for(r=0;r<n;r+=4)i=jo[t.charCodeAt(r)],A=jo[t.charCodeAt(r+1)],o=jo[t.charCodeAt(r+2)],l=jo[t.charCodeAt(r+3)],d[a++]=i<<2|A>>4,d[a++]=(A&15)<<4|o>>2,d[a++]=(o&3)<<6|l&63;return c},R5=function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n.push(t[r+1]<<8|t[r]);return n},H5=function(t){for(var e=t.length,n=[],r=0;r<e;r+=4)n.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return n},ci=5,Sf=11,eu=2,O5=Sf-ci,Xp=65536>>ci,G5=1<<ci,tu=G5-1,V5=1024>>ci,K5=Xp+V5,q5=K5,z5=32,J5=q5+z5,W5=65536>>Sf,Y5=1<<O5,$5=Y5-1,wg=function(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))},X5=function(t,e,n){return t.slice?t.slice(e,n):new Uint32Array(Array.prototype.slice.call(t,e,n))},Z5=function(t,e){var n=P5(t),r=Array.isArray(n)?H5(n):new Uint32Array(n),a=Array.isArray(n)?R5(n):new Uint16Array(n),i=24,A=wg(a,i/2,r[4]/2),o=r[5]===2?wg(a,(i+r[4])/2):X5(r,Math.ceil((i+r[4])/4));return new eB(r[0],r[1],r[2],r[3],A,o)},eB=function(){function t(e,n,r,a,i,A){this.initialValue=e,this.errorValue=n,this.highStart=r,this.highValueIndex=a,this.index=i,this.data=A}return t.prototype.get=function(e){var n;if(e>=0){if(e<55296||e>56319&&e<=65535)return n=this.index[e>>ci],n=(n<<eu)+(e&tu),this.data[n];if(e<=65535)return n=this.index[Xp+(e-55296>>ci)],n=(n<<eu)+(e&tu),this.data[n];if(e<this.highStart)return n=J5-W5+(e>>Sf),n=this.index[n],n+=e>>ci&$5,n=this.index[n],n=(n<<eu)+(e&tu),this.data[n];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),yg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tB=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Xl=0;Xl<yg.length;Xl++)tB[yg.charCodeAt(Xl)]=Xl;var nB=1,nu=2,ru=3,bg=4,vg=5,rB=7,Bg=8,su=9,au=10,Cg=11,Ng=12,Sg=13,Ig=14,iu=15,sB=function(t){for(var e=[],n=0,r=t.length;n<r;){var a=t.charCodeAt(n++);if(a>=55296&&a<=56319&&n<r){var i=t.charCodeAt(n++);(i&64512)===56320?e.push(((a&1023)<<10)+(i&1023)+65536):(e.push(a),n--)}else e.push(a)}return e},aB=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var r=[],a=-1,i="";++a<n;){var A=t[a];A<=65535?r.push(A):(A-=65536,r.push((A>>10)+55296,A%1024+56320)),(a+1===n||r.length>16384)&&(i+=String.fromCharCode.apply(String,r),r.length=0)}return i},iB=Z5(D5),zr="Ã—",Au="Ã·",AB=function(t){return iB.get(t)},oB=function(t,e,n){var r=n-2,a=e[r],i=e[n-1],A=e[n];if(i===nu&&A===ru)return zr;if(i===nu||i===ru||i===bg||A===nu||A===ru||A===bg)return Au;if(i===Bg&&[Bg,su,Cg,Ng].indexOf(A)!==-1||(i===Cg||i===su)&&(A===su||A===au)||(i===Ng||i===au)&&A===au||A===Sg||A===vg||A===rB||i===nB)return zr;if(i===Sg&&A===Ig){for(;a===vg;)a=e[--r];if(a===Ig)return zr}if(i===iu&&A===iu){for(var o=0;a===iu;)o++,a=e[--r];if(o%2===0)return zr}return Au},lB=function(t){var e=sB(t),n=e.length,r=0,a=0,i=e.map(AB);return{next:function(){if(r>=n)return{done:!0,value:null};for(var A=zr;r<n&&(A=oB(e,i,++r))===zr;);if(A!==zr||r===n){var o=aB.apply(null,e.slice(a,r));return a=r,{value:o,done:!1}}return{done:!0,value:null}}}},cB=function(t){for(var e=lB(t),n=[],r;!(r=e.next()).done;)r.value&&n.push(r.value.slice());return n},dB=function(t){var e=123;if(t.createRange){var n=t.createRange();if(n.getBoundingClientRect){var r=t.createElement("boundtest");r.style.height=e+"px",r.style.display="block",t.body.appendChild(r),n.selectNode(r);var a=n.getBoundingClientRect(),i=Math.round(a.height);if(t.body.removeChild(r),i===e)return!0}}return!1},uB=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var n=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var r=e.firstChild,a=$c(r.data).map(function(l){return un(l)}),i=0,A={},o=a.every(function(l,c){n.setStart(r,i),n.setEnd(r,i+l.length);var d=n.getBoundingClientRect();i+=l.length;var h=d.x>A.x||d.y>A.y;return A=d,c===0?!0:h});return t.body.removeChild(e),o},fB=function(){return typeof new Image().crossOrigin<"u"},hB=function(){return typeof new XMLHttpRequest().responseType=="string"},gB=function(t){var e=new Image,n=t.createElement("canvas"),r=n.getContext("2d");if(!r)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(e,0,0),n.toDataURL()}catch{return!1}return!0},Fg=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},mB=function(t){var e=t.createElement("canvas"),n=100;e.width=n,e.height=n;var r=e.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,n,n);var a=new Image,i=e.toDataURL();a.src=i;var A=Vu(n,n,0,0,a);return r.fillStyle="red",r.fillRect(0,0,n,n),Eg(A).then(function(o){r.drawImage(o,0,0);var l=r.getImageData(0,0,n,n).data;r.fillStyle="red",r.fillRect(0,0,n,n);var c=t.createElement("div");return c.style.backgroundImage="url("+i+")",c.style.height=n+"px",Fg(l)?Eg(Vu(n,n,0,0,c)):Promise.reject(!1)}).then(function(o){return r.drawImage(o,0,0),Fg(r.getImageData(0,0,n,n).data)}).catch(function(){return!1})},Vu=function(t,e,n,r,a){var i="http://www.w3.org/2000/svg",A=document.createElementNS(i,"svg"),o=document.createElementNS(i,"foreignObject");return A.setAttributeNS(null,"width",t.toString()),A.setAttributeNS(null,"height",e.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",n.toString()),o.setAttributeNS(null,"y",r.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),A.appendChild(o),o.appendChild(a),A},Eg=function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Rn={get SUPPORT_RANGE_BOUNDS(){var t=dB(document);return Object.defineProperty(Rn,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Rn.SUPPORT_RANGE_BOUNDS&&uB(document);return Object.defineProperty(Rn,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=gB(document);return Object.defineProperty(Rn,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?mB(document):Promise.resolve(!1);return Object.defineProperty(Rn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=fB();return Object.defineProperty(Rn,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=hB();return Object.defineProperty(Rn,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Rn,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Rn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Do=function(){function t(e,n){this.text=e,this.bounds=n}return t}(),pB=function(t,e,n,r){var a=yB(e,n),i=[],A=0;return a.forEach(function(o){if(n.textDecorationLine.length||o.trim().length>0)if(Rn.SUPPORT_RANGE_BOUNDS){var l=kg(r,A,o.length).getClientRects();if(l.length>1){var c=If(o),d=0;c.forEach(function(p){i.push(new Do(p,Ys.fromDOMRectList(t,kg(r,d+A,p.length).getClientRects()))),d+=p.length})}else i.push(new Do(o,Ys.fromDOMRectList(t,l)))}else{var h=r.splitText(o.length);i.push(new Do(o,xB(t,r))),r=h}else Rn.SUPPORT_RANGE_BOUNDS||(r=r.splitText(o.length));A+=o.length}),i},xB=function(t,e){var n=e.ownerDocument;if(n){var r=n.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(r,e);var i=Yc(t,r);return r.firstChild&&a.replaceChild(r.firstChild,r),i}}return Ys.EMPTY},kg=function(t,e,n){var r=t.ownerDocument;if(!r)throw new Error("Node has no owner document");var a=r.createRange();return a.setStart(t,e),a.setEnd(t,e+n),a},If=function(t){if(Rn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(n){return n.segment})}return cB(t)},wB=function(t,e){if(Rn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(t)).map(function(r){return r.segment})}return vB(t,e)},yB=function(t,e){return e.letterSpacing!==0?If(t):wB(t,e)},bB=[32,160,4961,65792,65793,4153,4241],vB=function(t,e){for(var n=W2(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),r=[],a,i=function(){if(a.value){var A=a.value.slice(),o=$c(A),l="";o.forEach(function(c){bB.indexOf(c)===-1?l+=un(c):(l.length&&r.push(l),r.push(un(c)),l="")}),l.length&&r.push(l)}};!(a=n.next()).done;)i();return r},BB=function(){function t(e,n,r){this.text=CB(n.data,r.textTransform),this.textBounds=pB(e,this.text,r,n)}return t}(),CB=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(NB,SB);case 2:return t.toUpperCase();default:return t}},NB=/(^|\s|:|-|\(|\))([a-z])/g,SB=function(t,e,n){return t.length>0?e+n.toUpperCase():t},Zp=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.src=r.currentSrc||r.src,a.intrinsicWidth=r.naturalWidth,a.intrinsicHeight=r.naturalHeight,a.context.cache.addImage(a.src),a}return e}(Qs),ex=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.canvas=r,a.intrinsicWidth=r.width,a.intrinsicHeight=r.height,a}return e}(Qs),tx=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this,i=new XMLSerializer,A=Yc(n,r);return r.setAttribute("width",A.width+"px"),r.setAttribute("height",A.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(r)),a.intrinsicWidth=r.width.baseVal.value,a.intrinsicHeight=r.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(Qs),nx=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.value=r.value,a}return e}(Qs),Ku=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.start=r.start,a.reversed=typeof r.reversed=="boolean"&&r.reversed===!0,a}return e}(Qs),IB=[{type:15,flags:0,unit:"px",number:3}],FB=[{type:16,flags:0,number:50}],EB=function(t){return t.width>t.height?new Ys(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new Ys(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},kB=function(t){var e=t.type===UB?new Array(t.value.length+1).join("â€¢"):t.value;return e.length===0?t.placeholder||"":e},Nc="checkbox",Sc="radio",UB="password",Ug=707406591,Ff=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;switch(a.type=r.type.toLowerCase(),a.checked=r.checked,a.value=kB(r),(a.type===Nc||a.type===Sc)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=EB(a.bounds)),a.type){case Nc:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=IB;break;case Sc:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=FB;break}return a}return e}(Qs),rx=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this,i=r.options[r.selectedIndex||0];return a.value=i&&i.text||"",a}return e}(Qs),sx=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.value=r.value,a}return e}(Qs),ax=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;a.src=r.src,a.width=parseInt(r.width,10)||0,a.height=parseInt(r.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){a.tree=Ax(n,r.contentWindow.document.documentElement);var i=r.contentWindow.document.documentElement?_o(n,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):Ws.TRANSPARENT,A=r.contentWindow.document.body?_o(n,getComputedStyle(r.contentWindow.document.body).backgroundColor):Ws.TRANSPARENT;a.backgroundColor=Ta(i)?Ta(A)?a.styles.backgroundColor:A:i}}catch{}return a}return e}(Qs),jB=["OL","UL","MENU"],gc=function(t,e,n,r){for(var a=e.firstChild,i=void 0;a;a=i)if(i=a.nextSibling,ox(a)&&a.data.trim().length>0)n.textNodes.push(new BB(t,a,n.styles));else if(uA(a))if(ux(a)&&a.assignedNodes)a.assignedNodes().forEach(function(o){return gc(t,o,n,r)});else{var A=ix(t,a);A.styles.isVisible()&&(TB(a,A,r)?A.flags|=4:QB(A.styles)&&(A.flags|=2),jB.indexOf(a.tagName)!==-1&&(A.flags|=8),n.elements.push(A),a.slot,a.shadowRoot?gc(t,a.shadowRoot,A,r):!Ic(a)&&!lx(a)&&!Fc(a)&&gc(t,a,A,r))}},ix=function(t,e){return zu(e)?new Zp(t,e):cx(e)?new ex(t,e):lx(e)?new tx(t,e):LB(e)?new nx(t,e):_B(e)?new Ku(t,e):MB(e)?new Ff(t,e):Fc(e)?new rx(t,e):Ic(e)?new sx(t,e):dx(e)?new ax(t,e):new Qs(t,e)},Ax=function(t,e){var n=ix(t,e);return n.flags|=4,gc(t,e,n,n),n},TB=function(t,e,n){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||Ef(t)&&n.styles.isTransparent()},QB=function(t){return t.isPositioned()||t.isFloating()},ox=function(t){return t.nodeType===Node.TEXT_NODE},uA=function(t){return t.nodeType===Node.ELEMENT_NODE},qu=function(t){return uA(t)&&typeof t.style<"u"&&!mc(t)},mc=function(t){return typeof t.className=="object"},LB=function(t){return t.tagName==="LI"},_B=function(t){return t.tagName==="OL"},MB=function(t){return t.tagName==="INPUT"},DB=function(t){return t.tagName==="HTML"},lx=function(t){return t.tagName==="svg"},Ef=function(t){return t.tagName==="BODY"},cx=function(t){return t.tagName==="CANVAS"},jg=function(t){return t.tagName==="VIDEO"},zu=function(t){return t.tagName==="IMG"},dx=function(t){return t.tagName==="IFRAME"},Tg=function(t){return t.tagName==="STYLE"},PB=function(t){return t.tagName==="SCRIPT"},Ic=function(t){return t.tagName==="TEXTAREA"},Fc=function(t){return t.tagName==="SELECT"},ux=function(t){return t.tagName==="SLOT"},Qg=function(t){return t.tagName.indexOf("-")>0},RB=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var n=this.counters[e];return n&&n.length?n[n.length-1]:1},t.prototype.getCounterValues=function(e){var n=this.counters[e];return n||[]},t.prototype.pop=function(e){var n=this;e.forEach(function(r){return n.counters[r].pop()})},t.prototype.parse=function(e){var n=this,r=e.counterIncrement,a=e.counterReset,i=!0;r!==null&&r.forEach(function(o){var l=n.counters[o.counter];l&&o.increment!==0&&(i=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=o.increment)});var A=[];return i&&a.forEach(function(o){var l=n.counters[o.counter];A.push(o.counter),l||(l=n.counters[o.counter]=[]),l.push(o.reset)}),A},t}(),Lg={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},_g={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Õ”","Õ“","Õ’","Õ‘","Õ","Õ","ÕŽ","Õ","ÕŒ","Õ‹","ÕŠ","Õ‰","Õˆ","Õ‡","Õ†","Õ…","Õ„","Õƒ","Õ‚","Õ","Õ€","Ô¿","Ô¾","Ô½","Ô¼","Ô»","Ôº","Ô¹","Ô¸","Ô·","Ô¶","Ôµ","Ô´","Ô³","Ô²","Ô±"]},HB={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["×™×³","×˜×³","×—×³","×–×³","×•×³","×”×³","×“×³","×’×³","×‘×³","××³","×ª","×©","×¨","×§","×¦","×¤","×¢","×¡","× ","×ž","×œ","×›","×™×˜","×™×—","×™×–","×˜×–","×˜×•","×™","×˜","×—","×–","×•","×”","×“","×’","×‘","×"]},OB={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["áƒµ","áƒ°","áƒ¯","áƒ´","áƒ®","áƒ­","áƒ¬","áƒ«","áƒª","áƒ©","áƒ¨","áƒ§","áƒ¦","áƒ¥","áƒ¤","áƒ³","áƒ¢","áƒ¡","áƒ ","áƒŸ","áƒž","áƒ","áƒ²","áƒœ","áƒ›","áƒš","áƒ™","áƒ˜","áƒ—","áƒ±","áƒ–","áƒ•","áƒ”","áƒ“","áƒ’","áƒ‘","áƒ"]},tA=function(t,e,n,r,a,i){return t<e||t>n?Vo(t,a,i.length>0):r.integers.reduce(function(A,o,l){for(;t>=o;)t-=o,A+=r.values[l];return A},"")+i},fx=function(t,e,n,r){var a="";do n||t--,a=r(t)+a,t/=e;while(t*e>=e);return a},dn=function(t,e,n,r,a){var i=n-e+1;return(t<0?"-":"")+(fx(Math.abs(t),i,r,function(A){return un(Math.floor(A%i)+e)})+a)},ti=function(t,e,n){n===void 0&&(n=". ");var r=e.length;return fx(Math.abs(t),r,!1,function(a){return e[Math.floor(a%r)]})+n},lA=1,va=2,Ba=4,To=8,Js=function(t,e,n,r,a,i){if(t<-9999||t>9999)return Vo(t,4,a.length>0);var A=Math.abs(t),o=a;if(A===0)return e[0]+o;for(var l=0;A>0&&l<=4;l++){var c=A%10;c===0&&Nn(i,lA)&&o!==""?o=e[c]+o:c>1||c===1&&l===0||c===1&&l===1&&Nn(i,va)||c===1&&l===1&&Nn(i,Ba)&&t>100||c===1&&l>1&&Nn(i,To)?o=e[c]+(l>0?n[l-1]:"")+o:c===1&&l>0&&(o=n[l-1]+o),A=Math.floor(A/10)}return(t<0?r:"")+o},Mg="åç™¾åƒè¬",Dg="æ‹¾ä½°ä»Ÿè¬",Pg="ãƒžã‚¤ãƒŠã‚¹",ou="ë§ˆì´ë„ˆìŠ¤",Vo=function(t,e,n){var r=n?". ":"",a=n?"ã€":"",i=n?", ":"",A=n?" ":"";switch(e){case 0:return"â€¢"+A;case 1:return"â—¦"+A;case 2:return"â—¾"+A;case 5:var o=dn(t,48,57,!0,r);return o.length<4?"0"+o:o;case 4:return ti(t,"ã€‡ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹",a);case 6:return tA(t,1,3999,Lg,3,r).toLowerCase();case 7:return tA(t,1,3999,Lg,3,r);case 8:return dn(t,945,969,!1,r);case 9:return dn(t,97,122,!1,r);case 10:return dn(t,65,90,!1,r);case 11:return dn(t,1632,1641,!0,r);case 12:case 49:return tA(t,1,9999,_g,3,r);case 35:return tA(t,1,9999,_g,3,r).toLowerCase();case 13:return dn(t,2534,2543,!0,r);case 14:case 30:return dn(t,6112,6121,!0,r);case 15:return ti(t,"å­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥",a);case 16:return ti(t,"ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸",a);case 17:case 48:return Js(t,"é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹",Mg,"è² ",a,va|Ba|To);case 47:return Js(t,"é›¶å£¹è²³åƒè‚†ä¼é™¸æŸ’æŒçŽ–",Dg,"è² ",a,lA|va|Ba|To);case 42:return Js(t,"é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹",Mg,"è´Ÿ",a,va|Ba|To);case 41:return Js(t,"é›¶å£¹è´°åè‚†ä¼é™†æŸ’æŒçŽ–",Dg,"è´Ÿ",a,lA|va|Ba|To);case 26:return Js(t,"ã€‡ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹","åç™¾åƒä¸‡",Pg,a,0);case 25:return Js(t,"é›¶å£±å¼å‚å››ä¼å…­ä¸ƒå…«ä¹","æ‹¾ç™¾åƒä¸‡",Pg,a,lA|va|Ba);case 31:return Js(t,"ì˜ì¼ì´ì‚¼ì‚¬ì˜¤ìœ¡ì¹ íŒ”êµ¬","ì‹­ë°±ì²œë§Œ",ou,i,lA|va|Ba);case 33:return Js(t,"é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹","åç™¾åƒè¬",ou,i,0);case 32:return Js(t,"é›¶å£¹è²³åƒå››äº”å…­ä¸ƒå…«ä¹","æ‹¾ç™¾åƒ",ou,i,lA|va|Ba);case 18:return dn(t,2406,2415,!0,r);case 20:return tA(t,1,19999,OB,3,r);case 21:return dn(t,2790,2799,!0,r);case 22:return dn(t,2662,2671,!0,r);case 22:return tA(t,1,10999,HB,3,r);case 23:return ti(t,"ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ã‚€ã‚ã‚‚ã‚„ã‚†ã‚ˆã‚‰ã‚Šã‚‹ã‚Œã‚ã‚ã‚ã‚‘ã‚’ã‚“");case 24:return ti(t,"ã„ã‚ã¯ã«ã»ã¸ã¨ã¡ã‚Šã¬ã‚‹ã‚’ã‚ã‹ã‚ˆãŸã‚Œãã¤ã­ãªã‚‰ã‚€ã†ã‚ã®ãŠãã‚„ã¾ã‘ãµã“ãˆã¦ã‚ã•ãã‚†ã‚ã¿ã—ã‚‘ã²ã‚‚ã›ã™");case 27:return dn(t,3302,3311,!0,r);case 28:return ti(t,"ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒŽãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒžãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ°ãƒ±ãƒ²ãƒ³",a);case 29:return ti(t,"ã‚¤ãƒ­ãƒãƒ‹ãƒ›ãƒ˜ãƒˆãƒãƒªãƒŒãƒ«ãƒ²ãƒ¯ã‚«ãƒ¨ã‚¿ãƒ¬ã‚½ãƒ„ãƒãƒŠãƒ©ãƒ ã‚¦ãƒ°ãƒŽã‚ªã‚¯ãƒ¤ãƒžã‚±ãƒ•ã‚³ã‚¨ãƒ†ã‚¢ã‚µã‚­ãƒ¦ãƒ¡ãƒŸã‚·ãƒ±ãƒ’ãƒ¢ã‚»ã‚¹",a);case 34:return dn(t,3792,3801,!0,r);case 37:return dn(t,6160,6169,!0,r);case 38:return dn(t,4160,4169,!0,r);case 39:return dn(t,2918,2927,!0,r);case 40:return dn(t,1776,1785,!0,r);case 43:return dn(t,3046,3055,!0,r);case 44:return dn(t,3174,3183,!0,r);case 45:return dn(t,3664,3673,!0,r);case 46:return dn(t,3872,3881,!0,r);case 3:default:return dn(t,48,57,!0,r)}},hx="data-html2canvas-ignore",Rg=function(){function t(e,n,r){if(this.context=e,this.options=r,this.scrolledElements=[],this.referenceElement=n,this.counters=new RB,this.quoteDepth=0,!n.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(n.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,n){var r=this,a=GB(e,n);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var i=e.defaultView.pageXOffset,A=e.defaultView.pageYOffset,o=a.contentWindow,l=o.document,c=qB(a).then(function(){return ir(r,void 0,void 0,function(){var d,h;return $n(this,function(p){switch(p.label){case 0:return this.scrolledElements.forEach(YB),o&&(o.scrollTo(n.left,n.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==n.top||o.scrollX!==n.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-n.left,o.scrollY-n.top,0,0))),d=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:p.sent(),p.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,KB(l)]:[3,4];case 3:p.sent(),p.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(l,h)}).then(function(){return a})]:[2,a]}})})});return l.open(),l.write(JB(document.doctype)+"<html></html>"),WB(this.referenceElement.ownerDocument,i,A),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c},t.prototype.createElementClone=function(e){if(Gu(e,2))debugger;if(cx(e))return this.createCanvasClone(e);if(jg(e))return this.createVideoClone(e);if(Tg(e))return this.createStyleClone(e);var n=e.cloneNode(!1);return zu(n)&&(zu(e)&&e.currentSrc&&e.currentSrc!==e.src&&(n.src=e.currentSrc,n.srcset=""),n.loading==="lazy"&&(n.loading="eager")),Qg(n)?this.createCustomElementClone(n):n},t.prototype.createCustomElementClone=function(e){var n=document.createElement("html2canvascustomelement");return lu(e.style,n),n},t.prototype.createStyleClone=function(e){try{var n=e.sheet;if(n&&n.cssRules){var r=[].slice.call(n.cssRules,0).reduce(function(i,A){return A&&typeof A.cssText=="string"?i+A.cssText:i},""),a=e.cloneNode(!1);return a.textContent=r,a}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var n;if(this.options.inlineImages&&e.ownerDocument){var r=e.ownerDocument.createElement("img");try{return r.src=e.toDataURL(),r}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var i=e.getContext("2d"),A=a.getContext("2d");if(A)if(!this.options.allowTaint&&i)A.putImageData(i.getImageData(0,0,e.width,e.height),0,0);else{var o=(n=e.getContext("webgl2"))!==null&&n!==void 0?n:e.getContext("webgl");if(o){var l=o.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}A.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var n=e.ownerDocument.createElement("canvas");n.width=e.offsetWidth,n.height=e.offsetHeight;var r=n.getContext("2d");try{return r&&(r.drawImage(e,0,0,n.width,n.height),this.options.allowTaint||r.getImageData(0,0,n.width,n.height)),n}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,n,r){(!uA(n)||!PB(n)&&!n.hasAttribute(hx)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(n)))&&(!this.options.copyStyles||!uA(n)||!Tg(n))&&e.appendChild(this.cloneNode(n,r))},t.prototype.cloneChildNodes=function(e,n,r){for(var a=this,i=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;i;i=i.nextSibling)if(uA(i)&&ux(i)&&typeof i.assignedNodes=="function"){var A=i.assignedNodes();A.length&&A.forEach(function(o){return a.appendChildNode(n,o,r)})}else this.appendChildNode(n,i,r)},t.prototype.cloneNode=function(e,n){if(ox(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var r=e.ownerDocument.defaultView;if(r&&uA(e)&&(qu(e)||mc(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var i=r.getComputedStyle(e),A=r.getComputedStyle(e,":before"),o=r.getComputedStyle(e,":after");this.referenceElement===e&&qu(a)&&(this.clonedReferenceElement=a),Ef(a)&&ZB(a);var l=this.counters.parse(new pg(this.context,i)),c=this.resolvePseudoContent(e,a,A,Po.BEFORE);Qg(e)&&(n=!0),jg(e)||this.cloneChildNodes(e,a,n),c&&a.insertBefore(c,a.firstChild);var d=this.resolvePseudoContent(e,a,o,Po.AFTER);return d&&a.appendChild(d),this.counters.pop(l),(i&&(this.options.copyStyles||mc(e))&&!dx(e)||n)&&lu(i,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(Ic(e)||Fc(e))&&(Ic(a)||Fc(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,n,r,a){var i=this;if(r){var A=r.content,o=n.ownerDocument;if(!(!o||!A||A==="none"||A==="-moz-alt-content"||r.display==="none")){this.counters.parse(new pg(this.context,r));var l=new L5(this.context,r),c=o.createElement("html2canvaspseudoelement");lu(r,c),l.content.forEach(function(h){if(h.type===0)c.appendChild(o.createTextNode(h.value));else if(h.type===22){var p=o.createElement("img");p.src=h.value,p.style.opacity="1",c.appendChild(p)}else if(h.type===18){if(h.name==="attr"){var m=h.values.filter(Dt);m.length&&c.appendChild(o.createTextNode(e.getAttribute(m[0].value)||""))}else if(h.name==="counter"){var B=h.values.filter(IA),y=B[0],b=B[1];if(y&&Dt(y)){var C=i.counters.getCounterValue(y.value),N=b&&Dt(b)?Ou.parse(i.context,b.value):3;c.appendChild(o.createTextNode(Vo(C,N,!1)))}}else if(h.name==="counters"){var k=h.values.filter(IA),y=k[0],E=k[1],b=k[2];if(y&&Dt(y)){var _=i.counters.getCounterValues(y.value),M=b&&Dt(b)?Ou.parse(i.context,b.value):3,D=E&&E.type===0?E.value:"",U=_.map(function(F){return Vo(F,M,!1)}).join(D);c.appendChild(o.createTextNode(U))}}}else if(h.type===20)switch(h.value){case"open-quote":c.appendChild(o.createTextNode(mg(l.quotes,i.quoteDepth++,!0)));break;case"close-quote":c.appendChild(o.createTextNode(mg(l.quotes,--i.quoteDepth,!1)));break;default:c.appendChild(o.createTextNode(h.value))}}),c.className=Ju+" "+Wu;var d=a===Po.BEFORE?" "+Ju:" "+Wu;return mc(n)?n.className.baseValue+=d:n.className+=d,c}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Po;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Po||(Po={}));var GB=function(t,e){var n=t.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=e.width.toString(),n.height=e.height.toString(),n.scrolling="no",n.setAttribute(hx,"true"),t.body.appendChild(n),n},VB=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},KB=function(t){return Promise.all([].slice.call(t.images,0).map(VB))},qB=function(t){return new Promise(function(e,n){var r=t.contentWindow;if(!r)return n("No window assigned for iframe");var a=r.document;r.onload=t.onload=function(){r.onload=t.onload=null;var i=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(i),e(t))},50)}})},zB=["all","d","content"],lu=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t.item(n);zB.indexOf(r)===-1&&e.style.setProperty(r,t.getPropertyValue(r))}return e},JB=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},WB=function(t,e,n){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||n!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,n)},YB=function(t){var e=t[0],n=t[1],r=t[2];e.scrollLeft=n,e.scrollTop=r},$B=":before",XB=":after",Ju="___html2canvas___pseudoelement_before",Wu="___html2canvas___pseudoelement_after",Hg=`{
    content: "" !important;
    display: none !important;
}`,ZB=function(t){eC(t,"."+Ju+$B+Hg+`
         .`+Wu+XB+Hg)},eC=function(t,e){var n=t.ownerDocument;if(n){var r=n.createElement("style");r.textContent=e,t.appendChild(r)}},gx=function(){function t(){}return t.getOrigin=function(e){var n=t._link;return n?(n.href=e,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),tC=function(){function t(e,n){this.context=e,this._options=n,this._cache={}}return t.prototype.addImage=function(e){var n=Promise.resolve();return this.has(e)||(du(e)||aC(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),n},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return ir(this,void 0,void 0,function(){var n,r,a,i,A=this;return $n(this,function(o){switch(o.label){case 0:return n=gx.isSameOrigin(e),r=!cu(e)&&this._options.useCORS===!0&&Rn.SUPPORT_CORS_IMAGES&&!n,a=!cu(e)&&!n&&!du(e)&&typeof this._options.proxy=="string"&&Rn.SUPPORT_CORS_XHR&&!r,!n&&this._options.allowTaint===!1&&!cu(e)&&!du(e)&&!a&&!r?[2]:(i=e,a?[4,this.proxy(i)]:[3,2]);case 1:i=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(l,c){var d=new Image;d.onload=function(){return l(d)},d.onerror=c,(iC(i)||r)&&(d.crossOrigin="anonymous"),d.src=i,d.complete===!0&&setTimeout(function(){return l(d)},500),A._options.imageTimeout>0&&setTimeout(function(){return c("Timed out ("+A._options.imageTimeout+"ms) loading image")},A._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var n=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(i,A){var o=Rn.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=function(){if(l.status===200)if(o==="text")i(l.response);else{var h=new FileReader;h.addEventListener("load",function(){return i(h.result)},!1),h.addEventListener("error",function(p){return A(p)},!1),h.readAsDataURL(l.response)}else A("Failed to proxy resource "+a+" with status code "+l.status)},l.onerror=A;var c=r.indexOf("?")>-1?"&":"?";if(l.open("GET",""+r+c+"url="+encodeURIComponent(e)+"&responseType="+o),o!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=o),n._options.imageTimeout){var d=n._options.imageTimeout;l.timeout=d,l.ontimeout=function(){return A("Timed out ("+d+"ms) proxying "+a)}}l.send()})},t}(),nC=/^data:image\/svg\+xml/i,rC=/^data:image\/.*;base64,/i,sC=/^data:image\/.*/i,aC=function(t){return Rn.SUPPORT_SVG_DRAWING||!AC(t)},cu=function(t){return sC.test(t)},iC=function(t){return rC.test(t)},du=function(t){return t.substr(0,4)==="blob"},AC=function(t){return t.substr(-3).toLowerCase()==="svg"||nC.test(t)},ze=function(){function t(e,n){this.type=0,this.x=e,this.y=n}return t.prototype.add=function(e,n){return new t(this.x+e,this.y+n)},t}(),nA=function(t,e,n){return new ze(t.x+(e.x-t.x)*n,t.y+(e.y-t.y)*n)},Zl=function(){function t(e,n,r,a){this.type=1,this.start=e,this.startControl=n,this.endControl=r,this.end=a}return t.prototype.subdivide=function(e,n){var r=nA(this.start,this.startControl,e),a=nA(this.startControl,this.endControl,e),i=nA(this.endControl,this.end,e),A=nA(r,a,e),o=nA(a,i,e),l=nA(A,o,e);return n?new t(this.start,r,A,l):new t(l,o,i,this.end)},t.prototype.add=function(e,n){return new t(this.start.add(e,n),this.startControl.add(e,n),this.endControl.add(e,n),this.end.add(e,n))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),Wr=function(t){return t.type===1},oC=function(){function t(e){var n=e.styles,r=e.bounds,a=Uo(n.borderTopLeftRadius,r.width,r.height),i=a[0],A=a[1],o=Uo(n.borderTopRightRadius,r.width,r.height),l=o[0],c=o[1],d=Uo(n.borderBottomRightRadius,r.width,r.height),h=d[0],p=d[1],m=Uo(n.borderBottomLeftRadius,r.width,r.height),B=m[0],y=m[1],b=[];b.push((i+l)/r.width),b.push((B+h)/r.width),b.push((A+y)/r.height),b.push((c+p)/r.height);var C=Math.max.apply(Math,b);C>1&&(i/=C,A/=C,l/=C,c/=C,h/=C,p/=C,B/=C,y/=C);var N=r.width-l,k=r.height-p,E=r.width-h,_=r.height-y,M=n.borderTopWidth,D=n.borderRightWidth,U=n.borderBottomWidth,j=n.borderLeftWidth,O=Kt(n.paddingTop,e.bounds.width),F=Kt(n.paddingRight,e.bounds.width),I=Kt(n.paddingBottom,e.bounds.width),P=Kt(n.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||A>0?Zt(r.left+j/3,r.top+M/3,i-j/3,A-M/3,Ut.TOP_LEFT):new ze(r.left+j/3,r.top+M/3),this.topRightBorderDoubleOuterBox=i>0||A>0?Zt(r.left+N,r.top+M/3,l-D/3,c-M/3,Ut.TOP_RIGHT):new ze(r.left+r.width-D/3,r.top+M/3),this.bottomRightBorderDoubleOuterBox=h>0||p>0?Zt(r.left+E,r.top+k,h-D/3,p-U/3,Ut.BOTTOM_RIGHT):new ze(r.left+r.width-D/3,r.top+r.height-U/3),this.bottomLeftBorderDoubleOuterBox=B>0||y>0?Zt(r.left+j/3,r.top+_,B-j/3,y-U/3,Ut.BOTTOM_LEFT):new ze(r.left+j/3,r.top+r.height-U/3),this.topLeftBorderDoubleInnerBox=i>0||A>0?Zt(r.left+j*2/3,r.top+M*2/3,i-j*2/3,A-M*2/3,Ut.TOP_LEFT):new ze(r.left+j*2/3,r.top+M*2/3),this.topRightBorderDoubleInnerBox=i>0||A>0?Zt(r.left+N,r.top+M*2/3,l-D*2/3,c-M*2/3,Ut.TOP_RIGHT):new ze(r.left+r.width-D*2/3,r.top+M*2/3),this.bottomRightBorderDoubleInnerBox=h>0||p>0?Zt(r.left+E,r.top+k,h-D*2/3,p-U*2/3,Ut.BOTTOM_RIGHT):new ze(r.left+r.width-D*2/3,r.top+r.height-U*2/3),this.bottomLeftBorderDoubleInnerBox=B>0||y>0?Zt(r.left+j*2/3,r.top+_,B-j*2/3,y-U*2/3,Ut.BOTTOM_LEFT):new ze(r.left+j*2/3,r.top+r.height-U*2/3),this.topLeftBorderStroke=i>0||A>0?Zt(r.left+j/2,r.top+M/2,i-j/2,A-M/2,Ut.TOP_LEFT):new ze(r.left+j/2,r.top+M/2),this.topRightBorderStroke=i>0||A>0?Zt(r.left+N,r.top+M/2,l-D/2,c-M/2,Ut.TOP_RIGHT):new ze(r.left+r.width-D/2,r.top+M/2),this.bottomRightBorderStroke=h>0||p>0?Zt(r.left+E,r.top+k,h-D/2,p-U/2,Ut.BOTTOM_RIGHT):new ze(r.left+r.width-D/2,r.top+r.height-U/2),this.bottomLeftBorderStroke=B>0||y>0?Zt(r.left+j/2,r.top+_,B-j/2,y-U/2,Ut.BOTTOM_LEFT):new ze(r.left+j/2,r.top+r.height-U/2),this.topLeftBorderBox=i>0||A>0?Zt(r.left,r.top,i,A,Ut.TOP_LEFT):new ze(r.left,r.top),this.topRightBorderBox=l>0||c>0?Zt(r.left+N,r.top,l,c,Ut.TOP_RIGHT):new ze(r.left+r.width,r.top),this.bottomRightBorderBox=h>0||p>0?Zt(r.left+E,r.top+k,h,p,Ut.BOTTOM_RIGHT):new ze(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=B>0||y>0?Zt(r.left,r.top+_,B,y,Ut.BOTTOM_LEFT):new ze(r.left,r.top+r.height),this.topLeftPaddingBox=i>0||A>0?Zt(r.left+j,r.top+M,Math.max(0,i-j),Math.max(0,A-M),Ut.TOP_LEFT):new ze(r.left+j,r.top+M),this.topRightPaddingBox=l>0||c>0?Zt(r.left+Math.min(N,r.width-D),r.top+M,N>r.width+D?0:Math.max(0,l-D),Math.max(0,c-M),Ut.TOP_RIGHT):new ze(r.left+r.width-D,r.top+M),this.bottomRightPaddingBox=h>0||p>0?Zt(r.left+Math.min(E,r.width-j),r.top+Math.min(k,r.height-U),Math.max(0,h-D),Math.max(0,p-U),Ut.BOTTOM_RIGHT):new ze(r.left+r.width-D,r.top+r.height-U),this.bottomLeftPaddingBox=B>0||y>0?Zt(r.left+j,r.top+Math.min(_,r.height-U),Math.max(0,B-j),Math.max(0,y-U),Ut.BOTTOM_LEFT):new ze(r.left+j,r.top+r.height-U),this.topLeftContentBox=i>0||A>0?Zt(r.left+j+P,r.top+M+O,Math.max(0,i-(j+P)),Math.max(0,A-(M+O)),Ut.TOP_LEFT):new ze(r.left+j+P,r.top+M+O),this.topRightContentBox=l>0||c>0?Zt(r.left+Math.min(N,r.width+j+P),r.top+M+O,N>r.width+j+P?0:l-j+P,c-(M+O),Ut.TOP_RIGHT):new ze(r.left+r.width-(D+F),r.top+M+O),this.bottomRightContentBox=h>0||p>0?Zt(r.left+Math.min(E,r.width-(j+P)),r.top+Math.min(k,r.height+M+O),Math.max(0,h-(D+F)),p-(U+I),Ut.BOTTOM_RIGHT):new ze(r.left+r.width-(D+F),r.top+r.height-(U+I)),this.bottomLeftContentBox=B>0||y>0?Zt(r.left+j+P,r.top+_,Math.max(0,B-(j+P)),y-(U+I),Ut.BOTTOM_LEFT):new ze(r.left+j+P,r.top+r.height-(U+I))}return t}(),Ut;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ut||(Ut={}));var Zt=function(t,e,n,r,a){var i=4*((Math.sqrt(2)-1)/3),A=n*i,o=r*i,l=t+n,c=e+r;switch(a){case Ut.TOP_LEFT:return new Zl(new ze(t,c),new ze(t,c-o),new ze(l-A,e),new ze(l,e));case Ut.TOP_RIGHT:return new Zl(new ze(t,e),new ze(t+A,e),new ze(l,c-o),new ze(l,c));case Ut.BOTTOM_RIGHT:return new Zl(new ze(l,e),new ze(l,e+o),new ze(t+A,c),new ze(t,c));case Ut.BOTTOM_LEFT:default:return new Zl(new ze(l,c),new ze(l-A,c),new ze(t,e+o),new ze(t,e))}},Ec=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},lC=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},kc=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},cC=function(){function t(e,n,r){this.offsetX=e,this.offsetY=n,this.matrix=r,this.type=0,this.target=6}return t}(),ec=function(){function t(e,n){this.path=e,this.target=n,this.type=1}return t}(),dC=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),uC=function(t){return t.type===0},mx=function(t){return t.type===1},fC=function(t){return t.type===2},Og=function(t,e){return t.length===e.length?t.some(function(n,r){return n===e[r]}):!1},hC=function(t,e,n,r,a){return t.map(function(i,A){switch(A){case 0:return i.add(e,n);case 1:return i.add(e+r,n);case 2:return i.add(e+r,n+a);case 3:return i.add(e,n+a)}return i})},px=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),xx=function(){function t(e,n){if(this.container=e,this.parent=n,this.effects=[],this.curves=new oC(this.container),this.container.styles.opacity<1&&this.effects.push(new dC(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new cC(r,a,i))}if(this.container.styles.overflowX!==0){var A=Ec(this.curves),o=kc(this.curves);Og(A,o)?this.effects.push(new ec(A,6)):(this.effects.push(new ec(A,2)),this.effects.push(new ec(o,4)))}}return t.prototype.getEffects=function(e){for(var n=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,a=this.effects.slice(0);r;){var i=r.effects.filter(function(l){return!mx(l)});if(n||r.container.styles.position!==0||!r.parent){if(a.unshift.apply(a,i),n=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var A=Ec(r.curves),o=kc(r.curves);Og(A,o)||a.unshift(new ec(o,6))}}else a.unshift.apply(a,i);r=r.parent}return a.filter(function(l){return Nn(l.target,e)})},t}(),Yu=function(t,e,n,r){t.container.elements.forEach(function(a){var i=Nn(a.flags,4),A=Nn(a.flags,2),o=new xx(a,t);Nn(a.styles.display,2048)&&r.push(o);var l=Nn(a.flags,8)?[]:r;if(i||A){var c=i||a.styles.isPositioned()?n:e,d=new px(o);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var h=a.styles.zIndex.order;if(h<0){var p=0;c.negativeZIndex.some(function(B,y){return h>B.element.container.styles.zIndex.order?(p=y,!1):p>0}),c.negativeZIndex.splice(p,0,d)}else if(h>0){var m=0;c.positiveZIndex.some(function(B,y){return h>=B.element.container.styles.zIndex.order?(m=y+1,!1):m>0}),c.positiveZIndex.splice(m,0,d)}else c.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?c.nonPositionedFloats.push(d):c.nonPositionedInlineLevel.push(d);Yu(o,d,i?d:n,l)}else a.styles.isInlineLevel()?e.inlineLevel.push(o):e.nonInlineLevel.push(o),Yu(o,e,n,l);Nn(a.flags,8)&&wx(a,l)})},wx=function(t,e){for(var n=t instanceof Ku?t.start:1,r=t instanceof Ku?t.reversed:!1,a=0;a<e.length;a++){var i=e[a];i.container instanceof nx&&typeof i.container.value=="number"&&i.container.value!==0&&(n=i.container.value),i.listValue=Vo(n,i.container.styles.listStyleType,!0),n+=r?-1:1}},gC=function(t){var e=new xx(t,null),n=new px(e),r=[];return Yu(e,n,n,r),wx(e.container,r),n},Gg=function(t,e){switch(e){case 0:return $r(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return $r(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return $r(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return $r(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},mC=function(t,e){switch(e){case 0:return $r(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return $r(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return $r(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return $r(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},pC=function(t,e){switch(e){case 0:return $r(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return $r(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return $r(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return $r(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},xC=function(t,e){switch(e){case 0:return tc(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return tc(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return tc(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return tc(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},tc=function(t,e){var n=[];return Wr(t)?n.push(t.subdivide(.5,!1)):n.push(t),Wr(e)?n.push(e.subdivide(.5,!0)):n.push(e),n},$r=function(t,e,n,r){var a=[];return Wr(t)?a.push(t.subdivide(.5,!1)):a.push(t),Wr(n)?a.push(n.subdivide(.5,!0)):a.push(n),Wr(r)?a.push(r.subdivide(.5,!0).reverse()):a.push(r),Wr(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},yx=function(t){var e=t.bounds,n=t.styles;return e.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},Uc=function(t){var e=t.styles,n=t.bounds,r=Kt(e.paddingLeft,n.width),a=Kt(e.paddingRight,n.width),i=Kt(e.paddingTop,n.width),A=Kt(e.paddingBottom,n.width);return n.add(r+e.borderLeftWidth,i+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+r+a),-(e.borderTopWidth+e.borderBottomWidth+i+A))},wC=function(t,e){return t===0?e.bounds:t===2?Uc(e):yx(e)},yC=function(t,e){return t===0?e.bounds:t===2?Uc(e):yx(e)},uu=function(t,e,n){var r=wC(cA(t.styles.backgroundOrigin,e),t),a=yC(cA(t.styles.backgroundClip,e),t),i=bC(cA(t.styles.backgroundSize,e),n,r),A=i[0],o=i[1],l=Uo(cA(t.styles.backgroundPosition,e),r.width-A,r.height-o),c=vC(cA(t.styles.backgroundRepeat,e),l,i,r,a),d=Math.round(r.left+l[0]),h=Math.round(r.top+l[1]);return[c,d,h,A,o]},rA=function(t){return Dt(t)&&t.value===wA.AUTO},nc=function(t){return typeof t=="number"},bC=function(t,e,n){var r=e[0],a=e[1],i=e[2],A=t[0],o=t[1];if(!A)return[0,0];if(yn(A)&&o&&yn(o))return[Kt(A,n.width),Kt(o,n.height)];var l=nc(i);if(Dt(A)&&(A.value===wA.CONTAIN||A.value===wA.COVER)){if(nc(i)){var c=n.width/n.height;return c<i!=(A.value===wA.COVER)?[n.width,n.width/i]:[n.height*i,n.height]}return[n.width,n.height]}var d=nc(r),h=nc(a),p=d||h;if(rA(A)&&(!o||rA(o))){if(d&&h)return[r,a];if(!l&&!p)return[n.width,n.height];if(p&&l){var m=d?r:a*i,B=h?a:r/i;return[m,B]}var y=d?r:n.width,b=h?a:n.height;return[y,b]}if(l){var C=0,N=0;return yn(A)?C=Kt(A,n.width):yn(o)&&(N=Kt(o,n.height)),rA(A)?C=N*i:(!o||rA(o))&&(N=C/i),[C,N]}var k=null,E=null;if(yn(A)?k=Kt(A,n.width):o&&yn(o)&&(E=Kt(o,n.height)),k!==null&&(!o||rA(o))&&(E=d&&h?k/r*a:n.height),E!==null&&rA(A)&&(k=d&&h?E/a*r:n.width),k!==null&&E!==null)return[k,E];throw new Error("Unable to calculate background-size for element")},cA=function(t,e){var n=t[e];return typeof n>"u"?t[0]:n},vC=function(t,e,n,r,a){var i=e[0],A=e[1],o=n[0],l=n[1];switch(t){case 2:return[new ze(Math.round(r.left),Math.round(r.top+A)),new ze(Math.round(r.left+r.width),Math.round(r.top+A)),new ze(Math.round(r.left+r.width),Math.round(l+r.top+A)),new ze(Math.round(r.left),Math.round(l+r.top+A))];case 3:return[new ze(Math.round(r.left+i),Math.round(r.top)),new ze(Math.round(r.left+i+o),Math.round(r.top)),new ze(Math.round(r.left+i+o),Math.round(r.height+r.top)),new ze(Math.round(r.left+i),Math.round(r.height+r.top))];case 1:return[new ze(Math.round(r.left+i),Math.round(r.top+A)),new ze(Math.round(r.left+i+o),Math.round(r.top+A)),new ze(Math.round(r.left+i+o),Math.round(r.top+A+l)),new ze(Math.round(r.left+i),Math.round(r.top+A+l))];default:return[new ze(Math.round(a.left),Math.round(a.top)),new ze(Math.round(a.left+a.width),Math.round(a.top)),new ze(Math.round(a.left+a.width),Math.round(a.height+a.top)),new ze(Math.round(a.left),Math.round(a.height+a.top))]}},BC="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Vg="Hidden Text",CC=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,n){var r=this._document.createElement("div"),a=this._document.createElement("img"),i=this._document.createElement("span"),A=this._document.body;r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=n,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",A.appendChild(r),a.src=BC,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=n,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(Vg)),r.appendChild(i),r.appendChild(a);var o=a.offsetTop-i.offsetTop+2;r.removeChild(i),r.appendChild(this._document.createTextNode(Vg)),r.style.lineHeight="normal",a.style.verticalAlign="super";var l=a.offsetTop-r.offsetTop+2;return A.removeChild(r),{baseline:o,middle:l}},t.prototype.getMetrics=function(e,n){var r=e+" "+n;return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(e,n)),this._data[r]},t}(),bx=function(){function t(e,n){this.context=e,this.options=n}return t}(),NC=1e4,SC=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a._activeEffects=[],a.canvas=r.canvas?r.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),r.canvas||(a.canvas.width=Math.floor(r.width*r.scale),a.canvas.height=Math.floor(r.height*r.scale),a.canvas.style.width=r.width+"px",a.canvas.style.height=r.height+"px"),a.fontMetrics=new CC(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-r.x,-r.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),a}return e.prototype.applyEffects=function(n){for(var r=this;this._activeEffects.length;)this.popEffect();n.forEach(function(a){return r.applyEffect(a)})},e.prototype.applyEffect=function(n){this.ctx.save(),fC(n)&&(this.ctx.globalAlpha=n.opacity),uC(n)&&(this.ctx.translate(n.offsetX,n.offsetY),this.ctx.transform(n.matrix[0],n.matrix[1],n.matrix[2],n.matrix[3],n.matrix[4],n.matrix[5]),this.ctx.translate(-n.offsetX,-n.offsetY)),mx(n)&&(this.path(n.path),this.ctx.clip()),this._activeEffects.push(n)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(n){return ir(this,void 0,void 0,function(){var r;return $n(this,function(a){switch(a.label){case 0:return r=n.element.container.styles,r.isVisible()?[4,this.renderStackContent(n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(n){return ir(this,void 0,void 0,function(){return $n(this,function(r){switch(r.label){case 0:if(Nn(n.container.flags,16))debugger;return n.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(n)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(n,r,a){var i=this;if(r===0)this.ctx.fillText(n.text,n.bounds.left,n.bounds.top+a);else{var A=If(n.text);A.reduce(function(o,l){return i.ctx.fillText(l,o,n.bounds.top+a),o+i.ctx.measureText(l).width},n.bounds.left)}},e.prototype.createFontStyle=function(n){var r=n.fontVariant.filter(function(A){return A==="normal"||A==="small-caps"}).join(""),a=UC(n.fontFamily).join(", "),i=Xo(n.fontSize)?""+n.fontSize.number+n.fontSize.unit:n.fontSize.number+"px";return[[n.fontStyle,r,n.fontWeight,i,a].join(" "),a,i]},e.prototype.renderTextNode=function(n,r){return ir(this,void 0,void 0,function(){var a,i,A,o,l,c,d,h,p=this;return $n(this,function(m){return a=this.createFontStyle(r),i=a[0],A=a[1],o=a[2],this.ctx.font=i,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",l=this.fontMetrics.getMetrics(A,o),c=l.baseline,d=l.middle,h=r.paintOrder,n.textBounds.forEach(function(B){h.forEach(function(y){switch(y){case 0:p.ctx.fillStyle=jn(r.color),p.renderTextWithLetterSpacing(B,r.letterSpacing,c);var b=r.textShadow;b.length&&B.text.trim().length&&(b.slice(0).reverse().forEach(function(C){p.ctx.shadowColor=jn(C.color),p.ctx.shadowOffsetX=C.offsetX.number*p.options.scale,p.ctx.shadowOffsetY=C.offsetY.number*p.options.scale,p.ctx.shadowBlur=C.blur.number,p.renderTextWithLetterSpacing(B,r.letterSpacing,c)}),p.ctx.shadowColor="",p.ctx.shadowOffsetX=0,p.ctx.shadowOffsetY=0,p.ctx.shadowBlur=0),r.textDecorationLine.length&&(p.ctx.fillStyle=jn(r.textDecorationColor||r.color),r.textDecorationLine.forEach(function(C){switch(C){case 1:p.ctx.fillRect(B.bounds.left,Math.round(B.bounds.top+c),B.bounds.width,1);break;case 2:p.ctx.fillRect(B.bounds.left,Math.round(B.bounds.top),B.bounds.width,1);break;case 3:p.ctx.fillRect(B.bounds.left,Math.ceil(B.bounds.top+d),B.bounds.width,1);break}}));break;case 1:r.webkitTextStrokeWidth&&B.text.trim().length&&(p.ctx.strokeStyle=jn(r.webkitTextStrokeColor),p.ctx.lineWidth=r.webkitTextStrokeWidth,p.ctx.lineJoin=window.chrome?"miter":"round",p.ctx.strokeText(B.text,B.bounds.left,B.bounds.top+c)),p.ctx.strokeStyle="",p.ctx.lineWidth=0,p.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(n,r,a){if(a&&n.intrinsicWidth>0&&n.intrinsicHeight>0){var i=Uc(n),A=kc(r);this.path(A),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,n.intrinsicWidth,n.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(n){return ir(this,void 0,void 0,function(){var r,a,i,A,o,l,N,N,c,d,h,p,E,m,B,_,y,b,C,N,k,E,_;return $n(this,function(M){switch(M.label){case 0:this.applyEffects(n.getEffects(4)),r=n.container,a=n.curves,i=r.styles,A=0,o=r.textNodes,M.label=1;case 1:return A<o.length?(l=o[A],[4,this.renderTextNode(l,i)]):[3,4];case 2:M.sent(),M.label=3;case 3:return A++,[3,1];case 4:if(!(r instanceof Zp))return[3,8];M.label=5;case 5:return M.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return N=M.sent(),this.renderReplacedElement(r,a,N),[3,8];case 7:return M.sent(),this.context.logger.error("Error loading image "+r.src),[3,8];case 8:if(r instanceof ex&&this.renderReplacedElement(r,a,r.canvas),!(r instanceof tx))return[3,12];M.label=9;case 9:return M.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return N=M.sent(),this.renderReplacedElement(r,a,N),[3,12];case 11:return M.sent(),this.context.logger.error("Error loading svg "+r.svg.substring(0,255)),[3,12];case 12:return r instanceof ax&&r.tree?(c=new e(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,c.render(r.tree)]):[3,14];case 13:d=M.sent(),r.width&&r.height&&this.ctx.drawImage(d,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),M.label=14;case 14:if(r instanceof Ff&&(h=Math.min(r.bounds.width,r.bounds.height),r.type===Nc?r.checked&&(this.ctx.save(),this.path([new ze(r.bounds.left+h*.39363,r.bounds.top+h*.79),new ze(r.bounds.left+h*.16,r.bounds.top+h*.5549),new ze(r.bounds.left+h*.27347,r.bounds.top+h*.44071),new ze(r.bounds.left+h*.39694,r.bounds.top+h*.5649),new ze(r.bounds.left+h*.72983,r.bounds.top+h*.23),new ze(r.bounds.left+h*.84,r.bounds.top+h*.34085),new ze(r.bounds.left+h*.39363,r.bounds.top+h*.79)]),this.ctx.fillStyle=jn(Ug),this.ctx.fill(),this.ctx.restore()):r.type===Sc&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+h/2,r.bounds.top+h/2,h/4,0,Math.PI*2,!0),this.ctx.fillStyle=jn(Ug),this.ctx.fill(),this.ctx.restore())),IC(r)&&r.value.length){switch(p=this.createFontStyle(i),E=p[0],m=p[1],B=this.fontMetrics.getMetrics(E,m).baseline,this.ctx.font=E,this.ctx.fillStyle=jn(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=EC(r.styles.textAlign),_=Uc(r),y=0,r.styles.textAlign){case 1:y+=_.width/2;break;case 2:y+=_.width;break}b=_.add(y,0,0,-_.height/2+1),this.ctx.save(),this.path([new ze(_.left,_.top),new ze(_.left+_.width,_.top),new ze(_.left+_.width,_.top+_.height),new ze(_.left,_.top+_.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Do(r.value,b),i.letterSpacing,B),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Nn(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(C=r.styles.listStyleImage,C.type!==0)return[3,18];N=void 0,k=C.url,M.label=15;case 15:return M.trys.push([15,17,,18]),[4,this.context.cache.match(k)];case 16:return N=M.sent(),this.ctx.drawImage(N,r.bounds.left-(N.width+10),r.bounds.top),[3,18];case 17:return M.sent(),this.context.logger.error("Error loading list-style-image "+k),[3,18];case 18:return[3,20];case 19:n.listValue&&r.styles.listStyleType!==-1&&(E=this.createFontStyle(i)[0],this.ctx.font=E,this.ctx.fillStyle=jn(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",_=new Ys(r.bounds.left,r.bounds.top+Kt(r.styles.paddingTop,r.bounds.width),r.bounds.width,hg(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Do(n.listValue,_),i.letterSpacing,hg(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),M.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(n){return ir(this,void 0,void 0,function(){var r,a,C,i,A,C,o,l,C,c,d,C,h,p,C,m,B,C,y,b,C;return $n(this,function(N){switch(N.label){case 0:if(Nn(n.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(n.element)];case 1:N.sent(),r=0,a=n.negativeZIndex,N.label=2;case 2:return r<a.length?(C=a[r],[4,this.renderStack(C)]):[3,5];case 3:N.sent(),N.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(n.element)];case 6:N.sent(),i=0,A=n.nonInlineLevel,N.label=7;case 7:return i<A.length?(C=A[i],[4,this.renderNode(C)]):[3,10];case 8:N.sent(),N.label=9;case 9:return i++,[3,7];case 10:o=0,l=n.nonPositionedFloats,N.label=11;case 11:return o<l.length?(C=l[o],[4,this.renderStack(C)]):[3,14];case 12:N.sent(),N.label=13;case 13:return o++,[3,11];case 14:c=0,d=n.nonPositionedInlineLevel,N.label=15;case 15:return c<d.length?(C=d[c],[4,this.renderStack(C)]):[3,18];case 16:N.sent(),N.label=17;case 17:return c++,[3,15];case 18:h=0,p=n.inlineLevel,N.label=19;case 19:return h<p.length?(C=p[h],[4,this.renderNode(C)]):[3,22];case 20:N.sent(),N.label=21;case 21:return h++,[3,19];case 22:m=0,B=n.zeroOrAutoZIndexOrTransformedOrOpacity,N.label=23;case 23:return m<B.length?(C=B[m],[4,this.renderStack(C)]):[3,26];case 24:N.sent(),N.label=25;case 25:return m++,[3,23];case 26:y=0,b=n.positiveZIndex,N.label=27;case 27:return y<b.length?(C=b[y],[4,this.renderStack(C)]):[3,30];case 28:N.sent(),N.label=29;case 29:return y++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(n){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(n.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(n){this.ctx.beginPath(),this.formatPath(n),this.ctx.closePath()},e.prototype.formatPath=function(n){var r=this;n.forEach(function(a,i){var A=Wr(a)?a.start:a;i===0?r.ctx.moveTo(A.x,A.y):r.ctx.lineTo(A.x,A.y),Wr(a)&&r.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(n,r,a,i){this.path(n),this.ctx.fillStyle=r,this.ctx.translate(a,i),this.ctx.fill(),this.ctx.translate(-a,-i)},e.prototype.resizeImage=function(n,r,a){var i;if(n.width===r&&n.height===a)return n;var A=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,o=A.createElement("canvas");o.width=Math.max(1,r),o.height=Math.max(1,a);var l=o.getContext("2d");return l.drawImage(n,0,0,n.width,n.height,0,0,r,a),o},e.prototype.renderBackgroundImage=function(n){return ir(this,void 0,void 0,function(){var r,a,i,A,o,l;return $n(this,function(c){switch(c.label){case 0:r=n.styles.backgroundImage.length-1,a=function(d){var h,p,m,O,X,le,P,V,U,B,O,X,le,P,V,y,b,C,N,k,E,_,M,D,U,j,O,F,I,P,V,ee,X,le,ae,de,ue,Ce,Q,z,W,Z;return $n(this,function(ne){switch(ne.label){case 0:if(d.type!==0)return[3,5];h=void 0,p=d.url,ne.label=1;case 1:return ne.trys.push([1,3,,4]),[4,i.context.cache.match(p)];case 2:return h=ne.sent(),[3,4];case 3:return ne.sent(),i.context.logger.error("Error loading background-image "+p),[3,4];case 4:return h&&(m=uu(n,r,[h.width,h.height,h.width/h.height]),O=m[0],X=m[1],le=m[2],P=m[3],V=m[4],U=i.ctx.createPattern(i.resizeImage(h,P,V),"repeat"),i.renderRepeat(O,U,X,le)),[3,6];case 5:uv(d)?(B=uu(n,r,[null,null,null]),O=B[0],X=B[1],le=B[2],P=B[3],V=B[4],y=Av(d.angle,P,V),b=y[0],C=y[1],N=y[2],k=y[3],E=y[4],_=document.createElement("canvas"),_.width=P,_.height=V,M=_.getContext("2d"),D=M.createLinearGradient(C,k,N,E),ug(d.stops,b).forEach(function(fe){return D.addColorStop(fe.stop,jn(fe.color))}),M.fillStyle=D,M.fillRect(0,0,P,V),P>0&&V>0&&(U=i.ctx.createPattern(_,"repeat"),i.renderRepeat(O,U,X,le))):fv(d)&&(j=uu(n,r,[null,null,null]),O=j[0],F=j[1],I=j[2],P=j[3],V=j[4],ee=d.position.length===0?[Cf]:d.position,X=Kt(ee[0],P),le=Kt(ee[ee.length-1],V),ae=ov(d,X,le,P,V),de=ae[0],ue=ae[1],de>0&&ue>0&&(Ce=i.ctx.createRadialGradient(F+X,I+le,0,F+X,I+le,de),ug(d.stops,de*2).forEach(function(fe){return Ce.addColorStop(fe.stop,jn(fe.color))}),i.path(O),i.ctx.fillStyle=Ce,de!==ue?(Q=n.bounds.left+.5*n.bounds.width,z=n.bounds.top+.5*n.bounds.height,W=ue/de,Z=1/W,i.ctx.save(),i.ctx.translate(Q,z),i.ctx.transform(1,0,0,W,0,0),i.ctx.translate(-Q,-z),i.ctx.fillRect(F,Z*(I-z)+z,P,V*Z),i.ctx.restore()):i.ctx.fill())),ne.label=6;case 6:return r--,[2]}})},i=this,A=0,o=n.styles.backgroundImage.slice(0).reverse(),c.label=1;case 1:return A<o.length?(l=o[A],[5,a(l)]):[3,4];case 2:c.sent(),c.label=3;case 3:return A++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(n,r,a){return ir(this,void 0,void 0,function(){return $n(this,function(i){return this.path(Gg(a,r)),this.ctx.fillStyle=jn(n),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(n,r,a,i){return ir(this,void 0,void 0,function(){var A,o;return $n(this,function(l){switch(l.label){case 0:return r<3?[4,this.renderSolidBorder(n,a,i)]:[3,2];case 1:return l.sent(),[2];case 2:return A=mC(i,a),this.path(A),this.ctx.fillStyle=jn(n),this.ctx.fill(),o=pC(i,a),this.path(o),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(n){return ir(this,void 0,void 0,function(){var r,a,i,A,o,l,c,d,h=this;return $n(this,function(p){switch(p.label){case 0:return this.applyEffects(n.getEffects(2)),r=n.container.styles,a=!Ta(r.backgroundColor)||r.backgroundImage.length,i=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],A=FC(cA(r.backgroundClip,0),n.curves),a||r.boxShadow.length?(this.ctx.save(),this.path(A),this.ctx.clip(),Ta(r.backgroundColor)||(this.ctx.fillStyle=jn(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(n.container)]):[3,2];case 1:p.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(m){h.ctx.save();var B=Ec(n.curves),y=m.inset?0:NC,b=hC(B,-y+(m.inset?1:-1)*m.spread.number,(m.inset?1:-1)*m.spread.number,m.spread.number*(m.inset?-2:2),m.spread.number*(m.inset?-2:2));m.inset?(h.path(B),h.ctx.clip(),h.mask(b)):(h.mask(B),h.ctx.clip(),h.path(b)),h.ctx.shadowOffsetX=m.offsetX.number+y,h.ctx.shadowOffsetY=m.offsetY.number,h.ctx.shadowColor=jn(m.color),h.ctx.shadowBlur=m.blur.number,h.ctx.fillStyle=m.inset?jn(m.color):"rgba(0,0,0,1)",h.ctx.fill(),h.ctx.restore()}),p.label=2;case 2:o=0,l=0,c=i,p.label=3;case 3:return l<c.length?(d=c[l],d.style!==0&&!Ta(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,o,n.curves,2)]:[3,11]):[3,13];case 4:return p.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,o,n.curves,3)];case 6:return p.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,o,n.curves)];case 8:return p.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,o,n.curves)];case 10:p.sent(),p.label=11;case 11:o++,p.label=12;case 12:return l++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(n,r,a,i,A){return ir(this,void 0,void 0,function(){var o,l,c,d,h,p,m,B,y,b,C,N,k,E,_,M,_,M;return $n(this,function(D){return this.ctx.save(),o=xC(i,a),l=Gg(i,a),A===2&&(this.path(l),this.ctx.clip()),Wr(l[0])?(c=l[0].start.x,d=l[0].start.y):(c=l[0].x,d=l[0].y),Wr(l[1])?(h=l[1].end.x,p=l[1].end.y):(h=l[1].x,p=l[1].y),a===0||a===2?m=Math.abs(c-h):m=Math.abs(d-p),this.ctx.beginPath(),A===3?this.formatPath(o):this.formatPath(l.slice(0,2)),B=r<3?r*3:r*2,y=r<3?r*2:r,A===3&&(B=r,y=r),b=!0,m<=B*2?b=!1:m<=B*2+y?(C=m/(2*B+y),B*=C,y*=C):(N=Math.floor((m+y)/(B+y)),k=(m-N*B)/(N-1),E=(m-(N+1)*B)/N,y=E<=0||Math.abs(y-k)<Math.abs(y-E)?k:E),b&&(A===3?this.ctx.setLineDash([0,B+y]):this.ctx.setLineDash([B,y])),A===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=jn(n),this.ctx.stroke(),this.ctx.setLineDash([]),A===2&&(Wr(l[0])&&(_=l[3],M=l[0],this.ctx.beginPath(),this.formatPath([new ze(_.end.x,_.end.y),new ze(M.start.x,M.start.y)]),this.ctx.stroke()),Wr(l[1])&&(_=l[1],M=l[2],this.ctx.beginPath(),this.formatPath([new ze(_.end.x,_.end.y),new ze(M.start.x,M.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(n){return ir(this,void 0,void 0,function(){var r;return $n(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=jn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=gC(n),[4,this.renderStack(r)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(bx),IC=function(t){return t instanceof sx||t instanceof rx?!0:t instanceof Ff&&t.type!==Sc&&t.type!==Nc},FC=function(t,e){switch(t){case 0:return Ec(e);case 2:return lC(e);case 1:default:return kc(e)}},EC=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},kC=["-apple-system","system-ui"],UC=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return kC.indexOf(e)===-1}):t},jC=function(t){hs(e,t);function e(n,r){var a=t.call(this,n,r)||this;return a.canvas=r.canvas?r.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=r,a.canvas.width=Math.floor(r.width*r.scale),a.canvas.height=Math.floor(r.height*r.scale),a.canvas.style.width=r.width+"px",a.canvas.style.height=r.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-r.x,-r.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),a}return e.prototype.render=function(n){return ir(this,void 0,void 0,function(){var r,a;return $n(this,function(i){switch(i.label){case 0:return r=Vu(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,n),[4,TC(r)];case 1:return a=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=jn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(bx),TC=function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},QC=function(){function t(e){var n=e.id,r=e.enabled;this.id=n,this.enabled=r,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Ql([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Ql([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Ql([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Ql([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),LC=function(){function t(e,n){var r;this.windowBounds=n,this.instanceName="#"+t.instanceCount++,this.logger=new QC({id:this.instanceName,enabled:e.logging}),this.cache=(r=e.cache)!==null&&r!==void 0?r:new tC(this,e)}return t.instanceCount=1,t}(),id=function(t,e){return e===void 0&&(e={}),_C(t,e)};typeof window<"u"&&gx.setContext(window);var _C=function(t,e){return ir(void 0,void 0,void 0,function(){var n,r,a,i,A,o,l,c,d,h,p,m,B,y,b,C,N,k,E,_,D,M,D,U,j,O,F,I,P,V,ee,X,le,ae,de,ue,Ce,Q,z,W;return $n(this,function(Z){switch(Z.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(n=t.ownerDocument,!n)throw new Error("Element is not attached to a Document");if(r=n.defaultView,!r)throw new Error("Document is not attached to a Window");return a={allowTaint:(U=e.allowTaint)!==null&&U!==void 0?U:!1,imageTimeout:(j=e.imageTimeout)!==null&&j!==void 0?j:15e3,proxy:e.proxy,useCORS:(O=e.useCORS)!==null&&O!==void 0?O:!1},i=Eu({logging:(F=e.logging)!==null&&F!==void 0?F:!0,cache:e.cache},a),A={windowWidth:(I=e.windowWidth)!==null&&I!==void 0?I:r.innerWidth,windowHeight:(P=e.windowHeight)!==null&&P!==void 0?P:r.innerHeight,scrollX:(V=e.scrollX)!==null&&V!==void 0?V:r.pageXOffset,scrollY:(ee=e.scrollY)!==null&&ee!==void 0?ee:r.pageYOffset},o=new Ys(A.scrollX,A.scrollY,A.windowWidth,A.windowHeight),l=new LC(i,o),c=(X=e.foreignObjectRendering)!==null&&X!==void 0?X:!1,d={allowTaint:(le=e.allowTaint)!==null&&le!==void 0?le:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:c,copyStyles:c},l.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),h=new Rg(l,t,d),p=h.clonedReferenceElement,p?[4,h.toIFrame(n,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return m=Z.sent(),B=Ef(p)||DB(p)?h2(p.ownerDocument):Yc(l,p),y=B.width,b=B.height,C=B.left,N=B.top,k=MC(l,p,e.backgroundColor),E={canvas:e.canvas,backgroundColor:k,scale:(de=(ae=e.scale)!==null&&ae!==void 0?ae:r.devicePixelRatio)!==null&&de!==void 0?de:1,x:((ue=e.x)!==null&&ue!==void 0?ue:0)+C,y:((Ce=e.y)!==null&&Ce!==void 0?Ce:0)+N,width:(Q=e.width)!==null&&Q!==void 0?Q:Math.ceil(y),height:(z=e.height)!==null&&z!==void 0?z:Math.ceil(b)},c?(l.logger.debug("Document cloned, using foreign object rendering"),D=new jC(l,E),[4,D.render(p)]):[3,3];case 2:return _=Z.sent(),[3,5];case 3:return l.logger.debug("Document cloned, element located at "+C+","+N+" with size "+y+"x"+b+" using computed rendering"),l.logger.debug("Starting DOM parsing"),M=Ax(l,p),k===M.styles.backgroundColor&&(M.styles.backgroundColor=Ws.TRANSPARENT),l.logger.debug("Starting renderer for element at "+E.x+","+E.y+" with size "+E.width+"x"+E.height),D=new SC(l,E),[4,D.render(M)];case 4:_=Z.sent(),Z.label=5;case 5:return(!((W=e.removeContainer)!==null&&W!==void 0)||W)&&(Rg.destroy(m)||l.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),l.logger.debug("Finished rendering"),[2,_]}})})},MC=function(t,e,n){var r=e.ownerDocument,a=r.documentElement?_o(t,getComputedStyle(r.documentElement).backgroundColor):Ws.TRANSPARENT,i=r.body?_o(t,getComputedStyle(r.body).backgroundColor):Ws.TRANSPARENT,A=typeof n=="string"?_o(t,n):n===null?Ws.TRANSPARENT:4294967295;return e===r.documentElement?Ta(a)?Ta(i)?A:i:a:A};const DC=Object.freeze(Object.defineProperty({__proto__:null,default:id},Symbol.toStringTag,{value:"Module"})),Kg=t=>{if(!t)return"-";const[e,n,r]=t.split("-");return!e||!n||!r?t:`${r}/${n}/${e}`},Pn=({label:t,value:e})=>s.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2 border-b border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 font-medium col-span-1",children:t}),s.jsx("p",{className:"text-sm text-gray-800 col-span-2",children:e||"-"})]});function PC({onBack:t,student:e,transportRoutes:n,academy:r}){const[a,i]=be.useState(!1),[A,o]=q.useState(!1),l=async()=>{i(!1);const d=document.getElementById("registration-form");if(d){o(!0);try{const p=(await id(d,{scale:2,useCORS:!0,backgroundColor:"#ffffff",width:d.scrollWidth,height:d.scrollHeight,windowWidth:d.scrollWidth,windowHeight:d.scrollHeight})).toDataURL("image/png"),m=new it({orientation:"portrait",unit:"pt",format:"a4"}),B=m.getImageProperties(p),y=m.internal.pageSize.getWidth(),b=B.height*y/B.width;if(m.addImage(p,"PNG",0,0,y,b),CA.isNativePlatform()){const C=m.output("datauristring").split(",")[1],N=`registration-form-${e.name}.pdf`,k=await my.writeFile({path:N,data:C,directory:mu.Cache});await gy.share({title:`Registration Form - ${e.name}`,text:`Here is the registration form for ${e.name}.`,files:[k.uri],dialogTitle:"Share Registration Form"})}else m.save(`registration-form-${e.name}.pdf`)}catch(h){console.error("Error exporting PDF:",h),alert("Could not export the PDF. Please try again.")}finally{o(!1)}}},c=n.find(d=>d.id===e.transportRouteId);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-200 min-h-screen",children:[s.jsxs("header",{className:"no-print bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md sticky top-0 z-10",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Registration Form"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(d=>!d),className:"p-1 rounded-full hover:bg-indigo-800",children:s.jsx(Wm,{className:"w-6 h-6"})}),a&&s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20",children:s.jsx("button",{onClick:l,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Export as PDF"})})]})]}),s.jsx("main",{className:"p-2 sm:p-4 md:p-8",children:s.jsxs("div",{className:"printable-form bg-white max-w-4xl mx-auto p-8 shadow-2xl font-sans",id:"registration-form",children:[s.jsxs("div",{className:"flex justify-between items-start pb-4 border-b-2 border-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[r.logoUrl?s.jsx("img",{src:r.logoUrl,alt:"Academy Logo",className:"w-16 h-16 object-contain"}):s.jsx(hi,{className:"w-16 h-16 text-indigo-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-extrabold text-gray-800 tracking-wider",children:r.name.toUpperCase()}),s.jsx("p",{className:"text-xs text-gray-500",children:"Institute Management System"})]})]}),s.jsxs("div",{className:"text-right text-xs text-gray-600",children:[r.contactEmail&&s.jsx("p",{children:r.contactEmail}),r.contactPhone&&s.jsx("p",{children:r.contactPhone}),r.address&&s.jsx("p",{children:r.address})]})]}),s.jsx("h2",{className:"text-center text-xl font-bold text-gray-700 my-6 underline underline-offset-4",children:"STUDENT REGISTRATION FORM"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-8 mb-8",children:[s.jsxs("div",{className:"flex-grow space-y-2",children:[s.jsx(Pn,{label:"Student Name",value:e.name}),s.jsx(Pn,{label:"Father's Name",value:e.fatherName}),s.jsx(Pn,{label:"Mother's Name",value:e.motherName}),s.jsx(Pn,{label:"Roll Number",value:e.rollNumber})]}),s.jsx("div",{className:"w-32 h-40 border-2 border-gray-300 flex items-center justify-center text-gray-400 text-sm bg-gray-50 flex-shrink-0",children:e.photo?s.jsx("img",{src:e.photo,alt:"Student",className:"w-full h-full object-cover"}):"Affix Photo"})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-indigo-700 mb-2 border-b pb-1",children:"Personal & Contact Details"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[s.jsx(Pn,{label:"Date of Birth",value:Kg(e.dob)}),s.jsx(Pn,{label:"Gender",value:e.gender}),s.jsx(Pn,{label:"Mobile Number 1",value:e.mobile1}),s.jsx(Pn,{label:"Mobile Number 2",value:e.mobile2}),s.jsx(Pn,{label:"Address",value:e.address}),s.jsx(Pn,{label:"ID Number",value:e.idNumber})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-indigo-700 mb-2 border-b pb-1",children:"Academic Details"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[s.jsx(Pn,{label:"Admission Date",value:Kg(e.admissionDate)}),s.jsx(Pn,{label:"School/College",value:e.schoolOrCollege}),s.jsx(Pn,{label:"Enrolled Batches",value:e.batches.join(", ")}),s.jsx(Pn,{label:"Fee Type",value:e.feeType}),s.jsx(Pn,{label:"Fee Amount",value:`â‚¹${e.feeAmount}`}),s.jsx(Pn,{label:"Transport",value:e.transport==="USE_TRANSPORT"?"Opted In":"Not Opted"}),s.jsx(Pn,{label:"Transport Route",value:c==null?void 0:c.routeName})]})]}),s.jsx("div",{className:"pt-16 mt-8 text-sm",children:s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-24 h-24 border-2 border-dashed border-gray-400 flex items-center justify-center",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Academy Seal"})}),s.jsx("p",{className:"mt-2 pt-2 border-t-2 border-gray-800 font-semibold",children:"Authorised Signatory"})]}),s.jsxs("div",{className:"space-y-10",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-48 h-10 border-b-2 border-gray-800"}),s.jsx("p",{className:"mt-1 font-semibold",children:"Parent/Guardian Signature"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-48 h-10 border-b-2 border-gray-800"}),s.jsx("p",{className:"mt-1 font-semibold",children:"Student Signature"})]})]})]})})]})})]}),A&&s.jsx("div",{className:"no-print fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white p-6 rounded-lg shadow-xl",children:s.jsx(Ar,{message:"Generating PDF..."})})})]})}const RC=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("path",{d:"M19 5H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zM8.5 10H7V8h1.5v2zm3-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm4 1h-1.5V8H15v2z"}),s.jsx("path",{d:"M21 14H3c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h3v-2h2v2h2v-2h2v2h2v-2h2v2h3c1.1 0 2-.9 2-2v-2c0-1.1-.9-2-2-2z"})]}),vx=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"}),s.jsx("path",{d:"M17 9H7v6h10V9zm-5 4.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"})]}),Bx=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"}),s.jsxs("g",{fill:"#fff",fillOpacity:"0.7",children:[s.jsx("path",{d:"M8 16h4v-1.5H8V16zm0-2.5h4V12H8v1.5z"}),s.jsx("path",{d:"M16 12.75v-1.5h-1.5v1.5h-1.5v1.5h1.5v1.5h1.5v-1.5h1.5v-1.5H16z"})]})]}),HC=[{name:"Pay Fees",Icon:RC,key:"select-batch-for-fees"},{name:"Fees Dues List",Icon:vx,key:"fee-dues-list"},{name:"Fee Collection Report",Icon:Bx,key:"fee-collection-report"}];function OC({onBack:t,onNavigate:e}){return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Fees Options"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:HC.map(({name:n,Icon:r,key:a})=>s.jsxs("button",{onClick:()=>e(a),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 flex items-center space-x-4 text-left",children:[s.jsx("div",{className:"w-10 h-10 text-indigo-500",children:s.jsx(r,{})}),s.jsx("span",{className:"text-lg font-medium text-indigo-800",children:n})]},a))})})]})}const GC=t=>{if(!t)return"N/A";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`};function VC({onBack:t,batches:e,onSelectBatch:n,staffPermissions:r}){const[a,i]=be.useState(""),A=e.filter(o=>{var l;return!o.isActive||r&&!((l=r[o.id])!=null&&l.fees)?!1:o.name.toLowerCase().includes(a.toLowerCase())});return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsx("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md flex-shrink-0 sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to fee options",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Select Batch for Fees"})]})}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx("input",{type:"text",placeholder:"Search batch...",value:a,onChange:o=>i(o.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),A.length>0?s.jsx("div",{className:"space-y-3",children:A.map(o=>s.jsxs("button",{onClick:()=>n(o.id),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 text-left",children:[s.jsx("h3",{className:"font-bold text-indigo-800",children:o.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[o.teacher," Â· ",GC(o.time)]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[o.currentStudents," / ",o.maxSlots," Students"]})]},o.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No batches assigned for fee collection."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Admin needs to grant you fee collection permission for one or more batches."})]})]})]})}function KC({onBack:t,batch:e,students:n,onSelectStudent:r}){const[a,i]=be.useState(""),o=q.useMemo(()=>n.filter(l=>l.isActive&&Array.isArray(l.batches)&&l.batches.includes(e.name)),[n,e.name]).filter(l=>l.name.toLowerCase().includes(a.toLowerCase())||l.rollNumber&&l.rollNumber.toLowerCase().includes(a.toLowerCase()));return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-10",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to batch selection",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Select Student"})]}),s.jsx("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-900/50 border-b dark:border-gray-700",children:s.jsx("h2",{className:"font-semibold text-indigo-800 dark:text-indigo-200",children:e.name})})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx("input",{type:"text",placeholder:"Search by name or roll no...",value:a,onChange:l=>i(l.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),o.length>0?s.jsx("div",{className:"space-y-3",children:o.map(l=>s.jsxs("button",{onClick:()=>r(l.id),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 text-left flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-lg",children:l.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:l.name}),s.jsx("p",{className:"text-sm text-gray-500",children:l.rollNumber})]})]},l.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No students found in this batch."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Try searching for a different student or check the active students list."})]})]})]})}const qC=(t,e)=>{if(!t.admissionDate||!t.feeType)return[];const n=[],r=new Date(t.admissionDate),a=new Date;if(t.feeType==="Monthly"){let i=new Date(r.getFullYear(),r.getMonth(),1);for(;i<=a;){const A=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;e.has(A)||n.push(A),i.setMonth(i.getMonth()+1)}}else{let i=new Date(r.getFullYear(),r.getMonth(),1);for(;i<=a;){const A=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;e.has(A)||n.push(A),i.setFullYear(i.getFullYear()+1)}}return n},zC=({month:t,student:e,onSave:n,onClose:r})=>{const[a,i]=be.useState(new Date().toISOString().split("T")[0]),[A,o]=be.useState("Cash"),[l,c]=be.useState("0"),[d,h]=be.useState(!1),[p,m]=be.useState(null),B=(e.feeAmount||0)+(e.transportFee||0),y=parseFloat(l)||0,b=Math.max(0,B-y);let C;if(e.feeType==="Yearly"){const k=new Date(t+"-02"),E=new Date(k);E.setFullYear(E.getFullYear()+1),E.setDate(E.getDate()-1),C=`${k.toLocaleString("default",{month:"long",year:"numeric"})} - ${E.toLocaleString("default",{month:"long",year:"numeric"})}`}else C=new Date(t+"-02").toLocaleString("default",{month:"long",year:"numeric"});const N=async k=>{k.preventDefault(),h(!0),m(null);try{await n({studentId:e.id,studentName:e.name,studentRollNumber:e.rollNumber,batchNames:e.batches,paymentDate:a,feeForMonth:t,totalAmount:B,discount:y,amountPaid:b,paymentMode:A,createdAt:new Date})}catch(E){E.code==="demo-mode"?m(E.message):m("Save failed. Check connection and try again."),console.error(E),h(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("form",{onSubmit:N,className:"bg-white rounded-lg shadow-xl m-4 w-full max-w-sm flex flex-col",children:[s.jsxs("h3",{className:"text-lg font-bold p-4 border-b text-center bg-gray-50 rounded-t-lg",children:["Collect Fee for ",C]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paymentDate",className:"block text-sm font-medium text-gray-700",children:"Payment Date"}),s.jsxs("div",{className:"relative mt-1",children:[s.jsx("input",{id:"paymentDate",type:"date",value:a,onChange:k=>i(k.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0}),s.jsx("label",{htmlFor:"paymentDate",className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer",children:s.jsx(Us,{className:"w-5 h-5 text-gray-400"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Mode"}),s.jsxs("select",{value:A,onChange:k=>o(k.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{children:"Cash"}),s.jsx("option",{children:"UPI"}),s.jsx("option",{children:"Card"}),s.jsx("option",{children:"Other"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Discount (â‚¹)"}),s.jsx("input",{type:"number",value:l,onChange:k=>c(k.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0"})]}),s.jsxs("div",{className:"border-t pt-3 mt-3 space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Tuition Fee:"})," ",s.jsxs("span",{className:"font-semibold",children:["â‚¹",(e.feeAmount||0).toFixed(2)]})]}),e.transportFee&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Transport Fee:"})," ",s.jsxs("span",{className:"font-semibold",children:["â‚¹",e.transportFee.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Total Amount:"})," ",s.jsxs("span",{className:"font-semibold",children:["â‚¹",B.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-red-600",children:[s.jsx("span",{className:"text-gray-600",children:"Discount:"})," ",s.jsxs("span",{className:"font-semibold",children:["- â‚¹",y.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold text-indigo-700",children:[s.jsx("span",{className:"text-gray-800",children:"Final Amount:"})," ",s.jsxs("span",{children:["â‚¹",b.toFixed(2)]})]})]}),p&&s.jsx("div",{className:"bg-red-50 text-red-700 text-sm text-center p-3 rounded-lg border border-red-200",children:p})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-b-lg grid grid-cols-2 gap-3",children:[s.jsx("button",{type:"button",onClick:r,disabled:d,className:"w-full bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d,className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300",children:d?"Saving...":"Collect Fee"})]})]})})};function Cx({onBack:t,student:e,feeCollections:n,onSavePayment:r,isEmbedded:a}){const[i,A]=be.useState(null),[o,l]=be.useState(!1),c=new Set(n.map(p=>p.feeForMonth)),d=qC(e,c),h=async p=>{try{await r(p),A(null),l(!0),setTimeout(()=>l(!1),2e3)}catch(m){throw m}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[!a&&s.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-10",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to student selection",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Student Fee Details"})]}),s.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:e.name}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.rollNumber}),s.jsxs("div",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-semibold mt-1",children:[s.jsxs("p",{children:["Tuition Fee: â‚¹",e.feeAmount||0]}),e.transportFee&&s.jsxs("p",{children:["Transport Fee: â‚¹",e.transportFee]}),s.jsxs("p",{className:"font-bold text-base text-gray-800 dark:text-gray-100",children:["Total Monthly: â‚¹",(e.feeAmount||0)+(e.transportFee||0)]})]})]})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsx("h3",{className:"font-bold text-gray-700 mb-3",children:"Pending Fees"}),d.length>0?s.jsx("div",{className:"space-y-3",children:d.map(p=>{const m=new Date(p+"-02");let B;if(e.feeType==="Yearly"){const b=new Date(m);b.setFullYear(b.getFullYear()+1),b.setDate(b.getDate()-1),B=`Year: ${m.getFullYear()} - ${b.getFullYear()}`}else B=`${m.toLocaleString("default",{month:"long"})}, ${m.getFullYear()}`;const y=(e.feeAmount||0)+(e.transportFee||0);return s.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-800",children:B}),s.jsxs("p",{className:"text-sm text-red-600",children:["Amount Due: â‚¹",y]})]}),s.jsx("button",{onClick:()=>A(p),className:"bg-green-600 text-white font-bold py-1.5 px-4 rounded-lg hover:bg-green-700 transition-colors text-sm",children:"Pay Now"})]},p)})}):s.jsxs("div",{className:"text-center py-20 px-4 bg-green-50 rounded-lg",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto"}),s.jsx("p",{className:"text-lg text-green-800 mt-4 font-semibold",children:"All fees paid!"}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"There are no pending fees for this student."})]})]})]}),i&&s.jsx(zC,{month:i,student:e,onSave:h,onClose:()=>A(null)}),o&&s.jsx("div",{className:"fixed top-5 right-5 bg-green-600 text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in z-50",children:"Payment Saved Successfully!"})]})}const Qn=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),JC=({fee:t,onSave:e,onClose:n,isDemoMode:r})=>{const a=C=>{if(!C)return new Date().toISOString().split("T")[0];if(typeof C.toDate=="function")return C.toDate().toISOString().split("T")[0];const N=new Date(C);return isNaN(N.getTime())?new Date().toISOString().split("T")[0]:N.toISOString().split("T")[0]},[i,A]=q.useState({paymentDate:a(t.paymentDate),paymentMode:t.paymentMode,discount:String(t.discount)}),[o,l]=q.useState(!1),[c,d]=q.useState(""),h=t.totalAmount,p=parseFloat(i.discount)||0,m=Math.max(0,h-p),B=new Date(t.feeForMonth+"-02").toLocaleString("default",{month:"long",year:"numeric"}),y=C=>{A(N=>({...N,[C.target.name]:C.target.value}))},b=async C=>{if(C.preventDefault(),r){alert("Demo mode: Cannot update data.");return}l(!0),d("");try{await e(t.id,{...i,discount:parseFloat(i.discount)}),n()}catch(N){d("Failed to update record. Please try again."),console.error(N)}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("form",{onSubmit:b,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl m-4 w-full max-w-sm flex flex-col",children:[s.jsxs("h3",{className:"text-lg font-bold p-4 border-b dark:border-gray-700 text-center bg-gray-50 dark:bg-gray-700/50 rounded-t-lg",children:["Edit Fee for ",B]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paymentDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Payment Date"}),s.jsxs("div",{className:"relative mt-1",children:[s.jsx("input",{id:"paymentDate",name:"paymentDate",type:"date",value:i.paymentDate,onChange:y,className:"block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700",required:!0}),s.jsx("label",{htmlFor:"paymentDate",className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer text-gray-400",children:s.jsx(Us,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Payment Mode"}),s.jsxs("select",{name:"paymentMode",value:i.paymentMode,onChange:y,className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700",children:[s.jsx("option",{children:"Cash"})," ",s.jsx("option",{children:"UPI"})," ",s.jsx("option",{children:"Card"})," ",s.jsx("option",{children:"Other"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Discount (â‚¹)"}),s.jsx("input",{type:"number",name:"discount",value:i.discount,onChange:y,className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700",placeholder:"0"})]}),s.jsxs("div",{className:"border-t dark:border-gray-700 pt-3 mt-3 space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Amount:"})," ",s.jsxs("span",{className:"font-semibold text-gray-800 dark:text-gray-100",children:["â‚¹",h.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-red-600",children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Discount:"})," ",s.jsxs("span",{className:"font-semibold",children:["- â‚¹",p.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold text-indigo-700 dark:text-indigo-400",children:[s.jsx("span",{className:"text-gray-800 dark:text-gray-100",children:"Final Amount:"})," ",s.jsxs("span",{children:["â‚¹",m.toFixed(2)]})]})]}),c&&s.jsx("p",{className:"text-red-500 text-sm text-center",children:c})]}),s.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-b-lg grid grid-cols-2 gap-3",children:[s.jsx("button",{type:"button",onClick:n,disabled:o,className:"w-full bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-100 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:o,className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300",children:o?"Updating...":"Update Fee"})]})]})})},WC=({onConfirm:t,onCancel:e,isDeleting:n})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Qn,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Are you sure?"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"This will permanently delete the fee record and its associated income transaction. This action cannot be undone."}),s.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3",children:[s.jsx("button",{onClick:t,disabled:n,className:"w-full sm:w-auto flex-1 bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors shadow-md disabled:bg-red-300",children:n?"Deleting...":"Delete"}),s.jsx("button",{onClick:e,disabled:n,className:"w-full sm:w-auto flex-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})});function YC({onBack:t,feeCollections:e,onDelete:n,onUpdate:r,isDemoMode:a}){const[i,A]=be.useState(""),[o,l]=be.useState(null),[c,d]=be.useState(null),[h,p]=q.useState(!1),B=[...e].sort((C,N)=>N.paymentDate.toMillis()-C.paymentDate.toMillis()).filter(C=>C.studentName.toLowerCase().includes(i.toLowerCase())||C.studentRollNumber.toLowerCase().includes(i.toLowerCase())),y=C=>{if(a){alert("Demo mode: Cannot delete data.");return}d(C)},b=async()=>{if(c){p(!0);try{await n(c.id),d(null)}catch(C){console.error("Failed to delete fee record:",C),alert("Failed to delete fee record. Please try again.")}finally{p(!1)}}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsx("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md flex-shrink-0 sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to fee options",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Fee Collection Report"})]})}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx("input",{type:"text",placeholder:"Search by name or roll no...",value:i,onChange:C=>A(C.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),B.length>0?s.jsx("div",{className:"space-y-3",children:B.map(C=>{var E;const N=(E=C.paymentDate)!=null&&E.toDate?C.paymentDate.toDate():new Date(C.paymentDate),k=new Date(C.feeForMonth+"-02");return s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-gray-800",children:C.studentName}),s.jsx("p",{className:"text-sm text-gray-500",children:C.studentRollNumber})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-lg text-green-600",children:["â‚¹",C.amountPaid.toFixed(2)]}),s.jsx("p",{className:"text-xs text-gray-500",children:N.toLocaleDateString("en-GB")})]})]}),s.jsxs("div",{className:"text-xs text-gray-600 mt-2 pt-2 border-t",children:[s.jsxs("p",{children:["Fee for: ",s.jsx("span",{className:"font-semibold",children:k.toLocaleString("default",{month:"long",year:"numeric"})})]}),C.discount>0&&s.jsxs("p",{className:"text-red-600",children:["Discount: ",s.jsxs("span",{className:"font-semibold",children:["â‚¹",C.discount.toFixed(2)]})]})]}),s.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:["Mode: ",s.jsx("span",{className:"font-semibold",children:C.paymentMode})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>l(C),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs font-semibold text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>y(C),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 rounded-md hover:bg-red-200 transition-colors",children:[s.jsx(Qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]})]})]})]},C.id)})}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No fee collections recorded yet."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"When you collect a fee, it will appear here."})]})]})]}),o&&s.jsx(JC,{fee:o,onSave:r,onClose:()=>l(null),isDemoMode:a}),c&&s.jsx(WC,{onConfirm:b,onCancel:()=>d(null),isDeleting:h})]})}const kf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),$C=({onClose:t,studentsWithDues:e,academy:n})=>{const[r,a]=q.useState("select_list"),[i,A]=q.useState(null),[o,l]=q.useState(0),c="feeReminder",d=`Gentle Fee Reminder.
Dear Parents, A fee of Rs. [FEES_AMOUNT] of [FEES_MONTHS] month(s) is pending for [STUDENT_NAME]([BATCH_NAME]). Kindly clear outstanding fee immediately to continue classes uninterrupted.

Thanks and Regards
[ACADEMY_NAME] ~`,h=y=>{A(y),l(0),a("sending_in_progress")},p=q.useCallback(()=>{a("select_list"),A(null)},[]),m=q.useCallback(()=>{var D;if(o>=e.length){a("sending_complete");return}const{student:y,pendingMonths:b}=e[o],C=((D=n.smsTemplates)==null?void 0:D[c])||d,N=((y.feeAmount||0)+(y.transportFee||0))*b.length,k=C.replace(/\[STUDENT_NAME\]/g,y.name).replace(/\[BATCH_NAME\]/g,y.batches.join(", ")).replace(/\[FEES_AMOUNT\]/g,String(N)).replace(/\[FEES_MONTHS\]/g,String(b.length)).replace(/\[ACADEMY_NAME\]/g,n.name),E=y.mobile1.replace(/[^0-9]/g,""),_=encodeURIComponent(k);let M="";i==="whatsapp"?M=`https://wa.me/${E.startsWith("91")?E:`91${E}`}?text=${_}`:M=`sms:${E}?body=${_}`,window.open(M,"_blank")},[o,e,n,i]);q.useEffect(()=>{const y=()=>{document.visibilityState==="visible"&&r==="sending_in_progress"&&setTimeout(()=>{l(b=>b+1)},500)};return r==="sending_in_progress"&&(m(),document.addEventListener("visibilitychange",y)),()=>{document.removeEventListener("visibilitychange",y)}},[r,o,m]);const B=()=>{switch(r){case"sending_in_progress":const y=e[o];return s.jsxs("div",{className:"text-center p-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"Preparing Message..."}),s.jsxs("p",{children:["Sending to: ",s.jsx("span",{className:"font-semibold",children:y==null?void 0:y.student.name})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["(",o+1," of ",e.length,")"]}),s.jsxs("p",{className:"text-xs mt-4 text-gray-500",children:["You will be redirected to ",i,". After sending, return to this app to continue."]}),s.jsx("button",{onClick:p,className:"mt-6 bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-lg text-sm",children:"Cancel Sending"})]});case"sending_complete":return s.jsxs("div",{className:"text-center p-8",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"All Done!"}),s.jsx("p",{className:"text-gray-600",children:"All messages have been prepared for sending."}),s.jsx("button",{onClick:t,className:"mt-6 bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg w-full",children:"Finish"})]});case"select_app":return s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:"Choose App"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>h("whatsapp"),className:"w-full flex items-center justify-center gap-3 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors",children:[s.jsx(Kc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via WhatsApp"})]}),s.jsxs("button",{onClick:()=>h("sms"),className:"w-full flex items-center justify-center gap-3 bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600 transition-colors",children:[s.jsx(qc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via SMS"})]})]})]});case"select_list":default:return s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-center text-gray-600 dark:text-gray-300 mb-2",children:"The following students have pending fees:"}),s.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 pr-2",children:e.length>0?e.map(({student:b})=>s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-2 rounded-md flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm flex-shrink-0",children:b.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:b.name}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:b.rollNumber})]})]},b.id)):s.jsx("p",{className:"text-center text-gray-500 pt-10",children:"No students with dues found in this filter."})}),s.jsx("div",{className:"pt-4 mt-auto",children:s.jsxs("button",{onClick:()=>a("select_app"),disabled:e.length===0,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300",children:["Send Reminder (",e.length,")"]})})]})}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg w-full max-w-sm flex flex-col max-h-[90vh] relative",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Send Fee Reminders"}),s.jsx("button",{onClick:r==="sending_in_progress"?p:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-500"})})]}),s.jsx("div",{className:"flex flex-col flex-grow overflow-hidden p-4",children:B()})]})})},XC=({academy:t,dues:e,batchFilterName:n})=>{const r=e.reduce((a,{student:i,pendingMonths:A})=>{const o=((i.feeAmount||0)+(i.transportFee||0))*A.length;return a+o},0);return s.jsx("div",{className:"printable-form bg-white text-black font-sans",children:s.jsxs("div",{className:"p-8",children:[s.jsxs("div",{className:"flex justify-between items-center pb-4 border-b-2 border-gray-300",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[t.logoUrl?s.jsx("img",{src:t.logoUrl,alt:"Logo",className:"w-16 h-16 object-contain"}):s.jsx(hi,{className:"w-16 h-16 text-indigo-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:t.name}),s.jsx("p",{className:"text-sm",children:"Fee Dues List"})]})]}),s.jsxs("div",{className:"text-right text-sm",children:[s.jsxs("p",{children:["Date: ",new Date().toLocaleDateString("en-GB")]}),s.jsxs("p",{children:["Batch: ",n]})]})]}),s.jsxs("table",{className:"w-full text-left mt-8 border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"p-2 border border-gray-300",children:"S.No."}),s.jsx("th",{className:"p-2 border border-gray-300",children:"Student Name"}),s.jsx("th",{className:"p-2 border border-gray-300",children:"Phone Number"}),s.jsx("th",{className:"p-2 border border-gray-300 text-right",children:"Amount Due (â‚¹)"})]})}),s.jsx("tbody",{children:e.map(({student:a,pendingMonths:i},A)=>{const o=((a.feeAmount||0)+(a.transportFee||0))*i.length;return s.jsxs("tr",{children:[s.jsx("td",{className:"p-2 border border-gray-300",children:A+1}),s.jsx("td",{className:"p-2 border border-gray-300",children:a.name}),s.jsx("td",{className:"p-2 border border-gray-300",children:a.mobile1}),s.jsx("td",{className:"p-2 border border-gray-300 text-right",children:o.toFixed(2)})]},a.id)})}),s.jsx("tfoot",{children:s.jsxs("tr",{className:"font-bold bg-gray-100",children:[s.jsx("td",{className:"p-2 border border-gray-300",colSpan:3,children:"Total Due Amount"}),s.jsx("td",{className:"p-2 border border-gray-300 text-right",children:r.toFixed(2)})]})})]}),s.jsx("div",{className:"pt-24 text-sm",children:s.jsx("div",{className:"flex justify-end",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-48 border-b-2 border-gray-400"}),s.jsx("p",{className:"mt-2 font-semibold",children:"Authorised Signature"})]})})})]})})},ZC=(t,e)=>{const n=[];return t.forEach(r=>{if(!r.isActive||!r.admissionDate||!r.feeType)return;const a=new Set(e.filter(l=>l.studentId===r.id).map(l=>l.feeForMonth)),i=[],A=new Date(r.admissionDate),o=new Date;if(r.feeType==="Monthly"){let l=new Date(A.getFullYear(),A.getMonth(),1);for(;l<=o;){const c=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;a.has(c)||i.push(c),l.setMonth(l.getMonth()+1)}}else{let l=new Date(A.getFullYear(),A.getMonth(),1);for(;l<=o;){const c=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;a.has(c)||i.push(c),l.setFullYear(l.getFullYear()+1)}}i.length>0&&n.push({student:r,pendingMonths:i})}),n};function eN({onBack:t,students:e,batches:n,feeCollections:r,academy:a}){var y;const[i,A]=be.useState("all"),[o,l]=q.useState(!1),[c,d]=q.useState(!1),p=ZC(e,r).filter(({student:b})=>i==="all"||b.batches.includes(i)),m=i==="all"?"All Batches":((y=n.find(b=>b.name===i))==null?void 0:y.name)||"All Batches",B=async()=>{d(!0),setTimeout(async()=>{const b=document.getElementById("pdf-report-container");if(!b){console.error("Report element not found"),d(!1);return}try{const N=(await id(b,{scale:2,useCORS:!0})).toDataURL("image/png"),k=new it({orientation:"portrait",unit:"px",format:"a4"}),E=k.internal.pageSize.getWidth(),_=k.internal.pageSize.getHeight(),M=k.getImageProperties(N),D=M.height/M.width;let U=E-20,j=U*D;j>_-20&&(j=_-20,U=j/D);const O=(E-U)/2;k.addImage(N,"PNG",O,10,U,j);const I=k.output("blob"),P=`Fee-Dues-${m.replace(/ /g,"_")}-${new Date().toLocaleDateString("en-CA")}.pdf`,V=new File([I],P,{type:"application/pdf"});if(navigator.share&&navigator.canShare&&navigator.canShare({files:[V]}))await navigator.share({title:"Fee Dues Report",text:`Fee Dues for ${m}`,files:[V]});else{const ee=document.createElement("a");ee.href=URL.createObjectURL(V),ee.download=P,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(ee.href)}}catch(C){console.error("Error generating PDF:",C),alert("Sorry, there was an error generating the PDF.")}finally{d(!1)}},100)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{position:"fixed",left:"-9999px",top:0,zIndex:-1},children:c&&s.jsx("div",{id:"pdf-report-container",style:{width:"210mm"},children:s.jsx(XC,{academy:a,dues:p,batchFilterName:m})})}),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-10 bg-slate-100 dark:bg-gray-900 shadow-md",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Fee Dues List"})]}),s.jsx("div",{className:"p-4",children:s.jsxs("select",{value:i,onChange:b=>A(b.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{value:"all",children:"All Batches"}),n.filter(b=>b.isActive).map(b=>s.jsx("option",{value:b.name,children:b.name},b.id))]})})]}),s.jsx("main",{className:"flex-grow overflow-y-auto px-4",children:p.length>0?s.jsx("div",{className:"space-y-4 pb-4",children:p.map(({student:b,pendingMonths:C})=>{const N=((b.feeAmount||0)+(b.transportFee||0))*C.length;return s.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border-l-4 border-red-500",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-gray-800",children:b.name}),s.jsx("p",{className:"text-sm text-gray-500",children:b.rollNumber})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-lg text-red-600",children:["â‚¹",N.toFixed(2)]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[C.length," ",b.feeType==="Monthly"?"month(s)":"year(s)"," due"]})]})]})},b.id)})}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No fee dues found!"}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"All student fees are up to date for the selected filter."})]})}),s.jsxs("footer",{className:"p-3 bg-white border-t grid grid-cols-2 gap-3 flex-shrink-0",children:[s.jsxs("button",{onClick:()=>l(!0),className:"flex items-center justify-center space-x-2 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:[s.jsx(Rc,{className:"w-5 h-5"}),s.jsx("span",{children:"Send Reminder"})]}),s.jsxs("button",{onClick:B,disabled:c,className:"flex items-center justify-center space-x-2 w-full bg-slate-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-900 transition-colors shadow-md disabled:bg-slate-600",children:[s.jsx(kf,{className:"w-5 h-5"}),s.jsx("span",{children:c?"Generating...":"Export PDF"})]})]}),o&&s.jsx($C,{onClose:()=>l(!1),studentsWithDues:p,academy:a})]})]})}const $u=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418"})}),Bo=({icon:t,label:e,id:n,type:r,...a})=>s.jsxs("div",{className:"relative",children:[s.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400",children:t}),r==="textarea"?s.jsx("textarea",{id:n,className:"w-full pl-10 pr-4 py-2 border bg-white text-gray-900 border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition",rows:3,...a}):s.jsx("input",{id:n,className:"w-full pl-10 pr-4 py-2 border bg-white text-gray-900 border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition",type:r,...a})]})]}),rc=({icon:t,label:e,value:n})=>n?s.jsxs("div",{className:"flex items-start space-x-4 p-3 bg-white rounded-lg border",children:[s.jsx("div",{className:"text-gray-400 mt-1",children:t}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:e}),s.jsx("p",{className:"text-gray-800 break-words",children:n})]})]}):null;function tN({onBack:t,onSave:e,onLogout:n,academy:r}){const[a,i]=be.useState(!1),[A,o]=be.useState({logoUrl:r.logoUrl||"",contactEmail:r.contactEmail||"",contactPhone:r.contactPhone||"",contactPhoneAlt:r.contactPhoneAlt||"",website:r.website||"",address:r.address||""}),[l,c]=be.useState(!1),d=B=>{const{name:y,value:b}=B.target;o(C=>({...C,[y]:b}))},h=B=>{if(B.target.files&&B.target.files[0]){const y=B.target.files[0],b=new FileReader;b.onloadend=()=>{o(C=>({...C,logoUrl:b.result}))},b.readAsDataURL(y)}},p=async B=>{B.preventDefault(),c(!0);try{await e(A),i(!1)}catch(y){console.error("Failed to save contact details:",y)}finally{c(!1)}},m=()=>{o({logoUrl:r.logoUrl||"",contactEmail:r.contactEmail||"",contactPhone:r.contactPhone||"",contactPhoneAlt:r.contactPhoneAlt||"",website:r.website||"",address:r.address||""}),i(!1)};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"My Account & Settings"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:a?s.jsxs("form",{id:"account-settings-form",onSubmit:p,className:"space-y-5",children:[s.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[s.jsx("label",{htmlFor:"logo-upload",className:"cursor-pointer",children:s.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-400 hover:border-indigo-500 transition",children:A.logoUrl?s.jsx("img",{src:A.logoUrl,alt:"Logo Preview",className:"w-full h-full object-cover"}):s.jsx(Vc,{className:"w-10 h-10 text-gray-500"})})}),s.jsx("input",{id:"logo-upload",type:"file",accept:"image/*",className:"hidden",onChange:h}),s.jsx("label",{htmlFor:"logo-upload",className:"text-sm font-medium text-indigo-600 cursor-pointer hover:underline",children:"Upload Logo"})]}),s.jsx(Bo,{icon:s.jsx(SA,{className:"w-5 h-5"}),label:"Email Address",id:"contactEmail",name:"contactEmail",type:"email",value:A.contactEmail,onChange:d,placeholder:"e.g., info@myacademy.com"}),s.jsx(Bo,{icon:s.jsx(Ua,{className:"w-5 h-5"}),label:"Phone Number",id:"contactPhone",name:"contactPhone",type:"tel",value:A.contactPhone,onChange:d,placeholder:"e.g., +91 12345 67890"}),s.jsx(Bo,{icon:s.jsx(Ua,{className:"w-5 h-5"}),label:"Alternative Phone (Optional)",id:"contactPhoneAlt",name:"contactPhoneAlt",type:"tel",value:A.contactPhoneAlt,onChange:d,placeholder:"Another contact number"}),s.jsx(Bo,{icon:s.jsx($u,{className:"w-5 h-5"}),label:"Website (Optional)",id:"website",name:"website",type:"url",value:A.website,onChange:d,placeholder:"e.g., https://www.myacademy.com"}),s.jsx(Bo,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Full Address",id:"address",name:"address",type:"textarea",value:A.address,onChange:d,placeholder:"Enter your academy's full address"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center p-4 bg-white rounded-lg border",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden border-2 border-indigo-200",children:r.logoUrl?s.jsx("img",{src:r.logoUrl,alt:"Academy Logo",className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-4xl font-bold text-indigo-600",children:r.name.charAt(0)})}),s.jsx("h2",{className:"mt-4 text-xl font-bold text-gray-800",children:r.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",r.academyId]})]}),s.jsx(rc,{icon:s.jsx(SA,{className:"w-5 h-5"}),label:"Contact Email",value:r.contactEmail}),s.jsx(rc,{icon:s.jsx(Ua,{className:"w-5 h-5"}),label:"Phone Number",value:r.contactPhone}),s.jsx(rc,{icon:s.jsx($u,{className:"w-5 h-5"}),label:"Website",value:r.website}),s.jsx(rc,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Address",value:r.address}),s.jsxs("button",{onClick:n,className:"w-full bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 flex items-center space-x-4 text-left border",children:[s.jsx("div",{className:"w-10 h-10 text-red-500 flex items-center justify-center p-1",children:s.jsx(Wo,{})}),s.jsx("span",{className:"text-lg font-medium text-red-600",children:"Logout"})]})]})}),s.jsx("footer",{className:"p-4 bg-slate-100 flex-shrink-0",children:a?s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("button",{type:"button",onClick:m,className:"w-full bg-gray-200 text-gray-800 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"CANCEL"}),s.jsx("button",{type:"submit",form:"account-settings-form",disabled:l,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-400",children:l?"Saving...":"SAVE DETAILS"})]}):s.jsxs("button",{onClick:()=>i(!0),className:"w-full flex items-center justify-center space-x-2 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:[s.jsx(Gn,{className:"w-5 h-5"}),s.jsx("span",{children:"EDIT DETAILS"})]})})]})}function nN(){return s.jsx("div",{className:"bg-blue-100 border-b-2 border-blue-300 text-blue-900 p-4 shadow-md z-20",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Jm,{className:"w-6 h-6 text-blue-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:"Action Required: Configure Firebase"}),s.jsx("p",{className:"mt-1 text-sm",children:"This application is currently using placeholder credentials and cannot connect to a database. To fix this, you must use your own Firebase project configuration."}),s.jsxs("ol",{className:"list-decimal list-inside mt-3 space-y-1 text-sm",children:[s.jsxs("li",{children:["Go to the ",s.jsx("a",{href:"https://console.firebase.google.com/",target:"_blank",rel:"noopener noreferrer",className:"font-semibold underline hover:text-blue-700",children:"Firebase Console"})," and select your project."]}),s.jsx("li",{children:"In Project Settings (âš™ï¸), find your web app's configuration object."}),s.jsxs("li",{children:["Copy the entire ",s.jsx("code",{className:"bg-blue-200 text-blue-800 px-1 rounded text-xs",children:"firebaseConfig"})," object."]}),s.jsxs("li",{children:["Open the ",s.jsx("code",{className:"bg-blue-200 text-blue-800 px-1 rounded text-xs",children:"firebaseConfig.ts"})," file in this project and replace the placeholder with your copied configuration."]})]}),s.jsx("p",{className:"mt-3 text-xs font-semibold",children:"This banner will disappear automatically after you update the configuration."})]})]})})}function rN({message:t,onClose:e}){const n=()=>{window.location.reload()};return s.jsx("div",{className:"bg-red-100 border-b-2 border-red-300 text-red-800 p-3 shadow-md z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium flex-grow mr-4",children:t}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[s.jsxs("button",{onClick:n,className:"flex items-center space-x-1.5 px-3 py-1 text-xs font-semibold bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors","aria-label":"Refresh page",children:[s.jsx(cf,{className:"w-4 h-4"}),s.jsx("span",{children:"Refresh"})]}),s.jsx("button",{onClick:e,className:"p-1 rounded-full text-red-500 hover:bg-red-200 transition-colors","aria-label":"Close error message",children:s.jsx(In,{className:"w-5 h-5"})})]})]})})}const sN=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-2.43-4.242 4.5 4.5 0 00-8.32 2.842 4.5 4.5 0 00-1.084 6.142A4.5 4.5 0 002.25 15z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 4.5l-15 15"})]});function aN(){return s.jsxs("div",{className:"bg-yellow-100 border-b-2 border-yellow-300 text-yellow-800 p-3 text-center text-sm font-medium z-10 flex flex-col sm:flex-row items-center justify-center space-x-2 animate-fade-in",children:[s.jsx(sN,{className:"w-5 h-5 flex-shrink-0 mb-1 sm:mb-0"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-bold",children:"You are currently offline."}),s.jsx("span",{className:"block sm:inline sm:ml-1",children:"The app will sync when you're back online. If this persists, check your network and Firebase configuration."})]})]})}const iN=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-2.43-4.242 4.5 4.5 0 00-8.32 2.842 4.5 4.5 0 00-1.084 6.142A4.5 4.5 0 002.25 15z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 12.75V15m0 0l-1.5-1.5m1.5 1.5l1.5-1.5M12 9.75V7.5m0 0l-1.5 1.5m1.5-1.5l1.5 1.5"})]});function AN({onAccept:t}){return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-lg max-w-md mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-purple-100 mb-5",children:s.jsx(iN,{className:"h-9 w-9 text-purple-600"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-3",children:"Internet Connection Required"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6",children:"Class Captain requires an internet connection to sync data in real-time. Please be aware that using this application on a mobile network may consume your mobile data and could result in charges from your provider."}),s.jsx("button",{onClick:t,className:"w-full bg-purple-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:"Accept & Continue"})]})})}const jr=({label:t,id:e,children:n,containerClassName:r,...a})=>s.jsxs("div",{className:`relative bg-white p-3 rounded-lg border border-gray-300 ${r}`,children:[s.jsx("label",{htmlFor:e,className:"absolute -top-2.5 left-3 bg-white px-1 text-xs text-gray-500",children:t}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:e,className:"w-full text-gray-800 bg-transparent outline-none",...a}),n&&s.jsx("label",{htmlFor:e,className:"cursor-pointer",children:n})]})]});function oN({onBack:t,onUpdate:e,student:n,batches:r}){const[a,i]=be.useState({...n,schoolOrCollege:n.schoolOrCollege||"",feeAmount:String(n.feeAmount||"")}),[A,o]=be.useState(!1),[l,c]=be.useState(!1),[d,h]=be.useState(null),p=be.useRef(null),m=be.useRef(null),B=be.useMemo(()=>r.filter(E=>E.isActive||a.batches.includes(E.name)),[r,a.batches]),y=E=>{const{name:_,value:M}=E.target;i(D=>({...D,[_]:M}))},b=E=>{const{name:_,value:M}=E.target;_==="gender"?i(D=>({...D,gender:M})):_==="feeType"&&i(D=>({...D,feeType:M}))},C=E=>{if(E.target.files&&E.target.files[0]){const _=E.target.files[0],M=new FileReader;M.onloadend=()=>{h(M.result)},M.readAsDataURL(_)}c(!1),E.target.value=""},N=E=>{i(_=>{const M=new Set(_.batches);return M.has(E)?M.delete(E):M.add(E),{..._,batches:Array.from(M)}})},k=()=>{if(!a.name.trim()||!a.fatherName.trim()||!a.motherName.trim()||!a.dob||!a.mobile1||!a.address||!a.admissionDate||!a.rollNumber){alert("Please fill all required fields, including Roll Number.");return}if(a.batches.length===0){alert("Please select at least one batch.");return}if(!a.feeType||!a.feeAmount.trim()){alert("Please specify fee type and amount.");return}e({...a,feeAmount:parseFloat(a.feeAmount)||0})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Edit Student"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsxs("form",{id:"edit-student-form",onSubmit:E=>{E.preventDefault(),k()},className:"space-y-5",children:[s.jsxs("div",{className:"flex justify-center",children:[s.jsx("button",{type:"button",onClick:()=>c(!0),className:"w-24 h-24 rounded-full border-2 border-indigo-400 bg-white flex items-center justify-center text-indigo-800 hover:bg-gray-100 transition overflow-hidden","aria-label":"Upload student photo",children:a.photo?s.jsx("img",{src:a.photo,alt:"Student Preview",className:"w-full h-full object-cover"}):s.jsx(Vc,{className:"w-12 h-12"})}),s.jsx("input",{type:"file",accept:"image/*",ref:p,onChange:C,className:"hidden"}),s.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:m,onChange:C,className:"hidden"})]}),s.jsx(jr,{label:"Roll Number / Student ID",id:"rollNumber",name:"rollNumber",placeholder:"Unique ID for login",value:a.rollNumber,onChange:y,required:!0,readOnly:!0}),s.jsx(jr,{label:"Student Name",id:"studentName",name:"name",value:a.name,onChange:y,required:!0,containerClassName:"border-indigo-500 border-2"}),s.jsx(jr,{label:"Father Name",id:"fatherName",name:"fatherName",value:a.fatherName,onChange:y,required:!0}),s.jsx(jr,{label:"Mother Name",id:"motherName",name:"motherName",value:a.motherName,onChange:y,required:!0}),s.jsx(jr,{label:"School / College (Optional)",id:"schoolOrCollege",name:"schoolOrCollege",value:a.schoolOrCollege,onChange:y}),s.jsx(jr,{label:"Date of birth",id:"dob",name:"dob",type:"date",value:a.dob,onChange:y,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})}),s.jsxs(jr,{label:"Mobile Number",id:"mobile1",name:"mobile1",type:"tel",value:a.mobile1,onChange:y,required:!0,children:[s.jsx("span",{className:"text-gray-500 mr-2",children:"+91"}),s.jsx(wc,{className:"w-6 h-6 text-indigo-600"})]}),s.jsxs(jr,{label:"Mobile Number",id:"mobile2",name:"mobile2",type:"tel",value:a.mobile2||"",onChange:y,children:[s.jsx("span",{className:"text-gray-500 mr-2",children:"+91"}),s.jsx(wc,{className:"w-6 h-6 text-indigo-600"})]}),s.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-300",children:s.jsx("div",{className:"flex items-center justify-around",children:["Male","Female","Other"].map(E=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"gender",value:E,checked:a.gender===E,onChange:b,className:"form-radio text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{children:E})]},E))})}),s.jsx(jr,{label:"Address",id:"address",name:"address",value:a.address,onChange:y,required:!0}),s.jsx(jr,{label:"Admission Date",id:"admissionDate",name:"admissionDate",type:"date",value:a.admissionDate,onChange:y,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("button",{type:"button",onClick:()=>o(!0),className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:a.batches.length>0?`Selected Batches (${a.batches.length})`:"SELECT BATCHES"}),s.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-300",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Fee Type"}),s.jsx("div",{className:"flex items-center justify-around",children:["Monthly","Yearly"].map(E=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"feeType",value:E,checked:a.feeType===E,onChange:b,className:"form-radio text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{children:E})]},E))})]}),s.jsxs("div",{className:"relative bg-white p-3 rounded-lg border border-indigo-500 border-2",children:[s.jsx("label",{htmlFor:"feeAmount",className:"absolute -top-2.5 left-3 bg-white px-1 text-xs text-gray-500",children:"Fee Amount"}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-gray-500 text-lg mr-2",children:"â‚¹"}),s.jsx("input",{id:"feeAmount",name:"feeAmount",type:"number",inputMode:"numeric",className:"w-full text-gray-800 bg-transparent outline-none",value:a.feeAmount,onChange:E=>i(_=>({..._,feeAmount:E.target.value})),required:!0,placeholder:"500"})]})]}),s.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-300",children:[s.jsxs("select",{id:"transport",name:"transport",value:a.transport,onChange:y,className:"w-full appearance-none bg-white p-3 pr-8 rounded-lg text-gray-800 outline-none border-2 border-indigo-500",children:[s.jsx("option",{value:"NO_TRANSPORT_USE",children:"NO TRANSPORT USE"}),s.jsx("option",{value:"USE_TRANSPORT",children:"USE TRANSPORT"})]}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-indigo-500",children:s.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),s.jsx(jr,{label:"ID Number(Optional)",id:"idNumber",name:"idNumber",value:a.idNumber||"",onChange:y}),s.jsx(jr,{label:"Field 1(Optional)",id:"field1",name:"field1",value:a.field1||"",onChange:y}),s.jsx(jr,{label:"Field 2(Optional)",id:"field2",name:"field2",value:a.field2||"",onChange:y})]})}),s.jsx("footer",{className:"p-4 flex-shrink-0 bg-slate-100",children:s.jsx("button",{type:"submit",form:"edit-student-form",className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"UPDATE"})})]}),A&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl m-4 w-full max-w-md flex flex-col max-h-[90vh]",children:[s.jsx("h3",{className:"text-lg font-bold p-4 border-b",children:"Select Batches"}),s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto",children:B.length>0?B.map(E=>s.jsxs("label",{className:"flex items-center p-3 rounded-lg hover:bg-slate-100 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500",checked:a.batches.includes(E.name),onChange:()=>N(E.name)}),s.jsxs("span",{className:"ml-3 text-gray-700",children:[E.name," ",!E.isActive&&s.jsx("span",{className:"text-xs text-red-500",children:"(Inactive)"})]})]},E.id)):s.jsx("p",{className:"text-gray-500 text-center",children:"No active batches available."})}),s.jsx("div",{className:"p-4 border-t",children:s.jsx("button",{onClick:()=>o(!1),className:"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Done"})})]})}),l&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl m-4 w-full max-w-xs flex flex-col",children:[s.jsx("h3",{className:"text-lg font-semibold p-4 border-b text-center",children:"Select Photo Source"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("button",{onClick:()=>{var E;return(E=p.current)==null?void 0:E.click()},className:"w-full bg-indigo-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Choose from Gallery"}),s.jsx("button",{onClick:()=>{var E;return(E=m.current)==null?void 0:E.click()},className:"w-full bg-sky-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-sky-700 transition-colors",children:"Take Photo"}),s.jsx("button",{onClick:()=>c(!1),className:"w-full bg-gray-200 text-gray-800 font-bold py-2.5 px-4 rounded-lg hover:bg-gray-300 transition-colors mt-2",children:"Cancel"})]})]})}),d&&s.jsx(xf,{src:d,onSave:E=>{i(_=>({..._,photo:E})),h(null)},onCancel:()=>h(null)})]})}const lN=({checked:t,onChange:e})=>s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${t?"bg-indigo-600":"bg-gray-300"}`,onClick:e,"aria-pressed":t,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${t?"translate-x-6":"translate-x-1"}`})}),cN=({student:t,onToggleStatus:e})=>s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md border-l-4 border-gray-400 flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[t.photo?s.jsx("img",{src:t.photo,alt:t.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center font-bold text-xl",children:t.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:t.name}),s.jsx("p",{className:"text-sm text-gray-500",children:t.rollNumber||t.id})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx(lN,{checked:t.isActive,onChange:()=>e(t.id)}),s.jsx("span",{className:"text-xs text-gray-400 mt-1",children:t.isActive?"Active":"Inactive"})]})]}),s.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:["Batches: ",t.batches.join(", ")||"None"]})]});function dN({onBack:t,students:e,batches:n,onToggleStudentStatus:r}){const[a,i]=be.useState("all"),[A,o]=be.useState(""),c=e.filter(d=>!d.isActive).filter(d=>a==="all"||d.batches.includes(a)).filter(d=>d.name.toLowerCase().includes(A.toLowerCase())||d.rollNumber&&d.rollNumber.toLowerCase().includes(A.toLowerCase()));return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Inactive Students"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[s.jsxs("div",{className:"relative flex-grow",children:[s.jsx("input",{type:"text",placeholder:"Search by name or roll no...",value:A,onChange:d=>o(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsxs("select",{value:a,onChange:d=>i(d.target.value),className:"w-full sm:w-auto px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{value:"all",children:"All Batches"}),n.filter(d=>d.isActive).map(d=>s.jsx("option",{value:d.name,children:d.name},d.id))]})]}),s.jsx("div",{className:"space-y-4 pb-4",children:c.length>0?c.map(d=>s.jsx(cN,{student:d,onToggleStatus:r},d.id)):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No inactive students found."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You can make a student inactive from the 'Active Students' list."})]})})]})]})}const Co=({label:t,id:e,icon:n,...r})=>s.jsxs("div",{className:"mb-6 relative",children:[s.jsx("label",{htmlFor:e,className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:t}),s.jsx("input",{id:e,className:"w-full bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-indigo-400 pb-2 text-lg text-gray-800 dark:text-gray-100 outline-none transition-colors",...r}),n&&s.jsx("label",{htmlFor:e,className:"absolute right-0 bottom-2 text-gray-400 cursor-pointer",children:n})]}),uN=({day:t,isSelected:e,onClick:n})=>s.jsx("button",{type:"button",onClick:n,className:`px-4 py-2 rounded-full border text-sm font-medium transition-colors ${e?"bg-indigo-600 border-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:t}),fN=({checked:t,onChange:e})=>s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${t?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"}`,onClick:e,"aria-pressed":t,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${t?"translate-x-6":"translate-x-1"}`})});function hN({onBack:t,onSave:e,batch:n}){const[r,a]=be.useState(n.name),[i,A]=be.useState(n.location),[o,l]=be.useState(n.teacher),[c,d]=be.useState(n.time),[h,p]=be.useState(String(n.maxSlots)),[m,B]=be.useState(new Set(n.days)),[y,b]=be.useState(String(n.batchFeeAmount||"")),[C,N]=be.useState(n.batchFeeType),[k,E]=be.useState(n.isActive),_=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],M=U=>{B(j=>{const O=new Set(j);return O.has(U)?O.delete(U):O.add(U),O})},D=()=>{if(!r.trim()||!h.trim()){alert("Batch Name and Maximum Slots are required.");return}const U=y?parseInt(y,10):void 0,j={name:r.trim(),location:i,teacher:o,time:c,days:Array.from(m),maxSlots:parseInt(h,10)||0,isActive:k};if(U&&U>0&&C)j.batchFeeAmount=U,j.batchFeeType=C;else if(U&&!C){alert("Please select a fee type (Monthly/Yearly) for the batch fee.");return}e(n.id,j)};return s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to batches",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Edit Batch"})]}),s.jsxs("form",{onSubmit:U=>{U.preventDefault(),D()},className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"mb-6 flex justify-between items-center bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-300 dark:border-gray-600",children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium",children:"Batch Status"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:`text-sm font-semibold ${k?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:k?"Active":"Inactive"}),s.jsx(fN,{checked:k,onChange:()=>E(U=>!U)})]})]}),s.jsx(Co,{id:"batchName",label:"Batch Name",value:r,onChange:U=>a(U.target.value),required:!0}),s.jsx(Co,{id:"batchLocation",label:"Batch Location",value:i,onChange:U=>A(U.target.value)}),s.jsx(Co,{id:"batchTeacher",label:"Batch Teacher",value:o,onChange:U=>l(U.target.value)}),s.jsx(Co,{id:"batchTime",label:"Batch Time",type:"time",value:c,onChange:U=>d(U.target.value),icon:s.jsx(Yo,{className:"w-6 h-6"})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-3",children:"Batch Fee (Optional)"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 text-lg",children:"â‚¹"}),s.jsx("input",{className:"w-full bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-indigo-400 pl-8 pr-2 pb-2 text-lg text-gray-800 dark:text-gray-100 outline-none transition-colors",type:"number",inputMode:"numeric",placeholder:"e.g. 500",value:y,onChange:U=>b(U.target.value)})]}),s.jsx("div",{className:"flex items-center justify-end gap-3 self-end mb-1",children:["Monthly","Yearly"].map(U=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"batchFeeType",value:U,checked:C===U,onChange:()=>N(U),className:"form-radio text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600",disabled:!y}),s.jsx("span",{children:U})]},U))})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-3",children:"Batch Days"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(U=>s.jsx(uN,{day:U,isSelected:m.has(U),onClick:()=>M(U)},U))})]}),s.jsx(Co,{id:"maxSlots",label:"Batch Maximum Slots",type:"number",inputMode:"numeric",pattern:"[0-9]*",value:h,onChange:U=>p(U.target.value),required:!0})]}),s.jsx("footer",{className:"p-4 flex-shrink-0 bg-slate-100 dark:bg-gray-900",children:s.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"UPDATE BATCH"})})]})]})}const gN=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})});function On({options:t,selectedValue:e,onSelect:n,placeholder:r="Select...",label:a}){const[i,A]=q.useState(!1),o=q.useRef(null),l=t.find(d=>d.value===e);q.useEffect(()=>{const d=h=>{o.current&&!o.current.contains(h.target)&&A(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]);const c=d=>{n(d),A(!1)};return s.jsxs("div",{className:"relative w-full",ref:o,children:[s.jsx("label",{className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:a}),s.jsxs("button",{type:"button",onClick:()=>A(!i),className:"w-full flex items-center justify-between p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-left focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-haspopup":"listbox","aria-expanded":i,children:[s.jsx("span",{className:`truncate ${e?"text-gray-800 dark:text-gray-100":"text-gray-500 dark:text-gray-400"}`,children:(l==null?void 0:l.label)||r}),s.jsx(gN,{className:`w-5 h-5 text-gray-400 transition-transform ${i?"rotate-180":""}`})]}),i&&s.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white dark:bg-gray-800 shadow-lg rounded-md max-h-60 overflow-auto border border-gray-200 dark:border-gray-700 animate-fade-in-up",children:s.jsx("ul",{role:"listbox",children:t.length>0?t.map(d=>s.jsx("li",{onClick:()=>c(d.value),className:`px-4 py-3 text-sm text-gray-700 dark:text-gray-200 cursor-pointer hover:bg-indigo-50 dark:hover:bg-gray-700 ${e===d.value?"bg-indigo-100 dark:bg-indigo-900/40 font-semibold":""}`,role:"option","aria-selected":e===d.value,children:d.label},d.value)):s.jsx("li",{className:"px-4 py-3 text-gray-500 text-sm",children:"No options available"})})})]})}const qg=t=>{if(!t)return"--:--";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`},mN=({batchName:t,onConfirm:e,onCancel:n,isDeleting:r})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Qn,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Delete Schedule?"}),s.jsxs("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete the schedule for ",s.jsx("span",{className:"font-bold",children:t})," on this day? This action cannot be undone."]}),s.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3",children:[s.jsx("button",{onClick:e,disabled:r,className:"w-full sm:w-auto flex-1 bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors shadow-md disabled:bg-red-300",children:r?"Deleting...":"Yes, Delete"}),s.jsx("button",{onClick:n,disabled:r,className:"w-full sm:w-auto flex-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"No"})]})]})}),pN=({onClose:t})=>(q.useEffect(()=>{const e=setTimeout(t,3e3);return()=>clearTimeout(e)},[t]),s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"animate-pulse",children:s.jsx(cs,{className:"w-20 h-20 text-green-500 mx-auto"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mt-4",children:"Deleted Successfully!"}),s.jsx("button",{onClick:t,className:"mt-6 bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg",children:"OK"})]})})),xN=({onBack:t,batches:e,staff:n,onSave:r,initialDate:a,initialBatchId:i,academyId:A,isDemoMode:o})=>{const[l,c]=q.useState(a),[d,h]=q.useState(i),[p,m]=q.useState([]),[B,y]=q.useState(!1),[b,C]=q.useState(null),N=l.toISOString().split("T")[0],k=e.filter(j=>j.isActive);q.useEffect(()=>{if(!d||o){m([]);return}(async()=>{y(!0),C(null);try{const O=Xe(Te,`academies/${A}/schedules/${l.toISOString().split("T")[0]}`),F=await Sn(O);if(F.exists()){const I=F.data();m(I[d]||[])}else m([])}catch(O){console.error("Error fetching schedule:",O),C("Failed to load schedule. Check your connection.")}finally{y(!1)}})()},[l,d,A,o]);const E=(j,O,F)=>{m(I=>I.map(P=>P.id===j?{...P,[O]:F}:P))},_=(j,O)=>{const F=n.find(I=>I.id===O);F&&m(I=>I.map(P=>P.id===j&&P.type==="class"?{...P,teacherId:F.id,teacherName:F.name}:P))},M=j=>{const O=j==="class"?{id:`${Date.now()}`,type:"class",subject:"",teacherId:"",teacherName:"",startTime:"",endTime:""}:{id:`${Date.now()}`,type:"break",breakType:"Short Break",startTime:"",endTime:""};m(F=>[...F,O])},D=j=>{m(O=>O.filter(F=>F.id!==j))},U=async()=>{try{await r(N,d,p),alert("Schedule saved successfully!"),t()}catch(j){alert(j.message)}};return s.jsxs("div",{className:"animate-fade-in",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"schedule-date",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"Date"}),s.jsx("input",{id:"schedule-date",type:"date",value:N,onChange:j=>c(new Date(j.target.value)),className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx(On,{label:"Batch",options:k.map(j=>({value:j.id,label:j.name})),selectedValue:d,onSelect:h,placeholder:"Select a Batch"})]}),d&&s.jsxs("div",{className:"space-y-4",children:[B&&s.jsx(Ar,{message:"Loading schedule..."}),b&&s.jsx("p",{className:"text-red-500",children:b}),p.map((j,O)=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border-l-4 border-indigo-500",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 border-b dark:border-gray-700 pb-3",children:[s.jsx("span",{className:"font-bold text-lg text-gray-800 dark:text-gray-200",children:j.type==="class"?`Class ${O+1-p.filter((F,I)=>I<O&&F.type==="break").length}`:"Break"}),s.jsx("button",{onClick:()=>D(j.id),className:"p-1.5 text-red-500 hover:text-red-700 rounded-full hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors",children:s.jsx(Qn,{className:"w-5 h-5"})})]}),j.type==="class"?s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"text",placeholder:"Subject",value:j.subject,onChange:F=>E(j.id,"subject",F.target.value),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsx(On,{label:"Teacher",options:n.map(F=>({value:F.id,label:F.name})),selectedValue:j.teacherId,onSelect:F=>_(j.id,F),placeholder:"Select Teacher"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("input",{type:"time","aria-label":"Start time",value:j.startTime,onChange:F=>E(j.id,"startTime",F.target.value),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border"}),s.jsx("input",{type:"time","aria-label":"End time",value:j.endTime,onChange:F=>E(j.id,"endTime",F.target.value),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border"})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx(On,{label:"Break Type",options:[{value:"Short Break",label:"Short Break"},{value:"Lunch Break",label:"Lunch Break"},{value:"Other",label:"Other"}],selectedValue:j.breakType,onSelect:F=>E(j.id,"breakType",F),placeholder:"Select Break Type"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("input",{type:"time","aria-label":"Start time",value:j.startTime,onChange:F=>E(j.id,"startTime",F.target.value),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border"}),s.jsx("input",{type:"time","aria-label":"End time",value:j.endTime,onChange:F=>E(j.id,"endTime",F.target.value),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border"})]})]})]},j.id)),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsxs("button",{onClick:()=>M("class"),className:"w-full bg-blue-500 text-white p-2.5 rounded-lg flex items-center justify-center gap-1.5 font-semibold hover:bg-blue-600",children:[s.jsx(Lr,{className:"w-5 h-5"})," Class"]}),s.jsxs("button",{onClick:()=>M("break"),className:"w-full bg-yellow-500 text-white p-2.5 rounded-lg flex items-center justify-center gap-1.5 font-semibold hover:bg-yellow-600",children:[s.jsx(Yo,{className:"w-5 h-5"})," Break"]})]}),s.jsxs("div",{className:"mt-6 flex gap-3",children:[s.jsx("button",{type:"button",onClick:t,className:"w-full bg-gray-200 text-gray-800 font-bold py-3 px-4 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{type:"button",onClick:U,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700",children:"Save Schedule"})]})]})]})},wN=({batch:t,items:e,onEdit:n,onDelete:r})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-lg text-indigo-700 dark:text-indigo-400 mb-2",children:t.name}),e.length===0?s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No classes scheduled for this batch."}):s.jsx("div",{className:"space-y-2",children:e.map(a=>s.jsxs("div",{className:`p-2 rounded-md flex items-center space-x-3 ${a.type==="class"?"bg-gray-50 dark:bg-gray-700/50":"bg-yellow-50 dark:bg-yellow-900/40"}`,children:[s.jsxs("div",{className:"text-center w-20 flex-shrink-0",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200",children:qg(a.startTime)}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:qg(a.endTime)})]}),a.type==="class"?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:a.subject}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.teacherName})]}):s.jsx("p",{className:"font-semibold text-yellow-800 dark:text-yellow-300",children:a.breakType})]},a.id))}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-end space-x-2",children:[s.jsxs("button",{onClick:()=>r(t.id,t.name),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60 transition-colors","aria-label":`Delete schedule for ${t.name}`,children:[s.jsx(Qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]}),s.jsxs("button",{onClick:()=>n(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors","aria-label":`Edit schedule for ${t.name}`,children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]})]}),yN=({batches:t,date:e,setDate:n,dailySchedule:r,isLoading:a,error:i,onEnterEditMode:A,onDeleteSchedule:o})=>{const l=e.toISOString().split("T")[0],c=new Date,d=e.toDateString()===c.toDateString(),h=q.useMemo(()=>r?t.filter(m=>r[m.id]&&r[m.id].length>0):[],[t,r]),p=q.useCallback(m=>d?m.filter(B=>{if(!B.endTime)return!0;const[y,b]=B.endTime.split(":").map(Number),C=new Date;return C.setHours(y,b,0,0),C>c}).sort((B,y)=>B.startTime.localeCompare(y.startTime)):m,[d,c]);return s.jsxs("div",{children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-4",children:[s.jsx("label",{htmlFor:"view-date",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"Select Date"}),s.jsx("input",{id:"view-date",type:"date",value:l,onChange:m=>n(new Date(m.target.value)),className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("button",{onClick:()=>{var m;return A(((m=t[0])==null?void 0:m.id)||"")},className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md mb-6",children:"Manage Schedule"}),s.jsxs("div",{className:"space-y-4",children:[a&&s.jsx(Ar,{message:"Loading schedule..."}),i&&s.jsx("p",{className:"text-red-500",children:i}),!a&&!i&&(h.length>0?h.map(m=>{const B=(r==null?void 0:r[m.id])||[],y=p(B);return y.length===0?null:s.jsx(wN,{batch:m,items:y,onEdit:A,onDelete:o},m.id)}):s.jsxs("div",{className:"text-center py-10",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No classes scheduled for this day."}),s.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Click 'Manage Schedule' to add classes."})]}))]})]})};function bN({onBack:t,batches:e,staff:n,academyId:r,onSave:a,isDemoMode:i}){const[A,o]=q.useState("view"),[l,c]=q.useState(null),[d,h]=q.useState(new Date),[p,m]=q.useState(null),[B,y]=q.useState(!1),[b,C]=q.useState(null),[N,k]=q.useState(null),[E,_]=q.useState(!1),[M,D]=q.useState(!1);q.useEffect(()=>{if(i)return;const F=d.toISOString().split("T")[0];(async()=>{y(!0),C(null);try{const P=Xe(Te,`academies/${r}/schedules/${F}`),V=await Sn(P);V.exists()?m(V.data()):m(null)}catch(P){console.error("Error fetching daily schedule:",P),C("Failed to load schedule data.")}finally{y(!1)}})()},[d,r,i]);const U=F=>{c(F),o("edit")},j=()=>{c(null),o("view")},O=async()=>{if(!N||i){i&&alert("Demo mode: Cannot delete schedule.");return}_(!0);try{const F=Xe(Te,`academies/${r}/schedules/${d.toISOString().split("T")[0]}`);await qr(F,{[N.batchId]:iA()}),m(I=>{if(!I)return null;const P={...I};return delete P[N.batchId],P}),k(null),D(!0)}catch(F){console.error("Error deleting schedule:",F),alert("Failed to delete schedule. Please try again.")}finally{_(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:A==="edit"?j:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Schedule Classes"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:A==="edit"&&l?s.jsx(xN,{onBack:j,batches:e,staff:n,onSave:a,initialDate:d,initialBatchId:l,academyId:r,isDemoMode:i}):s.jsx(yN,{batches:e,date:d,setDate:h,dailySchedule:p,isLoading:B,error:b,onEnterEditMode:U,onDeleteSchedule:(F,I)=>k({batchId:F,batchName:I})})}),N&&s.jsx(mN,{batchName:N.batchName,onConfirm:O,onCancel:()=>k(null),isDeleting:E}),M&&s.jsx(pN,{onClose:()=>D(!1)})]})}const di=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",children:s.jsx("path",{className:"checkmark-path",strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})}),vN="rzp_test_pnZyMfa3h3mMXR",BN=({title:t,price:e,period:n,features:r,isPopular:a,onSelect:i,isCurrent:A,isLoading:o,disabled:l})=>s.jsxs("div",{className:`relative border-2 rounded-xl p-6 ${a?"border-indigo-600":"border-gray-200 dark:border-gray-700"} bg-white dark:bg-gray-800`,children:[a&&s.jsx("div",{className:"absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 bg-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-full",children:"MOST POPULAR"}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:t}),s.jsxs("p",{className:"mt-4",children:[s.jsx("span",{className:"text-4xl font-extrabold text-gray-900 dark:text-white",children:e}),s.jsxs("span",{className:"text-base font-medium text-gray-500 dark:text-gray-400",children:["/",n]})]}),s.jsx("ul",{className:"mt-6 space-y-4",children:r.map(c=>s.jsxs("li",{className:"flex items-center space-x-3",children:[s.jsx(di,{className:"w-5 h-5 text-green-500"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:c})]},c))}),s.jsx("button",{onClick:i,disabled:A||o||l,className:`mt-8 w-full py-3 px-6 rounded-lg font-bold text-center transition-colors ${A?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 disabled:bg-indigo-300 dark:disabled:bg-indigo-800"}`,children:o?"Processing...":A?"Current Plan":"Choose Plan"})]}),CN=[{id:"monthly",title:"Monthly",price:"â‚¹499",period:"mo",months:1,amount:49900,features:["Up to 100 students","All core features","Email support"]},{id:"quarterly",title:"Quarterly",price:"â‚¹1299",period:"3-mo",months:3,amount:129900,features:["Up to 300 students","All core features","Priority email support"],isPopular:!0},{id:"yearly",title:"Yearly",price:"â‚¹4999",period:"yr",months:12,amount:499900,features:["Unlimited students","All core features","Phone & email support"]}];function Nx({onBack:t,academy:e,onSubscribe:n,isModal:r=!1}){const[a,i]=be.useState(null),A=async c=>{i(c.id);const d={key:vN,amount:c.amount,currency:"INR",name:"Class Captain Subscription",description:`Payment for ${c.title} Plan`,image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCAyOCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTAgMTIgSDE4IFYxNSBIMjIgVjIxIEg2IFYxNSBIMTAgVjEyIFoiIGZpbGw9IiNENUwMDAwIi8+PHBhdGggZD0iTTggNSBIMjAgTDE4IDExIEgxMCBaIiBmaWxsPSIjRDUwMDAwIi8+PC9zdmc+",handler:async h=>{try{await n(c.id,c.months,{paymentId:h.razorpay_payment_id,amount:c.amount})}catch(p){console.error("Firestore update failed after payment:",p),alert("Payment was successful, but we couldn't update your subscription. Please contact support.")}finally{i(null)}},prefill:{name:e.adminName||e.name,email:e.adminEmail,contact:e.contactPhone||""},notes:{academy_id:e.id,academy_name:e.name},theme:{color:"#4f46e5"},modal:{ondismiss:()=>{i(null)}}};try{const h=new window.Razorpay(d);h.on("payment.failed",function(p){alert("Payment failed. Please try again. Error: "+p.error.description),console.error("Payment Failed:",p.error),i(null)}),h.open()}catch(h){console.error("Razorpay Error:",h),alert("Could not initialize payment gateway. Please check your internet connection and try again."),i(null)}},o=()=>{const{subscriptionStatus:c,trialEndsAt:d,subscriptionEndsAt:h}=e;let p="Your subscription is expired.",m="bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300";if(c==="trialing"&&d){const B=Math.ceil((d.toMillis()-Date.now())/864e5);p=B>0?`You are on a trial with ${B} day(s) remaining.`:"Your trial has expired.",m=B>0?"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300":m}else if(c==="active"&&h){const B=h.toDate().toLocaleDateString();p=`Your ${e.plan||""} plan is active until ${B}.`,m="bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"}return s.jsx("div",{className:`p-3 rounded-lg text-sm font-semibold text-center ${m}`,children:p})},l=s.jsxs(s.Fragment,{children:[s.jsx(o,{}),s.jsxs("div",{className:"text-center my-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Choose Your Plan"}),s.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Select the perfect plan for your institute's needs."})]}),s.jsx("div",{className:"space-y-8 lg:space-y-0 lg:grid lg:grid-cols-3 lg:gap-8",children:CN.map(c=>s.jsx(BN,{title:c.title,price:c.price,period:c.period,features:c.features,isPopular:c.isPopular,onSelect:()=>A(c),isCurrent:e.plan===c.id&&e.subscriptionStatus==="active",isLoading:a===c.id,disabled:!!a},c.id))})]});return r?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fade-in",children:s.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 rounded-2xl shadow-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[s.jsxs("header",{className:"flex-shrink-0 p-4 flex justify-between items-center border-b dark:border-gray-700 bg-white dark:bg-gray-800 rounded-t-2xl",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Subscription & Billing"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-600 dark:text-gray-300"})})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:l})]})}):s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Subscription & Billing"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:l})]})}function NN({onNavigate:t,onLogout:e,academy:n,onSubscribe:r}){const[a,i]=q.useState(!1);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-gray-100 dark:bg-gray-900 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-md mx-auto text-center animate-fade-in-up",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Vm,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Subscription Expired"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"Your trial period has ended. Please choose a subscription plan to continue using Class Captain and manage your institute."}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("button",{onClick:()=>i(!0),className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"Choose a Plan"}),s.jsxs("button",{onClick:e,className:"w-full flex items-center justify-center gap-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Wo,{className:"w-5 h-5"}),s.jsx("span",{children:"Logout"})]})]})]})}),a&&s.jsx(Nx,{isModal:!0,onBack:()=>i(!1),academy:n,onSubscribe:r})]})}const SN={Income:["Tuition Fees","Admission Fees","Stationery Sales","Other Income"],Expense:["Salary","Rent","Electricity Bill","Maintenance","Stationery Purchase","Other Expense"]},IN=["Cash","UPI","Bank Transfer","Card","Other"],FN=({onConfirm:t,onCancel:e,isDeleting:n,transaction:r})=>{if(!r)return null;const a=r.feeCollectionId?"This will permanently delete the transaction and its linked fee payment record. This action cannot be undone.":"This will permanently delete the transaction. This action cannot be undone.";return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Qn,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Are you sure?"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:a}),s.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3",children:[s.jsx("button",{onClick:t,disabled:n,className:"w-full sm:w-auto flex-1 bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors shadow-md disabled:bg-red-300",children:n?"Deleting...":"Delete"}),s.jsx("button",{onClick:e,disabled:n,className:"w-full sm:w-auto flex-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})},zg=({onSave:t,onCancel:e,initialData:n,isDemoMode:r})=>{const a=h=>{if(!h)return new Date().toISOString().split("T")[0];if(typeof h.toDate=="function")return h.toDate().toISOString().split("T")[0];const p=new Date(h);return isNaN(p.getTime())?new Date().toISOString().split("T")[0]:p.toISOString().split("T")[0]},[i,A]=q.useState({type:(n==null?void 0:n.type)||"Expense",category:(n==null?void 0:n.category)||"",amount:(n==null?void 0:n.amount)||"",paymentMethod:(n==null?void 0:n.paymentMethod)||"Cash",description:(n==null?void 0:n.description)||"",date:a(n==null?void 0:n.date)}),[o,l]=q.useState(!1),c=h=>{const{name:p,value:m}=h.target;A(p==="type"?B=>({...B,type:m,category:""}):B=>({...B,[p]:m}))},d=async h=>{if(h.preventDefault(),r){alert("This is a demo. Data cannot be saved.");return}l(!0);try{await t({...i,amount:parseFloat(i.amount)})}catch(p){console.error(p),alert("Failed to save transaction.")}finally{l(!1)}};return s.jsxs("form",{onSubmit:d,className:"space-y-4",children:[s.jsx("div",{className:"grid grid-cols-2 gap-4",children:["Expense","Income"].map(h=>s.jsx("button",{type:"button",onClick:()=>c({target:{name:"type",value:h}}),className:`py-3 rounded-lg font-bold text-center transition-colors ${i.type===h?h==="Income"?"bg-green-600 text-white":"bg-red-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:h},h))}),s.jsxs("div",{className:"relative z-50",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Category"}),s.jsxs("select",{name:"category",value:i.category,onChange:c,required:!0,className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600",children:[s.jsx("option",{value:"",children:"Select Category"}),SN[i.type].map(h=>s.jsx("option",{value:h,children:h},h))]})]}),s.jsxs("div",{className:"relative z-40",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Amount"}),s.jsx("input",{type:"number",name:"amount",value:i.amount,onChange:c,required:!0,placeholder:"0.00",className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600"})]}),s.jsxs("div",{className:"relative z-30",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Payment Method"}),s.jsx("select",{name:"paymentMethod",value:i.paymentMethod,onChange:c,required:!0,className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600",children:IN.map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsxs("div",{className:"relative z-20",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),s.jsx("input",{type:"date",name:"date",value:i.date,onChange:c,required:!0,className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600"})]}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),s.jsx("textarea",{name:"description",value:i.description,onChange:c,rows:3,placeholder:"Add a note...",className:"mt-1 w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600"})]}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:e,disabled:o,className:"w-full py-2 px-4 rounded-md bg-gray-200 dark:bg-gray-600 font-semibold",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:o,className:"w-full py-2 px-4 rounded-md bg-indigo-600 text-white font-semibold disabled:bg-indigo-300",children:o?"Saving...":n?"Update":"Save"})]})]})};function EN({onBack:t,transactions:e,onSave:n,onUpdate:r,onDelete:a,isDemoMode:i}){const[A,o]=q.useState("view"),[l,c]=q.useState(null),[d,h]=q.useState({startDate:"",endDate:"",category:"all"}),[p,m]=q.useState(null),[B,y]=q.useState(!1),b=q.useMemo(()=>[...e].sort((O,F)=>{const I=F.date&&typeof F.date.toMillis=="function"?F.date.toMillis():new Date(F.date).getTime(),P=O.date&&typeof O.date.toMillis=="function"?O.date.toMillis():new Date(O.date).getTime();return isNaN(P)||isNaN(I)?0:I-P}),[e]),C=q.useMemo(()=>b.filter(O=>{const F=O.date&&typeof O.date.toDate=="function"?O.date.toDate():new Date(O.date);if(isNaN(F.getTime()))return!1;const I=d.startDate?new Date(d.startDate):null,P=d.endDate?new Date(d.endDate):null;I&&I.setHours(0,0,0,0),P&&P.setHours(23,59,59,999);const V=(!I||F>=I)&&(!P||F<=P),ee=d.category==="all"||O.category===d.category;return V&&ee}),[b,d]),{totalIncome:N,totalExpenses:k,netBalance:E}=q.useMemo(()=>{const O=C.reduce((F,I)=>(I.type==="Income"?F.totalIncome+=I.amount:F.totalExpenses+=I.amount,F),{totalIncome:0,totalExpenses:0});return{...O,netBalance:O.totalIncome-O.totalExpenses}},[C]),_=q.useMemo(()=>["all",...new Set(e.map(O=>O.category))],[e]),M=async O=>{const F={...O,date:Lt.fromDate(new Date(O.date)),createdAt:Jr()};await n(F),o("view")},D=async O=>{if(!l)return;const F={...O,date:Lt.fromDate(new Date(O.date))};await r(l.id,F),c(null)},U=O=>{if(i){alert("Demo mode: Cannot delete data.");return}m(O)},j=async()=>{if(p){y(!0);try{await a(p.id),m(null)}catch(O){console.error("Failed to delete transaction:",O),alert("Failed to delete transaction. Please try again.")}finally{y(!1)}}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Income / Expenses"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>o("add"),className:`w-full py-2 rounded-md font-semibold ${A==="add"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Add Entry"}),s.jsx("button",{onClick:()=>o("view"),className:`w-full py-2 rounded-md font-semibold ${A==="view"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"View All"}),s.jsx("button",{onClick:()=>o("reports"),className:`w-full py-2 rounded-md font-semibold ${A==="reports"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Reports"})]})}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[A==="add"&&s.jsx(zg,{onSave:M,onCancel:()=>o("view"),isDemoMode:i}),A==="view"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("input",{type:"date",value:d.startDate,onChange:O=>h(F=>({...F,startDate:O.target.value})),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600","aria-label":"Start Date"}),s.jsx("input",{type:"date",value:d.endDate,onChange:O=>h(F=>({...F,endDate:O.target.value})),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600","aria-label":"End Date"})]}),s.jsx("select",{value:d.category,onChange:O=>h(F=>({...F,category:O.target.value})),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600",children:_.map(O=>s.jsx("option",{value:O,children:O==="all"?"All Categories":O},O))})]}),l?s.jsx(zg,{onSave:D,onCancel:()=>c(null),initialData:l,isDemoMode:i}):C.length>0?C.map(O=>{var F;return s.jsxs("div",{className:`p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm border-l-4 ${O.type==="Income"?"border-green-500":"border-red-500"}`,children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:O.category}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(F=O.date)!=null&&F.toDate?O.date.toDate().toLocaleDateString():new Date(O.date).toLocaleDateString()})]}),s.jsxs("p",{className:`font-bold text-lg ${O.type==="Income"?"text-green-600":"text-red-600"}`,children:["â‚¹",O.amount.toFixed(2)]})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:O.description}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-2 border-t dark:border-gray-700",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:O.paymentMethod}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c(O),className:"p-1.5 text-blue-600 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/40",disabled:!!O.feeCollectionId,children:s.jsx(Gn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>U(O),className:"p-1.5 text-red-600 rounded-full hover:bg-red-100 dark:hover:bg-red-900/40",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]})]},O.id)}):s.jsx("p",{className:"text-center text-gray-500 pt-10",children:"No transactions found."})]}),A==="reports"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm",children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("input",{type:"date",value:d.startDate,onChange:O=>h(F=>({...F,startDate:O.target.value})),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600","aria-label":"Start Date"}),s.jsx("input",{type:"date",value:d.endDate,onChange:O=>h(F=>({...F,endDate:O.target.value})),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600","aria-label":"End Date"})]})}),s.jsxs("div",{className:"p-4 bg-green-100 dark:bg-green-900/40 rounded-lg text-center",children:[s.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-300",children:"Total Income"}),s.jsxs("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:["â‚¹",N.toFixed(2)]})]}),s.jsxs("div",{className:"p-4 bg-red-100 dark:bg-red-900/40 rounded-lg text-center",children:[s.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"Total Expenses"}),s.jsxs("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:["â‚¹",k.toFixed(2)]})]}),s.jsxs("div",{className:`p-4 rounded-lg text-center ${E>=0?"bg-blue-100 dark:bg-blue-900/40":"bg-orange-100 dark:bg-orange-900/40"}`,children:[s.jsx("p",{className:`text-sm font-medium ${E>=0?"text-blue-800 dark:text-blue-300":"text-orange-800 dark:text-orange-300"}`,children:"Net Balance"}),s.jsxs("p",{className:`text-3xl font-bold ${E>=0?"text-blue-600 dark:text-blue-400":"text-orange-600 dark:text-orange-400"}`,children:["â‚¹",E.toFixed(2)]})]})]})]})]}),p&&s.jsx(FN,{transaction:p,onConfirm:j,onCancel:()=>m(null),isDeleting:B})]})}const UA=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),Uf=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),kN=t=>{if(!t)return"";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`},UN=({exam:t,onNavigate:e,onPublish:n,isPublishing:r})=>{const a=i=>{i.stopPropagation(),window.confirm("Are you sure you want to publish the results? This will make them visible to students.")&&n()};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-lime-400",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100 uppercase",children:t.name}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${t.resultStatus==="Published"?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300":"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200"}`,children:t.resultStatus})]}),s.jsxs("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-300",children:[s.jsxs("p",{children:["Date: ",t.date.toDate().toLocaleDateString("en-GB")," at ",kN(t.date.toDate().toTimeString().substring(0,5))]}),s.jsxs("p",{children:["Max Marks: ",t.maxMarks," | Passing: ",t.passingMarks]})]}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-end space-x-2",children:[s.jsxs("button",{onClick:()=>e("create-exam",{examId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(UA,{className:"w-4 h-4"}),s.jsx("span",{children:"Details"})]}),s.jsxs("button",{onClick:()=>e("record-marks",{examId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Record Marks"})]}),t.resultStatus==="Draft"&&s.jsxs("button",{onClick:a,disabled:r,className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-green-400 transition-colors",children:[s.jsx(Uf,{className:"w-4 h-4"}),s.jsx("span",{children:r?"Publishing...":"Publish"})]})]})]})};function jN({onBack:t,exams:e,onNavigate:n,staffPermissions:r,onPublish:a}){const[i,A]=q.useState("upcoming"),[o,l]=q.useState(null),c=new Date,d=e.filter(y=>{var b;return r?!!((b=r[y.batchId])!=null&&b.exams):!0}),h=d.filter(y=>y.date.toDate()>=c).sort((y,b)=>y.date.toMillis()-b.date.toMillis()),p=d.filter(y=>y.date.toDate()<c).sort((y,b)=>b.date.toMillis()-y.date.toMillis()),m=i==="upcoming"?h:p,B=async y=>{l(y);try{await a(y,"Published")}catch{}finally{l(null)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Manage Exams"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>A("upcoming"),className:`w-full py-2 rounded-md font-semibold ${i==="upcoming"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>A("completed"),className:`w-full py-2 rounded-md font-semibold ${i==="completed"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Completed"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:m.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",i," exams found."]}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to create one."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:m.map(y=>s.jsx(UN,{exam:y,onNavigate:n,onPublish:()=>B(y.id),isPublishing:o===y.id},y.id))})}),s.jsx("button",{onClick:()=>n("create-exam"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Create New Exam",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}function TN({onBack:t,onSave:e,batches:n,exam:r,staffPermissions:a}){const i=!!r,[A,o]=q.useState({name:(r==null?void 0:r.name)||"",batchId:(r==null?void 0:r.batchId)||"",subject:(r==null?void 0:r.subject)||"",date:(r==null?void 0:r.date.toDate().toISOString().split("T")[0])||"",time:(r==null?void 0:r.date.toDate().toTimeString().substring(0,5))||"",maxMarks:String((r==null?void 0:r.maxMarks)||""),passingMarks:String((r==null?void 0:r.passingMarks)||""),description:(r==null?void 0:r.description)||""}),[l,c]=q.useState(!1),d=n.filter(m=>{var B;return m.isActive?a?!!((B=a[m.id])!=null&&B.exams):!0:!1}),h=m=>{o(B=>({...B,[m.target.name]:m.target.value}))},p=async m=>{if(m.preventDefault(),!A.batchId||!A.date||!A.time){alert("Please fill all required fields.");return}c(!0);try{const B=n.find(b=>b.id===A.batchId),y=Lt.fromDate(new Date(`${A.date}T${A.time}`));await e({name:A.name,batchId:A.batchId,batchName:(B==null?void 0:B.name)||"Unknown Batch",subject:A.subject,date:y,maxMarks:Number(A.maxMarks),passingMarks:Number(A.passingMarks),description:A.description,resultStatus:(r==null?void 0:r.resultStatus)||"Draft"})}catch(B){alert(B.message),c(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:i?"Edit Exam Details":"Create New Exam"})]}),s.jsxs("form",{onSubmit:p,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx("input",{type:"text",name:"name",placeholder:"Exam Name (e.g., Mid-Term Test)",value:A.name,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx(On,{label:"Batch / Class",options:d.map(m=>({value:m.id,label:m.name})),selectedValue:A.batchId,onSelect:m=>o(B=>({...B,batchId:m})),placeholder:"Select a batch"}),s.jsx("input",{type:"text",name:"subject",placeholder:"Subject",value:A.subject,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"date",name:"date",value:A.date,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx("input",{type:"time",name:"time",value:A.time,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"number",name:"maxMarks",placeholder:"Max Marks",value:A.maxMarks,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx("input",{type:"number",name:"passingMarks",placeholder:"Passing Marks",value:A.passingMarks,onChange:h,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("textarea",{name:"description",placeholder:"Description / Notes (Optional)",value:A.description,onChange:h,rows:4,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:l,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:l?"Saving...":i?"Update Exam":"Save Exam"})})]})]})}const QN="examMarks",LN=`Student Name : [STUDENT_NAME]([BATCH_NAME])
Topic : [EXAM_TOPIC]
Result : [MARKS]/[MAX_MARKS] on [DATE]
Regards,
[ACADEMY_NAME] ~`;function _N({onClose:t,students:e,marks:n,exam:r,academy:a}){const[i,A]=q.useState("select_app"),[o,l]=q.useState(null),[c,d]=q.useState(0),h=q.useMemo(()=>e.filter(b=>n[b.id]!==null&&n[b.id]!==void 0),[e,n]),p=b=>{l(b),d(0),A("sending_in_progress")},m=q.useCallback(()=>{A("select_app"),l(null)},[]),B=q.useCallback(()=>{var U;if(c>=h.length){A("sending_complete");return}const b=h[c],C=n[b.id],N=r.date.toDate().toLocaleDateString("en-GB"),E=(((U=a.smsTemplates)==null?void 0:U[QN])||LN).replace(/\[STUDENT_NAME\]/g,b.name).replace(/\[BATCH_NAME\]/g,r.batchName).replace(/\[EXAM_TOPIC\]/g,r.subject).replace(/\[MARKS\]/g,String(C)).replace(/\[MAX_MARKS\]/g,String(r.maxMarks)).replace(/\[DATE\]/g,N).replace(/\[ACADEMY_NAME\]/g,a.name),_=b.mobile1.replace(/[^0-9]/g,""),M=encodeURIComponent(E);let D="";o==="whatsapp"?D=`https://wa.me/${_.startsWith("91")?_:`91${_}`}?text=${M}`:D=`sms:${_}?body=${M}`,window.open(D,"_blank")},[c,h,n,r,a,o]);q.useEffect(()=>{const b=()=>{document.visibilityState==="visible"&&i==="sending_in_progress"&&setTimeout(()=>{d(C=>C+1)},500)};return i==="sending_in_progress"&&(B(),document.addEventListener("visibilitychange",b)),()=>{document.removeEventListener("visibilitychange",b)}},[i,c,B]);const y=()=>{switch(i){case"sending_in_progress":const b=h[c];return s.jsxs("div",{className:"text-center p-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"Preparing Message..."}),s.jsxs("p",{children:["Sending to: ",s.jsx("span",{className:"font-semibold",children:b==null?void 0:b.name})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["(",c+1," of ",h.length,")"]}),s.jsxs("p",{className:"text-xs mt-4 text-gray-500",children:["You will be redirected to ",o,". After sending, return to this app to continue."]}),s.jsx("button",{onClick:m,className:"mt-6 bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-lg text-sm",children:"Cancel Sending"})]});case"sending_complete":return s.jsxs("div",{className:"text-center p-8",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"All Done!"}),s.jsx("p",{className:"text-gray-600",children:"All messages have been prepared for sending."}),s.jsx("button",{onClick:t,className:"mt-6 bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg w-full",children:"Finish"})]});case"select_app":default:return s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:"Choose App to Send Marks"}),s.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-300 mb-4",children:["You are about to send results to ",h.length," student(s)."]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>p("whatsapp"),className:"w-full flex items-center justify-center gap-3 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors",children:[s.jsx(Kc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via WhatsApp"})]}),s.jsxs("button",{onClick:()=>p("sms"),className:"w-full flex items-center justify-center gap-3 bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600 transition-colors",children:[s.jsx(qc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via SMS"})]})]})]})}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg w-full max-w-sm flex flex-col max-h-[90vh] relative",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Send Exam Marks"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-500"})})]}),s.jsx("div",{className:"flex flex-col flex-grow overflow-hidden",children:y()})]})})}const MN=({onClose:t})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/40 mb-5",children:s.jsx(cs,{className:"h-9 w-9 text-green-600 dark:text-green-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Success!"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"Marks have been saved successfully."}),s.jsx("button",{onClick:t,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"OK"})]})}),DN=({onConfirm:t,onCancel:e,isPublishing:n})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900/40 mb-5",children:s.jsx(Uf,{className:"h-9 w-9 text-blue-600 dark:text-blue-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Confirm Publication"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"Are you sure you want to publish these results? They will become visible to students in their dashboard."}),s.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3",children:[s.jsx("button",{onClick:t,disabled:n,className:"w-full sm:w-auto flex-1 bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors shadow-md disabled:bg-green-300",children:n?"Publishing...":"Yes, Publish"}),s.jsx("button",{onClick:e,disabled:n,className:"w-full sm:w-auto flex-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})}),PN=({onClose:t})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/40 mb-5",children:s.jsx(cs,{className:"h-9 w-9 text-green-600 dark:text-green-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Results Published!"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:"Your marks are published and can be viewed by students in their dashboard."}),s.jsx("button",{onClick:t,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"OK"})]})});function RN({onBack:t,exam:e,students:n,academy:r,isDemoMode:a,onPublish:i}){const[A,o]=q.useState({}),[l,c]=q.useState(!0),[d,h]=q.useState(!1),[p,m]=q.useState(!1),[B,y]=q.useState(!1),[b,C]=q.useState(!1),[N,k]=q.useState(!1),[E,_]=q.useState(!1),M=n.filter(I=>I.isActive&&I.batches.includes(e.batchName)),D=q.useCallback(async()=>{if(a){c(!1);return}c(!0);const I=Bn(Te,`academies/${r.id}/exams/${e.id}/marks`),P=await Qa(I),V={};P.forEach(ee=>{V[ee.id]=ee.data().marksObtained}),o(V),c(!1)},[r.id,e.id,a]);q.useEffect(()=>{D()},[D]);const U=(I,P)=>{const V={...A},ee=P===""?null:Number(P);(ee===null||ee>=0&&ee<=e.maxMarks)&&(V[I]=ee,o(V))},j=async()=>{if(a){alert("Demo mode: Cannot save marks.");return}h(!0);const I=pr(Te);M.forEach(P=>{const V=P.id,ee=A[V]??null,X=ee===null?"Not Graded":ee>=e.passingMarks?"Passed":"Failed",le=Xe(Te,`academies/${r.id}/exams/${e.id}/marks`,V),ae={studentId:V,studentName:P.name,studentRollNumber:P.rollNumber,marksObtained:ee,status:X};I.set(le,ae,{merge:!0})});try{await I.commit(),y(!0)}catch(P){console.error("Error saving marks:",P),alert("Failed to save marks.")}finally{h(!1)}},O=async()=>{if(a){alert("Demo mode.");return}k(!0);try{await i(e.id,"Published"),C(!1),_(!0)}catch{alert("Failed to publish results.")}finally{k(!1)}},F=async()=>{if(a){alert("Demo mode.");return}if(window.confirm("Are you sure you want to unpublish the results? Students will no longer be able to see them."))try{await i(e.id,"Draft"),alert("Results have been successfully unpublished!")}catch{alert("Failed to update status.")}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h1",{className:"text-xl font-bold",children:"Record Marks"}),s.jsxs("p",{className:"text-sm opacity-90",children:[e.name," (",e.batchName,")"]})]})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:l?s.jsx(Ar,{message:"Loading student marks..."}):s.jsx("div",{className:"space-y-3",children:M.map(I=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:I.name}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:I.rollNumber})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"number",value:A[I.id]??"",onChange:P=>U(I.id,P.target.value),placeholder:"-",className:"w-20 p-2 text-center border rounded-md dark:bg-gray-700 dark:border-gray-600",max:e.maxMarks,min:0}),s.jsxs("span",{className:"text-gray-500",children:["/ ",e.maxMarks]})]})]},I.id))})}),s.jsxs("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700 flex-shrink-0 space-y-3",children:[e.resultStatus==="Draft"?s.jsx("button",{onClick:()=>C(!0),className:"w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700",children:"Publish Results"}):s.jsx("button",{onClick:()=>m(!0),className:"w-full bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600",children:"Send Marks to Parents"}),s.jsx("button",{onClick:j,disabled:d,className:"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-blue-300",children:d?"Saving...":"Save Marks"}),e.resultStatus==="Published"&&s.jsx("button",{onClick:F,className:"w-full bg-yellow-500 text-black font-bold py-3 px-4 rounded-lg hover:bg-yellow-600",children:"Unpublish Results"})]})]}),p&&s.jsx(_N,{onClose:()=>m(!1),students:M,marks:A,exam:e,academy:r}),B&&s.jsx(MN,{onClose:()=>y(!1)}),b&&s.jsx(DN,{onConfirm:O,onCancel:()=>C(!1),isPublishing:N}),E&&s.jsx(PN,{onClose:()=>_(!1)})]})}const HN=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z"})}),ON=({enquiry:t,onNavigate:e,onDelete:n})=>{const r=a=>{switch(a){case"New":return"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300";case"Follow-up":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300";case"Converted":return"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300";case"Lost":return"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300"}};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.studentName}),s.jsx("a",{href:`tel:${t.mobile}`,className:"text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:t.mobile})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${r(t.status)}`,children:t.status})]}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:["Interested in: ",s.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:t.interestedBatch})]}),t.notes&&s.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1 italic",children:["Notes: ",t.notes]}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex flex-wrap justify-end gap-2",children:[t.status!=="Converted"&&s.jsxs("button",{onClick:()=>e("new-student",{enquiryId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors",children:[s.jsx(HN,{className:"w-4 h-4"}),s.jsx("span",{children:"Convert to Admission"})]}),s.jsxs("button",{onClick:()=>e("edit-enquiry",{enquiryId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>n(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60 transition-colors",children:[s.jsx(Qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]})]})]})},GN=[{id:"All",label:"All"},{id:"New",label:"New"},{id:"Follow-up",label:"Follow-up"},{id:"Converted",label:"Converted"},{id:"Lost",label:"Lost"}];function VN({onBack:t,enquiries:e,onNavigate:n,onDelete:r,onUpdateStatus:a}){const[i,A]=q.useState("All"),[o,l]=q.useState(""),c=q.useMemo(()=>e.filter(d=>i==="All"||d.status===i).filter(d=>d.studentName.toLowerCase().includes(o.toLowerCase())||d.mobile.includes(o)).sort((d,h)=>h.createdAt.toMillis()-d.createdAt.toMillis()),[e,i,o]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Enquiry Manager"})]}),s.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by name or mobile...",value:o,onChange:d=>l(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsx("div",{className:"flex justify-start space-x-2 overflow-x-auto mt-2 pb-1",children:GN.map(d=>s.jsx("button",{onClick:()=>A(d.id),className:`px-4 py-1.5 text-sm font-semibold rounded-full flex-shrink-0 transition-colors ${i===d.id?"bg-indigo-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:d.label},d.id))})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:c.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No enquiries found for this filter."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to add a new enquiry."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:c.map(d=>s.jsx(ON,{enquiry:d,onNavigate:n,onDelete:r},d.id))})}),s.jsx("button",{onClick:()=>n("new-enquiry"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Add New Enquiry",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}const KN=["Google","Referral","Walk-in","Social Media","Other"],qN=["New","Follow-up","Converted","Lost"];function zN({onBack:t,onSave:e,batches:n,enquiry:r}){var p;const a=!!r,[i,A]=q.useState({studentName:(r==null?void 0:r.studentName)||"",mobile:(r==null?void 0:r.mobile)||"",email:(r==null?void 0:r.email)||"",interestedBatch:(r==null?void 0:r.interestedBatch)||"",referenceSource:(r==null?void 0:r.referenceSource)||"Other",followUpDate:((p=r==null?void 0:r.followUpDate)==null?void 0:p.toDate().toISOString().split("T")[0])||"",notes:(r==null?void 0:r.notes)||"",status:(r==null?void 0:r.status)||"New"}),[o,l]=q.useState(!1),c=n.filter(m=>m.isActive),d=m=>{A(B=>({...B,[m.target.name]:m.target.value}))},h=async m=>{if(m.preventDefault(),!i.studentName||!i.mobile||!i.interestedBatch){alert("Please fill Name, Mobile, and Interested Batch.");return}l(!0);const B={...i,referenceSource:i.referenceSource,status:i.status,followUpDate:i.followUpDate?Lt.fromDate(new Date(i.followUpDate)):null};try{a?await e({enquiryId:r.id,data:B}):await e({...B,createdAt:Jr()})}catch(y){alert(y.message),l(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:a?"Edit Enquiry":"New Enquiry"})]}),s.jsxs("form",{onSubmit:h,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx("input",{type:"text",name:"studentName",placeholder:"Student Name",value:i.studentName,onChange:d,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx("input",{type:"tel",name:"mobile",placeholder:"Mobile Number",value:i.mobile,onChange:d,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx("input",{type:"email",name:"email",placeholder:"Email (Optional)",value:i.email,onChange:d,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx(On,{label:"Interested Class",options:c.map(m=>({value:m.name,label:m.name})),selectedValue:i.interestedBatch,onSelect:m=>A(B=>({...B,interestedBatch:m})),placeholder:"Select a class"}),s.jsx(On,{label:"Reference Source",options:KN.map(m=>({value:m,label:m})),selectedValue:i.referenceSource,onSelect:m=>A(B=>({...B,referenceSource:m}))}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"followUpDate",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"Next Follow-up Date (Optional)"}),s.jsx("input",{id:"followUpDate",type:"date",name:"followUpDate",value:i.followUpDate,onChange:d,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx(On,{label:"Status",options:qN.map(m=>({value:m,label:m})),selectedValue:i.status,onSelect:m=>A(B=>({...B,status:m}))}),s.jsx("textarea",{name:"notes",placeholder:"Notes (Optional)",value:i.notes,onChange:d,rows:4,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:o,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:o?"Saving...":a?"Update Enquiry":"Save Enquiry"})})]})]})}const JN=[{name:"Attendance Report",Icon:Xs,key:"attendance-report"},{name:"Fee Collection Report",Icon:Bx,key:"fee-collection-report"},{name:"Fee Dues List",Icon:vx,key:"fee-dues-list"},{name:"Staff Attendance Report",Icon:Oc,key:"staff-attendance-report"},{name:"Exam Reports",Icon:mi,key:"exam-reports"}];function WN({onBack:t,onNavigate:e,onShowDevPopup:n}){const r=a=>{switch(a){case"attendance-report":case"fee-collection-report":case"fee-dues-list":case"staff-attendance-report":e(a);break;default:n("Exam Reports");break}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Reports"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:JN.map(({name:a,Icon:i,key:A})=>s.jsxs("button",{onClick:()=>r(A),className:"w-full bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 flex items-center space-x-4 text-left",children:[s.jsx("div",{className:"w-10 h-10 text-indigo-500 dark:text-indigo-400",children:s.jsx(i,{})}),s.jsx("span",{className:"text-lg font-medium text-indigo-800 dark:text-gray-100",children:a})]},A))})})]})}const YN="monthlyAttendanceReport",$N=`Dear Parents, Monthly attendance report for [STUDENT_NAME] ([BATCH_NAME]) for [MONTH]: Present-[P_DAYS], Absent-[A_DAYS], Leave-[L_DAYS].
Regards,
[ACADEMY_NAME] ~`,XN=({onClose:t,reportData:e,academy:n,batchName:r,month:a})=>{var B;const[i,A]=q.useState("select_app"),[o,l]=q.useState(null),[c,d]=q.useState(0),h=(e==null?void 0:e.students)||[],p=y=>{l(y),d(0),A("sending_in_progress")},m=q.useCallback(()=>{var D;if(c>=h.length){A("sending_complete");return}const y=h[c],b=e.summaries[y.id],C=new Date(a+"-02").toLocaleString("default",{month:"long",year:"numeric"}),k=(((D=n.smsTemplates)==null?void 0:D[YN])||$N).replace(/\[STUDENT_NAME\]/g,y.name).replace(/\[BATCH_NAME\]/g,r).replace(/\[MONTH\]/g,C).replace(/\[P_DAYS\]/g,String(b.P)).replace(/\[A_DAYS\]/g,String(b.A)).replace(/\[L_DAYS\]/g,String(b.L)).replace(/\[ACADEMY_NAME\]/g,n.name),E=y.mobile1.replace(/[^0-9]/g,""),_=encodeURIComponent(k);let M="";o==="whatsapp"?M=`https://wa.me/${E.startsWith("91")?E:`91${E}`}?text=${_}`:M=`sms:${E}?body=${_}`,window.open(M,"_blank")},[c,h,e,n,a,r,o]);return q.useEffect(()=>{const y=()=>{document.visibilityState==="visible"&&i==="sending_in_progress"&&setTimeout(()=>d(b=>b+1),500)};return i==="sending_in_progress"&&(m(),document.addEventListener("visibilitychange",y)),()=>document.removeEventListener("visibilitychange",y)},[i,c,m]),s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg w-full max-w-sm flex flex-col max-h-[90vh] relative",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Send Report"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6 text-gray-500"})})]}),s.jsxs("div",{className:"flex flex-col flex-grow overflow-hidden p-4",children:[i==="select_app"&&s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:"Choose App"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>p("whatsapp"),className:"w-full flex items-center justify-center gap-3 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors",children:[s.jsx(Kc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via WhatsApp"})]}),s.jsxs("button",{onClick:()=>p("sms"),className:"w-full flex items-center justify-center gap-3 bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600 transition-colors",children:[s.jsx(qc,{className:"w-6 h-6"}),s.jsx("span",{children:"Send via SMS"})]})]})]}),i==="sending_in_progress"&&s.jsxs("div",{className:"text-center p-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"Preparing Message..."}),s.jsxs("p",{children:["Sending to: ",s.jsx("span",{className:"font-semibold",children:(B=h[c])==null?void 0:B.name})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["(",c+1," of ",h.length,")"]}),s.jsxs("p",{className:"text-xs mt-4 text-gray-500",children:["You will be redirected to ",o,". After sending, return to this app to continue."]}),s.jsx("button",{onClick:t,className:"mt-6 bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-lg text-sm",children:"Cancel"})]}),i==="sending_complete"&&s.jsxs("div",{className:"text-center p-8",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto"}),s.jsx("h3",{className:"text-lg font-bold mt-4",children:"All Done!"}),s.jsx("p",{className:"text-gray-600",children:"All messages have been prepared."}),s.jsx("button",{onClick:t,className:"mt-6 bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg w-full",children:"Finish"})]})]})]})})},ZN=({academy:t,reportData:e,batchName:n,monthName:r})=>{if(!e)return null;const a=Object.keys(e.attendance[e.students[0].id]||{}).length||new Date(r).getDate(),i=A=>{switch(A){case"Present":return"P";case"Absent":return"A";case"Leave":return"L";case"Holiday":return"H";default:return"-"}};return s.jsxs("div",{className:"bg-white text-black p-4 font-sans",children:[s.jsxs("div",{className:"flex justify-between items-center pb-4 border-b-2 border-gray-300",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[t.logoUrl?s.jsx("img",{src:t.logoUrl,alt:"Logo",className:"w-16 h-16 object-contain"}):s.jsx(hi,{className:"w-16 h-16 text-indigo-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:t.name}),s.jsx("p",{className:"text-sm",children:"Monthly Attendance Report"})]})]}),s.jsxs("div",{className:"text-right text-sm",children:[s.jsxs("p",{children:["Batch: ",n]}),s.jsxs("p",{children:["Month: ",r]})]})]}),s.jsx("div",{className:"overflow-x-auto pt-4",children:s.jsxs("table",{className:"w-full text-xs border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"p-1 border border-gray-300",children:"Student"}),Array.from({length:a},(A,o)=>o+1).map(A=>s.jsx("th",{className:"p-1 border border-gray-300 text-center",children:A},A)),s.jsx("th",{className:"p-1 border border-gray-300 text-center",children:"P"}),s.jsx("th",{className:"p-1 border border-gray-300 text-center",children:"A"}),s.jsx("th",{className:"p-1 border border-gray-300 text-center",children:"L"})]})}),s.jsx("tbody",{children:e.students.map(A=>s.jsxs("tr",{children:[s.jsx("td",{className:"p-1 border border-gray-300 font-medium whitespace-nowrap",children:A.name}),Array.from({length:a},(o,l)=>l+1).map(o=>{var l;return s.jsx("td",{className:"p-1 border border-gray-300 text-center",children:i((l=e.attendance[A.id])==null?void 0:l[o])},o)}),s.jsx("td",{className:"p-1 border border-gray-300 text-center font-bold",children:e.summaries[A.id].P}),s.jsx("td",{className:"p-1 border border-gray-300 text-center font-bold",children:e.summaries[A.id].A}),s.jsx("td",{className:"p-1 border border-gray-300 text-center font-bold",children:e.summaries[A.id].L})]},A.id))})]})})]})};function e4({onBack:t,batches:e,students:n,academyId:r,academy:a}){var F,I;const i=e.filter(P=>P.isActive),[A,o]=q.useState(((F=i[0])==null?void 0:F.id)||null),[l,c]=q.useState(new Date().toISOString().substring(0,7)),[d,h]=q.useState(null),[p,m]=q.useState(!1),[B,y]=q.useState(null),[b,C]=q.useState(!1),[N,k]=q.useState(!1),E=async()=>{if(!A||!l){alert("Please select a batch and a month.");return}m(!0),y(null),h(null);try{const[P,V]=l.split("-").map(Number),ee=new Date(P,V,0).getDate(),X=n.filter(Ce=>Ce.batches.includes(i.find(Q=>Q.id===A).name)),le={};X.forEach(Ce=>{le[Ce.id]={}});const ae=Array.from({length:ee},(Ce,Q)=>{const z=Q+1,W=`${P}-${String(V).padStart(2,"0")}-${String(z).padStart(2,"0")}`;return Sn(Xe(Te,`academies/${r}/batches/${A}/attendance`,W))});(await Promise.all(ae)).forEach((Ce,Q)=>{const z=String(Q+1);if(Ce.exists()){const W=Ce.data();X.forEach(Z=>{W[Z.id]&&(le[Z.id][z]=W[Z.id])})}});const ue={};X.forEach(Ce=>{ue[Ce.id]={P:0,A:0,L:0,H:0},Object.values(le[Ce.id]).forEach(Q=>{Q==="Present"?ue[Ce.id].P++:Q==="Absent"?ue[Ce.id].A++:Q==="Leave"?ue[Ce.id].L++:Q==="Holiday"&&ue[Ce.id].H++})}),h({students:X,attendance:le,summaries:ue})}catch(P){console.error(P),y("Failed to generate report. Please check your connection and try again.")}finally{m(!1)}},_=async()=>{d&&(C(!0),setTimeout(async()=>{const P=document.getElementById("pdf-report-container");if(!P){console.error("Report element not found"),C(!1);return}try{const ee=(await id(P,{scale:2})).toDataURL("image/png"),X=new it({orientation:"landscape",unit:"px",format:"a4"}),le=X.internal.pageSize.getWidth(),ae=X.internal.pageSize.getHeight(),de=X.getImageProperties(ee),ue=de.height/de.width;let Ce=le-20,Q=Ce*ue;Q>ae-20&&(Q=ae-20,Ce=Q/ue);const z=(le-Ce)/2,W=(ae-Q)/2;X.addImage(ee,"PNG",z,W,Ce,Q);const Z=X.output("blob"),ne=`Attendance-${A}-${l}.pdf`,fe=new File([Z],ne,{type:"application/pdf"});if(navigator.share&&navigator.canShare&&navigator.canShare({files:[fe]}))await navigator.share({title:"Attendance Report",files:[fe]});else{const xe=document.createElement("a");xe.href=URL.createObjectURL(fe),xe.download=ne,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(xe.href)}}catch(V){console.error("Error generating PDF:",V),alert("Failed to generate PDF.")}finally{C(!1)}},100))},M=P=>{switch(P){case"Present":return"P";case"Absent":return"A";case"Leave":return"L";case"Holiday":return"H";default:return"-"}},D=P=>{switch(P){case"Present":return"text-green-600 font-bold";case"Absent":return"text-red-600 font-bold";case"Leave":return"text-orange-500 font-bold";case"Holiday":return"text-purple-500 font-bold";default:return"text-gray-400"}},U=q.useMemo(()=>{if(!l)return 0;const[P,V]=l.split("-").map(Number);return new Date(P,V,0).getDate()},[l]),j=((I=i.find(P=>P.id===A))==null?void 0:I.name)||"",O=new Date(l+"-02").toLocaleString("default",{month:"long",year:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{position:"fixed",left:"-9999px",top:0,zIndex:-1},children:b&&d&&s.jsx("div",{id:"pdf-report-container",style:{width:"297mm",height:"210mm"},children:s.jsx(ZN,{academy:a,reportData:d,batchName:j,monthName:O})})}),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10 no-print",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Attendance Report"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md mb-6 no-print",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Batch"}),s.jsxs("select",{value:A||"",onChange:P=>o(P.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600",children:[s.jsx("option",{value:"",disabled:!0,children:"Select a Batch"}),i.map(P=>s.jsx("option",{value:P.id,children:P.name},P.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Month"}),s.jsx("input",{type:"month",value:l,onChange:P=>c(P.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600"})]}),s.jsx("button",{onClick:E,disabled:p||!A,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-400",children:p?"Generating...":"Generate Report"})]})}),B&&s.jsx("p",{className:"text-center text-red-500",children:B}),d&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 mt-4 rounded-lg shadow-sm animate-fade-in-up",children:[s.jsxs("div",{className:"p-4 text-center border-b dark:border-gray-700",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:"Monthly Attendance Report"}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j," - ",O]})]}),s.jsx("div",{className:"overflow-x-auto p-4",children:s.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700",children:[s.jsx("th",{className:"p-2 border dark:border-gray-600",children:"Student Name"}),Array.from({length:U},(P,V)=>V+1).map(P=>s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center min-w-[30px]",children:P},P)),s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center bg-green-50 dark:bg-green-900/40 text-green-700 dark:text-green-300",children:"P"}),s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center bg-red-50 dark:bg-red-900/40 text-red-700 dark:text-red-300",children:"A"}),s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center bg-orange-50 dark:bg-orange-900/40 text-orange-700 dark:text-orange-300",children:"L"})]})}),s.jsx("tbody",{children:d.students.map(P=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[s.jsx("td",{className:"p-2 border dark:border-gray-600 font-medium whitespace-nowrap",children:P.name}),Array.from({length:U},(V,ee)=>ee+1).map(V=>{var ee,X;return s.jsx("td",{className:`p-2 border dark:border-gray-600 text-center ${D((ee=d.attendance[P.id])==null?void 0:ee[String(V)])}`,children:M((X=d.attendance[P.id])==null?void 0:X[String(V)])},V)}),s.jsx("td",{className:"p-2 border dark:border-gray-600 text-center font-bold",children:d.summaries[P.id].P}),s.jsx("td",{className:"p-2 border dark:border-gray-600 text-center font-bold",children:d.summaries[P.id].A}),s.jsx("td",{className:"p-2 border dark:border-gray-600 text-center font-bold",children:d.summaries[P.id].L})]},P.id))})]})})]})]}),d&&s.jsxs("footer",{className:"p-3 bg-white dark:bg-gray-800 border-t dark:border-gray-700 grid grid-cols-2 gap-3 flex-shrink-0 no-print",children:[s.jsxs("button",{onClick:()=>k(!0),className:"flex items-center justify-center space-x-2 w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[s.jsx(Rc,{className:"w-5 h-5"}),s.jsx("span",{children:"Send Attendance"})]}),s.jsxs("button",{onClick:_,disabled:b,className:"flex items-center justify-center space-x-2 w-full bg-slate-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-900 transition-colors shadow-md disabled:bg-slate-600",children:[s.jsx(kf,{className:"w-5 h-5"}),s.jsx("span",{children:b?"Generating...":"Download PDF"})]})]})]}),N&&d&&s.jsx(XN,{onClose:()=>k(!1),reportData:d,academy:a,batchName:j,month:l})]})}const Ad=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})}),t4=({material:t,onEdit:e,onDelete:n})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-gray-400",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100 truncate",children:t.title}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]})]}),s.jsx("div",{className:"flex-shrink-0 ml-2",children:t.fileType==="file"?s.jsx(UA,{className:"w-6 h-6 text-gray-500"}):s.jsx(Ad,{className:"w-6 h-6 text-gray-500"})})]}),t.description&&s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:t.description}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-end space-x-2",children:[s.jsx("a",{href:t.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:s.jsx("span",{children:"View"})}),s.jsxs("button",{onClick:()=>e(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsx("button",{onClick:()=>n(t),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60 transition-colors",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]});function n4({onBack:t,materials:e,batches:n,onNavigate:r,onDelete:a}){const[i,A]=q.useState("all"),[o,l]=q.useState(""),c=q.useMemo(()=>e.filter(d=>i==="all"||d.batchId===i).filter(d=>d.title.toLowerCase().includes(o.toLowerCase())||d.subject.toLowerCase().includes(o.toLowerCase())).sort((d,h)=>h.uploadedAt.toMillis()-d.uploadedAt.toMillis()),[e,i,o]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Study Material"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"space-y-4 mb-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by title or subject...",value:o,onChange:d=>l(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsxs("select",{value:i,onChange:d=>A(d.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[s.jsx("option",{value:"all",children:"All Batches"}),n.filter(d=>d.isActive).map(d=>s.jsx("option",{value:d.id,children:d.name},d.id))]})]}),c.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No study material found."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to upload."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:c.map(d=>s.jsx(t4,{material:d,onEdit:h=>r("edit-study-material",{studyMaterialId:h}),onDelete:a},d.id))})]}),s.jsx("button",{onClick:()=>r("upload-study-material"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Upload New Material",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}function r4({onBack:t,onSave:e,batches:n,academyId:r,uploaderName:a,materialToEdit:i,isDemoMode:A}){const o=!!i,[l,c]=q.useState({title:(i==null?void 0:i.title)||"",description:(i==null?void 0:i.description)||"",batchId:(i==null?void 0:i.batchId)||"",subject:(i==null?void 0:i.subject)||"",fileType:(i==null?void 0:i.fileType)||"file",fileUrl:(i==null?void 0:i.fileUrl)||""}),[d,h]=q.useState(null),[p,m]=q.useState(0),[B,y]=q.useState(!1),b=n.filter(E=>E.isActive),C=E=>{c(_=>({..._,[E.target.name]:E.target.value}))},N=E=>{E.target.files&&E.target.files[0]&&h(E.target.files[0])},k=async E=>{if(E.preventDefault(),A){alert("This is a demo. Data cannot be saved.");return}if(!l.title||!l.batchId||!l.subject){alert("Please fill Title, Batch, and Subject.");return}if(l.fileType==="file"&&!d&&!o){alert("Please select a file to upload.");return}if(l.fileType==="link"&&!l.fileUrl){alert("Please enter a link.");return}y(!0);const _=n.find(M=>M.id===l.batchId);try{let M=(i==null?void 0:i.fileUrl)||"",D=i==null?void 0:i.fileName,U=i==null?void 0:i.storagePath;if(l.fileType==="file"&&d){const j=`academies/${r}/study_materials/${Date.now()}_${d.name}`,O=Ea(ka,j),F=qo(O,d);M=await new Promise((I,P)=>{F.on("state_changed",V=>{const ee=V.bytesTransferred/V.totalBytes*100;m(ee)},V=>{console.error("Upload failed:",V),P(new Error("File upload failed. Please try again."))},async()=>{try{const V=await zo(F.snapshot.ref);I(V)}catch(V){P(V)}})}),D=d.name,U=j}else l.fileType==="link"&&(M=l.fileUrl,D=void 0,U=void 0);await e({title:l.title,description:l.description,batchId:l.batchId,subject:l.subject,fileType:l.fileType,fileUrl:M,fileName:D,storagePath:U,batchName:(_==null?void 0:_.name)||"",uploadedAt:(i==null?void 0:i.uploadedAt)||Jr(),uploadedBy:a})}catch(M){alert(M.message),y(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:o?"Edit Material":"Upload Material"})]}),s.jsxs("form",{onSubmit:k,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx("input",{type:"text",name:"title",placeholder:"Title",value:l.title,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx(On,{label:"Batch / Class",options:b.map(E=>({value:E.id,label:E.name})),selectedValue:l.batchId,onSelect:E=>c(_=>({..._,batchId:E})),placeholder:"Select a batch"}),s.jsx("input",{type:"text",name:"subject",placeholder:"Subject",value:l.subject,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx("textarea",{name:"description",placeholder:"Description (Optional)",value:l.description,onChange:C,rows:3,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 p-1 bg-gray-200 dark:bg-gray-700 rounded-lg",children:[s.jsx("button",{type:"button",onClick:()=>c(E=>({...E,fileType:"file"})),className:`py-2 rounded-md font-semibold ${l.fileType==="file"?"bg-white dark:bg-gray-800 text-indigo-600 shadow":"text-gray-600 dark:text-gray-300"}`,children:"Upload File"}),s.jsx("button",{type:"button",onClick:()=>c(E=>({...E,fileType:"link"})),className:`py-2 rounded-md font-semibold ${l.fileType==="link"?"bg-white dark:bg-gray-800 text-indigo-600 shadow":"text-gray-600 dark:text-gray-300"}`,children:"Add Link"})]}),l.fileType==="file"?s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"file-upload",className:"w-full p-3 bg-white dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500",children:[s.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-semibold",children:"Choose file to upload"}),d&&s.jsx("span",{className:"text-sm text-gray-500 mt-1",children:d.name}),o&&!d&&(i==null?void 0:i.fileName)&&s.jsxs("span",{className:"text-sm text-gray-500 mt-1",children:["Current: ",i.fileName]})]}),s.jsx("input",{id:"file-upload",type:"file",onChange:N,className:"hidden"})]}):s.jsx("input",{type:"url",name:"fileUrl",placeholder:"https://example.com/video",value:l.fileUrl,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsxs("button",{type:"submit",disabled:B,className:"relative w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-400 disabled:cursor-not-allowed overflow-hidden",children:[s.jsx("span",{className:"relative z-10",children:B?`Saving... ${Math.round(p)}%`:o?"Update Material":"Save Material"}),B&&s.jsx("div",{className:"absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-150",style:{width:`${p}%`}})]})})]})]})}const s4=({homework:t,onEdit:e,onDelete:n,onViewSubmissions:r})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-green-500",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100 truncate",children:t.title}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]})]}),s.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 font-semibold flex-shrink-0 ml-2",children:["Due: ",t.dueDate.toDate().toLocaleDateString()]})]}),t.description&&s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:t.description}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex flex-wrap justify-end gap-2",children:[s.jsx("button",{onClick:()=>r(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:s.jsx("span",{children:"View Submissions"})}),s.jsxs("button",{onClick:()=>e(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsx("button",{onClick:()=>n(t),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60 transition-colors",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]});function a4({onBack:t,homework:e,batches:n,onNavigate:r,onDelete:a}){const[i,A]=q.useState("all"),[o,l]=q.useState(""),c=q.useMemo(()=>e.filter(d=>i==="all"||d.batchId===i).filter(d=>d.title.toLowerCase().includes(o.toLowerCase())||d.subject.toLowerCase().includes(o.toLowerCase())).sort((d,h)=>h.assignedAt.toMillis()-d.assignedAt.toMillis()),[e,i,o]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Homework"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"space-y-4 mb-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search by title or subject...",value:o,onChange:d=>l(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsxs("select",{value:i,onChange:d=>A(d.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[s.jsx("option",{value:"all",children:"All Batches"}),n.filter(d=>d.isActive).map(d=>s.jsx("option",{value:d.id,children:d.name},d.id))]})]}),c.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No homework assigned."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to assign homework."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:c.map(d=>s.jsx(s4,{homework:d,onEdit:h=>r("edit-homework",{homeworkId:h}),onDelete:a,onViewSubmissions:h=>r("homework-submissions",{homeworkId:h})},d.id))})]}),s.jsx("button",{onClick:()=>r("assign-homework"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Assign New Homework",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}function i4({onBack:t,onSave:e,batches:n,academyId:r,uploaderName:a,homeworkToEdit:i,isDemoMode:A}){const o=!!i,[l,c]=q.useState({title:(i==null?void 0:i.title)||"",description:(i==null?void 0:i.description)||"",batchId:(i==null?void 0:i.batchId)||"",subject:(i==null?void 0:i.subject)||"",dueDate:(i==null?void 0:i.dueDate.toDate().toISOString().split("T")[0])||""}),[d,h]=q.useState(null),[p,m]=q.useState(0),[B,y]=q.useState(!1),b=n.filter(E=>E.isActive),C=E=>{c(_=>({..._,[E.target.name]:E.target.value}))},N=E=>{E.target.files&&E.target.files[0]&&h(E.target.files[0])},k=async E=>{if(E.preventDefault(),A){alert("This is a demo. Data cannot be saved.");return}if(!l.title||!l.batchId||!l.subject||!l.dueDate){alert("Please fill all required fields: Title, Batch, Subject, and Due Date.");return}y(!0);const _=n.find(M=>M.id===l.batchId);try{let M=i==null?void 0:i.attachmentUrl,D=i==null?void 0:i.attachmentName,U=i==null?void 0:i.storagePath;if(d){U=`academies/${r}/homework_attachments/${Date.now()}_${d.name}`;const j=Ea(ka,U),O=qo(j,d);await new Promise((F,I)=>{O.on("state_changed",P=>{const V=P.bytesTransferred/P.totalBytes*100;m(V)},P=>{console.error("Upload failed:",P),alert("File upload failed. Please try again."),y(!1),I(P)},async()=>{M=await zo(O.snapshot.ref),D=d.name,F()})})}await e({...l,dueDate:Lt.fromDate(new Date(l.dueDate)),attachmentUrl:M,attachmentName:D,storagePath:U,batchName:(_==null?void 0:_.name)||"",assignedAt:(i==null?void 0:i.assignedAt)||Jr(),assignedBy:a})}catch(M){if(!B)return;alert(M.message),y(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:o?"Edit Homework":"Assign Homework"})]}),s.jsxs("form",{onSubmit:k,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx("input",{type:"text",name:"title",placeholder:"Homework Title",value:l.title,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsx(On,{label:"Batch / Class",options:b.map(E=>({value:E.id,label:E.name})),selectedValue:l.batchId,onSelect:E=>c(_=>({..._,batchId:E})),placeholder:"Select a batch"}),s.jsx("input",{type:"text",name:"subject",placeholder:"Subject",value:l.subject,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"dueDate",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"Due Date"}),s.jsx("input",{id:"dueDate",type:"date",name:"dueDate",value:l.dueDate,onChange:C,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),s.jsx("textarea",{name:"description",placeholder:"Description / Instructions (Optional)",value:l.description,onChange:C,rows:4,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"file-upload",className:"w-full p-3 bg-white dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500",children:[s.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-semibold",children:"Attach File (Optional)"}),d&&s.jsx("span",{className:"text-sm text-gray-500 mt-1",children:d.name}),o&&!d&&(i==null?void 0:i.attachmentName)&&s.jsxs("span",{className:"text-sm text-gray-500 mt-1",children:["Current: ",i.attachmentName]})]}),s.jsx("input",{id:"file-upload",type:"file",onChange:N,className:"hidden"})]})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsxs("button",{type:"submit",disabled:B,className:"relative w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-400 disabled:cursor-not-allowed overflow-hidden",children:[s.jsx("span",{className:"relative z-10",children:B?`Saving... ${Math.round(p)}%`:o?"Update Homework":"Assign Homework"}),B&&s.jsx("div",{className:"absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-150",style:{width:`${p}%`}})]})})]})]})}function A4({onBack:t,homework:e,students:n,academyId:r}){const[a,i]=q.useState({}),[A,o]=q.useState(!0),l=q.useMemo(()=>n.filter(p=>p.isActive&&p.batches.includes(e.batchName)),[n,e.batchName]);q.useEffect(()=>{const p=Bn(Te,`academies/${r}/homework/${e.id}/submissions`),m=si(p,B=>{const y={};B.forEach(b=>{y[b.id]={id:b.id,...b.data()}}),i(y),o(!1)});return()=>m()},[r,e.id]);const c=p=>{const m=a[p];return m?m.status==="Checked"?"Checked":"Submitted":"Pending"},d=async p=>{const m=Xe(Te,`academies/${r}/homework/${e.id}/submissions`,p);try{await qr(m,{status:"Checked"})}catch(B){console.error("Failed to mark as checked:",B),alert("Failed to update status. Please try again.")}},h=p=>{switch(p){case"Pending":return"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200";case"Submitted":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300";case"Checked":return"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h1",{className:"text-xl font-bold",children:"Submissions"}),s.jsx("p",{className:"text-sm opacity-90",children:e.title})]})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:A?s.jsx(Ar,{message:"Loading submissions..."}):l.length===0?s.jsx("p",{className:"text-center text-gray-500 py-10",children:"No students in this batch."}):s.jsx("div",{className:"space-y-3",children:l.map(p=>{const m=c(p.id),B=a[p.id];return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:p.name}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:p.rollNumber})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${h(m)}`,children:m})]}),B&&s.jsxs("div",{className:"mt-3 pt-3 border-t dark:border-gray-700 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("a",{href:B.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:"View Submission"}),s.jsxs("p",{className:"text-xs text-gray-400",children:["Submitted on: ",B.submittedAt.toDate().toLocaleDateString()]})]}),m==="Submitted"&&s.jsx("button",{onClick:()=>d(p.id),className:"px-3 py-1 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700",children:"Mark as Checked"})]})]},p.id)})})})]})}const o4=({quiz:t,onNavigate:e,onDelete:n,onShowDevPopup:r})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-teal-500",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]})]}),s.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-semibold bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200",children:t.status})]}),s.jsxs("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-300",children:[s.jsxs("p",{children:["Date: ",t.dateTime.toDate().toLocaleString("en-GB")]}),s.jsxs("p",{children:["Duration: ",t.duration," mins | Marks: ",t.totalMarks]})]}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex flex-wrap justify-end gap-2",children:[s.jsx("button",{onClick:()=>e("quiz-results",{quizId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors",children:s.jsx("span",{children:"View Results"})}),s.jsxs("button",{onClick:()=>e("edit-quiz",{quizId:t.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsx("button",{onClick:()=>n(t.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 dark:bg-red-900/40 rounded-md hover:bg-red-200 dark:hover:bg-red-900/60 transition-colors",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]});function l4({onBack:t,quizzes:e,onNavigate:n,staffPermissions:r,onDelete:a,onShowDevPopup:i}){const[A,o]=q.useState("upcoming"),l=new Date,c=e.filter(m=>{var B;return r?!!((B=r[m.batchId])!=null&&B.onlineQuiz):!0}),d=c.filter(m=>m.dateTime.toDate()>=l).sort((m,B)=>m.dateTime.toMillis()-B.dateTime.toMillis()),h=c.filter(m=>m.dateTime.toDate()<l).sort((m,B)=>B.dateTime.toMillis()-m.dateTime.toMillis()),p=A==="upcoming"?d:h;return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Manage Quizzes"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>o("upcoming"),className:`w-full py-2 rounded-md font-semibold ${A==="upcoming"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>o("completed"),className:`w-full py-2 rounded-md font-semibold ${A==="completed"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Completed"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:p.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",A," quizzes found."]}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to create one."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:p.map(m=>s.jsx(o4,{quiz:m,onNavigate:n,onDelete:a,onShowDevPopup:i},m.id))})}),s.jsx("button",{onClick:()=>n("create-quiz"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Create New Quiz",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}const c4=({question:t,index:e,onUpdate:n,onRemove:r})=>{const a=(i,A)=>{const o=[...t.options];o[i]=A,n(t.id,"options",o)};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("h4",{className:"font-bold text-gray-700 dark:text-gray-200",children:["Question ",e+1]}),s.jsx("button",{type:"button",onClick:()=>r(t.id),className:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100 dark:hover:bg-red-900/40",children:s.jsx(Qn,{className:"w-5 h-5"})})]}),s.jsx("textarea",{placeholder:"Enter question text...",value:t.questionText,onChange:i=>n(t.id,"questionText",i.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 mb-3",rows:3}),s.jsx("div",{className:"space-y-2",children:t.options.map((i,A)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"radio",name:`correct-answer-${t.id}`,checked:t.correctAnswerIndex===A,onChange:()=>n(t.id,"correctAnswerIndex",A),className:"form-radio text-indigo-600"}),s.jsx("input",{type:"text",placeholder:`Option ${A+1}`,value:i,onChange:o=>a(A,o.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"})]},A))})]})};function d4({onBack:t,onSave:e,batches:n,quiz:r,staffPermissions:a}){const i=!!r,[A,o]=q.useState({title:(r==null?void 0:r.title)||"",batchId:(r==null?void 0:r.batchId)||"",subject:(r==null?void 0:r.subject)||"",date:(r==null?void 0:r.dateTime.toDate().toISOString().split("T")[0])||"",time:(r==null?void 0:r.dateTime.toDate().toTimeString().substring(0,5))||"",duration:String((r==null?void 0:r.duration)||""),totalMarks:String((r==null?void 0:r.totalMarks)||""),instructions:(r==null?void 0:r.instructions)||""}),[l,c]=q.useState((r==null?void 0:r.questions)||[]),[d,h]=q.useState(!1),p=n.filter(N=>{var k;return N.isActive?a?!!((k=a[N.id])!=null&&k.onlineQuiz):!0:!1}),m=N=>{o(k=>({...k,[N.target.name]:N.target.value}))},B=()=>{const N={id:`${Date.now()}`,questionText:"",options:["","","",""],correctAnswerIndex:0};c(k=>[...k,N])},y=N=>{c(k=>k.filter(E=>E.id!==N))},b=(N,k,E)=>{c(_=>_.map(M=>M.id===N?{...M,[k]:E}:M))},C=async N=>{if(N.preventDefault(),!A.batchId||!A.date||!A.time||!A.title||!A.subject||!A.duration||!A.totalMarks){alert("Please fill all required fields.");return}if(l.length===0){alert("Please add at least one question.");return}h(!0);try{const k=n.find(_=>_.id===A.batchId),E=Lt.fromDate(new Date(`${A.date}T${A.time}`));await e({title:A.title,batchId:A.batchId,batchName:(k==null?void 0:k.name)||"Unknown Batch",subject:A.subject,dateTime:E,duration:Number(A.duration),totalMarks:Number(A.totalMarks),instructions:A.instructions,questions:l,status:(r==null?void 0:r.status)||"Draft"})}catch(k){alert(k.message),h(!1)}};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:i?"Edit Quiz":"Create New Quiz"})]}),s.jsxs("form",{onSubmit:C,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx("input",{type:"text",name:"title",placeholder:"Quiz Title",value:A.title,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsx(On,{label:"Batch / Class",options:p.map(N=>({value:N.id,label:N.name})),selectedValue:A.batchId,onSelect:N=>o(k=>({...k,batchId:N})),placeholder:"Select a batch"}),s.jsx("input",{type:"text",name:"subject",placeholder:"Subject",value:A.subject,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"date",name:"date","aria-label":"Quiz Date",value:A.date,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsx("input",{type:"time",name:"time","aria-label":"Quiz Time",value:A.time,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"number",name:"duration",placeholder:"Duration (mins)",value:A.duration,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsx("input",{type:"number",name:"totalMarks",placeholder:"Total Marks",value:A.totalMarks,onChange:m,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"})]}),s.jsx("textarea",{name:"instructions",placeholder:"Instructions (Optional)",value:A.instructions,onChange:m,rows:3,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsxs("div",{className:"border-t pt-4 mt-4 dark:border-gray-700",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Questions"}),s.jsx("div",{className:"space-y-4",children:l.map((N,k)=>s.jsx(c4,{question:N,index:k,onUpdate:b,onRemove:y},N.id))}),s.jsxs("button",{type:"button",onClick:B,className:"w-full mt-4 flex items-center justify-center gap-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 font-semibold py-2.5 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600",children:[s.jsx(Lr,{className:"w-5 h-5"}),"Add Question"]})]})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:d,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:d?"Saving...":i?"Update Quiz":"Save Quiz"})})]})]})}function u4({onBack:t,quiz:e,submissions:n,students:r}){const a=[...n].sort((A,o)=>o.score-A.score),i=A=>{const o=r.find(l=>l.id===A);return(o==null?void 0:o.photo)||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent((o==null?void 0:o.name)||" ")}`};return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h1",{className:"text-xl font-bold",children:"Quiz Results"}),s.jsx("p",{className:"text-sm opacity-90",children:e.title})]})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsx("h2",{className:"text-lg font-bold text-center mb-4 text-gray-800 dark:text-gray-100",children:"Leaderboard"}),a.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No submissions yet for this quiz."})}):s.jsx("div",{className:"space-y-3",children:a.map((A,o)=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center space-x-4",children:[s.jsx("span",{className:"font-bold text-lg text-gray-500 dark:text-gray-400 w-6 text-center",children:o+1}),s.jsx("img",{src:i(A.studentId),alt:A.studentName,className:"w-10 h-10 rounded-full object-cover bg-gray-200"}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:A.studentName}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:A.studentRollNumber})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-xl text-indigo-600 dark:text-indigo-400",children:A.score.toFixed(2)}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["/ ",A.totalMarks]})]})]},A.id))})]})]})}const f4=({request:t,onUpdateStatus:e})=>{var n;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.userName}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.userRole==="student"?`Roll No: ${t.userRollNumber}`:"Staff"})]}),s.jsxs("div",{className:"text-right text-xs",children:[s.jsxs("p",{children:["From: ",t.fromDate.toDate().toLocaleDateString()]}),s.jsxs("p",{children:["To: ",t.toDate.toDate().toLocaleDateString()]})]})]}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2 italic",children:['"',t.reason,'"']}),t.attachmentUrl&&s.jsxs("a",{href:t.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:[s.jsx(Ad,{className:"w-4 h-4"}),s.jsx("span",{children:"View Attachment"})]}),t.status==="Pending"&&s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-end space-x-2",children:[s.jsxs("button",{onClick:()=>e(t.id,"Rejected"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 rounded-md hover:bg-red-200",children:[s.jsx(In,{className:"w-4 h-4"})," Reject"]}),s.jsxs("button",{onClick:()=>e(t.id,"Approved"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700",children:[s.jsx(di,{className:"w-4 h-4"})," Approve"]})]}),t.status!=="Pending"&&s.jsxs("div",{className:"border-t dark:border-gray-700 mt-2 pt-2 text-xs text-gray-500 dark:text-gray-400",children:["Reviewed by ",t.reviewedBy," on ",(n=t.reviewedAt)==null?void 0:n.toDate().toLocaleDateString()]})]})};function h4({onBack:t,leaveRequests:e,students:n,staff:r,currentUser:a,batches:i,onUpdateStatus:A}){const[o,l]=q.useState("Pending"),c=q.useMemo(()=>{let d=e;if(a.role==="staff"){const h=a.data,p=Object.keys(h.batchAccess||{}).filter(y=>{var b;return(b=h.batchAccess[y])==null?void 0:b.leaveRequests}),m=new Set(i.filter(y=>p.includes(y.id)).map(y=>y.name)),B=new Set(n.filter(y=>y.batches.some(b=>m.has(b))).map(y=>y.id));d=e.filter(y=>y.userRole==="student"&&B.has(y.userId))}return d.filter(h=>h.status===o).sort((h,p)=>p.requestedAt.toMillis()-h.requestedAt.toMillis())},[e,a,n,i,o]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Leave Manager"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsx("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:["Pending","Approved","Rejected"].map(d=>s.jsx("button",{onClick:()=>l(d),className:`w-full py-2 rounded-md font-semibold ${o===d?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:d},d))})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:c.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",o.toLowerCase()," requests found."]})}):s.jsx("div",{className:"space-y-3",children:c.map(d=>s.jsx(f4,{request:d,onUpdateStatus:A},d.id))})})]})}const g4=["Low","Medium","High"],m4=({onClose:t,onSave:e,staff:n,taskToEdit:r,isDemoMode:a})=>{const i=!!r,[A,o]=q.useState({title:(r==null?void 0:r.title)||"",description:(r==null?void 0:r.description)||"",assignedToId:(r==null?void 0:r.assignedToId)||"",dueDate:(r==null?void 0:r.dueDate.toDate().toISOString().split("T")[0])||"",priority:(r==null?void 0:r.priority)||"Medium"}),[l,c]=q.useState(!1),d=p=>{o(m=>({...m,[p.target.name]:p.target.value}))},h=async p=>{if(p.preventDefault(),a){alert("This is a demo. Data cannot be saved.");return}if(!A.title||!A.dueDate){alert("Title and Due Date are required.");return}c(!0);const m=n.find(B=>B.id===A.assignedToId);try{await e({title:A.title,description:A.description,assignedToId:m==null?void 0:m.id,assignedToName:m==null?void 0:m.name,dueDate:A.dueDate,priority:A.priority},r==null?void 0:r.id),t()}catch(B){console.error(B),alert("Failed to save task.")}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-lg mx-auto flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:i?"Edit Task":"New Task"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:h,className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[s.jsx("input",{type:"text",name:"title",placeholder:"Task Title",value:A.title,onChange:d,required:!0,className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"}),s.jsx("textarea",{name:"description",placeholder:"Description (optional)",value:A.description,onChange:d,rows:4,className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"}),s.jsx("input",{type:"date",name:"dueDate",value:A.dueDate,onChange:d,required:!0,className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"}),s.jsx(On,{label:"Priority",options:g4.map(p=>({value:p,label:p})),selectedValue:A.priority,onSelect:p=>o(m=>({...m,priority:p}))}),s.jsx(On,{label:"Assign To (Optional)",options:n.map(p=>({value:p.id,label:p.name})),selectedValue:A.assignedToId,onSelect:p=>o(m=>({...m,assignedToId:p})),placeholder:"Unassigned"}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 rounded-lg bg-gray-200 dark:bg-gray-600 font-bold",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2.5 rounded-lg bg-indigo-600 text-white font-bold disabled:bg-indigo-300",children:l?"Saving...":"Save Task"})]})]})]})})},p4=({task:t,onToggleStatus:e,onEdit:n,onDelete:r})=>{const a=t.dueDate.toDate()<new Date&&t.status==="Pending",i={High:"border-red-500",Medium:"border-yellow-500",Low:"border-blue-500"};return s.jsx("div",{className:`bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 ${i[t.priority]}`,children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("button",{onClick:()=>e(t.id,t.status),className:`w-6 h-6 rounded-md flex-shrink-0 mt-1 border-2 flex items-center justify-center ${t.status==="Completed"?"bg-indigo-600 border-indigo-600":"border-gray-300"}`,children:t.status==="Completed"&&s.jsx(di,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("p",{className:`font-semibold text-gray-800 dark:text-gray-100 ${t.status==="Completed"?"line-through text-gray-500":""}`,children:t.title}),t.description&&s.jsx("p",{className:`text-sm text-gray-500 dark:text-gray-400 ${t.status==="Completed"?"line-through":""}`,children:t.description}),s.jsxs("div",{className:"text-xs mt-2 flex flex-wrap gap-x-3 gap-y-1",children:[s.jsxs("span",{className:`font-medium ${a?"text-red-600":"text-gray-500"}`,children:["Due: ",t.dueDate.toDate().toLocaleDateString()]}),t.assignedToName&&s.jsxs("span",{className:"text-gray-500",children:["To: ",t.assignedToName]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("button",{onClick:()=>n(t),className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:s.jsx(Gn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>r(t.id),className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]})})};function x4({onBack:t,tasks:e,staff:n,onSaveTask:r,onToggleTaskStatus:a,onDeleteTask:i,isDemoMode:A}){const[o,l]=q.useState(!1),[c,d]=q.useState(null),[h,p]=q.useState("Pending"),m=q.useMemo(()=>e.filter(b=>b.status===h).sort((b,C)=>b.dueDate.toMillis()-C.dueDate.toMillis()),[e,h]),B=b=>{d(b),l(!0)},y=()=>{d(null),l(!0)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"To-Do List"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>p("Pending"),className:`w-full py-2 rounded-md font-semibold ${h==="Pending"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Pending"}),s.jsx("button",{onClick:()=>p("Completed"),className:`w-full py-2 rounded-md font-semibold ${h==="Completed"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Completed"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:m.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",h.toLowerCase()," tasks."]}),h==="Pending"&&s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to add one."]})]}):s.jsx("div",{className:"space-y-3 pb-20",children:m.map(b=>s.jsx(p4,{task:b,onToggleStatus:a,onEdit:B,onDelete:i},b.id))})}),s.jsx("button",{onClick:y,className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110","aria-label":"Add New Task",children:s.jsx(Lr,{className:"w-8 h-8"})})]}),o&&s.jsx(m4,{onClose:()=>l(!1),onSave:r,staff:n,taskToEdit:c,isDemoMode:A})]})}const w4=["All","Students","Staff"],y4=({onClose:t,onSave:e,noticeToEdit:n,isDemoMode:r,academyId:a})=>{const i=!!n,[A,o]=q.useState({title:(n==null?void 0:n.title)||"",description:(n==null?void 0:n.description)||"",targetAudience:(n==null?void 0:n.targetAudience)||"All",expiryDate:(n==null?void 0:n.expiryDate.toDate().toISOString().split("T")[0])||""}),[l,c]=q.useState(null),[d,h]=q.useState(!1),[p,m]=q.useState(0),B=C=>{o(N=>({...N,[C.target.name]:C.target.value}))},y=C=>{C.target.files&&C.target.files[0]&&c(C.target.files[0])},b=async C=>{if(C.preventDefault(),r){alert("This is a demo. Data cannot be saved.");return}if(!A.title||!A.description||!A.expiryDate){alert("Title, Description, and Expiry Date are required.");return}h(!0);try{let N=n==null?void 0:n.attachmentUrl,k=n==null?void 0:n.attachmentName,E=n==null?void 0:n.storagePath;if(l){E=`academies/${a}/notice_attachments/${Date.now()}_${l.name}`;const _=Ea(ka,E),M=qo(_,l);await new Promise((D,U)=>{M.on("state_changed",j=>m(j.bytesTransferred/j.totalBytes*100),j=>{console.error("Upload failed:",j),alert("File upload failed."),U(j)},async()=>{N=await zo(M.snapshot.ref),k=l.name,D()})})}await e({...A,targetAudience:A.targetAudience,expiryDate:A.expiryDate,attachmentUrl:N,attachmentName:k,storagePath:E},n==null?void 0:n.id),t()}catch(N){console.error(N),alert("Failed to save notice.")}finally{h(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-lg mx-auto flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:i?"Edit Notice":"New Notice"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:b,className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[s.jsx("input",{type:"text",name:"title",placeholder:"Notice Title",value:A.title,onChange:B,required:!0,className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"}),s.jsx("textarea",{name:"description",placeholder:"Message / Description",value:A.description,onChange:B,rows:5,required:!0,className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"}),s.jsx(On,{label:"Target Audience",options:w4.map(C=>({value:C,label:C})),selectedValue:A.targetAudience,onSelect:C=>o(N=>({...N,targetAudience:C}))}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Expiry Date"}),s.jsx("input",{type:"date",name:"expiryDate",value:A.expiryDate,onChange:B,required:!0,className:"w-full mt-1 p-3 bg-gray-50 dark:bg-gray-700 border rounded-lg"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"file-upload",className:"w-full p-3 bg-gray-50 dark:bg-gray-700 border-2 border-dashed rounded-lg flex flex-col items-center cursor-pointer hover:border-indigo-500",children:[s.jsx("span",{className:"text-indigo-600 font-semibold",children:"Attach File (Optional)"}),l&&s.jsx("span",{className:"text-sm text-gray-500 mt-1",children:l.name}),i&&!l&&(n==null?void 0:n.attachmentName)&&s.jsxs("span",{className:"text-sm text-gray-500 mt-1",children:["Current: ",n.attachmentName]})]}),s.jsx("input",{id:"file-upload",type:"file",onChange:y,className:"hidden"})]}),d&&l&&s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${p}%`}})}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 rounded-lg bg-gray-200 dark:bg-gray-600 font-bold",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2.5 rounded-lg bg-indigo-600 text-white font-bold disabled:bg-indigo-300",children:d?"Saving...":"Save Notice"})]})]})]})})},b4=({notice:t,onEdit:e,onDelete:n})=>s.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:s.jsxs("div",{className:"flex justify-between items-start gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Expires: ",t.expiryDate.toDate().toLocaleDateString()," | For: ",t.targetAudience]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:t.description}),t.attachmentUrl&&s.jsxs("a",{href:t.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:[s.jsx(UA,{className:"w-4 h-4"}),s.jsx("span",{children:t.attachmentName||"View Attachment"})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("button",{onClick:()=>e(t),className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:s.jsx(Gn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>n(t.id),className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]})});function v4({onBack:t,notices:e,onSaveNotice:n,onDeleteNotice:r,isDemoMode:a,academyId:i}){const[A,o]=q.useState(!1),[l,c]=q.useState(null),[d,h]=q.useState("Active"),p=q.useMemo(()=>{const y=new Date;return e.filter(b=>d==="Active"?b.expiryDate.toDate()>=y:b.expiryDate.toDate()<y).sort((b,C)=>C.createdAt.toMillis()-b.createdAt.toMillis())},[e,d]),m=y=>{c(y),o(!0)},B=()=>{c(null),o(!0)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Notice Board"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>h("Active"),className:`w-full py-2 rounded-md font-semibold ${d==="Active"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Active"}),s.jsx("button",{onClick:()=>h("Expired"),className:`w-full py-2 rounded-md font-semibold ${d==="Expired"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Expired"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:p.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",d.toLowerCase()," notices."]}),d==="Active"&&s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to add one."]})]}):s.jsx("div",{className:"space-y-3 pb-20",children:p.map(y=>s.jsx(b4,{notice:y,onEdit:m,onDelete:()=>r(y)},y.id))})}),s.jsx("button",{onClick:B,className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110","aria-label":"Add New Notice",children:s.jsx(Lr,{className:"w-8 h-8"})})]}),A&&s.jsx(y4,{onClose:()=>o(!1),onSave:n,noticeToEdit:l,isDemoMode:a,academyId:i})]})}const B4=({type:t,data:e,time:n,onNavigate:r})=>{let a=null,i=null,A="dashboard";switch(t){case"enquiry":const o=e;a=s.jsxs("p",{children:["New Enquiry from ",s.jsx("strong",{children:o.studentName})," for batch ",o.interestedBatch,"."]}),i=s.jsx(gf,{className:"w-5 h-5 text-blue-500"}),A="enquiry-manager";break;case"leave":const l=e;a=s.jsxs("p",{children:["New Leave Request from ",s.jsx("strong",{children:l.userName}),"."]}),i=s.jsx(Zs,{className:"w-5 h-5 text-orange-500"}),A="leave-manager";break;case"attendance":const c=e;a=s.jsxs("p",{children:["Attendance for batch ",s.jsx("strong",{children:c.name})," has not been marked for today."]}),i=s.jsx(Xs,{className:"w-5 h-5 text-purple-500"}),A="select-batch-attendance";break;case"schedule":const d=e;a=s.jsxs("p",{children:[s.jsx("strong",{children:"Schedule Alert:"})," ",d.message]}),i=s.jsx(pi,{className:"w-5 h-5 text-pink-500"}),A="schedule-classes";break;default:return null}return s.jsxs("button",{onClick:()=>r(A),className:"w-full text-left bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:i}),s.jsxs("div",{className:"flex-1",children:[a,s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:n.toLocaleString()})]})]})};function C4({onBack:t,enquiries:e,leaveRequests:n,unmarkedAttendanceBatches:r,scheduleAlerts:a,onNavigate:i}){const A=[...e.map(o=>({type:"enquiry",data:o,time:o.createdAt.toDate()})),...n.map(o=>({type:"leave",data:o,time:o.requestedAt.toDate()})),...r.map(o=>({type:"attendance",data:o,time:new Date})),...a].sort((o,l)=>l.time.getTime()-o.time.getTime());return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Notifications"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:A.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No new notifications."})}):s.jsx("div",{className:"space-y-3",children:A.map((o,l)=>s.jsx(B4,{type:o.type,data:o.data,time:o.time,onNavigate:i},`${o.type}-${o.data.id||l}`))})})]})}function N4({studentName:t,academyLogoUrl:e,onToggleNav:n,theme:r,onToggleTheme:a}){const[i,A]=be.useState("");return be.useEffect(()=>{const o=new Date().getHours();o<12?A("Good Morning"):o<17?A("Good Afternoon"):A("Good Evening")},[]),s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md sticky top-0 z-30",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-1","aria-label":"Open menu",children:s.jsx(uf,{className:"w-6 h-6"})}),e&&s.jsx("img",{src:e,alt:"Academy Logo",className:"w-8 h-8 rounded-full object-cover ml-3"}),s.jsxs("h1",{className:"text-xl font-bold ml-3",children:[i,", ",t,"!"]})]}),s.jsx("button",{onClick:a,className:"text-indigo-200 hover:text-white transition-colors p-2","aria-label":"Toggle dark mode",children:r==="light"?s.jsx(df,{className:"w-6 h-6"}):s.jsx(ff,{className:"w-6 h-6"})})]})}const S4=({name:t,Icon:e,color:n,onClick:r})=>{const a=!!r,i=A=>{r&&(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),r())};return s.jsxs("div",{className:`flex flex-col items-center justify-start group ${a?"cursor-pointer":""}`,onClick:r,onKeyDown:i,role:a?"button":void 0,tabIndex:a?0:void 0,"aria-label":a?t:void 0,children:[s.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center text-white shadow-md transform group-hover:scale-110 transition-transform duration-200 ${n}`,children:s.jsx(e,{className:"w-8 h-8"})}),s.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:t})]})},Sx=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 3L2 12h3v8h14v-8h3L12 3zm0 2.69L17.31 11H6.69L12 5.69zM18 18H6v-6h12v6zm-4-4h-4v2h4v-2z"})}),Ix=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),s.jsx("path",{d:"m18.3 14.71-3.59 3.59c-.39.39-1.02.39-1.41 0l-1.7-1.7c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l1 1 2.88-2.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.03 0 1.41z"})]}),Fx=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M15 8H8v2h7V8zm-4.5 3c-1.38 0-2.5 1.12-2.5 2.5s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5-1.12-2.5-2.5-2.5zM20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm-8-7.5c2.07 0 3.75-1.68 3.75-3.75S14.07 3 12 3s-3.75 1.68-3.75 3.75 1.68 3.75 3.75 3.75z"})}),Ex=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 3L2 12h3v8h5v-6h4v6h5v-8h3L12 3zm-2 15h-2v-4h2v4zm4 0h-2v-4h2v4z"})}),I4=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),kx=t=>s.jsxs("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("path",{d:"M19 2H5C3.9 2 3 2.9 3 4v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 18H7v-2h2v2zm0-4H7v-2h2v2zm0-4H7V8h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V8h2v2zm-4 4h-2v-2h2v2zm0-4h-2V8h2v2z"}),s.jsx("path",{d:"M0 0h24v24H0z",fill:"none"})]}),Jg=t=>{if(!t)return"--:--";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`},Ux=({schedule:t,onClose:e,isLoading:n})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-md mx-auto flex flex-col max-h-[90vh]",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4 text-center",children:"Today's Schedule"}),s.jsx("div",{className:"flex-grow overflow-y-auto pr-2 space-y-3",children:n?s.jsx(Ar,{message:"Loading schedule..."}):t&&t.length>0?t.map(r=>s.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-4 ${r.type==="class"?"bg-blue-50 dark:bg-blue-900/40":"bg-yellow-50 dark:bg-yellow-900/40"}`,children:[s.jsxs("div",{className:"text-center w-20 flex-shrink-0",children:[s.jsx("p",{className:"font-semibold text-sm text-gray-700 dark:text-gray-200",children:Jg(r.startTime)}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"to"}),s.jsx("p",{className:"font-semibold text-sm text-gray-700 dark:text-gray-200",children:Jg(r.endTime)})]}),r.type==="class"?s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:r.subject}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["by ",r.teacherName]})]}):s.jsxs("p",{className:"font-bold text-yellow-800 dark:text-yellow-300 flex items-center gap-2",children:[s.jsx(Yo,{className:"w-5 h-5"}),r.breakType]})]},r.id)):s.jsxs("div",{className:"text-center py-10",children:[s.jsx(Mc,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"No classes scheduled for today."})]})}),s.jsx("div",{className:"mt-6 flex-shrink-0",children:s.jsx("button",{onClick:e,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"OK"})})]})}),F4=({pendingMonths:t,totalDue:e,studentFeeType:n,onClose:r,onNavigate:a})=>{const i=()=>{a("fee-status"),r()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Jo,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-3",children:"Fee Reminder"}),s.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["You have pending fees for the following ",n==="Yearly"?"year(s)":"month(s)",":"]}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-left text-sm mb-4",children:s.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.map(A=>{const o=new Date(A+"-02"),l=n==="Yearly"?o.getFullYear():o.toLocaleString("default",{month:"long",year:"numeric"});return s.jsx("li",{children:l},A)})})}),s.jsxs("div",{className:"text-lg font-bold mb-6",children:["Total Amount Due: ",s.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["â‚¹",e.toFixed(2)]})]}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("button",{onClick:i,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Pay Now"}),s.jsx("button",{onClick:r,className:"w-full bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500",children:"Close"})]})]})})},E4=[{name:"My Academy",Icon:Sx,color:"bg-cyan-500"},{name:"Attendance",Icon:Ix,color:"bg-purple-500"},{name:"Timetable",Icon:pi,color:"bg-pink-500"},{name:"Tuition Fees",Icon:Fx,color:"bg-green-500"},{name:"Exams",Icon:mi,color:"bg-lime-500"},{name:"Study Material",Icon:kx,color:"bg-gray-700"},{name:"Homework",Icon:Ex,color:"bg-teal-500"},{name:"Online Quiz",Icon:I4,color:"bg-red-500"},{name:"My Leave",Icon:Zs,color:"bg-blue-500"},{name:"Notice Board",Icon:EA,color:"bg-cyan-600"},{name:"Transport",Icon:Gc,color:"bg-amber-500"}],k4=(t,e)=>{if(!t.admissionDate||!t.feeType)return[];const n=[],r=new Date(t.admissionDate),a=new Date;if(t.feeType==="Monthly"){let i=new Date(r.getFullYear(),r.getMonth(),1);for(;i<=a;){const A=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;e.has(A)||n.push(A),i.setMonth(i.getMonth()+1)}}else{let i=new Date(r.getFullYear(),r.getMonth(),1);for(;i<=a;){const A=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;e.has(A)||n.push(A),i.setFullYear(i.getFullYear()+1)}}return n};function Wg({student:t,academy:e,feeCollections:n,batches:r,onNavigate:a,onToggleNav:i,theme:A,onToggleTheme:o,onShowDevPopup:l}){const[c,d]=q.useState(!1),[h,p]=q.useState(!1),[m,B]=q.useState(null),[y,b]=q.useState(!0),[C,N]=q.useState(null),k=t.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(t.name)}`;q.useEffect(()=>{const D=async()=>{const O=r.filter(P=>t.batches.includes(P.name)).map(P=>P.id);if(O.length===0)return null;const F=O[0],I=new Date().toISOString().split("T")[0];try{const P=Xe(Te,`academies/${e.id}/schedules/${I}`),V=await Sn(P);if(V.exists()){const X=V.data()[F]||[];return X.sort((le,ae)=>le.startTime.localeCompare(ae.startTime)),X}return[]}catch(P){return console.error("Error fetching schedule for popup:",P),null}},U=()=>{const O=new Set(n.map(I=>I.feeForMonth)),F=k4(t,O);if(F.length>0){const I=F.length*((t.feeAmount||0)+(t.transportFee||0));return{months:F,total:I}}return null};(async()=>{if(sessionStorage.getItem("dashboardPopupsShown")==="true"){b(!1);return}const O=await D(),F=U();B(O),N(F),b(!1),O!==null?d(!0):F&&p(!0),sessionStorage.setItem("dashboardPopupsShown","true")})()},[t,e.id,r,n]);const E=()=>{d(!1),C&&p(!0)},_=D=>{switch(D){case"Tuition Fees":return()=>a("fee-status");case"My Academy":return()=>a("my-academy");case"Attendance":return()=>a("attendance");case"Timetable":return()=>a("timetable");case"Exams":return()=>a("student-exams");case"Study Material":return()=>a("student-study-material");case"Homework":return()=>a("student-homework");case"Online Quiz":return()=>a("student-quizzes");case"My Leave":return()=>a("my-leave");case"Notice Board":return()=>a("student-notice-board");case"Transport":return()=>a("student-transport");default:return()=>l(D)}},M=E4.filter(D=>D.name!=="Transport"||t.transportRouteId);return s.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 h-full font-sans flex flex-col",children:[s.jsx(N4,{studentName:t.name,academyLogoUrl:e.logoUrl,onToggleNav:i,theme:A,onToggleTheme:o}),s.jsxs("main",{className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-900 to-blue-700 text-white",children:[s.jsx("p",{className:"text-xs font-bold opacity-80",children:"CLASS CAPTAIN"}),s.jsx("h2",{className:"text-lg font-bold",children:"ADMISSIONS OPEN FOR"}),s.jsx("h3",{className:"text-2xl font-extrabold text-yellow-300",children:"II PUC COMMERCE"}),s.jsx("p",{className:"text-sm font-semibold",children:"FOR YEAR 2025-26"})]}),s.jsxs("div",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:[s.jsx("p",{className:"font-bold mb-2 text-gray-800 dark:text-gray-100",children:"WHAT'S SPECIAL?"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[s.jsx("li",{children:"Individual Attention"}),s.jsx("li",{children:"Experienced Faculty"}),s.jsx("li",{children:"Best Study Material"}),s.jsx("li",{children:"Shortcut Techniques"}),s.jsx("li",{children:"MONTHLY FEE STRUCTURE"})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 flex items-center space-x-4",children:[s.jsx("img",{src:k,alt:t.name,className:"w-16 h-16 rounded-full object-cover border-2 border-cyan-500 bg-gray-200"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:t.name.toUpperCase()}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",t.batches.join(", "),")"]})]})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4",children:s.jsx("div",{className:"grid grid-cols-3 gap-y-6 text-center",children:M.map(D=>s.jsx(S4,{...D,onClick:_(D.name)},D.name))})})]}),c&&s.jsx(Ux,{schedule:m,onClose:E,isLoading:y}),h&&C&&s.jsx(F4,{pendingMonths:C.months,totalDue:C.total,studentFeeType:t.feeType,onClose:()=>p(!1),onNavigate:a})]})}const U4=(t,e)=>{const n=[];if(!t.admissionDate||!t.feeType)return n;const r=new Map;e.forEach(A=>{r.set(A.feeForMonth,A)});const a=new Date(t.admissionDate),i=new Date;if(t.feeType==="Monthly"){let A=new Date(a.getFullYear(),a.getMonth(),1);for(;A<=i;){const o=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`;r.has(o)?n.push({month:o,status:"Paid",details:r.get(o)}):n.push({month:o,status:"Pending",details:null}),A.setMonth(A.getMonth()+1)}}else{let A=new Date(a.getFullYear(),a.getMonth(),1);for(;A<=i;){const o=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`;r.has(o)?n.push({month:o,status:"Paid",details:r.get(o)}):n.push({month:o,status:"Pending",details:null}),A.setFullYear(A.getFullYear()+1)}}return n.reverse()};function j4({student:t,feeCollections:e,onBack:n}){const r=U4(t,e);return s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("div",{className:"flex-shrink-0 sticky top-0 z-10",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Tuition Fee Status"})]}),s.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:t.name}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.rollNumber}),s.jsxs("p",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-semibold mt-1",children:[t.feeType," Fee: â‚¹",t.feeAmount||0]})]})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:r.length>0?s.jsx("div",{className:"space-y-3",children:r.map(({month:a,status:i,details:A})=>{var d;const o=new Date(a+"-02");let l;if(t.feeType==="Yearly"){const h=new Date(o);h.setFullYear(h.getFullYear()+1),h.setDate(h.getDate()-1),l=`Year: ${o.getFullYear()} - ${h.getFullYear()}`}else l=o.toLocaleString("default",{month:"long",year:"numeric"});const c=i==="Paid";return s.jsxs("div",{className:`bg-white p-4 rounded-lg shadow-sm border-l-4 ${c?"border-green-500":"border-red-500"}`,children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{className:"font-semibold text-gray-800",children:l}),s.jsx("div",{className:`text-sm font-bold px-2 py-0.5 rounded-full ${c?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i})]}),s.jsx("div",{className:"mt-2 text-sm text-gray-600 border-t pt-2",children:c&&A?s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Amount Paid: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["â‚¹",A.amountPaid.toFixed(2)]})]}),s.jsxs("p",{children:["Payment Date: ",s.jsx("span",{className:"font-semibold text-gray-900",children:A.paymentDate.toDate().toLocaleDateString("en-GB")})]}),A.discount>0&&s.jsxs("p",{className:"text-orange-600",children:["Discount: ",s.jsxs("span",{className:"font-semibold",children:["â‚¹",A.discount.toFixed(2)]})]})]}):s.jsxs("p",{children:["Amount Due: ",s.jsxs("span",{className:"font-semibold text-red-700",children:["â‚¹",((d=t.feeAmount)==null?void 0:d.toFixed(2))||"0.00"]})]})})]},a)})}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No fee records found."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Your fee history will appear here once payments are recorded."})]})})]})}function T4({isOpen:t,onClose:e,onNavigate:n,onLogout:r}){const a=i=>{n(i),e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-30 transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true"}),s.jsx("aside",{className:`fixed top-0 left-0 h-full w-72 bg-white shadow-xl z-40 transform transition-transform duration-300 ease-in-out ${t?"translate-x-0":"-translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidenav-title",children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hi,{className:"w-8 h-8 text-indigo-600"}),s.jsx("h2",{id:"sidenav-title",className:"text-lg font-bold text-gray-800",children:"Class Captain"})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Close menu",children:s.jsx(In,{className:"w-6 h-6 text-gray-600"})})]}),s.jsx("nav",{className:"flex-grow py-4",children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("my-academy"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Sx,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"My Academy"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("timetable"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(pi,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Timetable"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("attendance"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Ix,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Attendance"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("fee-status"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Fx,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Fee Status"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("student-exams"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(mi,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Exams"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("student-study-material"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(kx,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Study Material"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("student-homework"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Ex,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Homework"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("my-leave"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Zs,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"My Leave"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("student-notice-board"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(EA,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Notice Board"})]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>a("student-transport"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(Gc,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Transport"})]})})]})}),s.jsx("footer",{className:"p-4 border-t mt-auto",children:s.jsxs("button",{onClick:r,className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors rounded-lg",children:[s.jsx(Wo,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Logout"})]})})]})})]})}const No=({icon:t,label:e,value:n})=>n?s.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"text-gray-400 mt-1 flex-shrink-0",children:t}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 font-medium",children:e}),s.jsx("p",{className:"text-gray-800 break-words",children:n})]})]}):null;function Q4({academy:t,onBack:e}){return s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"My Academy"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6 text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-indigo-800",children:t.name}),s.jsxs("p",{className:"text-gray-500",children:["Academy ID: ",t.academyId]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(No,{icon:s.jsx(SA,{className:"w-5 h-5"}),label:"Contact Email",value:t.contactEmail}),s.jsx(No,{icon:s.jsx(Ua,{className:"w-5 h-5"}),label:"Contact Phone",value:t.contactPhone}),t.contactPhoneAlt&&s.jsx(No,{icon:s.jsx(Ua,{className:"w-5 h-5"}),label:"Alternative Phone",value:t.contactPhoneAlt}),s.jsx(No,{icon:s.jsx($u,{className:"w-5 h-5"}),label:"Website",value:t.website}),s.jsx(No,{icon:s.jsx(ks,{className:"w-5 h-5"}),label:"Address",value:t.address})]})]})]})}const jx=({status:t})=>{switch(t){case"Present":return s.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500 flex items-center justify-center","aria-label":"Present",children:s.jsx(di,{className:"w-4 h-4 text-white"})});case"Absent":return s.jsx("div",{className:"w-6 h-6 rounded-full bg-red-500 flex items-center justify-center","aria-label":"Absent",children:s.jsx(In,{className:"w-4 h-4 text-white",strokeWidth:3})});case"Leave":return s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-400 flex items-center justify-center","aria-label":"Leave",children:s.jsx(di,{className:"w-4 h-4 text-white"})});case"Holiday":return s.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-500 flex items-center justify-center","aria-label":"Holiday",children:s.jsx(di,{className:"w-4 h-4 text-white"})});default:return null}},sc=({label:t,value:e,color:n})=>s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:`text-2xl font-bold ${n}`,children:e}),s.jsx("p",{className:"text-xs text-gray-500",children:t})]}),ac=({status:t,label:e})=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(jx,{status:t}),s.jsx("span",{className:"text-sm text-gray-600",children:e})]});function Tx({student:t,academyId:e,onBack:n,isEmbedded:r}){const[a,i]=be.useState(new Date),[A,o]=be.useState({}),[l,c]=be.useState({present:0,absent:0,leave:0,holiday:0}),[d,h]=be.useState(!0),[p,m]=be.useState(null),B=be.useCallback(async()=>{if(h(!0),m(null),!t||!e||t.batches.length===0){o({}),c({present:0,absent:0,leave:0,holiday:0}),h(!1);return}const _=a.getFullYear(),M=a.getMonth(),D=new Date(_,M+1,0).getDate(),U=Array.from({length:D},(O,F)=>{const I=F+1;return`${_}-${String(M+1).padStart(2,"0")}-${String(I).padStart(2,"0")}`}),j={};try{const O=Bn(Te,`academies/${e}/batches`),F=ui(O,fi("name","in",t.batches)),P=(await Qa(F)).docs.map(ee=>ee.id);for(const ee of P){const X=U.map(ae=>Xe(Te,`academies/${e}/batches/${ee}/attendance`,ae));(await Promise.all(X.map(ae=>Sn(ae)))).forEach((ae,de)=>{if(ae.exists()){const Ce=ae.data()[t.id];if(Ce){const Q=String(de+1),z=j[Q],W={Present:4,Leave:3,Holiday:2,Absent:1,"Not Set":0};(!z||W[Ce]>W[z])&&(j[Q]=Ce)}}})}o(j);const V=Object.values(j).reduce((ee,X)=>(X==="Present"?ee.present++:X==="Absent"?ee.absent++:X==="Leave"?ee.leave++:X==="Holiday"&&ee.holiday++,ee),{present:0,absent:0,leave:0,holiday:0});c(V)}catch(O){console.error("Error fetching student attendance: ",O),O.code==="unavailable"?m("You appear to be offline. Please check your internet connection and try again."):m("Could not load attendance data. Please try again later.")}finally{h(!1)}},[a,t,e]);be.useEffect(()=>{B()},[B]);const y=_=>{i(M=>{const D=new Date(M);return D.setMonth(D.getMonth()+(_==="next"?1:-1)),D})},b=a.getFullYear(),C=a.getMonth(),N=new Date(b,C,1).getDay(),k=new Date(b,C+1,0).getDate(),E=["S","M","T","W","T","F","S"];return s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[!r&&s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Attendance"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-4",children:[s.jsx("h3",{className:"text-center font-bold text-gray-700 mb-3",children:"This Month's Summary"}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsx(sc,{label:"Present",value:l.present,color:"text-green-500"}),s.jsx(sc,{label:"Absent",value:l.absent,color:"text-red-500"}),s.jsx(sc,{label:"Leave",value:l.leave,color:"text-orange-400"}),s.jsx(sc,{label:"Holiday",value:l.holiday,color:"text-purple-500"})]})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("button",{onClick:()=>y("prev"),className:"p-2 rounded-full hover:bg-gray-100",children:s.jsx(Ge,{className:"w-5 h-5"})}),s.jsx("h2",{className:"text-lg font-bold text-indigo-700",children:a.toLocaleString("default",{month:"long",year:"numeric"})}),s.jsx("button",{onClick:()=>y("next"),className:"p-2 rounded-full hover:bg-gray-100",children:s.jsx(wf,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs font-bold text-gray-500 mb-2",children:E.map(_=>s.jsx("div",{children:_},_))}),d?s.jsx("div",{className:"flex justify-center items-center py-10",children:s.jsx(Ar,{message:"Loading attendance..."})}):p?s.jsxs("div",{className:"text-center py-10 px-4 bg-red-50 text-red-700 rounded-lg",children:[s.jsx("p",{className:"font-bold mb-2",children:"Failed to Load Data"}),s.jsx("p",{className:"text-sm",children:p}),s.jsx("button",{onClick:B,className:"mt-4 px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-colors",children:"Retry"})]}):s.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:N}).map((_,M)=>s.jsx("div",{},`empty-${M}`)),Array.from({length:k}).map((_,M)=>{const D=M+1,U=A[String(D)];return s.jsxs("div",{className:"flex flex-col items-center justify-start h-12",children:[s.jsx("span",{className:"text-sm text-gray-800",children:D}),U&&s.jsx("div",{className:"mt-1",children:s.jsx(jx,{status:U})})]},D)})]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm mt-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[s.jsx(ac,{status:"Present",label:"Present"}),s.jsx(ac,{status:"Absent",label:"Absent"}),s.jsx(ac,{status:"Leave",label:"Leave"}),s.jsx(ac,{status:"Holiday",label:"Holiday"})]})})]})]})}const Yg=t=>{if(!t)return"--:--";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`};function L4({onBack:t,student:e,academyId:n,batches:r}){const[a,i]=q.useState([]),[A,o]=q.useState(!0),[l,c]=q.useState(null),d=new Date,h=d.toISOString().split("T")[0];return q.useEffect(()=>{const p=r.filter(y=>e.batches.includes(y.name)).map(y=>y.id);if(p.length===0){o(!1);return}const m=p[0];(async()=>{o(!0),c(null);try{const y=Xe(Te,`academies/${n}/schedules`,h),b=await Sn(y);if(b.exists()){const N=b.data()[m]||[],k=new Date,E=N.filter(_=>{if(!_.endTime)return!0;const[M,D]=_.endTime.split(":").map(Number),U=new Date;return U.setHours(M,D,0,0),U>k});E.sort((_,M)=>_.startTime.localeCompare(M.startTime)),i(E)}else i([])}catch(y){console.error("Error fetching schedule:",y),c("Failed to load today's schedule. Please try again later.")}finally{o(!1)}})()},[h,n,e.batches,r]),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Today's Timetable"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("p",{className:"font-bold text-lg text-indigo-700 dark:text-indigo-400",children:d.toLocaleDateString("en-US",{weekday:"long"})}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:d.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),A&&s.jsx("p",{className:"text-center text-gray-500",children:"Loading schedule..."}),l&&s.jsx("p",{className:"text-center text-red-500",children:l}),!A&&!l&&(a.length>0?s.jsx("div",{className:"space-y-3",children:a.map(p=>s.jsxs("div",{className:`p-4 rounded-lg shadow-sm flex items-center space-x-4 ${p.type==="class"?"bg-white dark:bg-gray-800":"bg-yellow-50 dark:bg-yellow-900/40"}`,children:[s.jsxs("div",{className:"flex flex-col items-center w-20 text-indigo-600 dark:text-indigo-300",children:[s.jsx("span",{className:"font-bold text-sm",children:Yg(p.startTime)}),s.jsx("span",{className:"text-xs",children:"to"}),s.jsx("span",{className:"font-bold text-sm",children:Yg(p.endTime)})]}),s.jsx("div",{className:`w-1 h-16 rounded-full ${p.type==="class"?"bg-indigo-200 dark:bg-indigo-700":"bg-yellow-200 dark:bg-yellow-700"}`}),s.jsx("div",{children:p.type==="class"?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:p.subject}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["by ",p.teacherName]})]}):s.jsxs("h3",{className:"font-bold text-lg text-yellow-800 dark:text-yellow-300 flex items-center gap-2",children:[s.jsx(Yo,{className:"w-5 h-5"}),p.breakType]})})]},p.id))}):s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No upcoming classes for today."})}))]})]})}const _4=t=>{if(!t)return"";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`};function M4({onBack:t,student:e,academyId:n}){const[r,a]=q.useState([]),[i,A]=q.useState({}),[o,l]=q.useState(!0),[c,d]=q.useState("results");q.useEffect(()=>{if(!n||e.batches.length===0){l(!1);return}(async()=>{l(!0);try{const b=ui(Bn(Te,`academies/${n}/exams`),fi("batchName","in",e.batches)),N=(await Qa(b)).docs.map(D=>({id:D.id,...D.data()}));a(N);const k=N.filter(D=>D.resultStatus==="Published"),E=k.map(D=>Sn(Xe(Te,`academies/${n}/exams/${D.id}/marks`,e.id))),_=await Promise.all(E),M={};_.forEach((D,U)=>{D.exists()&&(M[k[U].id]=D.data())}),A(M)}catch(b){console.error("Error fetching exams/marks: ",b)}finally{l(!1)}})()},[n,e.batches,e.id]);const h=new Date,p=q.useMemo(()=>r.filter(y=>y.date.toDate()>=h).sort((y,b)=>y.date.toMillis()-b.date.toMillis()),[r]),m=q.useMemo(()=>r.filter(y=>y.date.toDate()<h&&y.resultStatus==="Published").sort((y,b)=>b.date.toMillis()-y.date.toMillis()),[r]),B=c==="upcoming"?p:m;return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Exams"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>d("results"),className:`w-full py-2 rounded-md font-semibold ${c==="results"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Results"}),s.jsx("button",{onClick:()=>d("upcoming"),className:`w-full py-2 rounded-md font-semibold ${c==="upcoming"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Upcoming"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:o?s.jsx(Ar,{message:"Loading exams..."}):B.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsxs("p",{className:"text-lg text-gray-500",children:["No ",c," exams found."]})}):s.jsx("div",{className:"space-y-4",children:B.map(y=>{const b=i[y.id];return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsxs("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:[y.name," - ",s.jsx("span",{className:"text-indigo-600 dark:text-indigo-400",children:y.subject})]}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.batchName}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Date: ",y.date.toDate().toLocaleDateString()," at ",_4(y.date.toDate().toTimeString().substring(0,5))]}),c==="results"&&b&&s.jsxs("div",{className:"mt-3 pt-3 border-t dark:border-gray-700 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Marks Obtained"}),s.jsxs("p",{className:"text-xl font-bold",children:[b.marksObtained??"N/A"," / ",y.maxMarks]})]}),s.jsx("span",{className:`px-3 py-1 text-sm font-bold rounded-full ${b.status==="Passed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.status})]})]},y.id)})})})]})}const D4=({material:t})=>s.jsxs("a",{href:t.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center space-x-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center",children:t.fileType==="file"?s.jsx(UA,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}):s.jsx(Ad,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100 truncate",children:t.title}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.subject}),s.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:t.uploadedAt.toDate().toLocaleDateString()})]})]});function P4({onBack:t,materials:e,student:n}){const r=q.useMemo(()=>{const a=new Set(n.batches);return e.filter(i=>a.has(i.batchName)).sort((i,A)=>A.uploadedAt.toMillis()-i.uploadedAt.toMillis())},[e,n.batches]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Study Material"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:r.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No study material has been uploaded for your batches yet."})}):s.jsx("div",{className:"space-y-3",children:r.map(a=>s.jsx(D4,{material:a},a.id))})})]})}const R4=({hw:t,student:e,academyId:n,isDemoMode:r})=>{const[a,i]=q.useState("loading"),[A,o]=q.useState(null),[l,c]=q.useState(!1),[d,h]=q.useState(0);q.useEffect(()=>{(async()=>{const N=Xe(Te,`academies/${n}/homework/${t.id}/submissions`,e.id),k=await Sn(N);k.exists()?i({id:k.id,...k.data()}):i("pending")})()},[n,t.id,e.id]);const p=C=>{C.target.files&&C.target.files[0]&&o(C.target.files[0])},m=async()=>{if(!A||r){r&&alert("This is a demo. Cannot submit homework.");return}c(!0);const C=`academies/${n}/homework_submissions/${t.id}/${e.id}_${A.name}`,N=Ea(ka,C),k=qo(N,A);k.on("state_changed",E=>{const _=E.bytesTransferred/E.totalBytes*100;h(_)},E=>{console.error("Upload failed:",E),alert("File upload failed."),c(!1)},async()=>{const E=await zo(k.snapshot.ref),_={studentId:e.id,studentName:e.name,studentRollNumber:e.rollNumber,submittedAt:Jr(),fileUrl:E,fileName:A.name,storagePath:C,status:"Submitted"},M=Xe(Te,`academies/${n}/homework/${t.id}/submissions`,e.id);await hA(M,_),i({..._,id:e.id,submittedAt:new Date}),c(!1),o(null)})},B=()=>a==="loading"?{text:"Loading...",color:"bg-gray-200 text-gray-800"}:a==="pending"?{text:"Pending",color:"bg-red-100 text-red-800"}:a.status==="Checked"?{text:"Checked",color:"bg-green-100 text-green-800"}:{text:"Submitted",color:"bg-yellow-100 text-yellow-800"},{text:y,color:b}=B();return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${b}`,children:y})]}),t.description&&s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:t.description}),s.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 font-semibold mt-1",children:["Due: ",t.dueDate.toDate().toLocaleDateString()]}),t.attachmentUrl&&s.jsxs("a",{href:t.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:[s.jsx(Ad,{className:"w-4 h-4"}),s.jsx("span",{children:"View Attachment"})]}),s.jsx("div",{className:"mt-4 pt-4 border-t dark:border-gray-700",children:a==="pending"?s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{htmlFor:`file-upload-${t.id}`,className:"flex-grow p-2 text-center text-sm bg-gray-100 dark:bg-gray-700 rounded-md cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 truncate",children:A?A.name:"Choose File"}),s.jsx("input",{id:`file-upload-${t.id}`,type:"file",onChange:p,className:"hidden"}),s.jsx("button",{onClick:m,disabled:!A||l,className:"px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:s.jsx(Uf,{className:"w-5 h-5"})})]}),l&&s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 dark:bg-gray-700 mt-2",children:s.jsx("div",{className:"bg-indigo-600 h-1.5 rounded-full",style:{width:`${d}%`}})})]}):a!=="loading"&&s.jsxs("div",{className:"text-sm",children:[s.jsxs("p",{children:["You submitted: ",s.jsx("a",{href:a.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 dark:text-indigo-400 hover:underline",children:a.fileName||"View File"})]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["on ",a.submittedAt.toDate().toLocaleString()]})]})})]})};function H4({onBack:t,homework:e,student:n,academyId:r,batches:a,isDemoMode:i}){const A=q.useMemo(()=>{const o=new Set(n.batches);return e.filter(l=>o.has(l.batchName)).sort((l,c)=>c.dueDate.toMillis()-l.dueDate.toMillis())},[e,n.batches]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Homework"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:A.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No homework assigned for your batches yet."})}):s.jsx("div",{className:"space-y-3",children:A.map(o=>s.jsx(R4,{hw:o,student:n,academyId:r,isDemoMode:i},o.id))})})]})}const O4=({quiz:t,status:e,onNavigate:n})=>{const r=()=>{e==="active"?n("take-quiz",{quizId:t.id}):e==="completed"&&n("quiz-result",{quizId:t.id})};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.batchName," Â· ",t.subject]}),s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-300 mt-2",children:[s.jsxs("p",{children:["Date: ",t.dateTime.toDate().toLocaleString()]}),s.jsxs("p",{children:["Duration: ",t.duration," mins | Total Marks: ",t.totalMarks]})]}),s.jsxs("div",{className:"mt-4 flex justify-end",children:[e==="upcoming"&&s.jsx("button",{disabled:!0,className:"px-4 py-2 text-sm font-semibold text-gray-500 bg-gray-200 dark:bg-gray-700 rounded-lg cursor-not-allowed",children:"Starts Soon"}),e==="active"&&s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-semibold text-white bg-green-600 rounded-lg hover:bg-green-700",children:"Start Quiz"}),e==="completed"&&s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"View Result"})]})]})};function G4({onBack:t,quizzes:e,student:n,onNavigate:r,academyId:a}){const[i,A]=q.useState("active"),[o,l]=q.useState(new Set),[c,d]=q.useState(!0);q.useEffect(()=>{(async()=>{d(!0);const b=new Set,C=new Set(n.batches),N=e.filter(k=>C.has(k.batchName)&&k.status==="Published");for(const k of N){const E=Xe(Te,`academies/${a}/quizzes/${k.id}/submissions`,n.id);try{(await Sn(E)).exists()&&b.add(k.id)}catch(_){console.error(`Error checking submission for quiz ${k.id}:`,_)}}l(b),d(!1)})()},[e,n.id,n.batches,a]);const{upcoming:h,active:p,completed:m}=q.useMemo(()=>{const y=new Set(n.batches),b=e.filter(_=>y.has(_.batchName)&&_.status==="Published"),C=[],N=[],k=[],E=new Date;return b.forEach(_=>{const M=_.dateTime.toDate(),D=new Date(M.getTime()+_.duration*6e4);o.has(_.id)?k.push(_):E<M?C.push(_):E>=M&&E<=D&&N.push(_)}),C.sort((_,M)=>_.dateTime.toMillis()-M.dateTime.toMillis()),N.sort((_,M)=>_.dateTime.toMillis()-M.dateTime.toMillis()),k.sort((_,M)=>M.dateTime.toMillis()-_.dateTime.toMillis()),{upcoming:C,active:N,completed:k}},[e,n.batches,o]),B=i==="upcoming"?h:i==="active"?p:m;return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Online Quizzes"})]}),s.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 shadow-sm flex-shrink-0",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>A("active"),className:`w-full py-2 rounded-md font-semibold ${i==="active"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Active"}),s.jsx("button",{onClick:()=>A("upcoming"),className:`w-full py-2 rounded-md font-semibold ${i==="upcoming"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>A("completed"),className:`w-full py-2 rounded-md font-semibold ${i==="completed"?"bg-indigo-600 text-white":"dark:text-gray-300"}`,children:"Completed"})]})}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:c?s.jsx(Ar,{message:"Loading quizzes..."}):B.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsxs("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:["No ",i," quizzes found."]})}):s.jsx("div",{className:"space-y-4",children:B.map(y=>s.jsx(O4,{quiz:y,status:i,onNavigate:r},y.id))})})]})}const V4=({onConfirm:t,onCancel:e,unansweredCount:n})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-sm text-center",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:"Confirm Submission"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"Are you sure you want to submit your quiz?"}),n>0&&s.jsxs("p",{className:"font-semibold text-yellow-600 dark:text-yellow-400 mb-6",children:["You have ",n," unanswered question(s)."]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"w-full py-2 px-4 rounded-md bg-gray-200 dark:bg-gray-600 font-semibold",children:"Review"}),s.jsx("button",{onClick:t,className:"w-full py-2 px-4 rounded-md bg-green-600 text-white font-semibold",children:"Submit"})]})]})}),K4=({onConfirm:t})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-sm text-center",children:[s.jsx("h2",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Time's Up!"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your time for this quiz has expired. Your answers will be submitted automatically."}),s.jsx("button",{onClick:t,className:"w-full py-3 px-4 rounded-lg bg-indigo-600 text-white font-bold",children:"OK"})]})});function q4({onBack:t,quiz:e,onSaveSubmission:n}){const[r,a]=q.useState(0),[i,A]=q.useState({}),[o,l]=q.useState(e.duration*60),[c,d]=q.useState(!1),[h,p]=q.useState(!1),[m,B]=q.useState(!1),y=q.useRef(null),b=q.useRef(!1),C=async()=>{if(!b.current){b.current=!0,d(!0),p(!1),y.current&&clearInterval(y.current);try{await n(e.id,i),alert("Quiz submitted successfully!"),t()}catch{alert("Failed to submit quiz. Please try again."),d(!1),b.current=!1}}};q.useEffect(()=>(y.current=window.setInterval(()=>{l(U=>U<=1?(y.current&&clearInterval(y.current),B(!0),0):U-1)},1e3),()=>{y.current&&clearInterval(y.current)}),[]);const N=()=>{B(!1),C()},k=(U,j)=>{A(O=>({...O,[U]:j}))},E=e.questions[r],_=Math.floor(o/60),M=o%60,D=e.questions.length-Object.keys(i).length;return c?s.jsx("div",{className:"h-full flex flex-col items-center justify-center bg-gray-100 dark:bg-gray-900",children:s.jsx(Ar,{message:"Submitting Quiz..."})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("h1",{className:"text-lg font-bold truncate",children:e.title}),s.jsxs("div",{className:`font-bold text-lg px-2 py-1 rounded-md ${o<60?"bg-red-500 text-white animate-pulse":"bg-white/20"}`,children:[String(_).padStart(2,"0"),":",String(M).padStart(2,"0")]})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-500",children:["Question ",r+1," of ",e.questions.length]}),s.jsx("p",{className:"font-semibold text-lg text-gray-800 dark:text-gray-100",children:E.questionText})]}),s.jsx("div",{className:"space-y-3",children:E.options.map((U,j)=>s.jsxs("label",{className:`block p-4 rounded-lg border-2 cursor-pointer transition-colors ${i[E.id]===j?"bg-indigo-100 border-indigo-500 dark:bg-indigo-900/50":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700"}`,children:[s.jsx("input",{type:"radio",name:`question-${E.id}`,className:"mr-3",checked:i[E.id]===j,onChange:()=>k(E.id,j)}),U]},j))})]}),s.jsxs("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700 flex-shrink-0",children:[s.jsxs("div",{className:"flex justify-between mb-4",children:[s.jsxs("button",{onClick:()=>a(U=>Math.max(0,U-1)),disabled:r===0,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 disabled:opacity-50",children:[s.jsx(Ge,{className:"w-5 h-5"})," Prev"]}),s.jsxs("button",{onClick:()=>a(U=>Math.min(e.questions.length-1,U+1)),disabled:r===e.questions.length-1,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 disabled:opacity-50",children:["Next ",s.jsx(wf,{className:"w-5 h-5"})]})]}),s.jsx("button",{onClick:()=>p(!0),className:"w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700",children:"Submit Quiz"})]})]}),h&&s.jsx(V4,{onConfirm:C,onCancel:()=>p(!1),unansweredCount:D}),m&&s.jsx(K4,{onConfirm:N})]})}const z4=({question:t,studentAnswerIndex:e})=>{const n=e===t.correctAnswerIndex;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-3",children:t.questionText}),s.jsx("div",{className:"space-y-2",children:t.options.map((r,a)=>{const i=e===a,A=t.correctAnswerIndex===a;let o="bg-gray-100 dark:bg-gray-700";return A&&(o="bg-green-100 dark:bg-green-900/50"),i&&!n&&(o="bg-red-100 dark:bg-red-900/50"),s.jsxs("div",{className:`p-2 rounded-md flex items-center gap-3 text-sm ${o}`,children:[A?s.jsx(di,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):i?s.jsx(In,{className:"w-5 h-5 text-red-600 flex-shrink-0"}):s.jsx("div",{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:r})]},a)})})]})};function J4({onBack:t,quiz:e,studentId:n,academyId:r}){const[a,i]=q.useState(null),[A,o]=q.useState(!0);q.useEffect(()=>{(async()=>{o(!0);const d=Xe(Te,`academies/${r}/quizzes/${e.id}/submissions`,n),h=await Sn(d);h.exists()&&i({id:h.id,...h.data()}),o(!1)})()},[r,e.id,n]);const l=a?a.score/a.totalMarks*100:0;return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Quiz Result"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:A?s.jsx("p",{className:"text-center text-gray-500",children:"Loading your result..."}):a?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm text-center",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:e.title}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.subject}),s.jsxs("p",{className:"text-4xl font-bold text-indigo-600 dark:text-indigo-400 mt-4",children:[a.score.toFixed(2)," / ",s.jsx("span",{className:"text-2xl text-gray-500",children:a.totalMarks})]}),s.jsxs("p",{className:"font-semibold text-lg",children:[l.toFixed(2),"%"]})]}),s.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-200 pt-4",children:"Answer Review"}),e.questions.map(c=>s.jsx(z4,{question:c,studentAnswerIndex:a.answers[c.id]},c.id))]}):s.jsx("p",{className:"text-center text-red-500",children:"Could not find your submission for this quiz."})})]})}const W4=t=>{switch(t){case"Pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300";case"Approved":return"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300";case"Rejected":return"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300"}};function Y4({onBack:t,onNavigate:e,currentUser:n,leaveRequests:r}){const a=n.role==="student"||n.role==="staff"?n.data.id:null,i=r.filter(A=>A.userId===a).sort((A,o)=>o.requestedAt.toMillis()-A.requestedAt.toMillis());return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"My Leave Requests"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:i.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"You haven't applied for any leave yet."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to apply."]})]}):s.jsx("div",{className:"space-y-3 pb-20",children:i.map(A=>s.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[A.fromDate.toDate().toLocaleDateString()," - ",A.toDate.toDate().toLocaleDateString()]}),s.jsx("p",{className:"font-semibold text-gray-700 dark:text-gray-200 mt-1",children:A.reason})]}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${W4(A.status)}`,children:A.status})]})},A.id))})}),s.jsx("button",{onClick:()=>e("apply-leave"),className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110","aria-label":"Apply for new leave",children:s.jsx(Lr,{className:"w-8 h-8"})})]})}const $4=({progress:t})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-xs text-center",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-100 mb-4",children:"Submitting Request"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Uploading attachment, please wait..."}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:s.jsx("div",{className:"bg-indigo-600 h-2.5 rounded-full transition-all duration-150",style:{width:`${t}%`}})}),s.jsxs("p",{className:"text-sm font-semibold mt-2 text-gray-700 dark:text-gray-200",children:[Math.round(t),"%"]})]})}),X4=({onClose:t})=>(q.useEffect(()=>{const e=setTimeout(t,2e3);return()=>clearTimeout(e)},[t]),s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-sm text-center",children:[s.jsx(cs,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Submitted Successfully!"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Your leave request has been sent for review."})]})}));function Z4({onBack:t,onSave:e,currentUser:n,academyId:r,isDemoMode:a}){const[i,A]=q.useState({fromDate:"",toDate:"",reason:""}),[o,l]=q.useState(null),[c,d]=q.useState(0),[h,p]=q.useState(!1),[m,B]=q.useState(!1),y=N=>{A(k=>({...k,[N.target.name]:N.target.value}))},b=N=>{N.target.files&&N.target.files[0]&&l(N.target.files[0])},C=async N=>{if(N.preventDefault(),a){alert("This is a demo. Cannot apply for leave.");return}if(!i.fromDate||!i.toDate||!i.reason){alert("Please fill all fields.");return}if(n.role!=="student"&&n.role!=="staff"){alert("Only students and staff can apply for leave.");return}p(!0);try{let k,E;if(o){E=`academies/${r}/leave_attachments/${Date.now()}_${o.name}`;const U=Ea(ka,E),j=qo(U,o);await new Promise((O,F)=>{j.on("state_changed",I=>{const P=I.bytesTransferred/I.totalBytes*100;d(P)},I=>{console.error("Upload failed:",I),alert("File upload failed. Please try again."),p(!1),F(I)},async()=>{k=await zo(j.snapshot.ref),O()})})}const _=n.data,M=n.role==="student"?_.batches:[],D={userId:_.id,userName:_.name,userRole:n.role,userRollNumber:n.role==="student"?_.rollNumber:void 0,userBatches:M,fromDate:Lt.fromDate(new Date(i.fromDate)),toDate:Lt.fromDate(new Date(i.toDate)),reason:i.reason,status:"Pending",requestedAt:Jr()};k&&(D.attachmentUrl=k),E&&(D.storagePath=E),await e(D),B(!0)}catch(k){if(!h)return;alert(k.message),p(!1)}};return s.jsxs(s.Fragment,{children:[h&&o&&s.jsx($4,{progress:c}),m&&s.jsx(X4,{onClose:t}),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Apply for Leave"})]}),s.jsxs("form",{onSubmit:C,className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"fromDate",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"From Date"}),s.jsx("input",{id:"fromDate",type:"date",name:"fromDate",value:i.fromDate,onChange:y,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"toDate",className:"block text-gray-500 dark:text-gray-400 text-sm font-medium mb-2",children:"To Date"}),s.jsx("input",{id:"toDate",type:"date",name:"toDate",value:i.toDate,onChange:y,required:!0,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"})]})]}),s.jsx("textarea",{name:"reason",placeholder:"Reason for leave...",value:i.reason,onChange:y,required:!0,rows:5,className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg"}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"file-upload",className:"w-full p-3 bg-white dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-indigo-500",children:[s.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-semibold",children:"Attach Document (Optional)"}),s.jsx("span",{className:"text-xs text-gray-500",children:"e.g., medical note"}),o&&s.jsx("span",{className:"text-sm text-gray-500 mt-1",children:o.name})]}),s.jsx("input",{id:"file-upload",type:"file",onChange:b,className:"hidden"})]})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:h,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-400",children:h?o?"Uploading...":"Submitting...":"Submit Application"})})]})]})]})}const eS=({notice:t})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Posted on: ",t.createdAt.toDate().toLocaleDateString()]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2 whitespace-pre-wrap",children:t.description}),t.attachmentUrl&&s.jsxs("a",{href:t.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:[s.jsx(UA,{className:"w-4 h-4"}),s.jsx("span",{children:t.attachmentName||"View Attachment"})]})]});function tS({onBack:t,notices:e}){const n=q.useMemo(()=>{const r=new Date;return e.filter(a=>(a.targetAudience==="All"||a.targetAudience==="Students")&&a.expiryDate.toDate()>=r).sort((a,i)=>i.createdAt.toMillis()-a.createdAt.toMillis())},[e]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Notice Board"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:n.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No new notices at the moment."})}):s.jsx("div",{className:"space-y-3",children:n.map(r=>s.jsx(eS,{notice:r},r.id))})})]})}const ar=({label:t,value:e})=>s.jsxs("div",{className:"grid grid-cols-3 gap-4 py-3 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 col-span-1",children:t}),s.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 col-span-2 font-medium break-words",children:e||"-"})]}),nS=({student:t,transportRoutes:e})=>{const n=e.find(r=>r.id===t.transportRouteId);return s.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-indigo-700 dark:text-indigo-400 mb-2 text-base border-b pb-2 dark:border-gray-700",children:"Personal Information"}),s.jsx(ar,{label:"Father's Name",value:t.fatherName}),s.jsx(ar,{label:"Mother's Name",value:t.motherName}),s.jsx(ar,{label:"Date of Birth",value:t.dob}),s.jsx(ar,{label:"Gender",value:t.gender}),s.jsx(ar,{label:"Address",value:t.address})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-indigo-700 dark:text-indigo-400 mb-2 text-base border-b pb-2 dark:border-gray-700",children:"Contact Information"}),s.jsx(ar,{label:"Mobile 1",value:t.mobile1}),s.jsx(ar,{label:"Mobile 2",value:t.mobile2}),s.jsx(ar,{label:"Email",value:t.email})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-indigo-700 dark:text-indigo-400 mb-2 text-base border-b pb-2 dark:border-gray-700",children:"Academic Information"}),s.jsx(ar,{label:"Admission Date",value:t.admissionDate}),s.jsx(ar,{label:"School/College",value:t.schoolOrCollege}),s.jsx(ar,{label:"Fee Type",value:t.feeType}),s.jsx(ar,{label:"Fee Amount",value:`â‚¹${t.feeAmount}`})]}),t.transport==="USE_TRANSPORT"&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-indigo-700 dark:text-indigo-400 mb-2 text-base border-b pb-2 dark:border-gray-700",children:"Transport Information"}),s.jsx(ar,{label:"Transport",value:"Opted In"}),s.jsx(ar,{label:"Route Name",value:n==null?void 0:n.routeName}),s.jsx(ar,{label:"Monthly Fee",value:n?`â‚¹${n.monthlyFee}`:"-"})]})]})};function rS({onBack:t,student:e,feeCollections:n,academyId:r,onSavePayment:a,transportRoutes:i,onShowImage:A,academy:o}){const[l,c]=q.useState("details"),d=e.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(e.name)}`;return s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-20",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Student Profile"})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800",children:[s.jsxs("div",{className:"p-4 flex items-center space-x-4",children:[s.jsxs("button",{onClick:()=>A(d),className:"flex-shrink-0 group relative",children:[s.jsx("img",{src:d,alt:e.name,className:"w-20 h-20 rounded-full object-cover bg-gray-200 border-2 border-indigo-300 group-hover:opacity-80 transition-opacity"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 rounded-full flex items-center justify-center transition-opacity",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607zM10.5 7.5v6m3-3h-6"})})})]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 truncate",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Roll No: ",e.rollNumber]}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:["Batches: ",e.batches.join(", ")]})]})]}),s.jsx("div",{className:"px-4 pb-4",children:s.jsxs("div",{className:"flex justify-around bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>c("details"),className:`w-full py-2 rounded-md font-semibold ${l==="details"?"bg-indigo-600 text-white shadow-sm":"dark:text-gray-300"}`,children:"Details"}),s.jsx("button",{onClick:()=>c("attendance"),className:`w-full py-2 rounded-md font-semibold ${l==="attendance"?"bg-indigo-600 text-white shadow-sm":"dark:text-gray-300"}`,children:"Attendance"}),s.jsx("button",{onClick:()=>c("fees"),className:`w-full py-2 rounded-md font-semibold ${l==="fees"?"bg-indigo-600 text-white shadow-sm":"dark:text-gray-300"}`,children:"Fees"})]})})]}),s.jsxs("div",{className:"p-4",children:[l==="details"&&s.jsx(nS,{student:e,transportRoutes:i}),l==="attendance"&&s.jsx(Tx,{student:e,academyId:r,onBack:()=>{},isEmbedded:!0}),l==="fees"&&s.jsx(Cx,{student:e,feeCollections:n,onSavePayment:a,onBack:()=>{},isEmbedded:!0,academy:o})]})]})]})}const sS=({src:t,alt:e,onClose:n})=>s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 animate-fade-in",onClick:n,role:"dialog","aria-modal":"true","aria-label":"Full screen image viewer",children:[s.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-white p-2 bg-black/50 rounded-full hover:bg-black/75 transition-colors","aria-label":"Close image viewer",children:s.jsx(In,{className:"w-8 h-8"})}),s.jsx("div",{className:"relative max-w-[90vw] max-h-[90vh]",onClick:r=>r.stopPropagation(),children:s.jsx("img",{src:t,alt:e,className:"w-auto h-auto max-w-full max-h-full object-contain rounded-lg shadow-2xl"})})]}),aS=[{name:"Students",Icon:gi,color:"bg-blue-600"},{name:"Attendance",Icon:Xs,color:"bg-purple-600"},{name:"Class Schedule",Icon:pi,color:"bg-pink-500"},{name:"Tuition Fees",Icon:Jo,color:"bg-emerald-500"},{name:"Manage Exams",Icon:mi,color:"bg-lime-500"},{name:"Leave Manager",Icon:Zs,color:"bg-blue-500"}],iS=[{name:"My Attendance",Icon:Xs,color:"bg-sky-500"},{name:"Notice Board",Icon:EA,color:"bg-cyan-600"},{name:"Salary Details",Icon:hf,color:"bg-orange-500"}];function $g({onNavigate:t,academy:e,staff:n,onShowDevPopup:r}){const{batchAccess:a}=n,i=n.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(n.name)}`,[A,o]=q.useState(!1),[l,c]=q.useState(null),[d,h]=q.useState(!0);q.useEffect(()=>{(async()=>{if(sessionStorage.getItem("staffDashboardPopupsShown")==="true"){h(!1);return}h(!0);const C=new Date().toISOString().split("T")[0];try{const N=Xe(Te,`academies/${e.id}/schedules`,C),k=await Sn(N),E=[];if(k.exists()){const _=k.data();for(const M in _)_[M].forEach(U=>{U.type==="class"&&U.teacherId===n.id&&E.push(U)})}E.sort((_,M)=>_.startTime.localeCompare(M.startTime)),c(E),o(!0),sessionStorage.setItem("staffDashboardPopupsShown","true")}catch(N){console.error("Error fetching staff schedule:",N),c(null)}finally{h(!1)}})()},[n.id,e.id]);const p=b=>Object.values(a||{}).some(C=>C[b]),B=[...aS.filter(b=>{switch(b.name){case"Students":return Object.keys(a||{}).length>0;case"Attendance":return p("attendance");case"Class Schedule":return Object.keys(a||{}).length>0;case"Tuition Fees":return p("fees");case"Manage Exams":return p("exams");case"Leave Manager":return p("leaveRequests");default:return!1}}),...iS],y=b=>{switch(b){case"Students":return()=>t("active-students");case"Tuition Fees":return()=>t("select-batch-for-fees");case"Attendance":return()=>t("select-batch-attendance");case"Class Schedule":return()=>t("class-schedule");case"Manage Exams":return()=>t("manage-exams");case"Leave Manager":return()=>t("leave-manager");case"Notice Board":return()=>t("staff-notice-board");case"My Attendance":return()=>t("staff-attendance");default:return()=>r(b)}};return s.jsxs(s.Fragment,{children:[s.jsxs("main",{className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 flex items-center space-x-4",children:[s.jsx("img",{src:i,alt:n.name,className:"w-16 h-16 rounded-full object-cover border-2 border-indigo-500 bg-gray-200"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:n.name.toUpperCase()}),s.jsx("p",{className:"text-sm text-gray-600",children:n.staffId})]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-y-6 gap-x-3 sm:gap-x-4 text-center",children:B.map(b=>s.jsx(_m,{...b,onClick:y(b.name)},b.name))})})]}),A&&s.jsx(Ux,{schedule:l,onClose:()=>o(!1),isLoading:d})]})}function AS({staffName:t,academyName:e,onLogout:n,onToggleNav:r,theme:a,onToggleTheme:i,onNavigate:A,notificationCount:o}){const[l,c]=be.useState("");return be.useEffect(()=>{const d=new Date().getHours();d<12?c("Good Morning"):d<17?c("Good Afternoon"):c("Good Evening")},[]),s.jsx("header",{className:"bg-indigo-700 text-white p-4 shadow-md sticky top-0 z-30",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:r,className:"text-indigo-200 hover:text-white transition-colors p-2 -ml-2 rounded-full","aria-label":"Open navigation menu",children:s.jsx(uf,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:[l,", ",t,"!"]}),s.jsx("p",{className:"text-sm text-indigo-200 mt-1",children:e})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:i,className:"text-indigo-200 hover:text-white transition-colors","aria-label":"Toggle dark mode",children:a==="light"?s.jsx(df,{className:"w-6 h-6"}):s.jsx(ff,{className:"w-6 h-6"})}),s.jsxs("button",{onClick:()=>A("staff-notifications"),className:"relative text-indigo-200 hover:text-white transition-colors","aria-label":"Notifications",children:[s.jsx(Rc,{className:"w-6 h-6"}),o>0&&s.jsx("span",{className:"absolute -top-1 -right-2 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-indigo-700",children:o>9?"9+":o})]})]})]})})}const oS=[{name:"Students",Icon:gi},{name:"Attendance",Icon:Xs},{name:"Class Schedule",Icon:pi},{name:"Tuition Fees",Icon:Jo},{name:"Manage Exams",Icon:mi},{name:"Leave Manager",Icon:Zs}];function lS({isOpen:t,onClose:e,onNavigate:n,onLogout:r,staff:a,onShowDevPopup:i}){const{batchAccess:A}=a,o=h=>Object.values(A||{}).some(p=>p[h]),l=h=>{n(h),e()},c=h=>{switch(h){case"Students":return()=>l("active-students");case"Tuition Fees":return()=>l("fees-options");case"Attendance":return()=>l("select-batch-attendance");case"Class Schedule":return()=>l("class-schedule");case"Manage Exams":return()=>l("manage-exams");case"Leave Manager":return()=>l("leave-manager");default:return()=>i(h)}},d=oS.filter(h=>{switch(h.name){case"Students":return Object.keys(A||{}).length>0;case"Attendance":return o("attendance");case"Class Schedule":return Object.keys(A||{}).length>0;case"Tuition Fees":return o("fees");case"Manage Exams":return o("exams");case"Leave Manager":return o("leaveRequests");default:return!1}});return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-30 transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true"}),s.jsx("aside",{className:`fixed top-0 left-0 h-full w-72 bg-white shadow-xl z-40 transform transition-transform duration-300 ease-in-out ${t?"translate-x-0":"-translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidenav-title",children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("header",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hi,{className:"w-8 h-8 text-indigo-600"}),s.jsx("h2",{id:"sidenav-title",className:"text-lg font-bold text-gray-800",children:"Class Captain"})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Close menu",children:s.jsx(In,{className:"w-6 h-6 text-gray-600"})})]}),s.jsx("nav",{className:"flex-grow overflow-y-auto py-4",children:s.jsx("ul",{children:d.map(({name:h,Icon:p})=>s.jsx("li",{children:s.jsxs("button",{onClick:c(h),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors",children:[s.jsx(p,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:h})]})},h))})}),s.jsxs("footer",{className:"p-4 border-t",children:[s.jsxs("button",{onClick:()=>l("staff-attendance"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors rounded-lg",children:[s.jsx(Xs,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"My Attendance"})]}),s.jsxs("button",{onClick:()=>l("staff-notice-board"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors rounded-lg",children:[s.jsx(EA,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Notice Board"})]}),s.jsxs("button",{onClick:()=>l("my-leave"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors rounded-lg",children:[s.jsx(Zs,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"My Leave"})]}),s.jsxs("button",{onClick:()=>i("My Account"),className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors rounded-lg mt-2",children:[s.jsx(pf,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"My Account"})]}),s.jsxs("button",{onClick:r,className:"w-full flex items-center px-4 py-3 text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors rounded-lg mt-2",children:[s.jsx(Wo,{className:"w-6 h-6 mr-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:"Logout"})]})]})]})})]})}const cS=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"})}),dS=({checked:t,onChange:e})=>s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${t?"bg-indigo-600":"bg-gray-300"}`,onClick:e,"aria-pressed":t,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${t?"translate-x-6":"translate-x-1"}`})});function uS({onBack:t,staff:e,onManageAccess:n,onShowDevPopup:r,onToggleStatus:a}){const i=e.filter(A=>A.isActive);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go to staff options",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Active Staff"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:i.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 mb-4",children:"No active staff members found."}),s.jsx("p",{className:"text-gray-400",children:"Go to Staff Options to add a new staff member."})]}):s.jsx("div",{className:"space-y-4 pb-4",children:i.map(A=>s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md border-l-4 border-indigo-500 flex flex-col justify-between",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:A.photo||`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(A.name)}`,alt:A.name,className:"w-12 h-12 rounded-full object-cover bg-gray-200"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800",children:A.name}),s.jsx("p",{className:"text-sm text-gray-500 mb-1",children:A.staffId})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx(dS,{checked:A.isActive,onChange:()=>a(A.id)}),s.jsx("span",{className:"text-xs text-gray-400 mt-1",children:A.isActive?"Active":"Inactive"})]})]})}),s.jsxs("div",{className:"border-t mt-4 pt-3 flex justify-end space-x-2",children:[s.jsxs("button",{onClick:()=>r("Edit Staff"),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors","aria-label":`Edit staff ${A.name}`,children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>n(A.id),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors","aria-label":`Manage access for ${A.name}`,children:[s.jsx(cS,{className:"w-4 h-4"}),s.jsx("span",{children:"Manage Access"})]}),s.jsxs("button",{onClick:()=>r("Delete Staff"),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-red-600 bg-red-100 rounded-md hover:bg-red-200 transition-colors","aria-label":`Delete staff ${A.name}`,children:[s.jsx(Qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]})]})]},A.id))})})]})}const ni=({label:t,id:e,children:n,containerClassName:r,...a})=>s.jsxs("div",{className:`relative bg-white p-3 rounded-lg border border-gray-300 ${r}`,children:[s.jsx("label",{htmlFor:e,className:"absolute -top-2.5 left-3 bg-white px-1 text-xs text-gray-500",children:t}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:e,className:"w-full text-gray-800 bg-transparent outline-none",...a}),n&&s.jsx("label",{htmlFor:e,className:"cursor-pointer",children:n})]})]});function fS({onBack:t,onSave:e,staff:n}){const[r,a]=be.useState({staffId:"",name:"",dob:"",mobile:"",email:"",gender:"Male",address:"",joiningDate:"",photo:""}),[i,A]=be.useState(!1),o=be.useRef(null),l=be.useRef(null),[c,d]=be.useState(null);be.useEffect(()=>{if(n){const b=n.reduce((N,k)=>{const E=parseInt(k.staffId.replace(/\D/g,""),10);return isNaN(E)?N:Math.max(N,E)},0)+1,C=`T${String(b).padStart(2,"0")}`;a(N=>({...N,staffId:C}))}else a(y=>({...y,staffId:"T01"}))},[n]);const h=y=>{const{name:b,value:C}=y.target;a(N=>({...N,[b]:C}))},p=y=>{const{name:b,value:C}=y.target;b==="gender"&&a(N=>({...N,gender:C}))},m=y=>{if(y.target.files&&y.target.files[0]){const b=y.target.files[0],C=new FileReader;C.onloadend=()=>{d(C.result)},C.readAsDataURL(b)}A(!1),y.target.value=""},B=()=>{if(!r.name.trim()||!r.dob||!r.mobile||!r.address||!r.joiningDate||!r.staffId){alert("Please fill all required fields.");return}e({...r,batchAccess:{},isActive:!0})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Add New Staff"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsxs("form",{id:"new-staff-form",onSubmit:y=>{y.preventDefault(),B()},className:"space-y-5",children:[s.jsxs("div",{className:"flex justify-center",children:[s.jsx("button",{type:"button",onClick:()=>A(!0),className:"w-24 h-24 rounded-full border-2 border-indigo-400 bg-white flex items-center justify-center text-indigo-800 hover:bg-gray-100 transition overflow-hidden","aria-label":"Upload staff photo",children:r.photo?s.jsx("img",{src:r.photo,alt:"Staff Preview",className:"w-full h-full object-cover"}):s.jsx(Vc,{className:"w-12 h-12"})}),s.jsx("input",{type:"file",accept:"image/*",ref:o,onChange:m,className:"hidden"}),s.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:l,onChange:m,className:"hidden"})]}),s.jsx(ni,{label:"Full Name",id:"name",name:"name",value:r.name,onChange:h,required:!0,containerClassName:"border-indigo-500 border-2"}),s.jsx(ni,{label:"Staff ID",id:"staffId",name:"staffId",value:r.staffId,onChange:h,placeholder:"e.g. T01",required:!0}),s.jsx(ni,{label:"Date of Birth",id:"dob",name:"dob",type:"date",value:r.dob,onChange:h,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})}),s.jsx(ni,{label:"Mobile Number",id:"mobile",name:"mobile",type:"tel",value:r.mobile,onChange:h,required:!0,children:s.jsx(wc,{className:"w-6 h-6 text-indigo-600"})}),s.jsx(ni,{label:"Email (Optional)",id:"email",name:"email",type:"email",value:r.email,onChange:h}),s.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-300",children:s.jsx("div",{className:"flex items-center justify-around",children:["Male","Female","Other"].map(y=>s.jsxs("label",{className:"flex items-center space-x-2 text-gray-700 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"gender",value:y,checked:r.gender===y,onChange:p,className:"form-radio text-indigo-600 focus:ring-indigo-500"}),s.jsx("span",{children:y})]},y))})}),s.jsx(ni,{label:"Address",id:"address",name:"address",value:r.address,onChange:h,required:!0}),s.jsx(ni,{label:"Date of Joining",id:"joiningDate",name:"joiningDate",type:"date",value:r.joiningDate,onChange:h,required:!0,children:s.jsx(Us,{className:"w-6 h-6 text-indigo-600"})})]})}),s.jsxs("footer",{className:"p-4 flex-shrink-0 bg-slate-100 grid grid-cols-2 gap-4",children:[s.jsx("button",{type:"button",onClick:t,className:"w-full bg-red-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-600 transition-colors shadow-md",children:"CANCEL"}),s.jsx("button",{type:"submit",form:"new-staff-form",className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"SAVE"})]})]}),i&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl m-4 w-full max-w-xs flex flex-col",children:[s.jsx("h3",{className:"text-lg font-semibold p-4 border-b text-center",children:"Select Photo Source"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("button",{onClick:()=>{var y;return(y=o.current)==null?void 0:y.click()},className:"w-full bg-indigo-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:"Choose from Gallery"}),s.jsx("button",{onClick:()=>{var y;return(y=l.current)==null?void 0:y.click()},className:"w-full bg-sky-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-sky-700 transition-colors",children:"Take Photo"}),s.jsx("button",{onClick:()=>A(!1),className:"w-full bg-gray-200 text-gray-800 font-bold py-2.5 px-4 rounded-lg hover:bg-gray-300 transition-colors mt-2",children:"Cancel"})]})]})}),c&&s.jsx(xf,{src:c,onSave:y=>{a(b=>({...b,photo:y})),d(null)},onCancel:()=>d(null)})]})}const hS=t=>s.jsxs("svg",{...t,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm-9-4c0-2.33 4.67-3.5 7-3.5s7 1.17 7 3.5V12H3v-2zM12 6c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"}),s.jsx("path",{d:"M18 13c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm2.5 5.5h-2v2h-1v-2h-2v-1h2v-2h1v2h2v1z"})]}),gS=[{name:"Add New Staff",Icon:hS,key:"new-staff"},{name:"Active Staff List",Icon:Km,key:"staff-manager"},{name:"Mark Staff Attendance",Icon:Xs,key:"mark-staff-attendance"},{name:"Staff Attendance Report",Icon:mf,key:"staff-attendance-report"},{name:"Inactive Staff List",Icon:zm,key:"inactive-staff"}];function mS({onBack:t,onNavigate:e}){return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Staff Options"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:gS.map(({name:n,Icon:r,key:a})=>s.jsxs("button",{onClick:()=>e(a),className:"w-full bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 flex items-center space-x-4 text-left",children:[s.jsx("div",{className:"w-10 h-10 text-indigo-500",children:s.jsx(r,{})}),s.jsx("span",{className:"text-lg font-medium text-indigo-800",children:n})]},a))})})]})}const pS=({checked:t,onChange:e})=>s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${t?"bg-indigo-600":"bg-gray-300"}`,onClick:e,"aria-pressed":t,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${t?"translate-x-6":"translate-x-1"}`})}),xS=({staff:t,onToggleStatus:e})=>s.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md border-l-4 border-gray-400 flex flex-col",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[t.photo?s.jsx("img",{src:t.photo,alt:t.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center font-bold text-xl",children:t.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:t.name}),s.jsx("p",{className:"text-sm text-gray-500",children:t.staffId})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx(pS,{checked:t.isActive,onChange:()=>e(t.id)}),s.jsx("span",{className:"text-xs text-gray-400 mt-1",children:t.isActive?"Active":"Inactive"})]})]})});function wS({onBack:t,staff:e,onToggleStatus:n}){const[r,a]=be.useState(""),A=e.filter(o=>!o.isActive).filter(o=>o.name.toLowerCase().includes(r.toLowerCase())||o.staffId.toLowerCase().includes(r.toLowerCase()));return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Inactive Staff"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx("input",{type:"text",placeholder:"Search by name or staff ID...",value:r,onChange:o=>a(o.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),s.jsx("div",{className:"space-y-4 pb-4",children:A.length>0?A.map(o=>s.jsx(xS,{staff:o,onToggleStatus:n},o.id)):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No inactive staff found."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You can make a staff member inactive from the 'Active Staff' list."})]})})]})]})}const yS=[{key:"attendance",label:"Attendance"},{key:"editStudents",label:"Edit Students"},{key:"exams",label:"Exams"},{key:"fees",label:"Fees"},{key:"studyMaterial",label:"Study Material"},{key:"homework",label:"Homework"},{key:"onlineQuiz",label:"Online Quiz"},{key:"schedule",label:"Manage Schedule"},{key:"leaveRequests",label:"Manage Leave"}];function bS({onBack:t,staff:e,batches:n,onSave:r}){const[a,i]=be.useState(()=>JSON.parse(JSON.stringify(e.batchAccess||{}))),A=(l,c)=>{i(d=>{const h={...d};return h[l]||(h[l]={}),h[l][c]=!h[l][c],h})},o=()=>{r(e.id,a)};return s.jsxs("div",{className:"bg-slate-100 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-sky-600 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-sky-700 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h1",{className:"text-xl font-bold",children:"Batch Access"}),s.jsx("p",{className:"text-sm opacity-90",children:e.name})]})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:n.length>0?s.jsx("div",{className:"space-y-4",children:n.map(l=>s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-800 border-b pb-2 mb-3",children:l.name}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-3 gap-x-4",children:yS.map(({key:c,label:d})=>{var h;return s.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-1",children:[s.jsx("input",{type:"checkbox",checked:!!((h=a[l.id])!=null&&h[c]),onChange:()=>A(l.id,c),className:"h-5 w-5 rounded text-sky-600 border-gray-300 focus:ring-sky-500"}),s.jsx("span",{className:"text-gray-700",children:d})]},c)})})]},l.id))}):s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500",children:"No batches have been created."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Create batches first to assign permissions."})]})}),s.jsx("footer",{className:"p-4 bg-white border-t flex-shrink-0",children:s.jsx("button",{onClick:o,className:"w-full bg-sky-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-700 transition-colors shadow-md",children:"SAVE"})})]})}const Xg=t=>{if(!t)return"--:--";const e=/^([01]\d|2[0-3]):([0-5]\d)/,n=t.match(e);if(!n)return t;let[r,a,i]=n,A=parseInt(a);const o=A>=12?"PM":"AM";return A=A%12,A=A||12,`${A}:${i} ${o}`};function vS({onBack:t,staff:e,academyId:n}){const[r,a]=q.useState([]),[i,A]=q.useState(!0),[o,l]=q.useState(null),c=new Date,d=c.toISOString().split("T")[0];return q.useEffect(()=>{(async()=>{A(!0),l(null);try{const p=Xe(Te,`academies/${n}/schedules`,d),m=await Sn(p),B=[];if(m.exists()){const C=m.data();for(const N in C){const k=await Sn(Xe(Te,`academies/${n}/batches`,N)),E=k.exists()?k.data().name:"Unknown Batch";C[N].forEach(_=>{_.type==="class"&&_.teacherId===e.id&&B.push({batchName:E,subject:_.subject,startTime:_.startTime,endTime:_.endTime})})}}const y=new Date,b=B.filter(C=>{if(!C.endTime)return!0;const[N,k]=C.endTime.split(":").map(Number),E=new Date;return E.setHours(N,k,0,0),E>y});b.sort((C,N)=>C.startTime.localeCompare(N.startTime)),a(b)}catch(p){console.error("Error fetching schedule:",p),l("Failed to load your schedule. Please try again later.")}finally{A(!1)}})()},[d,n,e.id]),s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Your Class Schedule"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("p",{className:"font-bold text-lg text-indigo-700 dark:text-indigo-400",children:c.toLocaleDateString("en-US",{weekday:"long"})}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),i&&s.jsx("p",{className:"text-center text-gray-500",children:"Loading your schedule..."}),o&&s.jsx("p",{className:"text-center text-red-500",children:o}),!i&&!o&&(r.length>0?s.jsx("div",{className:"space-y-3",children:r.map((h,p)=>s.jsxs("div",{className:"p-4 rounded-lg shadow-sm flex items-center space-x-4 bg-white dark:bg-gray-800",children:[s.jsxs("div",{className:"flex flex-col items-center w-20 text-indigo-600 dark:text-indigo-300",children:[s.jsx("span",{className:"font-bold text-sm",children:Xg(h.startTime)}),s.jsx("span",{className:"text-xs",children:"to"}),s.jsx("span",{className:"font-bold text-sm",children:Xg(h.endTime)})]}),s.jsx("div",{className:"w-1 h-16 rounded-full bg-indigo-200 dark:bg-indigo-700"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:h.subject}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:h.batchName})]})]},p))}):s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"You have no upcoming classes scheduled for today."})}))]})]})}const BS=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})}),ic=({title:t,children:e})=>s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-bold uppercase text-indigo-600 dark:text-indigo-400 px-4 py-2 bg-gray-200/50 dark:bg-gray-900/50",children:t}),s.jsx("div",{className:"bg-white dark:bg-gray-800 divide-y dark:divide-gray-700",children:e})]}),Ss=({title:t,subtitle:e,onClick:n})=>s.jsxs("button",{onClick:n,disabled:!n,className:"w-full text-left p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex justify-between items-center disabled:hover:bg-transparent",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-base text-gray-800 dark:text-gray-100",children:t}),e&&s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e})]}),n&&s.jsx(BS,{className:"w-5 h-5 text-gray-400"})]}),Zg=({title:t,subtitle:e,enabled:n,onToggle:r})=>s.jsxs("div",{className:"p-4 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-base text-gray-800 dark:text-gray-100",children:t}),e&&s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e})]}),s.jsx("button",{type:"button",className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 ${n?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"}`,onClick:()=>r(!n),"aria-pressed":n,children:s.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${n?"translate-x-6":"translate-x-1"}`})})]});function CS({onBack:t,onNavigate:e,onShowDevPopup:n}){const[r,a]=be.useState(!0),[i,A]=be.useState(!1);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Settings"})]}),s.jsx("main",{className:"flex-grow overflow-y-auto",children:s.jsxs("div",{className:"space-y-4 pt-4",children:[s.jsxs(ic,{title:"General",children:[s.jsx(Ss,{title:"Installments Preset",onClick:()=>n("Installments Preset")}),s.jsx(Ss,{title:"Add Signature",onClick:()=>n("Add Signature")}),s.jsx(Ss,{title:"ID Card Settings",onClick:()=>n("ID Card Settings")})]}),s.jsxs(ic,{title:"Communication",children:[s.jsx(Ss,{title:"Message Setting",subtitle:"Set custom SMS/WhatsApp messages",onClick:()=>e("custom-sms-settings")}),s.jsx(Ss,{title:"Set Custom Message",onClick:()=>n("Set Custom Message")}),s.jsx(Ss,{title:"Dual Sim Settings",subtitle:"Sim Slot 1",onClick:()=>n("Dual Sim Settings")}),s.jsx(Ss,{title:"WhatsApp Selection",subtitle:"WhatsApp Business",onClick:()=>n("WhatsApp Selection")})]}),s.jsxs(ic,{title:"Configuration",children:[s.jsx(Ss,{title:"Date Format",subtitle:"dd-MM-yyyy",onClick:()=>n("Date Format")}),s.jsx(Zg,{title:"Automatic Upload",subtitle:"Live Database",enabled:r,onToggle:a}),s.jsx(Zg,{title:"Fingerprint Enable",enabled:i,onToggle:A})]}),s.jsxs(ic,{title:"Other",children:[s.jsx(Ss,{title:"Copyright",subtitle:`Copyright Â© ${new Date().getFullYear()} TCMS`}),s.jsx(Ss,{title:"Terms",onClick:()=>n("Terms")})]})]})})]})}const jc={broadcast:{title:"Broadcast SMS",template:"Dear Parents, [MESSAGE]",placeholders:{"[MESSAGE]":"Your custom message"}},studentRegistration:{title:"Student Registration SMS",template:`[STUDENT_NAME] is registered successfully with [ACADEMY_NAME] on date [DATE], FUTURE UPDATES WILL BE PROVIDED TO THIS NUMBER.

Thanks & Regards,
[ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[ACADEMY_NAME]":"for academy name","[DATE]":"for registration date"}},feeReminder:{title:"Fee Reminder SMS",template:`Gentle Fee Reminder.
Dear Parents, A fee of Rs. [FEES_AMOUNT] of [FEES_MONTHS] month(s) is pending for [STUDENT_NAME]([BATCH_NAME]). Kindly clear outstanding fee immediately to continue classes uninterrupted.

Thanks and Regards
[ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[BATCH_NAME]":"for batch name","[ACADEMY_NAME]":"for academy name","[FEES_AMOUNT]":"for amount","[FEES_MONTHS]":"for months"}},feeReceipt:{title:"Fee Receipt SMS",template:"Fees Rs. [FEES_AMOUNT] received from [STUDENT_NAME]([BATCH_NAME]) on date : [DATE]. Thanks and Regards [ACADEMY_NAME]",placeholders:{"[STUDENT_NAME]":"for student name","[BATCH_NAME]":"for batch name","[ACADEMY_NAME]":"for academy name","[FEES_AMOUNT]":"for amount","[DATE]":"for payment date"}},salary:{title:"Salary SMS",template:"Salary Rs. [SALARY_AMOUNT] credit to [STAFF_NAME] on date : [DATE]. Thanks and Regards [ACADEMY_NAME]",placeholders:{"[STAFF_NAME]":"for Staff Name","[ACADEMY_NAME]":"for academy name","[SALARY_AMOUNT]":"for amount","[DATE]":"for payment date"}},attendance:{title:"Attendance SMS",template:`Student : [STUDENT_NAME]([BATCH_NAME]) is *[STATUS]* for today's class Date : [DATE]
Regards,
[ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[BATCH_NAME]":"for batch name","[STATUS]":"for present/absent","[DATE]":"for attendance date"}},monthlyAttendanceReport:{title:"Monthly Attendance Report SMS",template:`Dear Parents, Monthly attendance report for [STUDENT_NAME] ([BATCH_NAME]) for [MONTH]: Present-[P_DAYS], Absent-[A_DAYS], Leave-[L_DAYS].
Regards,
[ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[BATCH_NAME]":"for batch name","[MONTH]":"for the report month","[P_DAYS]":"for present days count","[A_DAYS]":"for absent days count","[L_DAYS]":"for leave days count","[ACADEMY_NAME]":"for academy name"}},staffAttendance:{title:"Staff Attendance SMS",template:"Staff : [STAFF_NAME] is [STATUS] on [ACADEMY_NAME] Date : [DATE]",placeholders:{"[STAFF_NAME]":"for student name","[ACADEMY_NAME]":"for academy name","[STATUS]":"for present/absent","[DATE]":"for attendance date"}},examMarks:{title:"Exam Marks SMS",template:`Student Name : [STUDENT_NAME]([BATCH_NAME])
Topic : [EXAM_TOPIC]
Result : [MARKS]/[MAX_MARKS] on [DATE]
Regards,
[ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[BATCH_NAME]":"for batch name","[ACADEMY_NAME]":"for academy name","[EXAM_TOPIC]":"for exam topic","[MARKS]":"for obtained marks","[MAX_MARKS]":"for maximum marks","[REMARKS]":"for remarks","[DATE]":"for exam date"}},enquiryRegistered:{title:"Enquiry Registered SMS",template:"Welcome [STUDENT_NAME] to [ACADEMY_NAME]... You came to our academy enquiry for [ENQUIRY_TOPIC] on [DATE]",placeholders:{"[STUDENT_NAME]":"for student name","[ACADEMY_NAME]":"for academy name","[ENQUIRY_TOPIC]":"for enquiry topic","[DATE]":"for enquiry date"}},birthdayWishes:{title:"Birthday Wishes SMS",template:`Dear [STUDENT_NAME],
â€œWishing you the best on your birthday and everything good in the year ahead.â€
From : [ACADEMY_NAME] ~`,placeholders:{"[STUDENT_NAME]":"for student name","[ACADEMY_NAME]":"for academy name"}}},NS=Object.keys(jc),SS=({title:t,template:e,onClick:n,onReset:r})=>s.jsxs("div",{onClick:n,className:"w-full bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between text-left hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer",children:[s.jsxs("div",{className:"flex-1 overflow-hidden",children:[s.jsx("h3",{className:"font-semibold text-blue-600 dark:text-blue-400",children:t}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate pr-2",children:e.replace(/\n/g," ")})]}),s.jsx("button",{onClick:a=>{a.stopPropagation(),window.confirm(`Are you sure you want to reset the "${t}" template to its default?`)&&r()},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 flex-shrink-0","aria-label":`Reset ${t} template`,children:s.jsx(cf,{className:"w-5 h-5"})})]}),IS=({templateKey:t,currentTemplate:e,onSave:n,onClose:r})=>{const[a,i]=q.useState(e),A=jc[t],o=()=>{n(a),r()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-lg mx-auto flex flex-col max-h-[90vh]",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:A.title}),s.jsx("textarea",{value:a,onChange:l=>i(l.target.value),className:"w-full flex-grow p-3 border rounded-lg bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",rows:8}),s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Available Placeholders:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(A.placeholders).map(([l,c])=>s.jsx("div",{title:c,className:"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300 text-xs font-mono px-2 py-1 rounded-md cursor-help",children:l},l))})]}),s.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[s.jsx("button",{onClick:r,className:"px-6 py-2.5 rounded-lg bg-red-600 text-white font-bold hover:bg-red-700 transition-colors",children:"CANCEL"}),s.jsx("button",{onClick:o,className:"px-6 py-2.5 rounded-lg bg-green-600 text-white font-bold hover:bg-green-700 transition-colors",children:"SAVE"})]})]})})};function FS({onBack:t,academy:e,onSave:n}){const[r,a]=q.useState(null),i={...Object.fromEntries(Object.entries(jc).map(([l,c])=>[l,c.template])),...e.smsTemplates},A=(l,c)=>{const d={...e.smsTemplates,[l]:c};n({smsTemplates:d})},o=l=>{const c={...e.smsTemplates};delete c[l],n({smsTemplates:c})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to settings",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Custom SMS Settings"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-3",children:NS.map(l=>s.jsx(SS,{title:jc[l].title,template:i[l],onClick:()=>a(l),onReset:()=>o(l)},l))})})]}),r&&s.jsx(IS,{templateKey:r,currentTemplate:i[r],onSave:l=>A(r,l),onClose:()=>a(null)})]})}const ES=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.472-2.472a3.75 3.75 0 00-5.303-5.303L6 11.42m5.877 5.877l-5.877-5.877m0 0a3.75 3.75 0 015.303-5.303L17.25 6"})}),kS=({notice:t})=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:t.title}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Posted on: ",t.createdAt.toDate().toLocaleDateString()]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2 whitespace-pre-wrap",children:t.description}),t.attachmentUrl&&s.jsxs("a",{href:t.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:[s.jsx(UA,{className:"w-4 h-4"}),s.jsx("span",{children:t.attachmentName||"View Attachment"})]})]});function US({onBack:t,notices:e}){const n=q.useMemo(()=>{const r=new Date;return e.filter(a=>(a.targetAudience==="All"||a.targetAudience==="Staff")&&a.expiryDate.toDate()>=r).sort((a,i)=>i.createdAt.toMillis()-a.createdAt.toMillis())},[e]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Notice Board"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:n.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No new notices at the moment."})}):s.jsx("div",{className:"space-y-3",children:n.map(r=>s.jsx(kS,{notice:r},r.id))})})]})}function jS({onBack:t,pendingLeaves:e,onNavigate:n}){return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Notifications"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:e.length===0?s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"No new notifications."})}):s.jsx("div",{className:"space-y-3",children:e.map(r=>s.jsxs("button",{onClick:()=>n("leave-manager"),className:"w-full text-left bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:s.jsx(Zs,{className:"w-5 h-5 text-orange-500"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{children:["New Leave Request from ",s.jsx("strong",{children:r.userName}),"."]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r.requestedAt.toDate().toLocaleString()})]})]},r.id))})})]})}const TS=({onClose:t,onSave:e,staffMember:n,date:r,batches:a,scheduledClasses:i,existingEntry:A})=>{const o=!!A,[l,c]=q.useState((A==null?void 0:A.scheduleItemId)||(i.length>0?i[0].id:"unscheduled")),[d,h]=q.useState(o&&!(A!=null&&A.scheduleItemId)?A.batchId:""),[p,m]=q.useState(o&&!(A!=null&&A.scheduleItemId)?A.subject:""),[B,y]=q.useState((A==null?void 0:A.startTime)||""),[b,C]=q.useState((A==null?void 0:A.endTime)||""),[N,k]=q.useState((A==null?void 0:A.notes)||""),[E,_]=q.useState(!1),M=q.useMemo(()=>[...i.map(U=>({value:U.id,label:`${U.subject} - ${U.batchName} (${U.startTime})`})),{value:"unscheduled",label:"Unscheduled Class"}],[i]),D=async U=>{U.preventDefault(),_(!0);let j={};if(l==="unscheduled"){const O=a.find(F=>F.id===d);if(!O||!p){alert("Please select a batch and enter a subject for unscheduled classes."),_(!1);return}j={batchId:O.id,batchName:O.name,subject:p,scheduleItemId:null}}else{const O=i.find(I=>I.id===l),F=a.find(I=>I.name===(O==null?void 0:O.batchName));if(!O||!F){alert("Selected scheduled class is invalid."),_(!1);return}j={batchId:F.id,batchName:F.name,subject:O.subject,scheduleItemId:O.id}}try{await e({...j,startTime:B,endTime:b,notes:N}),t()}catch(O){console.error(O),alert("Failed to save attendance.")}finally{_(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg w-full max-w-lg mx-auto flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:o?"Edit Entry":"Add Class Entry"}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(In,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:D,className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[s.jsx(On,{label:"Class",options:M,selectedValue:l,onSelect:c}),l==="unscheduled"&&s.jsxs("div",{className:"p-3 border rounded-md space-y-3 bg-gray-50 dark:bg-gray-700/50",children:[s.jsx(On,{label:"Batch",options:a.map(U=>({value:U.id,label:U.name})),selectedValue:d,onSelect:h,placeholder:"Select batch..."}),s.jsx("input",{type:"text",placeholder:"Subject",value:p,onChange:U=>m(U.target.value),className:"w-full p-2 border rounded-md"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Start Time"}),s.jsx("input",{type:"time",value:B,onChange:U=>y(U.target.value),required:!0,className:"mt-1 w-full p-2 border rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"End Time"}),s.jsx("input",{type:"time",value:b,onChange:U=>C(U.target.value),required:!0,className:"mt-1 w-full p-2 border rounded-md"})]})]}),s.jsx("textarea",{placeholder:"Notes (optional)",value:N,onChange:U=>k(U.target.value),rows:3,className:"w-full p-2 border rounded-md"}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 rounded-lg bg-gray-200 dark:bg-gray-600 font-bold",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:E,className:"px-6 py-2.5 rounded-lg bg-indigo-600 text-white font-bold disabled:bg-indigo-300",children:E?"Saving...":"Save"})]})]})]})})};function QS({onBack:t,batches:e,staff:n,academyId:r,isDemoMode:a,staffAttendance:i,onSave:A,onDelete:o}){var U;const[l,c]=q.useState(new Date),[d,h]=q.useState(((U=n.find(j=>j.isActive))==null?void 0:U.id)||null),[p,m]=q.useState(!1),[B,y]=q.useState(null),[b,C]=q.useState(!1),[N,k]=q.useState([]),E=l.toISOString().split("T")[0],_=n.filter(j=>j.isActive);q.useEffect(()=>{if(!d||a){k([]);return}(async()=>{C(!0);try{const O=Xe(Te,`academies/${r}/schedules/${E}`),F=await Sn(O),I=[];if(F.exists()){const P=F.data();for(const V in P){const ee=e.find(X=>X.id===V);ee&&P[V].forEach(X=>{X.type==="class"&&X.teacherId===d&&I.push({...X,batchName:ee.name})})}}I.sort((P,V)=>P.startTime.localeCompare(V.startTime)),k(I)}catch(O){console.error("Error fetching staff schedule:",O)}finally{C(!1)}})()},[l,d,r,a,e]);const M=q.useMemo(()=>i.filter(j=>j.staffId===d&&j.date.toDate().toDateString()===l.toDateString()).sort((j,O)=>j.startTime.localeCompare(O.startTime)),[i,d,l]),D=async j=>{if(!d)return;const O=n.find(F=>F.id===d);O&&await A({...j,staffId:O.id,staffName:O.name,date:Lt.fromDate(l)},B==null?void 0:B.id)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Staff Attendance"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm space-y-4 mb-4",children:[s.jsx("input",{type:"date",value:E,onChange:j=>c(new Date(j.target.value)),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"}),s.jsx(On,{label:"Select Staff",options:_.map(j=>({value:j.id,label:j.name})),selectedValue:d,onSelect:h,placeholder:"Select a staff member"})]}),d&&s.jsxs(s.Fragment,{children:[b?s.jsx(Ar,{message:"Loading schedule..."}):M.length>0?s.jsx("div",{className:"space-y-3",children:M.map(j=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold",children:[j.subject," ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",j.batchName,")"]})]}),s.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[j.startTime," - ",j.endTime," (",j.durationMinutes," mins)"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{y(j),m(!0)},className:"p-1.5 text-blue-600 rounded-full hover:bg-blue-100",children:s.jsx(Gn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>o(j.id),className:"p-1.5 text-red-600 rounded-full hover:bg-red-100",children:s.jsx(Qn,{className:"w-4 h-4"})})]})]},j.id))}):s.jsx("p",{className:"text-center text-gray-500 py-6",children:"No attendance marked for this day."}),s.jsxs("button",{onClick:()=>{y(null),m(!0)},className:"mt-4 w-full flex items-center justify-center gap-2 bg-indigo-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-indigo-700",children:[s.jsx(Lr,{className:"w-5 h-5"}),"Add Class Entry"]})]})]})]}),p&&d&&s.jsx(TS,{onClose:()=>m(!1),onSave:D,staffMember:n.find(j=>j.id===d),date:l,batches:e,scheduledClasses:N,existingEntry:B})]})}function LS({onBack:t,staff:e,staffAttendance:n}){var h;const[r,a]=q.useState(null),[i,A]=q.useState(""),[o,l]=q.useState(""),c=e.filter(p=>p.isActive),d=q.useMemo(()=>{if(!r)return null;const p=n.filter(y=>{if(y.staffId!==r)return!1;const b=y.date.toDate(),C=i?new Date(i):null,N=o?new Date(o):null;return C&&C.setHours(0,0,0,0),N&&N.setHours(23,59,59,999),(!C||b>=C)&&(!N||b<=N)}).sort((y,b)=>y.date.toMillis()-b.date.toMillis()),B=(p.reduce((y,b)=>y+b.durationMinutes,0)/60).toFixed(2);return{records:p,totalClasses:p.length,totalHours:B}},[n,r,i,o]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10 no-print",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Staff Attendance Report"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm space-y-4 no-print",children:[s.jsx(On,{label:"Select Staff",options:c.map(p=>({value:p.id,label:p.name})),selectedValue:r,onSelect:a,placeholder:"Select a staff member"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"date",value:i,onChange:p=>A(p.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600","aria-label":"Start Date"}),s.jsx("input",{type:"date",value:o,onChange:p=>l(p.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600","aria-label":"End Date"})]})]}),d&&s.jsxs("div",{className:"printable-form bg-white dark:bg-gray-800 mt-4 rounded-lg shadow-sm",children:[s.jsxs("div",{className:"p-4 text-center border-b dark:border-gray-700",children:[s.jsx(hi,{className:"w-12 h-12 mx-auto mb-2"}),s.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:"Staff Attendance Report"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(h=c.find(p=>p.id===r))==null?void 0:h.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[i," to ",o]})]}),s.jsx("div",{className:"overflow-x-auto p-4",children:s.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700",children:[s.jsx("th",{className:"p-2 border dark:border-gray-600",children:"Date"}),s.jsx("th",{className:"p-2 border dark:border-gray-600",children:"Class Details"}),s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center",children:"Duration"})]})}),s.jsxs("tbody",{children:[d.records.map(p=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[s.jsx("td",{className:"p-2 border dark:border-gray-600 whitespace-nowrap",children:p.date.toDate().toLocaleDateString()}),s.jsxs("td",{className:"p-2 border dark:border-gray-600",children:[s.jsx("p",{className:"font-semibold",children:p.subject}),s.jsxs("p",{className:"text-xs text-gray-500",children:[p.batchName," | ",p.startTime," - ",p.endTime]})]}),s.jsxs("td",{className:"p-2 border dark:border-gray-600 text-center font-mono",children:[p.durationMinutes," mins"]})]},p.id)),s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700 font-bold",children:[s.jsx("td",{className:"p-2 border dark:border-gray-600",colSpan:2,children:"Total"}),s.jsxs("td",{className:"p-2 border dark:border-gray-600 text-center",children:[d.totalClasses," classes (",d.totalHours," hrs)"]})]})]})]})})]})]}),d&&s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700 flex-shrink-0 no-print",children:s.jsxs("button",{onClick:()=>window.print(),className:"w-full flex items-center justify-center space-x-2 bg-slate-800 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-900 transition-colors shadow-md",children:[s.jsx(kf,{className:"w-5 h-5"}),s.jsx("span",{children:"Print / Save as PDF"})]})})]})}function _S({onBack:t,staff:e,staffAttendance:n}){const r=new Date,a=new Date(r.getFullYear(),r.getMonth(),1).toISOString().split("T")[0],i=new Date(r.getFullYear(),r.getMonth()+1,0).toISOString().split("T")[0],[A,o]=q.useState(a),[l,c]=q.useState(i),d=q.useMemo(()=>{const h=n.filter(B=>{if(B.staffId!==e.id)return!1;const y=B.date.toDate(),b=A?new Date(A):null,C=l?new Date(l):null;return b&&b.setHours(0,0,0,0),C&&C.setHours(23,59,59,999),(!b||y>=b)&&(!C||y<=C)}).sort((B,y)=>B.date.toMillis()-y.date.toMillis()),m=(h.reduce((B,y)=>B+y.durationMinutes,0)/60).toFixed(2);return{records:h,totalClasses:h.length,totalHours:m}},[n,e.id,A,l]);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"My Attendance"})]}),s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm space-y-4 mb-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Filter by Date:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"date",value:A,onChange:h=>o(h.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600","aria-label":"Start Date"}),s.jsx("input",{type:"date",value:l,onChange:h=>c(h.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600","aria-label":"End Date"})]})]}),d&&s.jsx("div",{className:"bg-white dark:bg-gray-800 mt-4 rounded-lg shadow-sm",children:s.jsx("div",{className:"overflow-x-auto p-4",children:s.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700",children:[s.jsx("th",{className:"p-2 border dark:border-gray-600",children:"Date"}),s.jsx("th",{className:"p-2 border dark:border-gray-600",children:"Class Details"}),s.jsx("th",{className:"p-2 border dark:border-gray-600 text-center",children:"Duration"})]})}),s.jsxs("tbody",{children:[d.records.map(h=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[s.jsx("td",{className:"p-2 border dark:border-gray-600 whitespace-nowrap",children:h.date.toDate().toLocaleDateString()}),s.jsxs("td",{className:"p-2 border dark:border-gray-600",children:[s.jsx("p",{className:"font-semibold",children:h.subject}),s.jsxs("p",{className:"text-xs text-gray-500",children:[h.batchName," | ",h.startTime," - ",h.endTime]})]}),s.jsxs("td",{className:"p-2 border dark:border-gray-600 text-center font-mono",children:[h.durationMinutes," mins"]})]},h.id)),s.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700 font-bold",children:[s.jsx("td",{className:"p-2 border dark:border-gray-600",colSpan:2,children:"Total"}),s.jsxs("td",{className:"p-2 border dark:border-gray-600 text-center",children:[d.totalClasses," classes (",d.totalHours," hrs)"]})]})]})]})})})]})]})}const MS=({onConfirm:t,onCancel:e,isDeleting:n,routeName:r})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/40 mb-5",children:s.jsx(Qn,{className:"h-9 w-9 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Are you sure?"}),s.jsxs("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:['Do you really want to delete the route "',r,'"? Assigned students will be unmapped. This action cannot be undone.']}),s.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3",children:[s.jsx("button",{onClick:t,disabled:n,className:"w-full sm:w-auto flex-1 bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors shadow-md disabled:bg-red-300",children:n?"Deleting...":"Delete"}),s.jsx("button",{onClick:e,disabled:n,className:"w-full sm:w-auto flex-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})});function DS({onBack:t,onCreate:e,routes:n,onNavigate:r,onDelete:a}){const[i,A]=be.useState(null),[o,l]=be.useState(!1),c=async()=>{if(i){l(!0);try{await a(i.id),A(null)}catch(d){console.error("Failed to delete route:",d),alert("Could not delete the route. Please try again.")}finally{l(!1)}}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"animate-fade-in flex flex-col h-full",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go to dashboard",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Manage Transport"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:n.length===0?s.jsxs("div",{className:"text-center py-20 px-4",children:[s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400 mb-4",children:"No transport routes created yet."}),s.jsxs("p",{className:"text-gray-400 dark:text-gray-500",children:["Click the ",s.jsx("span",{className:"font-bold text-indigo-500",children:"+"})," button to add your first route."]})]}):s.jsx("div",{className:"space-y-4 pb-20",children:n.map(d=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border-l-4 border-amber-500 hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:d.routeName}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:[d.driverName," Â· ",d.vehicleNumber]})]}),s.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:["â‚¹",d.monthlyFee]})]})}),s.jsxs("div",{className:"border-t dark:border-gray-700 mt-4 pt-3 flex justify-between items-center",children:[s.jsx("button",{onClick:()=>A(d),className:"p-2 text-red-600 bg-red-100 rounded-full hover:bg-red-200 transition-colors","aria-label":`Delete route ${d.routeName}`,children:s.jsx(Qn,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>r("edit-transport-route",{routeId:d.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-gray-600 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Gn,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>r("map-students-to-route",{routeId:d.id}),className:"flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:[s.jsx(gi,{className:"w-4 h-4"}),s.jsx("span",{children:"Assign Students"})]})]})]})]},d.id))})}),s.jsx("button",{onClick:e,className:"absolute bottom-20 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","aria-label":"Create New Route",children:s.jsx(Lr,{className:"w-8 h-8"})})]}),i&&s.jsx(MS,{routeName:i.routeName,isDeleting:o,onConfirm:c,onCancel:()=>A(null)})]})}const PS=({onClose:t,message:e})=>{const[n,r]=be.useState(3);return be.useEffect(()=>{if(n<=0){t();return}const a=setTimeout(()=>r(i=>i-1),1e3);return()=>clearTimeout(a)},[n,t]),s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/40 mb-5",children:s.jsxs("svg",{className:"w-9 h-9 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("style",{children:`
                            .tick-path {
                                stroke-dasharray: 48;
                                stroke-dashoffset: 48;
                                animation: draw 0.5s ease-out forwards;
                            }
                            @keyframes draw {
                                to {
                                    stroke-dashoffset: 0;
                                }
                            }
                        `}),s.jsx("path",{className:"tick-path",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})]})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:e}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:["Redirecting in ",n,"..."]}),s.jsx("button",{onClick:t,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"OK"})]})})},sA=({label:t,id:e,...n})=>s.jsxs("div",{children:[s.jsx("label",{htmlFor:e,className:"block text-gray-700 dark:text-gray-300 text-sm font-medium mb-1",children:t}),n.type==="textarea"?s.jsx("textarea",{id:e,className:"w-full bg-white dark:bg-gray-700 p-2 border border-gray-300 dark:border-gray-600 rounded-md",...n}):s.jsx("input",{id:e,className:"w-full bg-white dark:bg-gray-700 p-2 border border-gray-300 dark:border-gray-600 rounded-md",...n})]});function RS({onBack:t,onSave:e}){const[n,r]=be.useState({routeName:"",vehicleNumber:"",driverName:"",driverContact:"",points:"",monthlyFee:""}),[a,i]=be.useState(!1),[A,o]=be.useState(!1),l=d=>{r(h=>({...h,[d.target.name]:d.target.value}))},c=async()=>{if(!n.routeName.trim()||!n.monthlyFee.trim()){alert("Route Name and Monthly Fee are required.");return}i(!0);try{await e({...n,monthlyFee:parseInt(n.monthlyFee,10)||0}),o(!0)}catch{alert("Failed to save route. Please try again."),i(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to routes",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"New Transport Route"})]}),s.jsxs("form",{onSubmit:d=>{d.preventDefault(),c()},className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx(sA,{id:"routeName",name:"routeName",label:"Route Name",value:n.routeName,onChange:l,required:!0}),s.jsx(sA,{id:"vehicleNumber",name:"vehicleNumber",label:"Vehicle Number",value:n.vehicleNumber,onChange:l}),s.jsx(sA,{id:"driverName",name:"driverName",label:"Driver Name",value:n.driverName,onChange:l}),s.jsx(sA,{id:"driverContact",name:"driverContact",label:"Driver Contact",type:"tel",value:n.driverContact,onChange:l}),s.jsx(sA,{id:"points",name:"points",label:"Pickup/Drop Points (comma-separated)",type:"textarea",value:n.points,onChange:l,rows:3}),s.jsx(sA,{id:"monthlyFee",name:"monthlyFee",label:"Monthly Fee (â‚¹)",type:"number",inputMode:"numeric",value:n.monthlyFee,onChange:l,required:!0})]}),s.jsx("footer",{className:"p-4 flex-shrink-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:a,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:a?"SAVING...":"SAVE ROUTE"})})]})]}),A&&s.jsx(PS,{message:"Route saved successfully!",onClose:t})]})}const HS=({onClose:t,message:e})=>{const[n,r]=be.useState(3);return be.useEffect(()=>{if(n<=0){t();return}const a=setTimeout(()=>r(i=>i-1),1e3);return()=>clearTimeout(a)},[n,t]),s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/40 mb-5",children:s.jsxs("svg",{className:"w-9 h-9 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("style",{children:`
                            .tick-path {
                                stroke-dasharray: 48;
                                stroke-dashoffset: 48;
                                animation: draw 0.5s ease-out forwards;
                            }
                            @keyframes draw {
                                to {
                                    stroke-dashoffset: 0;
                                }
                            }
                        `}),s.jsx("path",{className:"tick-path",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})]})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:e}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:["Redirecting in ",n,"..."]}),s.jsx("button",{onClick:t,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"OK"})]})})},aA=({label:t,id:e,...n})=>s.jsxs("div",{children:[s.jsx("label",{htmlFor:e,className:"block text-gray-700 dark:text-gray-300 text-sm font-medium mb-1",children:t}),n.type==="textarea"?s.jsx("textarea",{id:e,className:"w-full bg-white dark:bg-gray-700 p-2 border border-gray-300 dark:border-gray-600 rounded-md",...n}):s.jsx("input",{id:e,className:"w-full bg-white dark:bg-gray-700 p-2 border border-gray-300 dark:border-gray-600 rounded-md",...n})]});function OS({onBack:t,onSave:e,route:n}){const[r,a]=be.useState({routeName:n.routeName,vehicleNumber:n.vehicleNumber,driverName:n.driverName,driverContact:n.driverContact,points:n.points,monthlyFee:String(n.monthlyFee)}),[i,A]=be.useState(!1),[o,l]=be.useState(!1),c=h=>{a(p=>({...p,[h.target.name]:h.target.value}))},d=async()=>{if(!r.routeName.trim()||!r.monthlyFee.trim()){alert("Route Name and Monthly Fee are required.");return}A(!0);try{await e(n.id,{...r,monthlyFee:parseInt(r.monthlyFee,10)||0}),l(!0)}catch{alert("Failed to update route. Please try again."),A(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-slate-100 dark:bg-gray-900 flex flex-col h-full animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back to routes",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"Edit Transport Route"})]}),s.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},className:"flex-grow flex flex-col",children:[s.jsxs("main",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[s.jsx(aA,{id:"routeName",name:"routeName",label:"Route Name",value:r.routeName,onChange:c,required:!0}),s.jsx(aA,{id:"vehicleNumber",name:"vehicleNumber",label:"Vehicle Number",value:r.vehicleNumber,onChange:c}),s.jsx(aA,{id:"driverName",name:"driverName",label:"Driver Name",value:r.driverName,onChange:c}),s.jsx(aA,{id:"driverContact",name:"driverContact",label:"Driver Contact",type:"tel",value:r.driverContact,onChange:c}),s.jsx(aA,{id:"points",name:"points",label:"Pickup/Drop Points (comma-separated)",type:"textarea",value:r.points,onChange:c,rows:3}),s.jsx(aA,{id:"monthlyFee",name:"monthlyFee",label:"Monthly Fee (â‚¹)",type:"number",inputMode:"numeric",value:r.monthlyFee,onChange:c,required:!0})]}),s.jsx("footer",{className:"p-4 flex-shrink-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{type:"submit",disabled:i,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300",children:i?"UPDATING...":"UPDATE ROUTE"})})]})]}),o&&s.jsx(HS,{message:"Route updated successfully!",onClose:t})]})}function GS({onBack:t,route:e,students:n,onSave:r}){const[a,i]=q.useState(()=>new Set(n.filter(m=>m.transportRouteId===e.id).map(m=>m.id))),[A,o]=q.useState(""),l=q.useMemo(()=>new Set(n.filter(m=>m.transportRouteId===e.id).map(m=>m.id)),[n,e.id]),{assigned:c,unassigned:d}=q.useMemo(()=>{const m=[],B=[];return n.filter(y=>y.isActive).forEach(y=>{(y.name.toLowerCase().includes(A.toLowerCase())||y.rollNumber.toLowerCase().includes(A.toLowerCase()))&&(a.has(y.id)?m.push(y):(!y.transportRouteId||y.transportRouteId===e.id)&&B.push(y))}),{assigned:m,unassigned:B}},[n,a,A,e.id]),h=m=>{i(B=>{const y=new Set(B);return y.has(m)?y.delete(m):y.add(m),y})},p=()=>{const m=[...a].filter(y=>!l.has(y)),B=[...l].filter(y=>!a.has(y));r(e.id,m,B)};return s.jsxs("div",{className:"flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h1",{className:"text-xl font-bold",children:"Assign Students"}),s.jsx("p",{className:"text-sm opacity-90",children:e.routeName})]})]}),s.jsx("div",{className:"p-4 flex-shrink-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search students...",value:A,onChange:m=>o(m.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"}),s.jsx(ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]})}),s.jsxs("main",{className:"flex-grow overflow-y-auto px-4 space-y-4",children:[s.jsxs("section",{children:[s.jsxs("h2",{className:"font-bold text-gray-700 dark:text-gray-200 mb-2",children:["Assigned Students (",c.length,")"]}),s.jsx("div",{className:"space-y-2",children:c.map(m=>s.jsxs("button",{onClick:()=>h(m.id),className:"w-full text-left bg-white dark:bg-gray-800 p-2 rounded-md shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:m.name}),s.jsx("p",{className:"text-xs text-gray-500",children:m.rollNumber})]}),s.jsx("span",{className:"text-red-500 font-bold text-lg",children:"-"})]},m.id))})]}),s.jsxs("section",{children:[s.jsxs("h2",{className:"font-bold text-gray-700 dark:text-gray-200 mb-2",children:["Unassigned Students (",d.length,")"]}),s.jsx("div",{className:"space-y-2",children:d.map(m=>s.jsxs("button",{onClick:()=>h(m.id),className:"w-full text-left bg-white dark:bg-gray-800 p-2 rounded-md shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:m.name}),s.jsx("p",{className:"text-xs text-gray-500",children:m.rollNumber})]}),s.jsx("span",{className:"text-green-500 font-bold text-lg",children:"+"})]},m.id))})]})]}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700",children:s.jsx("button",{onClick:p,className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-lg",children:"Save Changes"})})]})}const Ac=({label:t,value:e})=>s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t}),s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:e})]});function VS({student:t,transportRoutes:e,onBack:n}){const r=e.find(a=>a.id===t.transportRouteId);return s.jsxs("div",{className:"animate-fade-in flex flex-col h-full bg-gray-100 dark:bg-gray-900",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center shadow-md flex-shrink-0 sticky top-0 z-10",children:[s.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Go back",children:s.jsx(Ge,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold ml-2",children:"My Transport Details"})]}),s.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:r?s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[s.jsx(Ac,{label:"Route Name",value:r.routeName}),s.jsx(Ac,{label:"Vehicle Number",value:r.vehicleNumber}),s.jsx(Ac,{label:"Driver Name",value:r.driverName}),s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Driver Contact"}),s.jsxs("a",{href:`tel:${r.driverContact}`,className:"font-semibold text-indigo-600 dark:text-indigo-400 flex items-center gap-2",children:[s.jsx(Ua,{className:"w-4 h-4"}),r.driverContact]})]}),s.jsx(Ac,{label:"Monthly Fee",value:`â‚¹${r.monthlyFee}`}),s.jsxs("div",{className:"py-3",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Pickup/Drop Points"}),s.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-100 whitespace-pre-line",children:r.points.split(",").join(`
`)})]})]}):s.jsx("div",{className:"text-center py-20 px-4",children:s.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"You are not assigned to any transport route."})})})]})}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KS,qS;function zS(){return{geminiUrl:KS,vertexUrl:qS}}function JS(t,e,n,r){var a,i;if(!(t!=null&&t.baseUrl)){const A=zS();return e?(a=A.vertexUrl)!==null&&a!==void 0?a:n:(i=A.geminiUrl)!==null&&i!==void 0?i:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ea{}function qe(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];return i!=null?String(i):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function g(t,e,n){for(let i=0;i<e.length-1;i++){const A=e[i];if(A.endsWith("[]")){const o=A.slice(0,-2);if(!(o in t))if(Array.isArray(n))t[o]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${A}`);if(Array.isArray(t[o])){const l=t[o];if(Array.isArray(n))for(let c=0;c<l.length;c++){const d=l[c];g(d,e.slice(i+1),n[c])}else for(const c of l)g(c,e.slice(i+1),n)}return}else if(A.endsWith("[0]")){const o=A.slice(0,-3);o in t||(t[o]=[{}]);const l=t[o];g(l[0],e.slice(i+1),n);return}(!t[A]||typeof t[A]!="object")&&(t[A]={}),t=t[A]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function u(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const a=e[r];if(a.endsWith("[]")){const i=a.slice(0,-2);if(i in t){const A=t[i];return Array.isArray(A)?A.map(o=>u(o,e.slice(r+1),n)):n}else return n}else t=t[a]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function WS(t,e){for(const[n,r]of Object.entries(e)){const a=n.split("."),i=r.split("."),A=new Set;let o=-1;for(let l=0;l<a.length;l++)if(a[l]==="*"){o=l;break}if(o!==-1&&i.length>o)for(let l=o;l<i.length;l++){const c=i[l];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&A.add(c)}Xu(t,a,i,0,A)}}function Xu(t,e,n,r,a){if(r>=e.length||typeof t!="object"||t===null)return;const i=e[r];if(i.endsWith("[]")){const A=i.slice(0,-2),o=t;if(A in o&&Array.isArray(o[A]))for(const l of o[A])Xu(l,e,n,r+1,a)}else if(i==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const A=t,o=Object.keys(A).filter(c=>!c.startsWith("_")&&!a.has(c)),l={};for(const c of o)l[c]=A[c];for(const[c,d]of Object.entries(l)){const h=[];for(const p of n.slice(r))p==="*"?h.push(c):h.push(p);g(A,h,d)}for(const c of o)delete A[c]}}else{const A=t;i in A&&Xu(A[i],e,n,r+1,a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jf(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YS(t){const e={},n=u(t,["operationName"]);n!=null&&g(e,["operationName"],n);const r=u(t,["resourceName"]);return r!=null&&g(e,["_url","resourceName"],r),e}function $S(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response","generateVideoResponse"]);return A!=null&&g(e,["response"],ZS(A)),e}function XS(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response"]);return A!=null&&g(e,["response"],e3(A)),e}function ZS(t){const e={},n=u(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(A=>t3(A))),g(e,["generatedVideos"],i)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&g(e,["raiMediaFilteredCount"],r);const a=u(t,["raiMediaFilteredReasons"]);return a!=null&&g(e,["raiMediaFilteredReasons"],a),e}function e3(t){const e={},n=u(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(A=>n3(A))),g(e,["generatedVideos"],i)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&g(e,["raiMediaFilteredCount"],r);const a=u(t,["raiMediaFilteredReasons"]);return a!=null&&g(e,["raiMediaFilteredReasons"],a),e}function t3(t){const e={},n=u(t,["video"]);return n!=null&&g(e,["video"],o3(n)),e}function n3(t){const e={},n=u(t,["_self"]);return n!=null&&g(e,["video"],l3(n)),e}function r3(t){const e={},n=u(t,["operationName"]);return n!=null&&g(e,["_url","operationName"],n),e}function s3(t){const e={},n=u(t,["operationName"]);return n!=null&&g(e,["_url","operationName"],n),e}function a3(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response"]);return A!=null&&g(e,["response"],i3(A)),e}function i3(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&g(e,["parent"],r);const a=u(t,["documentName"]);return a!=null&&g(e,["documentName"],a),e}function Qx(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response"]);return A!=null&&g(e,["response"],A3(A)),e}function A3(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&g(e,["parent"],r);const a=u(t,["documentName"]);return a!=null&&g(e,["documentName"],a),e}function o3(t){const e={},n=u(t,["uri"]);n!=null&&g(e,["uri"],n);const r=u(t,["encodedVideo"]);r!=null&&g(e,["videoBytes"],jf(r));const a=u(t,["encoding"]);return a!=null&&g(e,["mimeType"],a),e}function l3(t){const e={},n=u(t,["gcsUri"]);n!=null&&g(e,["uri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&g(e,["videoBytes"],jf(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["mimeType"],a),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var e0;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(e0||(e0={}));var t0;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(t0||(t0={}));var n0;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(n0||(n0={}));var Xr;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Xr||(Xr={}));var r0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(r0||(r0={}));var s0;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(s0||(s0={}));var a0;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(a0||(a0={}));var i0;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(i0||(i0={}));var A0;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(A0||(A0={}));var o0;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(o0||(o0={}));var l0;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(l0||(l0={}));var c0;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(c0||(c0={}));var d0;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(d0||(d0={}));var u0;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(u0||(u0={}));var f0;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(f0||(f0={}));var h0;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(h0||(h0={}));var g0;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(g0||(g0={}));var m0;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(m0||(m0={}));var p0;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(p0||(p0={}));var Tc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Tc||(Tc={}));var x0;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(x0||(x0={}));var w0;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(w0||(w0={}));var y0;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(y0||(y0={}));var Zu;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Zu||(Zu={}));var b0;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(b0||(b0={}));var v0;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(v0||(v0={}));var B0;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(B0||(B0={}));var C0;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(C0||(C0={}));var N0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(N0||(N0={}));var S0;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(S0||(S0={}));var I0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(I0||(I0={}));var F0;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(F0||(F0={}));var E0;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(E0||(E0={}));var k0;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(k0||(k0={}));var U0;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(U0||(U0={}));var j0;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(j0||(j0={}));var T0;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(T0||(T0={}));var Q0;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Q0||(Q0={}));var L0;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(L0||(L0={}));var _0;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(_0||(_0={}));var M0;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(M0||(M0={}));var D0;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(D0||(D0={}));var P0;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(P0||(P0={}));var R0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(R0||(R0={}));var H0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(H0||(H0={}));var O0;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(O0||(O0={}));var G0;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(G0||(G0={}));var V0;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(V0||(V0={}));var K0;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(K0||(K0={}));var q0;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(q0||(q0={}));var z0;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(z0||(z0={}));var J0;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(J0||(J0={}));var W0;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(W0||(W0={}));var Y0;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Y0||(Y0={}));var fA;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(fA||(fA={}));class ef{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class So{get text(){var e,n,r,a,i,A,o,l;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",d=!1;const h=[];for(const p of(l=(o=(A=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[m,B]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(B!==null||B!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;d=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?c:void 0}get data(){var e,n,r,a,i,A,o,l;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const d=[];for(const h of(l=(o=(A=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&d.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,r,a,i,A,o,l;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(o=(A=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,r,a,i,A,o,l,c;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(o=(A=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,r,a,i,A,o,l,c;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(o=(A=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.output}}class $0{}class X0{}class c3{}class d3{}class u3{}class f3{}class Z0{}class em{}class tm{}class h3{}class Qc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Qc;let a;const i=e;return n?a=XS(i):a=$S(i),Object.assign(r,a),r}}class nm{}class rm{}class sm{}class g3{}class m3{}class p3{}class Tf{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Tf,i=a3(e);return Object.assign(r,i),r}}class x3{}class w3{}class y3{}class am{}class b3{get text(){var e,n,r;let a="",i=!1;const A=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="text"&&l!=="thought"&&c!==null&&A.push(l);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;i=!0,a+=o.text}}return A.length>0&&console.warn(`there are non-text parts ${A} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?a:void 0}get data(){var e,n,r;let a="";const i=[];for(const A of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[o,l]of Object.entries(A))o!=="inlineData"&&l!==null&&i.push(o);A.inlineData&&typeof A.inlineData.data=="string"&&(a+=atob(A.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class v3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Qf{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Qf,i=Qx(e);return Object.assign(r,i),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ft(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Lx(t,e){const n=Ft(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function _x(t){return Array.isArray(t)?t.map(e=>Lc(e)):[Lc(t)]}function Lc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Mx(t){const e=Lc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Dx(t){const e=Lc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function im(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Px(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>im(e)):[im(t)]}function tf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Am(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function om(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function tr(t){if(t==null)throw new Error("ContentUnion is required");return tf(t)?t:{role:"user",parts:Px(t)}}function Lf(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=tr(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=tr(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>tr(n)):[tr(e)]}function Zr(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Am(t)||om(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tr(t)]}const e=[],n=[],r=tf(t[0]);for(const a of t){const i=tf(a);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(a);else{if(Am(a)||om(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:Px(n)}),e}function B3(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Xr).includes(n[0].toUpperCase())?n[0].toUpperCase():Xr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Xr).includes(r.toUpperCase())?r.toUpperCase():Xr.TYPE_UNSPECIFIED})}}function yA(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&B3(t.type,e);for(const[A,o]of Object.entries(t))if(o!=null)if(A=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;e.type=Object.values(Xr).includes(o.toUpperCase())?o.toUpperCase():Xr.TYPE_UNSPECIFIED}else if(n.includes(A))e[A]=yA(o);else if(r.includes(A)){const l=[];for(const c of o){if(c.type=="null"){e.nullable=!0;continue}l.push(yA(c))}e[A]=l}else if(a.includes(A)){const l={};for(const[c,d]of Object.entries(o))l[c]=yA(d);e[A]=l}else{if(A==="additionalProperties")continue;e[A]=o}return e}function _f(t){return yA(t)}function Mf(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Df(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function jA(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=yA(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=yA(e.response));return t}function TA(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function C3(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function ta(t,e){if(typeof e!="string")throw new Error("name must be a string");return C3(t,e,"cachedContents")}function Rx(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Da(t){return jf(t)}function N3(t){return t!=null&&typeof t=="object"&&"name"in t}function S3(t){return t!=null&&typeof t=="object"&&"video"in t}function I3(t){return t!=null&&typeof t=="object"&&"uri"in t}function Hx(t){var e;let n;if(N3(t)&&(n=t.name),!(I3(t)&&(n=t.uri,n===void 0))&&!(S3(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ox(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Gx(t){for(const e of["models","tunedModels","publisherModels"])if(F3(t,e))return t[e];return[]}function F3(t,e){return t!==null&&typeof t=="object"&&e in t}function E3(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function k3(t,e={}){const n=[],r=new Set;for(const a of t){const i=a.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const A=E3(a,e);A.functionDeclarations&&n.push(...A.functionDeclarations)}return{functionDeclarations:n}}function Vx(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,a=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(a>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function U3(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Kx(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const a=n.inlinedResponses;if(!Array.isArray(a)||a.length===0)return t;let i=!1;for(const A of a){if(typeof A!="object"||A===null)continue;const l=A.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function QA(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function qx(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j3(t){const e={},n=u(t,["responsesFile"]);n!=null&&g(e,["fileName"],n);const r=u(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>uI(A))),g(e,["inlinedResponses"],i)}const a=u(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["inlinedEmbedContentResponses"],i)}return e}function T3(t){const e={},n=u(t,["predictionsFormat"]);n!=null&&g(e,["format"],n);const r=u(t,["gcsDestination","outputUriPrefix"]);r!=null&&g(e,["gcsUri"],r);const a=u(t,["bigqueryDestination","outputUri"]);return a!=null&&g(e,["bigqueryUri"],a),e}function Q3(t){const e={},n=u(t,["format"]);n!=null&&g(e,["predictionsFormat"],n);const r=u(t,["gcsUri"]);r!=null&&g(e,["gcsDestination","outputUriPrefix"],r);const a=u(t,["bigqueryUri"]);if(a!=null&&g(e,["bigqueryDestination","outputUri"],a),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(u(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function pc(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata","displayName"]);r!=null&&g(e,["displayName"],r);const a=u(t,["metadata","state"]);a!=null&&g(e,["state"],qx(a));const i=u(t,["metadata","createTime"]);i!=null&&g(e,["createTime"],i);const A=u(t,["metadata","endTime"]);A!=null&&g(e,["endTime"],A);const o=u(t,["metadata","updateTime"]);o!=null&&g(e,["updateTime"],o);const l=u(t,["metadata","model"]);l!=null&&g(e,["model"],l);const c=u(t,["metadata","output"]);return c!=null&&g(e,["dest"],j3(Kx(c))),e}function nf(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["displayName"]);r!=null&&g(e,["displayName"],r);const a=u(t,["state"]);a!=null&&g(e,["state"],qx(a));const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["createTime"]);A!=null&&g(e,["createTime"],A);const o=u(t,["startTime"]);o!=null&&g(e,["startTime"],o);const l=u(t,["endTime"]);l!=null&&g(e,["endTime"],l);const c=u(t,["updateTime"]);c!=null&&g(e,["updateTime"],c);const d=u(t,["model"]);d!=null&&g(e,["model"],d);const h=u(t,["inputConfig"]);h!=null&&g(e,["src"],L3(h));const p=u(t,["outputConfig"]);p!=null&&g(e,["dest"],T3(Kx(p)));const m=u(t,["completionStats"]);return m!=null&&g(e,["completionStats"],m),e}function L3(t){const e={},n=u(t,["instancesFormat"]);n!=null&&g(e,["format"],n);const r=u(t,["gcsSource","uris"]);r!=null&&g(e,["gcsUri"],r);const a=u(t,["bigquerySource","inputUri"]);return a!=null&&g(e,["bigqueryUri"],a),e}function _3(t,e){const n={};if(u(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(u(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=u(e,["fileName"]);r!=null&&g(n,["fileName"],r);const a=u(e,["inlinedRequests"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>dI(t,A))),g(n,["requests","requests"],i)}return n}function M3(t){const e={},n=u(t,["format"]);n!=null&&g(e,["instancesFormat"],n);const r=u(t,["gcsUri"]);r!=null&&g(e,["gcsSource","uris"],r);const a=u(t,["bigqueryUri"]);if(a!=null&&g(e,["bigquerySource","inputUri"],a),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function D3(t){const e={},n=u(t,["data"]);if(n!=null&&g(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function P3(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function R3(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function H3(t){const e={},n=u(t,["content"]);n!=null&&g(e,["content"],n);const r=u(t,["citationMetadata"]);r!=null&&g(e,["citationMetadata"],O3(r));const a=u(t,["tokenCount"]);a!=null&&g(e,["tokenCount"],a);const i=u(t,["finishReason"]);i!=null&&g(e,["finishReason"],i);const A=u(t,["avgLogprobs"]);A!=null&&g(e,["avgLogprobs"],A);const o=u(t,["groundingMetadata"]);o!=null&&g(e,["groundingMetadata"],o);const l=u(t,["index"]);l!=null&&g(e,["index"],l);const c=u(t,["logprobsResult"]);c!=null&&g(e,["logprobsResult"],c);const d=u(t,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),g(e,["safetyRatings"],p)}const h=u(t,["urlContextMetadata"]);return h!=null&&g(e,["urlContextMetadata"],h),e}function O3(t){const e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a)),g(e,["citations"],r)}return e}function zx(t){const e={},n=u(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>wI(i))),g(e,["parts"],a)}const r=u(t,["role"]);return r!=null&&g(e,["role"],r),e}function G3(t,e){const n={},r=u(t,["displayName"]);if(e!==void 0&&r!=null&&g(e,["batch","displayName"],r),u(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function V3(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const a=u(t,["dest"]);return e!==void 0&&a!=null&&g(e,["outputConfig"],Q3(U3(a))),n}function lm(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["src"]);a!=null&&g(n,["batch","inputConfig"],_3(t,Vx(t,a)));const i=u(e,["config"]);return i!=null&&G3(i,n),n}function K3(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["model"],Ft(t,r));const a=u(e,["src"]);a!=null&&g(n,["inputConfig"],M3(Vx(t,a)));const i=u(e,["config"]);return i!=null&&V3(i,n),n}function q3(t,e){const n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&g(e,["batch","displayName"],r),n}function z3(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["src"]);a!=null&&g(n,["batch","inputConfig"],eI(t,a));const i=u(e,["config"]);return i!=null&&q3(i,n),n}function J3(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function W3(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function Y3(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["name"]);r!=null&&g(e,["name"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);return i!=null&&g(e,["error"],i),e}function $3(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["name"]);r!=null&&g(e,["name"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);return i!=null&&g(e,["error"],i),e}function X3(t,e){const n={},r=u(e,["contents"]);if(r!=null){let i=Lf(t,r);Array.isArray(i)&&(i=i.map(A=>A)),g(n,["requests[]","request","content"],i)}const a=u(e,["config"]);return a!=null&&(g(n,["_self"],Z3(a,n)),WS(n,{"requests[].*":"requests[].request.*"})),n}function Z3(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&g(e,["requests[]","taskType"],r);const a=u(t,["title"]);e!==void 0&&a!=null&&g(e,["requests[]","title"],a);const i=u(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&g(e,["requests[]","outputDimensionality"],i),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function eI(t,e){const n={},r=u(e,["fileName"]);r!=null&&g(n,["file_name"],r);const a=u(e,["inlinedRequests"]);return a!=null&&g(n,["requests"],X3(t,a)),n}function tI(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&g(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function nI(t){const e={},n=u(t,["id"]);n!=null&&g(e,["id"],n);const r=u(t,["args"]);r!=null&&g(e,["args"],r);const a=u(t,["name"]);if(a!=null&&g(e,["name"],a),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rI(t){const e={},n=u(t,["mode"]);n!=null&&g(e,["mode"],n);const r=u(t,["allowedFunctionNames"]);if(r!=null&&g(e,["allowedFunctionNames"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function sI(t,e,n){const r={},a=u(e,["systemInstruction"]);n!==void 0&&a!=null&&g(n,["systemInstruction"],zx(tr(a)));const i=u(e,["temperature"]);i!=null&&g(r,["temperature"],i);const A=u(e,["topP"]);A!=null&&g(r,["topP"],A);const o=u(e,["topK"]);o!=null&&g(r,["topK"],o);const l=u(e,["candidateCount"]);l!=null&&g(r,["candidateCount"],l);const c=u(e,["maxOutputTokens"]);c!=null&&g(r,["maxOutputTokens"],c);const d=u(e,["stopSequences"]);d!=null&&g(r,["stopSequences"],d);const h=u(e,["responseLogprobs"]);h!=null&&g(r,["responseLogprobs"],h);const p=u(e,["logprobs"]);p!=null&&g(r,["logprobs"],p);const m=u(e,["presencePenalty"]);m!=null&&g(r,["presencePenalty"],m);const B=u(e,["frequencyPenalty"]);B!=null&&g(r,["frequencyPenalty"],B);const y=u(e,["seed"]);y!=null&&g(r,["seed"],y);const b=u(e,["responseMimeType"]);b!=null&&g(r,["responseMimeType"],b);const C=u(e,["responseSchema"]);C!=null&&g(r,["responseSchema"],_f(C));const N=u(e,["responseJsonSchema"]);if(N!=null&&g(r,["responseJsonSchema"],N),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=u(e,["safetySettings"]);if(n!==void 0&&k!=null){let I=k;Array.isArray(I)&&(I=I.map(P=>yI(P))),g(n,["safetySettings"],I)}const E=u(e,["tools"]);if(n!==void 0&&E!=null){let I=TA(E);Array.isArray(I)&&(I=I.map(P=>vI(jA(P)))),g(n,["tools"],I)}const _=u(e,["toolConfig"]);if(n!==void 0&&_!=null&&g(n,["toolConfig"],bI(_)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=u(e,["cachedContent"]);n!==void 0&&M!=null&&g(n,["cachedContent"],ta(t,M));const D=u(e,["responseModalities"]);D!=null&&g(r,["responseModalities"],D);const U=u(e,["mediaResolution"]);U!=null&&g(r,["mediaResolution"],U);const j=u(e,["speechConfig"]);if(j!=null&&g(r,["speechConfig"],Mf(j)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=u(e,["thinkingConfig"]);O!=null&&g(r,["thinkingConfig"],O);const F=u(e,["imageConfig"]);return F!=null&&g(r,["imageConfig"],cI(F)),r}function aI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>H3(c))),g(e,["candidates"],l)}const a=u(t,["modelVersion"]);a!=null&&g(e,["modelVersion"],a);const i=u(t,["promptFeedback"]);i!=null&&g(e,["promptFeedback"],i);const A=u(t,["responseId"]);A!=null&&g(e,["responseId"],A);const o=u(t,["usageMetadata"]);return o!=null&&g(e,["usageMetadata"],o),e}function iI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function AI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],QA(t,r)),n}function oI(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&g(e,["enableWidget"],n),e}function lI(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&g(e,["timeRangeFilter"],n),e}function cI(t){const e={},n=u(t,["aspectRatio"]);n!=null&&g(e,["aspectRatio"],n);const r=u(t,["imageSize"]);if(r!=null&&g(e,["imageSize"],r),u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function dI(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["request","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let o=Zr(a);Array.isArray(o)&&(o=o.map(l=>zx(l))),g(n,["request","contents"],o)}const i=u(e,["metadata"]);i!=null&&g(n,["metadata"],i);const A=u(e,["config"]);return A!=null&&g(n,["request","generationConfig"],sI(t,A,u(n,["request"],{}))),n}function uI(t){const e={},n=u(t,["response"]);n!=null&&g(e,["response"],aI(n));const r=u(t,["error"]);return r!=null&&g(e,["error"],r),e}function fI(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);if(e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),u(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function hI(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);e!==void 0&&a!=null&&g(e,["_query","pageToken"],a);const i=u(t,["filter"]);return e!==void 0&&i!=null&&g(e,["_query","filter"],i),n}function gI(t){const e={},n=u(t,["config"]);return n!=null&&fI(n,e),e}function mI(t){const e={},n=u(t,["config"]);return n!=null&&hI(n,e),e}function pI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["operations"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>pc(A))),g(e,["batchJobs"],i)}return e}function xI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["batchPredictionJobs"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>nf(A))),g(e,["batchJobs"],i)}return e}function wI(t){const e={},n=u(t,["mediaResolution"]);n!=null&&g(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&g(e,["codeExecutionResult"],r);const a=u(t,["executableCode"]);a!=null&&g(e,["executableCode"],a);const i=u(t,["fileData"]);i!=null&&g(e,["fileData"],tI(i));const A=u(t,["functionCall"]);A!=null&&g(e,["functionCall"],nI(A));const o=u(t,["functionResponse"]);o!=null&&g(e,["functionResponse"],o);const l=u(t,["inlineData"]);l!=null&&g(e,["inlineData"],D3(l));const c=u(t,["text"]);c!=null&&g(e,["text"],c);const d=u(t,["thought"]);d!=null&&g(e,["thought"],d);const h=u(t,["thoughtSignature"]);h!=null&&g(e,["thoughtSignature"],h);const p=u(t,["videoMetadata"]);return p!=null&&g(e,["videoMetadata"],p),e}function yI(t){const e={},n=u(t,["category"]);if(n!=null&&g(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=u(t,["threshold"]);return r!=null&&g(e,["threshold"],r),e}function bI(t){const e={},n=u(t,["functionCallingConfig"]);n!=null&&g(e,["functionCallingConfig"],rI(n));const r=u(t,["retrievalConfig"]);return r!=null&&g(e,["retrievalConfig"],r),e}function vI(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),g(e,["functionDeclarations"],d)}if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=u(t,["googleSearchRetrieval"]);r!=null&&g(e,["googleSearchRetrieval"],r);const a=u(t,["computerUse"]);a!=null&&g(e,["computerUse"],a);const i=u(t,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const A=u(t,["codeExecution"]);if(A!=null&&g(e,["codeExecution"],A),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["googleMaps"]);o!=null&&g(e,["googleMaps"],oI(o));const l=u(t,["googleSearch"]);l!=null&&g(e,["googleSearch"],lI(l));const c=u(t,["urlContext"]);return c!=null&&g(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $s;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})($s||($s={}));class wi{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let A={config:{}};!r||Object.keys(r).length===0?A={config:{}}:typeof r=="object"?A=Object.assign({},r):A=r,A.config&&(A.config.pageToken=n.nextPageToken),this.paramsInternal=A,this.pageInternalSize=(i=(a=A.config)===null||a===void 0?void 0:a.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BI extends ea{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new wi($s.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=lm(this.apiClient,e),r=n._url,a=qe("{model}:batchGenerateContent",r),o=n.batch.inputConfig.requests,l=o.requests,c=[];for(const d of l){const h=Object.assign({},d);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}c.push(h)}return o.requests=c,delete n.config,delete n._url,delete n._query,{path:a,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},a=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${a}`),r.dest===void 0){const i=this.getGcsUri(e),A=this.getBigqueryUri(e);if(i)i.endsWith(".jsonl")?r.dest=`${i.slice(0,-6)}/dest`:r.dest=`${i}_dest_${a}`;else if(A)r.dest=`${A}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=K3(this.apiClient,e);return o=qe("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>nf(d))}else{const c=lm(this.apiClient,e);return o=qe("{model}:batchGenerateContent",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>pc(d))}}async createEmbeddingsInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=z3(this.apiClient,e);return i=qe("{model}:asyncBatchEmbedContent",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>pc(l))}}async get(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=AI(this.apiClient,e);return o=qe("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>nf(d))}else{const c=iI(this.apiClient,e);return o=qe("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>pc(d))}}async cancel(e){var n,r,a,i;let A="",o={};if(this.apiClient.isVertexAI()){const l=R3(this.apiClient,e);A=qe("batchPredictionJobs/{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=P3(this.apiClient,e);A=qe("batches/{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=mI(e);return o=qe("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=xI(d),p=new am;return Object.assign(p,h),p})}else{const c=gI(e);return o=qe("batches",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=pI(d),p=new am;return Object.assign(p,h),p})}}async delete(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=W3(this.apiClient,e);return o=qe("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>$3(d))}else{const c=J3(this.apiClient,e);return o=qe("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>Y3(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CI(t){const e={},n=u(t,["data"]);if(n!=null&&g(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function cm(t){const e={},n=u(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>zI(i))),g(e,["parts"],a)}const r=u(t,["role"]);return r!=null&&g(e,["role"],r),e}function NI(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&g(e,["ttl"],r);const a=u(t,["expireTime"]);e!==void 0&&a!=null&&g(e,["expireTime"],a);const i=u(t,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const A=u(t,["contents"]);if(e!==void 0&&A!=null){let d=Zr(A);Array.isArray(d)&&(d=d.map(h=>cm(h))),g(e,["contents"],d)}const o=u(t,["systemInstruction"]);e!==void 0&&o!=null&&g(e,["systemInstruction"],cm(tr(o)));const l=u(t,["tools"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(h=>WI(h))),g(e,["tools"],d)}const c=u(t,["toolConfig"]);if(e!==void 0&&c!=null&&g(e,["toolConfig"],JI(c)),u(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function SI(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&g(e,["ttl"],r);const a=u(t,["expireTime"]);e!==void 0&&a!=null&&g(e,["expireTime"],a);const i=u(t,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const A=u(t,["contents"]);if(e!==void 0&&A!=null){let h=Zr(A);Array.isArray(h)&&(h=h.map(p=>p)),g(e,["contents"],h)}const o=u(t,["systemInstruction"]);e!==void 0&&o!=null&&g(e,["systemInstruction"],tr(o));const l=u(t,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>YI(p))),g(e,["tools"],h)}const c=u(t,["toolConfig"]);e!==void 0&&c!=null&&g(e,["toolConfig"],c);const d=u(t,["kmsKeyName"]);return e!==void 0&&d!=null&&g(e,["encryption_spec","kmsKeyName"],d),n}function II(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["model"],Lx(t,r));const a=u(e,["config"]);return a!=null&&NI(a,n),n}function FI(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["model"],Lx(t,r));const a=u(e,["config"]);return a!=null&&SI(a,n),n}function EI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],ta(t,r)),n}function kI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],ta(t,r)),n}function UI(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function jI(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function TI(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&g(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function QI(t){const e={},n=u(t,["id"]);n!=null&&g(e,["id"],n);const r=u(t,["args"]);r!=null&&g(e,["args"],r);const a=u(t,["name"]);if(a!=null&&g(e,["name"],a),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function LI(t){const e={},n=u(t,["mode"]);n!=null&&g(e,["mode"],n);const r=u(t,["allowedFunctionNames"]);if(r!=null&&g(e,["allowedFunctionNames"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function _I(t){const e={};if(u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=u(t,["description"]);n!=null&&g(e,["description"],n);const r=u(t,["name"]);r!=null&&g(e,["name"],r);const a=u(t,["parameters"]);a!=null&&g(e,["parameters"],a);const i=u(t,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const A=u(t,["response"]);A!=null&&g(e,["response"],A);const o=u(t,["responseJsonSchema"]);return o!=null&&g(e,["responseJsonSchema"],o),e}function MI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],ta(t,r)),n}function DI(t,e){const n={},r=u(e,["name"]);return r!=null&&g(n,["_url","name"],ta(t,r)),n}function PI(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&g(e,["enableWidget"],n),e}function RI(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&g(e,["timeRangeFilter"],n),e}function HI(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);return e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),n}function OI(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);return e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),n}function GI(t){const e={},n=u(t,["config"]);return n!=null&&HI(n,e),e}function VI(t){const e={},n=u(t,["config"]);return n!=null&&OI(n,e),e}function KI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["cachedContents"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["cachedContents"],i)}return e}function qI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["cachedContents"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["cachedContents"],i)}return e}function zI(t){const e={},n=u(t,["mediaResolution"]);n!=null&&g(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&g(e,["codeExecutionResult"],r);const a=u(t,["executableCode"]);a!=null&&g(e,["executableCode"],a);const i=u(t,["fileData"]);i!=null&&g(e,["fileData"],TI(i));const A=u(t,["functionCall"]);A!=null&&g(e,["functionCall"],QI(A));const o=u(t,["functionResponse"]);o!=null&&g(e,["functionResponse"],o);const l=u(t,["inlineData"]);l!=null&&g(e,["inlineData"],CI(l));const c=u(t,["text"]);c!=null&&g(e,["text"],c);const d=u(t,["thought"]);d!=null&&g(e,["thought"],d);const h=u(t,["thoughtSignature"]);h!=null&&g(e,["thoughtSignature"],h);const p=u(t,["videoMetadata"]);return p!=null&&g(e,["videoMetadata"],p),e}function JI(t){const e={},n=u(t,["functionCallingConfig"]);n!=null&&g(e,["functionCallingConfig"],LI(n));const r=u(t,["retrievalConfig"]);return r!=null&&g(e,["retrievalConfig"],r),e}function WI(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),g(e,["functionDeclarations"],d)}if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=u(t,["googleSearchRetrieval"]);r!=null&&g(e,["googleSearchRetrieval"],r);const a=u(t,["computerUse"]);a!=null&&g(e,["computerUse"],a);const i=u(t,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const A=u(t,["codeExecution"]);if(A!=null&&g(e,["codeExecution"],A),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["googleMaps"]);o!=null&&g(e,["googleMaps"],PI(o));const l=u(t,["googleSearch"]);l!=null&&g(e,["googleSearch"],RI(l));const c=u(t,["urlContext"]);return c!=null&&g(e,["urlContext"],c),e}function YI(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>_I(p))),g(e,["functionDeclarations"],h)}const r=u(t,["retrieval"]);r!=null&&g(e,["retrieval"],r);const a=u(t,["googleSearchRetrieval"]);a!=null&&g(e,["googleSearchRetrieval"],a);const i=u(t,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const A=u(t,["codeExecution"]);A!=null&&g(e,["codeExecution"],A);const o=u(t,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);const l=u(t,["googleMaps"]);l!=null&&g(e,["googleMaps"],l);const c=u(t,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);const d=u(t,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function $I(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&g(e,["ttl"],r);const a=u(t,["expireTime"]);return e!==void 0&&a!=null&&g(e,["expireTime"],a),n}function XI(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&g(e,["ttl"],r);const a=u(t,["expireTime"]);return e!==void 0&&a!=null&&g(e,["expireTime"],a),n}function ZI(t,e){const n={},r=u(e,["name"]);r!=null&&g(n,["_url","name"],ta(t,r));const a=u(e,["config"]);return a!=null&&$I(a,n),n}function eF(t,e){const n={},r=u(e,["name"]);r!=null&&g(n,["_url","name"],ta(t,r));const a=u(e,["config"]);return a!=null&&XI(a,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tF extends ea{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new wi($s.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=FI(this.apiClient,e);return o=qe("cachedContents",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>d)}else{const c=II(this.apiClient,e);return o=qe("cachedContents",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>d)}}async get(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=DI(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>d)}else{const c=MI(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>d)}}async delete(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=kI(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=jI(d),p=new rm;return Object.assign(p,h),p})}else{const c=EI(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=UI(d),p=new rm;return Object.assign(p,h),p})}}async update(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=eF(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>d)}else{const c=ZI(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>d)}}async listInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=VI(e);return o=qe("cachedContents",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=qI(d),p=new sm;return Object.assign(p,h),p})}else{const c=GI(e);return o=qe("cachedContents",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=KI(d),p=new sm;return Object.assign(p,h),p})}}}function dm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function zt(t){return this instanceof zt?(this.v=t,this):new zt(t)}function bA(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",A),a[Symbol.asyncIterator]=function(){return this},a;function A(m){return function(B){return Promise.resolve(B).then(m,h)}}function o(m,B){r[m]&&(a[m]=function(y){return new Promise(function(b,C){i.push([m,y,b,C])>1||l(m,y)})},B&&(a[m]=B(a[m])))}function l(m,B){try{c(r[m](B))}catch(y){p(i[0][3],y)}}function c(m){m.value instanceof zt?Promise.resolve(m.value.v).then(d,h):p(i[0][2],m)}function d(m){l("next",m)}function h(m){l("throw",m)}function p(m,B){m(B),i.shift(),i.length&&l(i[0][0],i[0][1])}}function Ro(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof dm=="function"?dm(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(A){return new Promise(function(o,l){A=t[i](A),a(o,l,A.done,A.value)})}}function a(i,A,o,l){Promise.resolve(l).then(function(c){i({value:c,done:o})},A)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nF(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Jx(n)}function Jx(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function rF(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function um(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let i=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),i&&!Jx(t[r])&&(i=!1),r++;i?e.push(...a):e.pop()}return e}class sF{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new aF(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class aF{constructor(e,n,r,a={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=i,this.sendPromise=Promise.resolve(),rF(i)}async sendMessage(e){var n;await this.sendPromise;const r=tr(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,A,o;const l=await a,c=(A=(i=l.candidates)===null||i===void 0?void 0:i[0])===null||A===void 0?void 0:A.content,d=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];d!=null&&(p=(o=d.slice(h))!==null&&o!==void 0?o:[]);const m=c?[c]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=tr(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const i=await a;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?um(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return bA(this,arguments,function*(){var A,o,l,c;const d=[];try{for(var h=!0,p=Ro(e),m;m=yield zt(p.next()),A=m.done,!A;h=!0){c=m.value,h=!1;const B=c;if(nF(B)){const y=(a=(r=B.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;y!==void 0&&d.push(y)}yield yield zt(B)}}catch(B){o={error:B}}finally{try{!h&&!A&&(l=p.return)&&(yield zt(l.call(p)))}finally{if(o)throw o.error}}this.recordHistory(n,d)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(i=>i.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...um(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class od extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,od.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iF(t){const e={},n=u(t,["file"]);return n!=null&&g(e,["file"],n),e}function AF(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function oF(t){const e={},n=u(t,["name"]);return n!=null&&g(e,["_url","file"],Hx(n)),e}function lF(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function cF(t){const e={},n=u(t,["name"]);return n!=null&&g(e,["_url","file"],Hx(n)),e}function dF(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);return e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),n}function uF(t){const e={},n=u(t,["config"]);return n!=null&&dF(n,e),e}function fF(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["files"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["files"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hF extends ea{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new wi($s.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=uF(e);return i=qe("files",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>{const c=fF(l),d=new x3;return Object.assign(d,c),d})}}async createInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=iF(e);return i=qe("upload/v1beta/files",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=AF(l),d=new w3;return Object.assign(d,c),d})}}async get(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cF(e);return i=qe("files/{file}",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async delete(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=oF(e);return i=qe("files/{file}",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>{const c=lF(l),d=new y3;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xc(t){const e={},n=u(t,["data"]);if(n!=null&&g(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function gF(t){const e={},n=u(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>UF(i))),g(e,["parts"],a)}const r=u(t,["role"]);return r!=null&&g(e,["role"],r),e}function mF(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&g(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function pF(t){const e={},n=u(t,["id"]);n!=null&&g(e,["id"],n);const r=u(t,["args"]);r!=null&&g(e,["args"],r);const a=u(t,["name"]);if(a!=null&&g(e,["name"],a),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xF(t){const e={};if(u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=u(t,["description"]);n!=null&&g(e,["description"],n);const r=u(t,["name"]);r!=null&&g(e,["name"],r);const a=u(t,["parameters"]);a!=null&&g(e,["parameters"],a);const i=u(t,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const A=u(t,["response"]);A!=null&&g(e,["response"],A);const o=u(t,["responseJsonSchema"]);return o!=null&&g(e,["responseJsonSchema"],o),e}function wF(t){const e={},n=u(t,["modelSelectionConfig"]);n!=null&&g(e,["modelConfig"],n);const r=u(t,["responseJsonSchema"]);r!=null&&g(e,["responseJsonSchema"],r);const a=u(t,["audioTimestamp"]);a!=null&&g(e,["audioTimestamp"],a);const i=u(t,["candidateCount"]);i!=null&&g(e,["candidateCount"],i);const A=u(t,["enableAffectiveDialog"]);A!=null&&g(e,["enableAffectiveDialog"],A);const o=u(t,["frequencyPenalty"]);o!=null&&g(e,["frequencyPenalty"],o);const l=u(t,["logprobs"]);l!=null&&g(e,["logprobs"],l);const c=u(t,["maxOutputTokens"]);c!=null&&g(e,["maxOutputTokens"],c);const d=u(t,["mediaResolution"]);d!=null&&g(e,["mediaResolution"],d);const h=u(t,["presencePenalty"]);h!=null&&g(e,["presencePenalty"],h);const p=u(t,["responseLogprobs"]);p!=null&&g(e,["responseLogprobs"],p);const m=u(t,["responseMimeType"]);m!=null&&g(e,["responseMimeType"],m);const B=u(t,["responseModalities"]);B!=null&&g(e,["responseModalities"],B);const y=u(t,["responseSchema"]);y!=null&&g(e,["responseSchema"],y);const b=u(t,["routingConfig"]);b!=null&&g(e,["routingConfig"],b);const C=u(t,["seed"]);C!=null&&g(e,["seed"],C);const N=u(t,["speechConfig"]);N!=null&&g(e,["speechConfig"],Wx(N));const k=u(t,["stopSequences"]);k!=null&&g(e,["stopSequences"],k);const E=u(t,["temperature"]);E!=null&&g(e,["temperature"],E);const _=u(t,["thinkingConfig"]);_!=null&&g(e,["thinkingConfig"],_);const M=u(t,["topK"]);M!=null&&g(e,["topK"],M);const D=u(t,["topP"]);if(D!=null&&g(e,["topP"],D),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function yF(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&g(e,["enableWidget"],n),e}function bF(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&g(e,["timeRangeFilter"],n),e}function vF(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig"],r);const a=u(t,["responseModalities"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","responseModalities"],a);const i=u(t,["temperature"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","temperature"],i);const A=u(t,["topP"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","topP"],A);const o=u(t,["topK"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","topK"],o);const l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","mediaResolution"],c);const d=u(t,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const h=u(t,["speechConfig"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","speechConfig"],Df(h));const p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","thinkingConfig"],p);const m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],m);const B=u(t,["systemInstruction"]);e!==void 0&&B!=null&&g(e,["setup","systemInstruction"],gF(tr(B)));const y=u(t,["tools"]);if(e!==void 0&&y!=null){let M=TA(y);Array.isArray(M)&&(M=M.map(D=>TF(jA(D)))),g(e,["setup","tools"],M)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&g(e,["setup","sessionResumption"],jF(b));const C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],C);const N=u(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","outputAudioTranscription"],N);const k=u(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&g(e,["setup","realtimeInputConfig"],k);const E=u(t,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],E);const _=u(t,["proactivity"]);return e!==void 0&&_!=null&&g(e,["setup","proactivity"],_),n}function BF(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig"],wF(r));const a=u(t,["responseModalities"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","responseModalities"],a);const i=u(t,["temperature"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","temperature"],i);const A=u(t,["topP"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","topP"],A);const o=u(t,["topK"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","topK"],o);const l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","mediaResolution"],c);const d=u(t,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const h=u(t,["speechConfig"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","speechConfig"],Wx(Df(h)));const p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","thinkingConfig"],p);const m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],m);const B=u(t,["systemInstruction"]);e!==void 0&&B!=null&&g(e,["setup","systemInstruction"],tr(B));const y=u(t,["tools"]);if(e!==void 0&&y!=null){let M=TA(y);Array.isArray(M)&&(M=M.map(D=>QF(jA(D)))),g(e,["setup","tools"],M)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&g(e,["setup","sessionResumption"],b);const C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],C);const N=u(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","outputAudioTranscription"],N);const k=u(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&g(e,["setup","realtimeInputConfig"],k);const E=u(t,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],E);const _=u(t,["proactivity"]);return e!==void 0&&_!=null&&g(e,["setup","proactivity"],_),n}function CF(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["setup","model"],Ft(t,r));const a=u(e,["config"]);return a!=null&&g(n,["config"],vF(a,n)),n}function NF(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["setup","model"],Ft(t,r));const a=u(e,["config"]);return a!=null&&g(n,["config"],BF(a,n)),n}function SF(t){const e={},n=u(t,["musicGenerationConfig"]);return n!=null&&g(e,["musicGenerationConfig"],n),e}function IF(t){const e={},n=u(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a)),g(e,["weightedPrompts"],r)}return e}function FF(t){const e={},n=u(t,["media"]);if(n!=null){let c=_x(n);Array.isArray(c)&&(c=c.map(d=>xc(d))),g(e,["mediaChunks"],c)}const r=u(t,["audio"]);r!=null&&g(e,["audio"],xc(Dx(r)));const a=u(t,["audioStreamEnd"]);a!=null&&g(e,["audioStreamEnd"],a);const i=u(t,["video"]);i!=null&&g(e,["video"],xc(Mx(i)));const A=u(t,["text"]);A!=null&&g(e,["text"],A);const o=u(t,["activityStart"]);o!=null&&g(e,["activityStart"],o);const l=u(t,["activityEnd"]);return l!=null&&g(e,["activityEnd"],l),e}function EF(t){const e={},n=u(t,["media"]);if(n!=null){let c=_x(n);Array.isArray(c)&&(c=c.map(d=>d)),g(e,["mediaChunks"],c)}const r=u(t,["audio"]);r!=null&&g(e,["audio"],Dx(r));const a=u(t,["audioStreamEnd"]);a!=null&&g(e,["audioStreamEnd"],a);const i=u(t,["video"]);i!=null&&g(e,["video"],Mx(i));const A=u(t,["text"]);A!=null&&g(e,["text"],A);const o=u(t,["activityStart"]);o!=null&&g(e,["activityStart"],o);const l=u(t,["activityEnd"]);return l!=null&&g(e,["activityEnd"],l),e}function kF(t){const e={},n=u(t,["setupComplete"]);n!=null&&g(e,["setupComplete"],n);const r=u(t,["serverContent"]);r!=null&&g(e,["serverContent"],r);const a=u(t,["toolCall"]);a!=null&&g(e,["toolCall"],a);const i=u(t,["toolCallCancellation"]);i!=null&&g(e,["toolCallCancellation"],i);const A=u(t,["usageMetadata"]);A!=null&&g(e,["usageMetadata"],LF(A));const o=u(t,["goAway"]);o!=null&&g(e,["goAway"],o);const l=u(t,["sessionResumptionUpdate"]);return l!=null&&g(e,["sessionResumptionUpdate"],l),e}function UF(t){const e={},n=u(t,["mediaResolution"]);n!=null&&g(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&g(e,["codeExecutionResult"],r);const a=u(t,["executableCode"]);a!=null&&g(e,["executableCode"],a);const i=u(t,["fileData"]);i!=null&&g(e,["fileData"],mF(i));const A=u(t,["functionCall"]);A!=null&&g(e,["functionCall"],pF(A));const o=u(t,["functionResponse"]);o!=null&&g(e,["functionResponse"],o);const l=u(t,["inlineData"]);l!=null&&g(e,["inlineData"],xc(l));const c=u(t,["text"]);c!=null&&g(e,["text"],c);const d=u(t,["thought"]);d!=null&&g(e,["thought"],d);const h=u(t,["thoughtSignature"]);h!=null&&g(e,["thoughtSignature"],h);const p=u(t,["videoMetadata"]);return p!=null&&g(e,["videoMetadata"],p),e}function jF(t){const e={},n=u(t,["handle"]);if(n!=null&&g(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Wx(t){const e={},n=u(t,["languageCode"]);n!=null&&g(e,["languageCode"],n);const r=u(t,["voiceConfig"]);if(r!=null&&g(e,["voiceConfig"],r),u(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function TF(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),g(e,["functionDeclarations"],d)}if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=u(t,["googleSearchRetrieval"]);r!=null&&g(e,["googleSearchRetrieval"],r);const a=u(t,["computerUse"]);a!=null&&g(e,["computerUse"],a);const i=u(t,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const A=u(t,["codeExecution"]);if(A!=null&&g(e,["codeExecution"],A),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["googleMaps"]);o!=null&&g(e,["googleMaps"],yF(o));const l=u(t,["googleSearch"]);l!=null&&g(e,["googleSearch"],bF(l));const c=u(t,["urlContext"]);return c!=null&&g(e,["urlContext"],c),e}function QF(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>xF(p))),g(e,["functionDeclarations"],h)}const r=u(t,["retrieval"]);r!=null&&g(e,["retrieval"],r);const a=u(t,["googleSearchRetrieval"]);a!=null&&g(e,["googleSearchRetrieval"],a);const i=u(t,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const A=u(t,["codeExecution"]);A!=null&&g(e,["codeExecution"],A);const o=u(t,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);const l=u(t,["googleMaps"]);l!=null&&g(e,["googleMaps"],l);const c=u(t,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);const d=u(t,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function LF(t){const e={},n=u(t,["promptTokenCount"]);n!=null&&g(e,["promptTokenCount"],n);const r=u(t,["cachedContentTokenCount"]);r!=null&&g(e,["cachedContentTokenCount"],r);const a=u(t,["candidatesTokenCount"]);a!=null&&g(e,["responseTokenCount"],a);const i=u(t,["toolUsePromptTokenCount"]);i!=null&&g(e,["toolUsePromptTokenCount"],i);const A=u(t,["thoughtsTokenCount"]);A!=null&&g(e,["thoughtsTokenCount"],A);const o=u(t,["totalTokenCount"]);o!=null&&g(e,["totalTokenCount"],o);const l=u(t,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(B=>B)),g(e,["promptTokensDetails"],m)}const c=u(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(B=>B)),g(e,["cacheTokensDetails"],m)}const d=u(t,["candidatesTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(B=>B)),g(e,["responseTokensDetails"],m)}const h=u(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(B=>B)),g(e,["toolUsePromptTokensDetails"],m)}const p=u(t,["trafficType"]);return p!=null&&g(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _F(t){const e={},n=u(t,["data"]);if(n!=null&&g(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function MF(t){const e={},n=u(t,["content"]);n!=null&&g(e,["content"],n);const r=u(t,["citationMetadata"]);r!=null&&g(e,["citationMetadata"],DF(r));const a=u(t,["tokenCount"]);a!=null&&g(e,["tokenCount"],a);const i=u(t,["finishReason"]);i!=null&&g(e,["finishReason"],i);const A=u(t,["avgLogprobs"]);A!=null&&g(e,["avgLogprobs"],A);const o=u(t,["groundingMetadata"]);o!=null&&g(e,["groundingMetadata"],o);const l=u(t,["index"]);l!=null&&g(e,["index"],l);const c=u(t,["logprobsResult"]);c!=null&&g(e,["logprobsResult"],c);const d=u(t,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),g(e,["safetyRatings"],p)}const h=u(t,["urlContextMetadata"]);return h!=null&&g(e,["urlContextMetadata"],h),e}function DF(t){const e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a)),g(e,["citations"],r)}return e}function PF(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let i=Zr(a);Array.isArray(i)&&(i=i.map(A=>A)),g(n,["contents"],i)}return n}function RF(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["tokensInfo"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>i)),g(e,["tokensInfo"],a)}return e}function HF(t){const e={},n=u(t,["values"]);n!=null&&g(e,["values"],n);const r=u(t,["statistics"]);return r!=null&&g(e,["statistics"],OF(r)),e}function OF(t){const e={},n=u(t,["truncated"]);n!=null&&g(e,["truncated"],n);const r=u(t,["token_count"]);return r!=null&&g(e,["tokenCount"],r),e}function ld(t){const e={},n=u(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>$E(i))),g(e,["parts"],a)}const r=u(t,["role"]);return r!=null&&g(e,["role"],r),e}function GF(t){const e={},n=u(t,["controlType"]);n!=null&&g(e,["controlType"],n);const r=u(t,["enableControlImageComputation"]);return r!=null&&g(e,["computeControl"],r),e}function VF(t){const e={};if(u(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(u(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(u(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function KF(t,e){const n={},r=u(t,["systemInstruction"]);e!==void 0&&r!=null&&g(e,["systemInstruction"],tr(r));const a=u(t,["tools"]);if(e!==void 0&&a!=null){let A=a;Array.isArray(A)&&(A=A.map(o=>ew(o))),g(e,["tools"],A)}const i=u(t,["generationConfig"]);return e!==void 0&&i!=null&&g(e,["generationConfig"],_E(i)),n}function qF(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let A=Zr(a);Array.isArray(A)&&(A=A.map(o=>ld(o))),g(n,["contents"],A)}const i=u(e,["config"]);return i!=null&&VF(i),n}function zF(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let A=Zr(a);Array.isArray(A)&&(A=A.map(o=>o)),g(n,["contents"],A)}const i=u(e,["config"]);return i!=null&&KF(i,n),n}function JF(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["totalTokens"]);r!=null&&g(e,["totalTokens"],r);const a=u(t,["cachedContentTokenCount"]);return a!=null&&g(e,["cachedContentTokenCount"],a),e}function WF(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["totalTokens"]);return r!=null&&g(e,["totalTokens"],r),e}function YF(t,e){const n={},r=u(e,["model"]);return r!=null&&g(n,["_url","name"],Ft(t,r)),n}function $F(t,e){const n={},r=u(e,["model"]);return r!=null&&g(n,["_url","name"],Ft(t,r)),n}function XF(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function ZF(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}function eE(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const a=u(t,["negativePrompt"]);e!==void 0&&a!=null&&g(e,["parameters","negativePrompt"],a);const i=u(t,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);const A=u(t,["aspectRatio"]);e!==void 0&&A!=null&&g(e,["parameters","aspectRatio"],A);const o=u(t,["guidanceScale"]);e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o);const l=u(t,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const c=u(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&g(e,["parameters","safetySetting"],c);const d=u(t,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const h=u(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&g(e,["parameters","includeSafetyAttributes"],h);const p=u(t,["includeRaiReason"]);e!==void 0&&p!=null&&g(e,["parameters","includeRaiReason"],p);const m=u(t,["language"]);e!==void 0&&m!=null&&g(e,["parameters","language"],m);const B=u(t,["outputMimeType"]);e!==void 0&&B!=null&&g(e,["parameters","outputOptions","mimeType"],B);const y=u(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","compressionQuality"],y);const b=u(t,["addWatermark"]);e!==void 0&&b!=null&&g(e,["parameters","addWatermark"],b);const C=u(t,["labels"]);e!==void 0&&C!=null&&g(e,["labels"],C);const N=u(t,["editMode"]);e!==void 0&&N!=null&&g(e,["parameters","editMode"],N);const k=u(t,["baseSteps"]);return e!==void 0&&k!=null&&g(e,["parameters","editConfig","baseSteps"],k),n}function tE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["prompt"]);a!=null&&g(n,["instances[0]","prompt"],a);const i=u(e,["referenceImages"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>rk(l))),g(n,["instances[0]","referenceImages"],o)}const A=u(e,["config"]);return A!=null&&eE(A,n),n}function nE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>cd(i))),g(e,["generatedImages"],a)}return e}function rE(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&g(e,["requests[]","taskType"],r);const a=u(t,["title"]);e!==void 0&&a!=null&&g(e,["requests[]","title"],a);const i=u(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&g(e,["requests[]","outputDimensionality"],i),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function sE(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&g(e,["instances[]","task_type"],r);const a=u(t,["title"]);e!==void 0&&a!=null&&g(e,["instances[]","title"],a);const i=u(t,["outputDimensionality"]);e!==void 0&&i!=null&&g(e,["parameters","outputDimensionality"],i);const A=u(t,["mimeType"]);e!==void 0&&A!=null&&g(e,["instances[]","mimeType"],A);const o=u(t,["autoTruncate"]);return e!==void 0&&o!=null&&g(e,["parameters","autoTruncate"],o),n}function aE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let o=Lf(t,a);Array.isArray(o)&&(o=o.map(l=>l)),g(n,["requests[]","content"],o)}const i=u(e,["config"]);i!=null&&rE(i,n);const A=u(e,["model"]);return A!==void 0&&g(n,["requests[]","model"],Ft(t,A)),n}function iE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let A=Lf(t,a);Array.isArray(A)&&(A=A.map(o=>o)),g(n,["instances[]","content"],A)}const i=u(e,["config"]);return i!=null&&sE(i,n),n}function AE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["embeddings"],i)}const a=u(t,["metadata"]);return a!=null&&g(e,["metadata"],a),e}function oE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>HF(A))),g(e,["embeddings"],i)}const a=u(t,["metadata"]);return a!=null&&g(e,["metadata"],a),e}function lE(t){const e={},n=u(t,["endpoint"]);n!=null&&g(e,["name"],n);const r=u(t,["deployedModelId"]);return r!=null&&g(e,["deployedModelId"],r),e}function cE(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&g(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function dE(t){const e={},n=u(t,["id"]);n!=null&&g(e,["id"],n);const r=u(t,["args"]);r!=null&&g(e,["args"],r);const a=u(t,["name"]);if(a!=null&&g(e,["name"],a),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function uE(t){const e={},n=u(t,["mode"]);n!=null&&g(e,["mode"],n);const r=u(t,["allowedFunctionNames"]);if(r!=null&&g(e,["allowedFunctionNames"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function fE(t){const e={};if(u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=u(t,["description"]);n!=null&&g(e,["description"],n);const r=u(t,["name"]);r!=null&&g(e,["name"],r);const a=u(t,["parameters"]);a!=null&&g(e,["parameters"],a);const i=u(t,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const A=u(t,["response"]);A!=null&&g(e,["response"],A);const o=u(t,["responseJsonSchema"]);return o!=null&&g(e,["responseJsonSchema"],o),e}function hE(t,e,n){const r={},a=u(e,["systemInstruction"]);n!==void 0&&a!=null&&g(n,["systemInstruction"],ld(tr(a)));const i=u(e,["temperature"]);i!=null&&g(r,["temperature"],i);const A=u(e,["topP"]);A!=null&&g(r,["topP"],A);const o=u(e,["topK"]);o!=null&&g(r,["topK"],o);const l=u(e,["candidateCount"]);l!=null&&g(r,["candidateCount"],l);const c=u(e,["maxOutputTokens"]);c!=null&&g(r,["maxOutputTokens"],c);const d=u(e,["stopSequences"]);d!=null&&g(r,["stopSequences"],d);const h=u(e,["responseLogprobs"]);h!=null&&g(r,["responseLogprobs"],h);const p=u(e,["logprobs"]);p!=null&&g(r,["logprobs"],p);const m=u(e,["presencePenalty"]);m!=null&&g(r,["presencePenalty"],m);const B=u(e,["frequencyPenalty"]);B!=null&&g(r,["frequencyPenalty"],B);const y=u(e,["seed"]);y!=null&&g(r,["seed"],y);const b=u(e,["responseMimeType"]);b!=null&&g(r,["responseMimeType"],b);const C=u(e,["responseSchema"]);C!=null&&g(r,["responseSchema"],_f(C));const N=u(e,["responseJsonSchema"]);if(N!=null&&g(r,["responseJsonSchema"],N),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=u(e,["safetySettings"]);if(n!==void 0&&k!=null){let I=k;Array.isArray(I)&&(I=I.map(P=>sk(P))),g(n,["safetySettings"],I)}const E=u(e,["tools"]);if(n!==void 0&&E!=null){let I=TA(E);Array.isArray(I)&&(I=I.map(P=>dk(jA(P)))),g(n,["tools"],I)}const _=u(e,["toolConfig"]);if(n!==void 0&&_!=null&&g(n,["toolConfig"],ck(_)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=u(e,["cachedContent"]);n!==void 0&&M!=null&&g(n,["cachedContent"],ta(t,M));const D=u(e,["responseModalities"]);D!=null&&g(r,["responseModalities"],D);const U=u(e,["mediaResolution"]);U!=null&&g(r,["mediaResolution"],U);const j=u(e,["speechConfig"]);if(j!=null&&g(r,["speechConfig"],Mf(j)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=u(e,["thinkingConfig"]);O!=null&&g(r,["thinkingConfig"],O);const F=u(e,["imageConfig"]);return F!=null&&g(r,["imageConfig"],HE(F)),r}function gE(t,e,n){const r={},a=u(e,["systemInstruction"]);n!==void 0&&a!=null&&g(n,["systemInstruction"],tr(a));const i=u(e,["temperature"]);i!=null&&g(r,["temperature"],i);const A=u(e,["topP"]);A!=null&&g(r,["topP"],A);const o=u(e,["topK"]);o!=null&&g(r,["topK"],o);const l=u(e,["candidateCount"]);l!=null&&g(r,["candidateCount"],l);const c=u(e,["maxOutputTokens"]);c!=null&&g(r,["maxOutputTokens"],c);const d=u(e,["stopSequences"]);d!=null&&g(r,["stopSequences"],d);const h=u(e,["responseLogprobs"]);h!=null&&g(r,["responseLogprobs"],h);const p=u(e,["logprobs"]);p!=null&&g(r,["logprobs"],p);const m=u(e,["presencePenalty"]);m!=null&&g(r,["presencePenalty"],m);const B=u(e,["frequencyPenalty"]);B!=null&&g(r,["frequencyPenalty"],B);const y=u(e,["seed"]);y!=null&&g(r,["seed"],y);const b=u(e,["responseMimeType"]);b!=null&&g(r,["responseMimeType"],b);const C=u(e,["responseSchema"]);C!=null&&g(r,["responseSchema"],_f(C));const N=u(e,["responseJsonSchema"]);N!=null&&g(r,["responseJsonSchema"],N);const k=u(e,["routingConfig"]);k!=null&&g(r,["routingConfig"],k);const E=u(e,["modelSelectionConfig"]);E!=null&&g(r,["modelConfig"],E);const _=u(e,["safetySettings"]);if(n!==void 0&&_!=null){let X=_;Array.isArray(X)&&(X=X.map(le=>le)),g(n,["safetySettings"],X)}const M=u(e,["tools"]);if(n!==void 0&&M!=null){let X=TA(M);Array.isArray(X)&&(X=X.map(le=>ew(jA(le)))),g(n,["tools"],X)}const D=u(e,["toolConfig"]);n!==void 0&&D!=null&&g(n,["toolConfig"],D);const U=u(e,["labels"]);n!==void 0&&U!=null&&g(n,["labels"],U);const j=u(e,["cachedContent"]);n!==void 0&&j!=null&&g(n,["cachedContent"],ta(t,j));const O=u(e,["responseModalities"]);O!=null&&g(r,["responseModalities"],O);const F=u(e,["mediaResolution"]);F!=null&&g(r,["mediaResolution"],F);const I=u(e,["speechConfig"]);I!=null&&g(r,["speechConfig"],Zx(Mf(I)));const P=u(e,["audioTimestamp"]);P!=null&&g(r,["audioTimestamp"],P);const V=u(e,["thinkingConfig"]);V!=null&&g(r,["thinkingConfig"],V);const ee=u(e,["imageConfig"]);return ee!=null&&g(r,["imageConfig"],OE(ee)),r}function fm(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let A=Zr(a);Array.isArray(A)&&(A=A.map(o=>ld(o))),g(n,["contents"],A)}const i=u(e,["config"]);return i!=null&&g(n,["generationConfig"],hE(t,i,n)),n}function hm(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["contents"]);if(a!=null){let A=Zr(a);Array.isArray(A)&&(A=A.map(o=>o)),g(n,["contents"],A)}const i=u(e,["config"]);return i!=null&&g(n,["generationConfig"],gE(t,i,n)),n}function gm(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>MF(c))),g(e,["candidates"],l)}const a=u(t,["modelVersion"]);a!=null&&g(e,["modelVersion"],a);const i=u(t,["promptFeedback"]);i!=null&&g(e,["promptFeedback"],i);const A=u(t,["responseId"]);A!=null&&g(e,["responseId"],A);const o=u(t,["usageMetadata"]);return o!=null&&g(e,["usageMetadata"],o),e}function mm(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>d)),g(e,["candidates"],c)}const a=u(t,["createTime"]);a!=null&&g(e,["createTime"],a);const i=u(t,["modelVersion"]);i!=null&&g(e,["modelVersion"],i);const A=u(t,["promptFeedback"]);A!=null&&g(e,["promptFeedback"],A);const o=u(t,["responseId"]);o!=null&&g(e,["responseId"],o);const l=u(t,["usageMetadata"]);return l!=null&&g(e,["usageMetadata"],l),e}function mE(t,e){const n={};if(u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const a=u(t,["aspectRatio"]);e!==void 0&&a!=null&&g(e,["parameters","aspectRatio"],a);const i=u(t,["guidanceScale"]);if(e!==void 0&&i!=null&&g(e,["parameters","guidanceScale"],i),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const A=u(t,["safetyFilterLevel"]);e!==void 0&&A!=null&&g(e,["parameters","safetySetting"],A);const o=u(t,["personGeneration"]);e!==void 0&&o!=null&&g(e,["parameters","personGeneration"],o);const l=u(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&g(e,["parameters","includeSafetyAttributes"],l);const c=u(t,["includeRaiReason"]);e!==void 0&&c!=null&&g(e,["parameters","includeRaiReason"],c);const d=u(t,["language"]);e!==void 0&&d!=null&&g(e,["parameters","language"],d);const h=u(t,["outputMimeType"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","mimeType"],h);const p=u(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&g(e,["parameters","outputOptions","compressionQuality"],p),u(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=u(t,["imageSize"]);if(e!==void 0&&m!=null&&g(e,["parameters","sampleImageSize"],m),u(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function pE(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const a=u(t,["negativePrompt"]);e!==void 0&&a!=null&&g(e,["parameters","negativePrompt"],a);const i=u(t,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);const A=u(t,["aspectRatio"]);e!==void 0&&A!=null&&g(e,["parameters","aspectRatio"],A);const o=u(t,["guidanceScale"]);e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o);const l=u(t,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const c=u(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&g(e,["parameters","safetySetting"],c);const d=u(t,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const h=u(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&g(e,["parameters","includeSafetyAttributes"],h);const p=u(t,["includeRaiReason"]);e!==void 0&&p!=null&&g(e,["parameters","includeRaiReason"],p);const m=u(t,["language"]);e!==void 0&&m!=null&&g(e,["parameters","language"],m);const B=u(t,["outputMimeType"]);e!==void 0&&B!=null&&g(e,["parameters","outputOptions","mimeType"],B);const y=u(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","compressionQuality"],y);const b=u(t,["addWatermark"]);e!==void 0&&b!=null&&g(e,["parameters","addWatermark"],b);const C=u(t,["labels"]);e!==void 0&&C!=null&&g(e,["labels"],C);const N=u(t,["imageSize"]);e!==void 0&&N!=null&&g(e,["parameters","sampleImageSize"],N);const k=u(t,["enhancePrompt"]);return e!==void 0&&k!=null&&g(e,["parameters","enhancePrompt"],k),n}function xE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["prompt"]);a!=null&&g(n,["instances[0]","prompt"],a);const i=u(e,["config"]);return i!=null&&mE(i,n),n}function wE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["prompt"]);a!=null&&g(n,["instances[0]","prompt"],a);const i=u(e,["config"]);return i!=null&&pE(i,n),n}function yE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>jE(A))),g(e,["generatedImages"],i)}const a=u(t,["positivePromptSafetyAttributes"]);return a!=null&&g(e,["positivePromptSafetyAttributes"],$x(a)),e}function bE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>cd(A))),g(e,["generatedImages"],i)}const a=u(t,["positivePromptSafetyAttributes"]);return a!=null&&g(e,["positivePromptSafetyAttributes"],Xx(a)),e}function vE(t,e){const n={},r=u(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r),u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=u(t,["durationSeconds"]);if(e!==void 0&&a!=null&&g(e,["parameters","durationSeconds"],a),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=u(t,["aspectRatio"]);e!==void 0&&i!=null&&g(e,["parameters","aspectRatio"],i);const A=u(t,["resolution"]);e!==void 0&&A!=null&&g(e,["parameters","resolution"],A);const o=u(t,["personGeneration"]);if(e!==void 0&&o!=null&&g(e,["parameters","personGeneration"],o),u(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=u(t,["negativePrompt"]);e!==void 0&&l!=null&&g(e,["parameters","negativePrompt"],l);const c=u(t,["enhancePrompt"]);if(e!==void 0&&c!=null&&g(e,["parameters","enhancePrompt"],c),u(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=u(t,["lastFrame"]);e!==void 0&&d!=null&&g(e,["instances[0]","lastFrame"],dd(d));const h=u(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Ck(m))),g(e,["instances[0]","referenceImages"],p)}if(u(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(u(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function BE(t,e){const n={},r=u(t,["numberOfVideos"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const a=u(t,["outputGcsUri"]);e!==void 0&&a!=null&&g(e,["parameters","storageUri"],a);const i=u(t,["fps"]);e!==void 0&&i!=null&&g(e,["parameters","fps"],i);const A=u(t,["durationSeconds"]);e!==void 0&&A!=null&&g(e,["parameters","durationSeconds"],A);const o=u(t,["seed"]);e!==void 0&&o!=null&&g(e,["parameters","seed"],o);const l=u(t,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const c=u(t,["resolution"]);e!==void 0&&c!=null&&g(e,["parameters","resolution"],c);const d=u(t,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const h=u(t,["pubsubTopic"]);e!==void 0&&h!=null&&g(e,["parameters","pubsubTopic"],h);const p=u(t,["negativePrompt"]);e!==void 0&&p!=null&&g(e,["parameters","negativePrompt"],p);const m=u(t,["enhancePrompt"]);e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m);const B=u(t,["generateAudio"]);e!==void 0&&B!=null&&g(e,["parameters","generateAudio"],B);const y=u(t,["lastFrame"]);e!==void 0&&y!=null&&g(e,["instances[0]","lastFrame"],gs(y));const b=u(t,["referenceImages"]);if(e!==void 0&&b!=null){let k=b;Array.isArray(k)&&(k=k.map(E=>Nk(E))),g(e,["instances[0]","referenceImages"],k)}const C=u(t,["mask"]);e!==void 0&&C!=null&&g(e,["instances[0]","mask"],Bk(C));const N=u(t,["compressionQuality"]);return e!==void 0&&N!=null&&g(e,["parameters","compressionQuality"],N),n}function CE(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response","generateVideoResponse"]);return A!=null&&g(e,["response"],FE(A)),e}function NE(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response"]);return A!=null&&g(e,["response"],EE(A)),e}function SE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["prompt"]);a!=null&&g(n,["instances[0]","prompt"],a);const i=u(e,["image"]);i!=null&&g(n,["instances[0]","image"],dd(i));const A=u(e,["video"]);A!=null&&g(n,["instances[0]","video"],tw(A));const o=u(e,["source"]);o!=null&&kE(o,n);const l=u(e,["config"]);return l!=null&&vE(l,n),n}function IE(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["prompt"]);a!=null&&g(n,["instances[0]","prompt"],a);const i=u(e,["image"]);i!=null&&g(n,["instances[0]","image"],gs(i));const A=u(e,["video"]);A!=null&&g(n,["instances[0]","video"],nw(A));const o=u(e,["source"]);o!=null&&UE(o,n);const l=u(e,["config"]);return l!=null&&BE(l,n),n}function FE(t){const e={},n=u(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(A=>QE(A))),g(e,["generatedVideos"],i)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&g(e,["raiMediaFilteredCount"],r);const a=u(t,["raiMediaFilteredReasons"]);return a!=null&&g(e,["raiMediaFilteredReasons"],a),e}function EE(t){const e={},n=u(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(A=>LE(A))),g(e,["generatedVideos"],i)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&g(e,["raiMediaFilteredCount"],r);const a=u(t,["raiMediaFilteredReasons"]);return a!=null&&g(e,["raiMediaFilteredReasons"],a),e}function kE(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const a=u(t,["image"]);e!==void 0&&a!=null&&g(e,["instances[0]","image"],dd(a));const i=u(t,["video"]);return e!==void 0&&i!=null&&g(e,["instances[0]","video"],tw(i)),n}function UE(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const a=u(t,["image"]);e!==void 0&&a!=null&&g(e,["instances[0]","image"],gs(a));const i=u(t,["video"]);return e!==void 0&&i!=null&&g(e,["instances[0]","video"],nw(i)),n}function jE(t){const e={},n=u(t,["_self"]);n!=null&&g(e,["image"],GE(n));const r=u(t,["raiFilteredReason"]);r!=null&&g(e,["raiFilteredReason"],r);const a=u(t,["_self"]);return a!=null&&g(e,["safetyAttributes"],$x(a)),e}function cd(t){const e={},n=u(t,["_self"]);n!=null&&g(e,["image"],Yx(n));const r=u(t,["raiFilteredReason"]);r!=null&&g(e,["raiFilteredReason"],r);const a=u(t,["_self"]);a!=null&&g(e,["safetyAttributes"],Xx(a));const i=u(t,["prompt"]);return i!=null&&g(e,["enhancedPrompt"],i),e}function TE(t){const e={},n=u(t,["_self"]);n!=null&&g(e,["mask"],Yx(n));const r=u(t,["labels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>i)),g(e,["labels"],a)}return e}function QE(t){const e={},n=u(t,["video"]);return n!=null&&g(e,["video"],bk(n)),e}function LE(t){const e={},n=u(t,["_self"]);return n!=null&&g(e,["video"],vk(n)),e}function _E(t){const e={},n=u(t,["modelSelectionConfig"]);n!=null&&g(e,["modelConfig"],n);const r=u(t,["responseJsonSchema"]);r!=null&&g(e,["responseJsonSchema"],r);const a=u(t,["audioTimestamp"]);a!=null&&g(e,["audioTimestamp"],a);const i=u(t,["candidateCount"]);i!=null&&g(e,["candidateCount"],i);const A=u(t,["enableAffectiveDialog"]);A!=null&&g(e,["enableAffectiveDialog"],A);const o=u(t,["frequencyPenalty"]);o!=null&&g(e,["frequencyPenalty"],o);const l=u(t,["logprobs"]);l!=null&&g(e,["logprobs"],l);const c=u(t,["maxOutputTokens"]);c!=null&&g(e,["maxOutputTokens"],c);const d=u(t,["mediaResolution"]);d!=null&&g(e,["mediaResolution"],d);const h=u(t,["presencePenalty"]);h!=null&&g(e,["presencePenalty"],h);const p=u(t,["responseLogprobs"]);p!=null&&g(e,["responseLogprobs"],p);const m=u(t,["responseMimeType"]);m!=null&&g(e,["responseMimeType"],m);const B=u(t,["responseModalities"]);B!=null&&g(e,["responseModalities"],B);const y=u(t,["responseSchema"]);y!=null&&g(e,["responseSchema"],y);const b=u(t,["routingConfig"]);b!=null&&g(e,["routingConfig"],b);const C=u(t,["seed"]);C!=null&&g(e,["seed"],C);const N=u(t,["speechConfig"]);N!=null&&g(e,["speechConfig"],Zx(N));const k=u(t,["stopSequences"]);k!=null&&g(e,["stopSequences"],k);const E=u(t,["temperature"]);E!=null&&g(e,["temperature"],E);const _=u(t,["thinkingConfig"]);_!=null&&g(e,["thinkingConfig"],_);const M=u(t,["topK"]);M!=null&&g(e,["topK"],M);const D=u(t,["topP"]);if(D!=null&&g(e,["topP"],D),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function ME(t,e){const n={},r=u(e,["model"]);return r!=null&&g(n,["_url","name"],Ft(t,r)),n}function DE(t,e){const n={},r=u(e,["model"]);return r!=null&&g(n,["_url","name"],Ft(t,r)),n}function PE(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&g(e,["enableWidget"],n),e}function RE(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&g(e,["timeRangeFilter"],n),e}function HE(t){const e={},n=u(t,["aspectRatio"]);n!=null&&g(e,["aspectRatio"],n);const r=u(t,["imageSize"]);if(r!=null&&g(e,["imageSize"],r),u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function OE(t){const e={},n=u(t,["aspectRatio"]);n!=null&&g(e,["aspectRatio"],n);const r=u(t,["imageSize"]);r!=null&&g(e,["imageSize"],r);const a=u(t,["outputMimeType"]);a!=null&&g(e,["imageOutputOptions","mimeType"],a);const i=u(t,["outputCompressionQuality"]);return i!=null&&g(e,["imageOutputOptions","compressionQuality"],i),e}function GE(t){const e={},n=u(t,["bytesBase64Encoded"]);n!=null&&g(e,["imageBytes"],Da(n));const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Yx(t){const e={},n=u(t,["gcsUri"]);n!=null&&g(e,["gcsUri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&g(e,["imageBytes"],Da(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["mimeType"],a),e}function dd(t){const e={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=u(t,["imageBytes"]);n!=null&&g(e,["bytesBase64Encoded"],Da(n));const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function gs(t){const e={},n=u(t,["gcsUri"]);n!=null&&g(e,["gcsUri"],n);const r=u(t,["imageBytes"]);r!=null&&g(e,["bytesBase64Encoded"],Da(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["mimeType"],a),e}function VE(t,e,n){const r={},a=u(e,["pageSize"]);n!==void 0&&a!=null&&g(n,["_query","pageSize"],a);const i=u(e,["pageToken"]);n!==void 0&&i!=null&&g(n,["_query","pageToken"],i);const A=u(e,["filter"]);n!==void 0&&A!=null&&g(n,["_query","filter"],A);const o=u(e,["queryBase"]);return n!==void 0&&o!=null&&g(n,["_url","models_url"],Ox(t,o)),r}function KE(t,e,n){const r={},a=u(e,["pageSize"]);n!==void 0&&a!=null&&g(n,["_query","pageSize"],a);const i=u(e,["pageToken"]);n!==void 0&&i!=null&&g(n,["_query","pageToken"],i);const A=u(e,["filter"]);n!==void 0&&A!=null&&g(n,["_query","filter"],A);const o=u(e,["queryBase"]);return n!==void 0&&o!=null&&g(n,["_url","models_url"],Ox(t,o)),r}function qE(t,e){const n={},r=u(e,["config"]);return r!=null&&VE(t,r,n),n}function zE(t,e){const n={},r=u(e,["config"]);return r!=null&&KE(t,r,n),n}function JE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["_self"]);if(a!=null){let i=Gx(a);Array.isArray(i)&&(i=i.map(A=>rf(A))),g(e,["models"],i)}return e}function WE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["_self"]);if(a!=null){let i=Gx(a);Array.isArray(i)&&(i=i.map(A=>sf(A))),g(e,["models"],i)}return e}function YE(t){const e={},n=u(t,["maskMode"]);n!=null&&g(e,["maskMode"],n);const r=u(t,["segmentationClasses"]);r!=null&&g(e,["maskClasses"],r);const a=u(t,["maskDilation"]);return a!=null&&g(e,["dilation"],a),e}function rf(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["displayName"]);r!=null&&g(e,["displayName"],r);const a=u(t,["description"]);a!=null&&g(e,["description"],a);const i=u(t,["version"]);i!=null&&g(e,["version"],i);const A=u(t,["_self"]);A!=null&&g(e,["tunedModelInfo"],uk(A));const o=u(t,["inputTokenLimit"]);o!=null&&g(e,["inputTokenLimit"],o);const l=u(t,["outputTokenLimit"]);l!=null&&g(e,["outputTokenLimit"],l);const c=u(t,["supportedGenerationMethods"]);c!=null&&g(e,["supportedActions"],c);const d=u(t,["temperature"]);d!=null&&g(e,["temperature"],d);const h=u(t,["maxTemperature"]);h!=null&&g(e,["maxTemperature"],h);const p=u(t,["topP"]);p!=null&&g(e,["topP"],p);const m=u(t,["topK"]);m!=null&&g(e,["topK"],m);const B=u(t,["thinking"]);return B!=null&&g(e,["thinking"],B),e}function sf(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["displayName"]);r!=null&&g(e,["displayName"],r);const a=u(t,["description"]);a!=null&&g(e,["description"],a);const i=u(t,["versionId"]);i!=null&&g(e,["version"],i);const A=u(t,["deployedModels"]);if(A!=null){let h=A;Array.isArray(h)&&(h=h.map(p=>lE(p))),g(e,["endpoints"],h)}const o=u(t,["labels"]);o!=null&&g(e,["labels"],o);const l=u(t,["_self"]);l!=null&&g(e,["tunedModelInfo"],fk(l));const c=u(t,["defaultCheckpointId"]);c!=null&&g(e,["defaultCheckpointId"],c);const d=u(t,["checkpoints"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["checkpoints"],h)}return e}function $E(t){const e={},n=u(t,["mediaResolution"]);n!=null&&g(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&g(e,["codeExecutionResult"],r);const a=u(t,["executableCode"]);a!=null&&g(e,["executableCode"],a);const i=u(t,["fileData"]);i!=null&&g(e,["fileData"],cE(i));const A=u(t,["functionCall"]);A!=null&&g(e,["functionCall"],dE(A));const o=u(t,["functionResponse"]);o!=null&&g(e,["functionResponse"],o);const l=u(t,["inlineData"]);l!=null&&g(e,["inlineData"],_F(l));const c=u(t,["text"]);c!=null&&g(e,["text"],c);const d=u(t,["thought"]);d!=null&&g(e,["thought"],d);const h=u(t,["thoughtSignature"]);h!=null&&g(e,["thoughtSignature"],h);const p=u(t,["videoMetadata"]);return p!=null&&g(e,["videoMetadata"],p),e}function XE(t){const e={},n=u(t,["productImage"]);return n!=null&&g(e,["image"],gs(n)),e}function ZE(t,e){const n={},r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const a=u(t,["baseSteps"]);e!==void 0&&a!=null&&g(e,["parameters","baseSteps"],a);const i=u(t,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);const A=u(t,["seed"]);e!==void 0&&A!=null&&g(e,["parameters","seed"],A);const o=u(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&g(e,["parameters","safetySetting"],o);const l=u(t,["personGeneration"]);e!==void 0&&l!=null&&g(e,["parameters","personGeneration"],l);const c=u(t,["addWatermark"]);e!==void 0&&c!=null&&g(e,["parameters","addWatermark"],c);const d=u(t,["outputMimeType"]);e!==void 0&&d!=null&&g(e,["parameters","outputOptions","mimeType"],d);const h=u(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","compressionQuality"],h);const p=u(t,["enhancePrompt"]);e!==void 0&&p!=null&&g(e,["parameters","enhancePrompt"],p);const m=u(t,["labels"]);return e!==void 0&&m!=null&&g(e,["labels"],m),n}function ek(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["source"]);a!=null&&nk(a,n);const i=u(e,["config"]);return i!=null&&ZE(i,n),n}function tk(t){const e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>cd(a))),g(e,["generatedImages"],r)}return e}function nk(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const a=u(t,["personImage"]);e!==void 0&&a!=null&&g(e,["instances[0]","personImage","image"],gs(a));const i=u(t,["productImages"]);if(e!==void 0&&i!=null){let A=i;Array.isArray(A)&&(A=A.map(o=>XE(o))),g(e,["instances[0]","productImages"],A)}return n}function rk(t){const e={},n=u(t,["referenceImage"]);n!=null&&g(e,["referenceImage"],gs(n));const r=u(t,["referenceId"]);r!=null&&g(e,["referenceId"],r);const a=u(t,["referenceType"]);a!=null&&g(e,["referenceType"],a);const i=u(t,["maskImageConfig"]);i!=null&&g(e,["maskImageConfig"],YE(i));const A=u(t,["controlImageConfig"]);A!=null&&g(e,["controlImageConfig"],GF(A));const o=u(t,["styleImageConfig"]);o!=null&&g(e,["styleImageConfig"],o);const l=u(t,["subjectImageConfig"]);return l!=null&&g(e,["subjectImageConfig"],l),e}function $x(t){const e={},n=u(t,["safetyAttributes","categories"]);n!=null&&g(e,["categories"],n);const r=u(t,["safetyAttributes","scores"]);r!=null&&g(e,["scores"],r);const a=u(t,["contentType"]);return a!=null&&g(e,["contentType"],a),e}function Xx(t){const e={},n=u(t,["safetyAttributes","categories"]);n!=null&&g(e,["categories"],n);const r=u(t,["safetyAttributes","scores"]);r!=null&&g(e,["scores"],r);const a=u(t,["contentType"]);return a!=null&&g(e,["contentType"],a),e}function sk(t){const e={},n=u(t,["category"]);if(n!=null&&g(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=u(t,["threshold"]);return r!=null&&g(e,["threshold"],r),e}function ak(t){const e={},n=u(t,["image"]);return n!=null&&g(e,["image"],gs(n)),e}function ik(t,e){const n={},r=u(t,["mode"]);e!==void 0&&r!=null&&g(e,["parameters","mode"],r);const a=u(t,["maxPredictions"]);e!==void 0&&a!=null&&g(e,["parameters","maxPredictions"],a);const i=u(t,["confidenceThreshold"]);e!==void 0&&i!=null&&g(e,["parameters","confidenceThreshold"],i);const A=u(t,["maskDilation"]);e!==void 0&&A!=null&&g(e,["parameters","maskDilation"],A);const o=u(t,["binaryColorThreshold"]);e!==void 0&&o!=null&&g(e,["parameters","binaryColorThreshold"],o);const l=u(t,["labels"]);return e!==void 0&&l!=null&&g(e,["labels"],l),n}function Ak(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["source"]);a!=null&&lk(a,n);const i=u(e,["config"]);return i!=null&&ik(i,n),n}function ok(t){const e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>TE(a))),g(e,["generatedMasks"],r)}return e}function lk(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const a=u(t,["image"]);e!==void 0&&a!=null&&g(e,["instances[0]","image"],gs(a));const i=u(t,["scribbleImage"]);return e!==void 0&&i!=null&&g(e,["instances[0]","scribble"],ak(i)),n}function Zx(t){const e={},n=u(t,["languageCode"]);n!=null&&g(e,["languageCode"],n);const r=u(t,["voiceConfig"]);if(r!=null&&g(e,["voiceConfig"],r),u(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function ck(t){const e={},n=u(t,["functionCallingConfig"]);n!=null&&g(e,["functionCallingConfig"],uE(n));const r=u(t,["retrievalConfig"]);return r!=null&&g(e,["retrievalConfig"],r),e}function dk(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),g(e,["functionDeclarations"],d)}if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=u(t,["googleSearchRetrieval"]);r!=null&&g(e,["googleSearchRetrieval"],r);const a=u(t,["computerUse"]);a!=null&&g(e,["computerUse"],a);const i=u(t,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const A=u(t,["codeExecution"]);if(A!=null&&g(e,["codeExecution"],A),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["googleMaps"]);o!=null&&g(e,["googleMaps"],PE(o));const l=u(t,["googleSearch"]);l!=null&&g(e,["googleSearch"],RE(l));const c=u(t,["urlContext"]);return c!=null&&g(e,["urlContext"],c),e}function ew(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>fE(p))),g(e,["functionDeclarations"],h)}const r=u(t,["retrieval"]);r!=null&&g(e,["retrieval"],r);const a=u(t,["googleSearchRetrieval"]);a!=null&&g(e,["googleSearchRetrieval"],a);const i=u(t,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const A=u(t,["codeExecution"]);A!=null&&g(e,["codeExecution"],A);const o=u(t,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);const l=u(t,["googleMaps"]);l!=null&&g(e,["googleMaps"],l);const c=u(t,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);const d=u(t,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function uk(t){const e={},n=u(t,["baseModel"]);n!=null&&g(e,["baseModel"],n);const r=u(t,["createTime"]);r!=null&&g(e,["createTime"],r);const a=u(t,["updateTime"]);return a!=null&&g(e,["updateTime"],a),e}function fk(t){const e={},n=u(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&g(e,["baseModel"],n);const r=u(t,["createTime"]);r!=null&&g(e,["createTime"],r);const a=u(t,["updateTime"]);return a!=null&&g(e,["updateTime"],a),e}function hk(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const a=u(t,["description"]);e!==void 0&&a!=null&&g(e,["description"],a);const i=u(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&g(e,["defaultCheckpointId"],i),n}function gk(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const a=u(t,["description"]);e!==void 0&&a!=null&&g(e,["description"],a);const i=u(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&g(e,["defaultCheckpointId"],i),n}function mk(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","name"],Ft(t,r));const a=u(e,["config"]);return a!=null&&hk(a,n),n}function pk(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["config"]);return a!=null&&gk(a,n),n}function xk(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const a=u(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&g(e,["parameters","safetySetting"],a);const i=u(t,["personGeneration"]);e!==void 0&&i!=null&&g(e,["parameters","personGeneration"],i);const A=u(t,["includeRaiReason"]);e!==void 0&&A!=null&&g(e,["parameters","includeRaiReason"],A);const o=u(t,["outputMimeType"]);e!==void 0&&o!=null&&g(e,["parameters","outputOptions","mimeType"],o);const l=u(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&g(e,["parameters","outputOptions","compressionQuality"],l);const c=u(t,["enhanceInputImage"]);e!==void 0&&c!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],c);const d=u(t,["imagePreservationFactor"]);e!==void 0&&d!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],d);const h=u(t,["labels"]);e!==void 0&&h!=null&&g(e,["labels"],h);const p=u(t,["numberOfImages"]);e!==void 0&&p!=null&&g(e,["parameters","sampleCount"],p);const m=u(t,["mode"]);return e!==void 0&&m!=null&&g(e,["parameters","mode"],m),n}function wk(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["_url","model"],Ft(t,r));const a=u(e,["image"]);a!=null&&g(n,["instances[0]","image"],gs(a));const i=u(e,["upscaleFactor"]);i!=null&&g(n,["parameters","upscaleConfig","upscaleFactor"],i);const A=u(e,["config"]);return A!=null&&xk(A,n),n}function yk(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>cd(i))),g(e,["generatedImages"],a)}return e}function bk(t){const e={},n=u(t,["uri"]);n!=null&&g(e,["uri"],n);const r=u(t,["encodedVideo"]);r!=null&&g(e,["videoBytes"],Da(r));const a=u(t,["encoding"]);return a!=null&&g(e,["mimeType"],a),e}function vk(t){const e={},n=u(t,["gcsUri"]);n!=null&&g(e,["uri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&g(e,["videoBytes"],Da(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["mimeType"],a),e}function Bk(t){const e={},n=u(t,["image"]);n!=null&&g(e,["_self"],gs(n));const r=u(t,["maskMode"]);return r!=null&&g(e,["maskMode"],r),e}function Ck(t){const e={},n=u(t,["image"]);n!=null&&g(e,["image"],dd(n));const r=u(t,["referenceType"]);return r!=null&&g(e,["referenceType"],r),e}function Nk(t){const e={},n=u(t,["image"]);n!=null&&g(e,["image"],gs(n));const r=u(t,["referenceType"]);return r!=null&&g(e,["referenceType"],r),e}function tw(t){const e={},n=u(t,["uri"]);n!=null&&g(e,["uri"],n);const r=u(t,["videoBytes"]);r!=null&&g(e,["encodedVideo"],Da(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["encoding"],a),e}function nw(t){const e={},n=u(t,["uri"]);n!=null&&g(e,["gcsUri"],n);const r=u(t,["videoBytes"]);r!=null&&g(e,["bytesBase64Encoded"],Da(r));const a=u(t,["mimeType"]);return a!=null&&g(e,["mimeType"],a),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sk="Content-Type",Ik="X-Server-Timeout",Fk="User-Agent",af="x-goog-api-client",Ek="1.30.0",kk=`google-genai-sdk/${Ek}`,Uk="v1beta1",jk="v1beta",pm=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Tk{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Uk,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:jk,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[A,o]of Object.entries(e.queryParams))a.searchParams.append(A,String(o));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,a.toString(),e.abortSignal),this.unaryApiCall(a,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,i]of Object.entries(n))typeof i=="object"?r[a]=Object.assign(Object.assign({},r[a]),i):i!==void 0&&(r[a]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,a.toString(),e.abortSignal),this.streamApiCall(a,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,a){if(n&&n.timeout||a){const i=new AbortController,A=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}a&&a.addEventListener("abort",()=>{i.abort()}),e.signal=A}return n&&n.extraBody!==null&&Qk(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await xm(a),new ef(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await xm(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return bA(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let A="";for(;;){const{done:o,value:l}=yield zt(a.read());if(o){if(A.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=i.decode(l,{stream:!0});try{const h=JSON.parse(c);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,B=p.code,y=`got status: ${m}. ${JSON.stringify(h)}`;if(B>=400&&B<600)throw new od({message:y,status:B})}}catch(h){if(h.name==="ApiError")throw h}A+=c;let d=A.match(pm);for(;d;){const h=d[1];try{const p=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield zt(new ef(p)),A=A.slice(d[0].length),d=A.match(pm)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=kk+" "+this.clientOptions.userAgentExtra;return e[Fk]=n,e[af]=n,e[Sk]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[a,i]of Object.entries(e.headers))r.append(a,i);e.timeout&&e.timeout>0&&r.append(Ik,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const i=this.clientOptions.uploader,A=await i.stat(e);a.sizeBytes=String(A.size);const o=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:A.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=o;const l={file:a},c=this.getFileName(e),d=qe("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(d,a.sizeBytes,a.mimeType,c,l,n==null?void 0:n.httpOptions);return i.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,r){var a;const i=this.clientOptions.uploader,A=await i.stat(n),o=String(A.size),l=(a=r==null?void 0:r.mimeType)!==null&&a!==void 0?a:A.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,d=this.getFileName(n),h={};r!=null&&r.customMetadata&&(h.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(h.chunkingConfig=r.chunkingConfig);const p=await this.fetchUploadUrl(c,o,l,d,h,r==null?void 0:r.httpOptions);return i.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,a,i,A){var o;let l={};A?l=A:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},a?{"X-Goog-Upload-File-Name":a}:{})};const c=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(o=c==null?void 0:c.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function xm(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new od({message:a,status:n}):new Error(a)}}function Qk(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,A){const o=Object.assign({},i);for(const l in A)if(Object.prototype.hasOwnProperty.call(A,l)){const c=A[l],d=o[l];c&&typeof c=="object"&&!Array.isArray(c)&&d&&typeof d=="object"&&!Array.isArray(d)?o[l]=r(d,c):(d&&c&&typeof d!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof c}. Overwriting.`),o[l]=c)}return o}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Lk="mcp_used/unknown";let _k=!1;function rw(t){for(const e of t)if(Mk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return _k}function sw(t){var e;const n=(e=t[af])!==null&&e!==void 0?e:"";t[af]=(n+` ${Lk}`).trimStart()}function Mk(t){return t!==null&&typeof t=="object"&&t instanceof Pf}function Dk(t,e=100){return bA(this,arguments,function*(){let r,a=0;for(;a<e;){const i=yield zt(t.listTools({cursor:r}));for(const A of i.tools)yield yield zt(A),a++;if(!i.nextCursor)break;r=i.nextCursor}})}class Pf{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Pf(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const i={},A=[];for(const d of this.mcpClients)try{for(var o=!0,l=(n=void 0,Ro(Dk(d))),c;c=await l.next(),e=c.done,!e;o=!0){a=c.value,o=!1;const h=a;A.push(h);const p=h.name;if(i[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);i[p]=d}}catch(h){n={error:h}}finally{try{!o&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=A,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),k3(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const A=await a.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:A.isError?{error:A}:A}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Pk(t,e,n){const r=new v3;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data),Object.assign(r,a),e(r)}class Rk{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),A=Gk(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),l=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${o}`;let c=()=>{};const d=new Promise(k=>{c=k}),h=e.callbacks,p=function(){c({})},m=this.apiClient,B={onopen:p,onmessage:k=>{Pk(m,h.onmessage,k)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(k){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(k){}},y=this.webSocketFactory.create(l,Ok(A),B);y.connect(),await d;const N={setup:{model:Ft(this.apiClient,e.model)}};return y.send(JSON.stringify(N)),new Hk(y,this.apiClient)}}class Hk{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=IF(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=SF(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(fA.PLAY)}pause(){this.sendPlaybackControl(fA.PAUSE)}stop(){this.sendPlaybackControl(fA.STOP)}resetContext(){this.sendPlaybackControl(fA.RESET_CONTEXT)}close(){this.conn.close()}}function Ok(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Gk(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Kk(t,e,n){const r=new b3;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const i=JSON.parse(a);if(t.isVertexAI()){const A=kF(i);Object.assign(r,A)}else Object.assign(r,i);e(r)}class qk{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new Rk(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,i,A,o;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let d;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&rw(e.config.tools)&&sw(h);const p=Yk(h);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,d);else{const j=this.apiClient.getApiKey();let O="BidiGenerateContent",F="key";j!=null&&j.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),O="BidiGenerateContentConstrained",F="access_token"),d=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${O}?${F}=${j}`}let m=()=>{};const B=new Promise(j=>{m=j}),y=e.callbacks,b=function(){var j;(j=y==null?void 0:y.onopen)===null||j===void 0||j.call(y),m({})},C=this.apiClient,N={onopen:b,onmessage:j=>{Kk(C,y.onmessage,j)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(j){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(j){}},k=this.webSocketFactory.create(d,Wk(p),N);k.connect(),await B;let E=Ft(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const j=this.apiClient.getProject(),O=this.apiClient.getLocation();E=`projects/${j}/locations/${O}/`+E}let _={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Tc.AUDIO]}:e.config.responseModalities=[Tc.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(o=(A=e.config)===null||A===void 0?void 0:A.tools)!==null&&o!==void 0?o:[],D=[];for(const j of M)if(this.isCallableTool(j)){const O=j;D.push(await O.tool())}else D.push(j);D.length>0&&(e.config.tools=D);const U={model:E,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=NF(this.apiClient,U):_=CF(this.apiClient,U),delete _.config,k.send(JSON.stringify(_)),new Jk(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const zk={turnComplete:!0};class Jk{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Zr(n.turns),e.isVertexAI()||(r=r.map(a=>ld(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(Vk)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},zk),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:EF(e)}:n={realtimeInput:FF(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Wk(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Yk(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wm=10;function ym(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const A of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(vA(A)){a=!0;break}if(!a)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function vA(t){return"callTool"in t&&typeof t.callTool=="function"}function $k(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>vA(a)))!==null&&r!==void 0?r:!1}function bm(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,a)=>{if(vA(r))return;const i=r;i.functionDeclarations&&i.functionDeclarations.length>0&&n.push(a)}),n}function vm(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xk extends ea{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,i,A,o;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!$k(n)||ym(n.config))return await this.generateContentInternal(l);const c=bm(n);if(c.length>0){const y=c.map(b=>`tools[${b}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${y}.`)}let d,h;const p=Zr(l.contents),m=(i=(a=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&i!==void 0?i:wm;let B=0;for(;B<m&&(d=await this.generateContentInternal(l),!(!d.functionCalls||d.functionCalls.length===0));){const y=d.candidates[0].content,b=[];for(const C of(o=(A=n.config)===null||A===void 0?void 0:A.tools)!==null&&o!==void 0?o:[])if(vA(C)){const k=await C.callTool(d.functionCalls);b.push(...k)}B++,h={role:"user",parts:b},l.contents=Zr(l.contents),l.contents.push(y),l.contents.push(h),vm(l.config)&&(p.push(y),p.push(h))}return vm(l.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async n=>{var r,a,i,A,o;if(this.maybeMoveToResponseJsonSchem(n),ym(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const l=bm(n);if(l.length>0){const h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(i=(a=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||a===void 0?void 0:a.functionCallingConfig)===null||i===void 0?void 0:i.streamFunctionCallArguments,d=(o=(A=n==null?void 0:n.config)===null||A===void 0?void 0:A.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(c&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let i;const A=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((a=l==null?void 0:l.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?i=l==null?void 0:l.safetyAttributes:A.push(l);let o;return i?o={generatedImages:A,positivePromptSafetyAttributes:i,sdkHttpResponse:r.sdkHttpResponse}:o={generatedImages:A,sdkHttpResponse:r.sdkHttpResponse},o}),this.list=async n=>{var r;const A={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!A.config.queryBase){if(!((r=A.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");A.config.filter="labels.tune-type:*"}return new wi($s.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(A),A)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)},this.generateVideos=async n=>{var r,a,i,A,o,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((a=n.video)===null||a===void 0)&&a.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((A=(i=n.source)===null||i===void 0?void 0:i.video)===null||A===void 0)&&A.uri&&(!((l=(o=n.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,a;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const A=await Promise.all(i.map(async l=>vA(l)?await l.tool():l)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:A})};if(o.config.tools=A,e.config&&e.config.tools&&rw(e.config.tools)){const l=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),sw(c),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return o}async initAfcToolsMap(e){var n,r,a;const i=new Map;for(const A of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(vA(A)){const o=A,l=await o.tool();for(const c of(a=l.functionDeclarations)!==null&&a!==void 0?a:[]){if(!c.name)throw new Error("Function declaration name is required.");if(i.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);i.set(c.name,o)}}return i}async processAfcStream(e){var n,r,a;const i=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:wm;let A=!1,o=0;const l=await this.initAfcToolsMap(e);return function(c,d,h){var p,m;return bA(this,arguments,function*(){for(var B,y,b,C;o<i;){A&&(o++,A=!1);const _=yield zt(c.processParamsMaybeAddMcpUsage(h)),M=yield zt(c.generateContentStreamInternal(_)),D=[],U=[];try{for(var N=!0,k=(y=void 0,Ro(M)),E;E=yield zt(k.next()),B=E.done,!B;N=!0){C=E.value,N=!1;const j=C;if(yield yield zt(j),j.candidates&&(!((p=j.candidates[0])===null||p===void 0)&&p.content)){U.push(j.candidates[0].content);for(const O of(m=j.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(o<i&&O.functionCall){if(!O.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(O.functionCall.name)){const F=yield zt(d.get(O.functionCall.name).callTool([O.functionCall]));D.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${O.functionCall.name}`)}}}}catch(j){y={error:j}}finally{try{!N&&!B&&(b=k.return)&&(yield zt(b.call(k)))}finally{if(y)throw y.error}}if(D.length>0){A=!0;const j=new So;j.candidates=[{content:{role:"user",parts:D}}],yield yield zt(j);const O=[];O.push(...U),O.push({role:"user",parts:D});const F=Zr(h.contents).concat(O);h.contents=F}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=hm(this.apiClient,e);return o=qe("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=mm(d),p=new So;return Object.assign(p,h),p})}else{const c=fm(this.apiClient,e);return o=qe("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=gm(d),p=new So;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=hm(this.apiClient,e);return o=qe("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),A.then(function(h){return bA(this,arguments,function*(){var p,m,B,y;try{for(var b=!0,C=Ro(h),N;N=yield zt(C.next()),p=N.done,!p;b=!0){y=N.value,b=!1;const k=y,E=mm(yield zt(k.json()));E.sdkHttpResponse={headers:k.headers};const _=new So;Object.assign(_,E),yield yield zt(_)}}catch(k){m={error:k}}finally{try{!b&&!p&&(B=C.return)&&(yield zt(B.call(C)))}finally{if(m)throw m.error}}})})}else{const c=fm(this.apiClient,e);return o=qe("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),A.then(function(h){return bA(this,arguments,function*(){var p,m,B,y;try{for(var b=!0,C=Ro(h),N;N=yield zt(C.next()),p=N.done,!p;b=!0){y=N.value,b=!1;const k=y,E=gm(yield zt(k.json()));E.sdkHttpResponse={headers:k.headers};const _=new So;Object.assign(_,E),yield yield zt(_)}}catch(k){m={error:k}}finally{try{!b&&!p&&(B=C.return)&&(yield zt(B.call(C)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=iE(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=oE(d),p=new $0;return Object.assign(p,h),p})}else{const c=aE(this.apiClient,e);return o=qe("{model}:batchEmbedContents",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=AE(d),p=new $0;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=wE(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=bE(d),p=new X0;return Object.assign(p,h),p})}else{const c=xE(this.apiClient,e);return o=qe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=yE(d),p=new X0;return Object.assign(p,h),p})}}async editImageInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=tE(this.apiClient,e);return i=qe("{model}:predict",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>{const c=nE(l),d=new c3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=wk(this.apiClient,e);return i=qe("{model}:predict",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>{const c=yk(l),d=new d3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=ek(this.apiClient,e);return i=qe("{model}:predict",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=tk(l),d=new u3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=Ak(this.apiClient,e);return i=qe("{model}:predict",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=ok(l),d=new f3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=DE(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>sf(d))}else{const c=ME(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>rf(d))}}async listInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=zE(this.apiClient,e);return o=qe("{models_url}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=WE(d),p=new Z0;return Object.assign(p,h),p})}else{const c=qE(this.apiClient,e);return o=qe("{models_url}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=JE(d),p=new Z0;return Object.assign(p,h),p})}}async update(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=pk(this.apiClient,e);return o=qe("{model}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>sf(d))}else{const c=mk(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>rf(d))}}async delete(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=$F(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=ZF(d),p=new em;return Object.assign(p,h),p})}else{const c=YF(this.apiClient,e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=XF(d),p=new em;return Object.assign(p,h),p})}}async countTokens(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=zF(this.apiClient,e);return o=qe("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=WF(d),p=new tm;return Object.assign(p,h),p})}else{const c=qF(this.apiClient,e);return o=qe("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=JF(d),p=new tm;return Object.assign(p,h),p})}}async computeTokens(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=PF(this.apiClient,e);return i=qe("{model}:computeTokens",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>{const c=RF(l),d=new h3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=IE(this.apiClient,e);return o=qe("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A.then(d=>{const h=NE(d),p=new Qc;return Object.assign(p,h),p})}else{const c=SE(this.apiClient,e);return o=qe("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A.then(d=>{const h=CE(d),p=new Qc;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zk extends ea{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const A=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:A,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const A=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:A,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=s3(e);return o=qe("{operationName}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),A}else{const c=r3(e);return o=qe("{operationName}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),A}}async fetchPredictVideosOperationInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=YS(e);return i=qe("{resourceName}:fetchPredictOperation",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e6(t){const e={},n=u(t,["data"]);if(n!=null&&g(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function t6(t){const e={},n=u(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>c6(i))),g(e,["parts"],a)}const r=u(t,["role"]);return r!=null&&g(e,["role"],r),e}function n6(t,e,n){const r={},a=u(e,["expireTime"]);n!==void 0&&a!=null&&g(n,["expireTime"],a);const i=u(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&g(n,["newSessionExpireTime"],i);const A=u(e,["uses"]);n!==void 0&&A!=null&&g(n,["uses"],A);const o=u(e,["liveConnectConstraints"]);n!==void 0&&o!=null&&g(n,["bidiGenerateContentSetup"],l6(t,o));const l=u(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&g(n,["fieldMask"],l),r}function r6(t,e){const n={},r=u(e,["config"]);return r!=null&&g(n,["config"],n6(t,r,n)),n}function s6(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&g(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function a6(t){const e={},n=u(t,["id"]);n!=null&&g(e,["id"],n);const r=u(t,["args"]);r!=null&&g(e,["args"],r);const a=u(t,["name"]);if(a!=null&&g(e,["name"],a),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function i6(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&g(e,["enableWidget"],n),e}function A6(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&g(e,["timeRangeFilter"],n),e}function o6(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig"],r);const a=u(t,["responseModalities"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","responseModalities"],a);const i=u(t,["temperature"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","temperature"],i);const A=u(t,["topP"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","topP"],A);const o=u(t,["topK"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","topK"],o);const l=u(t,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const c=u(t,["mediaResolution"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","mediaResolution"],c);const d=u(t,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const h=u(t,["speechConfig"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","speechConfig"],Df(h));const p=u(t,["thinkingConfig"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","thinkingConfig"],p);const m=u(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],m);const B=u(t,["systemInstruction"]);e!==void 0&&B!=null&&g(e,["setup","systemInstruction"],t6(tr(B)));const y=u(t,["tools"]);if(e!==void 0&&y!=null){let M=TA(y);Array.isArray(M)&&(M=M.map(D=>u6(jA(D)))),g(e,["setup","tools"],M)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&g(e,["setup","sessionResumption"],d6(b));const C=u(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],C);const N=u(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&g(e,["setup","outputAudioTranscription"],N);const k=u(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&g(e,["setup","realtimeInputConfig"],k);const E=u(t,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],E);const _=u(t,["proactivity"]);return e!==void 0&&_!=null&&g(e,["setup","proactivity"],_),n}function l6(t,e){const n={},r=u(e,["model"]);r!=null&&g(n,["setup","model"],Ft(t,r));const a=u(e,["config"]);return a!=null&&g(n,["config"],o6(a,n)),n}function c6(t){const e={},n=u(t,["mediaResolution"]);n!=null&&g(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&g(e,["codeExecutionResult"],r);const a=u(t,["executableCode"]);a!=null&&g(e,["executableCode"],a);const i=u(t,["fileData"]);i!=null&&g(e,["fileData"],s6(i));const A=u(t,["functionCall"]);A!=null&&g(e,["functionCall"],a6(A));const o=u(t,["functionResponse"]);o!=null&&g(e,["functionResponse"],o);const l=u(t,["inlineData"]);l!=null&&g(e,["inlineData"],e6(l));const c=u(t,["text"]);c!=null&&g(e,["text"],c);const d=u(t,["thought"]);d!=null&&g(e,["thought"],d);const h=u(t,["thoughtSignature"]);h!=null&&g(e,["thoughtSignature"],h);const p=u(t,["videoMetadata"]);return p!=null&&g(e,["videoMetadata"],p),e}function d6(t){const e={},n=u(t,["handle"]);if(n!=null&&g(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function u6(t){const e={},n=u(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),g(e,["functionDeclarations"],d)}if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=u(t,["googleSearchRetrieval"]);r!=null&&g(e,["googleSearchRetrieval"],r);const a=u(t,["computerUse"]);a!=null&&g(e,["computerUse"],a);const i=u(t,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const A=u(t,["codeExecution"]);if(A!=null&&g(e,["codeExecution"],A),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["googleMaps"]);o!=null&&g(e,["googleMaps"],i6(o));const l=u(t,["googleSearch"]);l!=null&&g(e,["googleSearch"],A6(l));const c=u(t,["urlContext"]);return c!=null&&g(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f6(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(i=>`${n}.${i}`);e.push(...a)}else e.push(n)}return e.join(",")}function h6(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const i=f6(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const A=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];a.length>0&&(o=a.map(c=>A.includes(c)?`generationConfig.${c}`:c));const l=[];i&&l.push(i),o.length>0&&l.push(...o),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class g6 extends ea{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=r6(this.apiClient,e);i=qe("auth_tokens",o._url),A=o._query,delete o.config,delete o._url,delete o._query;const l=h6(o,e.config);return a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function m6(t,e){const n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&g(e,["displayName"],r),n}function p6(t){const e={},n=u(t,["config"]);return n!=null&&m6(n,e),e}function x6(t,e){const n={},r=u(t,["force"]);return e!==void 0&&r!=null&&g(e,["_query","force"],r),n}function w6(t){const e={},n=u(t,["name"]);n!=null&&g(e,["_url","name"],n);const r=u(t,["config"]);return r!=null&&x6(r,e),e}function y6(t){const e={},n=u(t,["name"]);return n!=null&&g(e,["_url","name"],n),e}function b6(t,e){const n={},r=u(t,["customMetadata"]);if(e!==void 0&&r!=null){let i=r;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["customMetadata"],i)}const a=u(t,["chunkingConfig"]);return e!==void 0&&a!=null&&g(e,["chunkingConfig"],a),n}function v6(t){const e={},n=u(t,["name"]);n!=null&&g(e,["name"],n);const r=u(t,["metadata"]);r!=null&&g(e,["metadata"],r);const a=u(t,["done"]);a!=null&&g(e,["done"],a);const i=u(t,["error"]);i!=null&&g(e,["error"],i);const A=u(t,["response"]);return A!=null&&g(e,["response"],C6(A)),e}function B6(t){const e={},n=u(t,["fileSearchStoreName"]);n!=null&&g(e,["_url","file_search_store_name"],n);const r=u(t,["fileName"]);r!=null&&g(e,["fileName"],r);const a=u(t,["config"]);return a!=null&&b6(a,e),e}function C6(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&g(e,["parent"],r);const a=u(t,["documentName"]);return a!=null&&g(e,["documentName"],a),e}function N6(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);return e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),n}function S6(t){const e={},n=u(t,["config"]);return n!=null&&N6(n,e),e}function I6(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["fileSearchStores"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["fileSearchStores"],i)}return e}function F6(t,e){const n={},r=u(t,["mimeType"]);e!==void 0&&r!=null&&g(e,["mimeType"],r);const a=u(t,["displayName"]);e!==void 0&&a!=null&&g(e,["displayName"],a);const i=u(t,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["customMetadata"],o)}const A=u(t,["chunkingConfig"]);return e!==void 0&&A!=null&&g(e,["chunkingConfig"],A),n}function E6(t){const e={},n=u(t,["fileSearchStoreName"]);n!=null&&g(e,["_url","file_search_store_name"],n);const r=u(t,["config"]);return r!=null&&F6(r,e),e}function k6(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&g(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function U6(t,e){const n={},r=u(t,["force"]);return e!==void 0&&r!=null&&g(e,["_query","force"],r),n}function j6(t){const e={},n=u(t,["name"]);n!=null&&g(e,["_url","name"],n);const r=u(t,["config"]);return r!=null&&U6(r,e),e}function T6(t){const e={},n=u(t,["name"]);return n!=null&&g(e,["_url","name"],n),e}function Q6(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const a=u(t,["pageToken"]);return e!==void 0&&a!=null&&g(e,["_query","pageToken"],a),n}function L6(t){const e={},n=u(t,["parent"]);n!=null&&g(e,["_url","parent"],n);const r=u(t,["config"]);return r!=null&&Q6(r,e),e}function _6(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&g(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&g(e,["nextPageToken"],r);const a=u(t,["documents"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(A=>A)),g(e,["documents"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M6 extends ea{constructor(e){super(),this.apiClient=e,this.list=async n=>new wi($s.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=T6(e);return i=qe("{name}",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async delete(e){var n,r;let a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const A=j6(e);a=qe("{name}",A._url),i=A._query,delete A._url,delete A._query,await this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(A),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=L6(e);return i=qe("{parent}/documents",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=_6(l),d=new g3;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class D6 extends ea{constructor(e,n=new M6(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new wi($s.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=p6(e);return i=qe("fileSearchStores",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async get(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=y6(e);return i=qe("{name}",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async delete(e){var n,r;let a="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const A=w6(e);a=qe("{name}",A._url),i=A._query,delete A._url,delete A._query,await this.apiClient.request({path:a,queryParams:i,body:JSON.stringify(A),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=S6(e);return i=qe("fileSearchStores",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=I6(l),d=new m3;return Object.assign(d,c),d})}}async uploadToFileSearchStoreInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=E6(e);return i=qe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=k6(l),d=new p3;return Object.assign(d,c),d})}}async importFile(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=B6(e);return i=qe("{file_search_store_name}:importFile",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const c=v6(l),d=new Tf;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P6(t,e){const n={},r=u(t,["name"]);return r!=null&&g(n,["_url","name"],r),n}function R6(t,e){const n={},r=u(t,["name"]);return r!=null&&g(n,["_url","name"],r),n}function H6(t,e,n){const r={};if(u(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=u(t,["tunedModelDisplayName"]);if(e!==void 0&&a!=null&&g(e,["displayName"],a),u(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=u(t,["epochCount"]);e!==void 0&&i!=null&&g(e,["tuningTask","hyperparameters","epochCount"],i);const A=u(t,["learningRateMultiplier"]);if(A!=null&&g(r,["tuningTask","hyperparameters","learningRateMultiplier"],A),u(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(u(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(u(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=u(t,["batchSize"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","batchSize"],o);const l=u(t,["learningRate"]);if(e!==void 0&&l!=null&&g(e,["tuningTask","hyperparameters","learningRate"],l),u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(u(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function O6(t,e,n){const r={};let a=u(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=u(t,["validationDataset"]);e!==void 0&&m!=null&&g(e,["supervisedTuningSpec"],Bm(m))}else if(a==="PREFERENCE_TUNING"){const m=u(t,["validationDataset"]);e!==void 0&&m!=null&&g(e,["preferenceOptimizationSpec"],Bm(m))}const i=u(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&g(e,["tunedModelDisplayName"],i);const A=u(t,["description"]);e!==void 0&&A!=null&&g(e,["description"],A);let o=u(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const m=u(t,["epochCount"]);e!==void 0&&m!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(o==="PREFERENCE_TUNING"){const m=u(t,["epochCount"]);e!==void 0&&m!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=u(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=u(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){const m=u(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let c=u(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const m=u(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(c==="PREFERENCE_TUNING"){const m=u(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let d=u(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=u(t,["adapterSize"]);e!==void 0&&m!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(d==="PREFERENCE_TUNING"){const m=u(t,["adapterSize"]);e!==void 0&&m!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(u(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(u(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=u(t,["labels"]);e!==void 0&&h!=null&&g(e,["labels"],h);const p=u(t,["beta"]);return e!==void 0&&p!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function G6(t,e){const n={},r=u(t,["baseModel"]);r!=null&&g(n,["baseModel"],r);const a=u(t,["preTunedModel"]);a!=null&&g(n,["preTunedModel"],a);const i=u(t,["trainingDataset"]);i!=null&&eU(i);const A=u(t,["config"]);return A!=null&&H6(A,n),n}function V6(t,e){const n={},r=u(t,["baseModel"]);r!=null&&g(n,["baseModel"],r);const a=u(t,["preTunedModel"]);a!=null&&g(n,["preTunedModel"],a);const i=u(t,["trainingDataset"]);i!=null&&tU(i,n,e);const A=u(t,["config"]);return A!=null&&O6(A,n,e),n}function K6(t,e){const n={},r=u(t,["name"]);return r!=null&&g(n,["_url","name"],r),n}function q6(t,e){const n={},r=u(t,["name"]);return r!=null&&g(n,["_url","name"],r),n}function z6(t,e,n){const r={},a=u(t,["pageSize"]);e!==void 0&&a!=null&&g(e,["_query","pageSize"],a);const i=u(t,["pageToken"]);e!==void 0&&i!=null&&g(e,["_query","pageToken"],i);const A=u(t,["filter"]);return e!==void 0&&A!=null&&g(e,["_query","filter"],A),r}function J6(t,e,n){const r={},a=u(t,["pageSize"]);e!==void 0&&a!=null&&g(e,["_query","pageSize"],a);const i=u(t,["pageToken"]);e!==void 0&&i!=null&&g(e,["_query","pageToken"],i);const A=u(t,["filter"]);return e!==void 0&&A!=null&&g(e,["_query","filter"],A),r}function W6(t,e){const n={},r=u(t,["config"]);return r!=null&&z6(r,n),n}function Y6(t,e){const n={},r=u(t,["config"]);return r!=null&&J6(r,n),n}function $6(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&g(n,["sdkHttpResponse"],r);const a=u(t,["nextPageToken"]);a!=null&&g(n,["nextPageToken"],a);const i=u(t,["tunedModels"]);if(i!=null){let A=i;Array.isArray(A)&&(A=A.map(o=>aw(o))),g(n,["tuningJobs"],A)}return n}function X6(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&g(n,["sdkHttpResponse"],r);const a=u(t,["nextPageToken"]);a!=null&&g(n,["nextPageToken"],a);const i=u(t,["tuningJobs"]);if(i!=null){let A=i;Array.isArray(A)&&(A=A.map(o=>Af(o))),g(n,["tuningJobs"],A)}return n}function Z6(t,e){const n={},r=u(t,["name"]);r!=null&&g(n,["model"],r);const a=u(t,["name"]);return a!=null&&g(n,["endpoint"],a),n}function eU(t,e){const n={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=u(t,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>i)),g(n,["examples","examples"],a)}return n}function tU(t,e,n){const r={};let a=u(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const A=u(t,["gcsUri"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],A)}else if(a==="PREFERENCE_TUNING"){const A=u(t,["gcsUri"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],A)}let i=u(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const A=u(t,["vertexDatasetResource"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],A)}else if(i==="PREFERENCE_TUNING"){const A=u(t,["vertexDatasetResource"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],A)}if(u(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function aw(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&g(n,["sdkHttpResponse"],r);const a=u(t,["name"]);a!=null&&g(n,["name"],a);const i=u(t,["state"]);i!=null&&g(n,["state"],Rx(i));const A=u(t,["createTime"]);A!=null&&g(n,["createTime"],A);const o=u(t,["tuningTask","startTime"]);o!=null&&g(n,["startTime"],o);const l=u(t,["tuningTask","completeTime"]);l!=null&&g(n,["endTime"],l);const c=u(t,["updateTime"]);c!=null&&g(n,["updateTime"],c);const d=u(t,["description"]);d!=null&&g(n,["description"],d);const h=u(t,["baseModel"]);h!=null&&g(n,["baseModel"],h);const p=u(t,["_self"]);return p!=null&&g(n,["tunedModel"],Z6(p)),n}function Af(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&g(n,["sdkHttpResponse"],r);const a=u(t,["name"]);a!=null&&g(n,["name"],a);const i=u(t,["state"]);i!=null&&g(n,["state"],Rx(i));const A=u(t,["createTime"]);A!=null&&g(n,["createTime"],A);const o=u(t,["startTime"]);o!=null&&g(n,["startTime"],o);const l=u(t,["endTime"]);l!=null&&g(n,["endTime"],l);const c=u(t,["updateTime"]);c!=null&&g(n,["updateTime"],c);const d=u(t,["error"]);d!=null&&g(n,["error"],d);const h=u(t,["description"]);h!=null&&g(n,["description"],h);const p=u(t,["baseModel"]);p!=null&&g(n,["baseModel"],p);const m=u(t,["tunedModel"]);m!=null&&g(n,["tunedModel"],m);const B=u(t,["preTunedModel"]);B!=null&&g(n,["preTunedModel"],B);const y=u(t,["supervisedTuningSpec"]);y!=null&&g(n,["supervisedTuningSpec"],y);const b=u(t,["preferenceOptimizationSpec"]);b!=null&&g(n,["preferenceOptimizationSpec"],b);const C=u(t,["tuningDataStats"]);C!=null&&g(n,["tuningDataStats"],C);const N=u(t,["encryptionSpec"]);N!=null&&g(n,["encryptionSpec"],N);const k=u(t,["partnerModelTuningSpec"]);k!=null&&g(n,["partnerModelTuningSpec"],k);const E=u(t,["customBaseModel"]);E!=null&&g(n,["customBaseModel"],E);const _=u(t,["experiment"]);_!=null&&g(n,["experiment"],_);const M=u(t,["labels"]);M!=null&&g(n,["labels"],M);const D=u(t,["outputUri"]);D!=null&&g(n,["outputUri"],D);const U=u(t,["pipelineJob"]);U!=null&&g(n,["pipelineJob"],U);const j=u(t,["serviceAccount"]);j!=null&&g(n,["serviceAccount"],j);const O=u(t,["tunedModelDisplayName"]);O!=null&&g(n,["tunedModelDisplayName"],O);const F=u(t,["veoTuningSpec"]);return F!=null&&g(n,["veoTuningSpec"],F),n}function nU(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&g(n,["sdkHttpResponse"],r);const a=u(t,["name"]);a!=null&&g(n,["name"],a);const i=u(t,["metadata"]);i!=null&&g(n,["metadata"],i);const A=u(t,["done"]);A!=null&&g(n,["done"],A);const o=u(t,["error"]);return o!=null&&g(n,["error"],o),n}function Bm(t,e){const n={},r=u(t,["gcsUri"]);r!=null&&g(n,["validationDatasetUri"],r);const a=u(t,["vertexDatasetResource"]);return a!=null&&g(n,["validationDatasetUri"],a),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rU extends ea{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new wi($s.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const a={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(a.checkpointId=n.config.preTunedModelCheckpointId);const i=Object.assign(Object.assign({},n),{preTunedModel:a});return i.baseModel=void 0,await this.tuneInternal(i)}else{const a=Object.assign({},n);return await this.tuneInternal(a)}else{const a=Object.assign({},n),i=await this.tuneMldevInternal(a);let A="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?A=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(A=i.name.split("/operations/")[0]),{name:A,state:Zu.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=q6(e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>Af(d))}else{const c=K6(e);return o=qe("{name}",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>aw(d))}}async listInternal(e){var n,r,a,i;let A,o="",l={};if(this.apiClient.isVertexAI()){const c=Y6(e);return o=qe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=X6(d),p=new nm;return Object.assign(p,h),p})}else{const c=W6(e);return o=qe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,A=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),A.then(d=>{const h=$6(d),p=new nm;return Object.assign(p,h),p})}}async cancel(e){var n,r,a,i;let A="",o={};if(this.apiClient.isVertexAI()){const l=R6(e);A=qe("{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=P6(e);A=qe("{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:A,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async tuneInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI()){const o=V6(e,e);return i=qe("tuningJobs",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>Af(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,i="",A={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=G6(e);return i=qe("tunedModels",o._url),A=o._query,delete o._url,delete o._query,a=this.apiClient.request({path:i,queryParams:A,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),a.then(l=>nU(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sU{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const aU=1024*1024*8,iU=3,AU=1e3,oU=2,_c="x-goog-upload-status";async function lU(t,e,n){var r;const a=await iw(t,e,n),i=await(a==null?void 0:a.json());if(((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[_c])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}async function cU(t,e,n){var r;const a=await iw(t,e,n),i=await(a==null?void 0:a.json());if(((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[_c])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const A=Qx(i),o=new Qf;return Object.assign(o,A),o}async function iw(t,e,n){var r,a;let i=0,A=0,o=new ef(new Response),l="upload";for(i=t.size;A<i;){const c=Math.min(aU,i-A),d=t.slice(A,A+c);A+c>=i&&(l+=", finalize");let h=0,p=AU;for(;h<iU&&(o=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(A),"Content-Length":String(c)}}}),!(!((r=o==null?void 0:o.headers)===null||r===void 0)&&r[_c]));)h++,await uU(p),p=p*oU;if(A+=c,((a=o==null?void 0:o.headers)===null||a===void 0?void 0:a[_c])!=="active")break;if(i<=A)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function dU(t){return{size:t.size,type:t.type}}function uU(t){return new Promise(e=>setTimeout(e,t))}class fU{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lU(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cU(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dU(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hU{create(e,n,r){return new gU(e,n,r)}}class gU{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cm="x-goog-api-key";class mU{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Cm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Cm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pU="gl-node/";class xU{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=JS(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new mU(this.apiKey);this.apiClient=new Tk({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:pU+"web",uploader:new fU,downloader:new sU}),this.models=new Xk(this.apiClient),this.live=new qk(this.apiClient,a,new hU),this.batches=new BI(this.apiClient),this.chats=new sF(this.models,this.apiClient),this.caches=new tF(this.apiClient),this.files=new hF(this.apiClient),this.operations=new Zk(this.apiClient),this.authTokens=new g6(this.apiClient),this.tunings=new rU(this.apiClient),this.fileSearchStores=new D6(this.apiClient)}}const wU=t=>s.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 016 0v8.25a3 3 0 01-3 3z"})});var yU={};const bU=(t,e)=>{const n=[];return t.forEach(r=>{if(!r.isActive||!r.admissionDate||!r.feeType)return;const a=new Set(e.filter(l=>l.studentId===r.id).map(l=>l.feeForMonth)),i=[],A=new Date(r.admissionDate),o=new Date;if(r.feeType==="Monthly"){let l=new Date(A.getFullYear(),A.getMonth(),1);for(;l<=o;){const c=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;a.has(c)||i.push(c),l.setMonth(l.getMonth()+1)}}i.length>0&&n.push({student:r,pendingMonths:i})}),n},vU={dashboard:"dashboard",attendance:"select-batch-attendance",fees:"fees-options",students:"student-options",batches:"batches",reports:"reports-options"};function BU({isOpen:t,onClose:e,onNavigate:n,students:r,feeCollections:a,batches:i,academyId:A}){const[o,l]=q.useState([]),[c,d]=q.useState(""),[h,p]=q.useState(!1),[m,B]=q.useState(!1),y=q.useRef(null),b=q.useRef(null);q.useEffect(()=>{t&&l([{role:"model",parts:[{text:"Hello! I'm your AI assistant. How can I help you manage your academy today?"}]}])},[t]),q.useEffect(()=>{var M;(M=b.current)==null||M.scrollTo({top:b.current.scrollHeight,behavior:"smooth"})},[o]),q.useEffect(()=>{const M=window.SpeechRecognition||window.webkitSpeechRecognition;if(!M){console.warn("Speech recognition not supported in this browser.");return}const D=new M;D.continuous=!1,D.interimResults=!1,D.lang="en-US",D.onresult=U=>{const j=U.results[0][0].transcript;k(j)},D.onerror=U=>{console.error("Speech recognition error:",U.error),U.error==="not-allowed"&&alert("Microphone access was denied. Please allow microphone access in your browser settings to use voice commands."),B(!1)},D.onend=()=>{B(!1)},y.current=D},[]);const C=new xU({apiKey:yU.API_KEY}),N={functionDeclarations:[{name:"navigateTo",description:"Navigate to a specific page in the application.",parameters:{type:Xr.OBJECT,properties:{page:{type:Xr.STRING,description:"The destination page. Can be one of: dashboard, attendance, fees, students, batches, reports."}},required:["page"]}},{name:"getFeeDuesCount",description:"Get the total number of students who have not paid their fees.",parameters:{type:Xr.OBJECT,properties:{}}},{name:"checkScheduledClasses",description:"Check if any classes are scheduled for today and for which batches.",parameters:{type:Xr.OBJECT,properties:{}}}]},k=async M=>{if(!M.trim()||h)return;const D={role:"user",parts:[{text:M}]};l(U=>[...U,D]),d(""),p(!0);try{const U=[...o,D],j=await C.models.generateContent({model:"gemini-2.5-flash",contents:{role:"user",parts:[{text:M}]},config:{tools:[N]},history:U.slice(0,-1)});if(j.functionCalls&&j.functionCalls.length>0){const O=j.functionCalls[0];let F;if(O.name==="navigateTo"){const P=O.args.page,V=vU[P.toLowerCase()];V?(n(V),F={success:!0,message:`Navigating to ${P}.`}):F={success:!1,message:`Sorry, I can't navigate to a page called ${P}.`}}else if(O.name==="getFeeDuesCount")F={count:bU(r,a).length};else if(O.name==="checkScheduledClasses"){const P=new Date().toISOString().split("T")[0],V=Xe(Te,`academies/${A}/schedules`,P),ee=await Sn(V);ee.exists()?F={scheduled:!0,batches:Object.keys(ee.data()).map(ae=>{var de;return(de=i.find(ue=>ue.id===ae))==null?void 0:de.name}).filter(Boolean)}:F={scheduled:!1}}const I=await C.models.generateContent({model:"gemini-2.5-flash",contents:{role:"user",parts:[{functionResponse:{name:O.name,response:F}}]},history:[...U,{role:"model",parts:[{functionCall:O}]}]});l(P=>[...P,I])}else l(O=>[...O,{role:"model",parts:[{text:j.text}]}])}catch(U){console.error("AI Error:",U),l(j=>[...j,{role:"model",parts:[{text:"Sorry, I encountered an error. Please try again."}]}])}finally{p(!1)}},E=M=>{M.preventDefault(),k(c)},_=()=>{var M,D;h||(m?(M=y.current)==null||M.stop():(d(""),(D=y.current)==null||D.start()),B(!m))};return t?s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex flex-col z-40 animate-fade-in",children:[s.jsxs("header",{className:"bg-indigo-700 text-white p-3 flex items-center justify-between shadow-md flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Gm,{className:"w-7 h-7"}),s.jsx("h1",{className:"text-xl font-bold",children:"AI Assistant"})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-indigo-800 transition-colors","aria-label":"Close chatbot",children:s.jsx(In,{className:"w-6 h-6"})})]}),s.jsx("main",{ref:b,className:"flex-grow p-4 overflow-y-auto bg-gray-100 dark:bg-gray-900",children:s.jsxs("div",{className:"space-y-4",children:[o.map((M,D)=>s.jsx("div",{className:`flex ${M.role==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-xs md:max-w-md lg:max-w-lg px-4 py-3 rounded-2xl ${M.role==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-bl-none"}`,children:M.parts.map((U,j)=>"text"in U&&s.jsx("p",{children:U.text},j))})},D)),h&&s.jsx("div",{className:"flex justify-start",children:s.jsx("div",{className:"max-w-xs px-4 py-3 rounded-2xl bg-white dark:bg-gray-700 rounded-bl-none",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"h-2 w-2 bg-indigo-500 rounded-full animate-bounce [animation-delay:-0.3s]"}),s.jsx("span",{className:"h-2 w-2 bg-indigo-500 rounded-full animate-bounce [animation-delay:-0.15s]"}),s.jsx("span",{className:"h-2 w-2 bg-indigo-500 rounded-full animate-bounce"})]})})})]})}),s.jsx("footer",{className:"p-4 bg-white dark:bg-gray-800 border-t dark:border-gray-700 flex-shrink-0",children:s.jsxs("form",{onSubmit:E,className:"flex items-center gap-3",children:[s.jsx("input",{type:"text",value:c,onChange:M=>d(M.target.value),placeholder:m?"Listening...":"Type or press mic to talk...",className:"w-full p-3 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",disabled:h||m}),y.current&&s.jsx("button",{type:"button",onClick:_,disabled:h,className:`p-3 rounded-lg transition-colors ${m?"bg-red-500 text-white animate-pulse":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200"}`,"aria-label":m?"Stop listening":"Start listening",children:s.jsx(wU,{className:"w-6 h-6"})}),s.jsx("button",{type:"submit",disabled:h||!c.trim(),className:"p-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300",children:s.jsx(R1,{className:"w-6 h-6"})})]})})]}):null}const oc=Fm.apiKey.includes("placeholder"),CU=({featureName:t,onClose:e})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 animate-fade-in p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg max-w-sm mx-auto text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 dark:bg-yellow-900/40 mb-5",children:s.jsx(ES,{className:"h-9 w-9 text-yellow-600 dark:text-yellow-400"})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Feature Under Development"}),s.jsxs("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6",children:['The "',t,'" feature is not yet implemented. Please check back later!']}),s.jsx("button",{onClick:e,className:"w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:"Got it"})]})}),Nm=async(t,e,n,r)=>{const a=ui(Bn(Te,"academies"),fi("academyId","==",n));if(!(await Qa(a)).empty)throw new Error(`Academy ID "${n}" is already taken. Please go back and choose another one.`);const A=Xe(Bn(Te,"academies")),o={name:e,adminEmail:t.email,adminUid:t.uid,adminName:r,createdAt:Lt.now(),status:"active",academyId:n,subscriptionStatus:"trialing",trialEndsAt:Lt.fromMillis(Date.now()+7*24*60*60*1e3)},l=Xe(Te,"users",t.uid),c={academyId:A.id,role:"admin"};try{const d=pr(Te);if(d.set(A,o),d.set(l,c),await d.commit(),!(await Sn(A)).exists())throw new Error("Failed to verify academy creation in database.");return{id:A.id,...o}}catch(d){throw console.error("Academy and user mapping creation failed:",d),d}};function NU(){var qa;const[t,e]=q.useState(()=>localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),[n,r]=q.useState("role-selection"),[a,i]=q.useState("academy"),[A,o]=q.useState({}),[l,c]=q.useState(null),[d,h]=q.useState(!0),[p,m]=q.useState(!1),[B,y]=q.useState(null),[b,C]=q.useState(null),[N,k]=q.useState([]),[E,_]=q.useState([]),[M,D]=q.useState([]),[U,j]=q.useState([]),[O,F]=q.useState([]),[I,P]=q.useState([]),[V,ee]=q.useState([]),[X,le]=q.useState([]),[ae,de]=q.useState([]),[ue,Ce]=q.useState([]),[Q,z]=q.useState([]),[W,Z]=q.useState([]),[ne,fe]=q.useState([]),[xe,we]=q.useState([]),[Qe,je]=q.useState([]),[Me,De]=q.useState([]),[st,ve]=q.useState({}),[$,At]=q.useState("loading"),[et,Ue]=q.useState(null),[Le,He]=q.useState(null),[Oe,tt]=q.useState(null),[ut,mt]=q.useState(null),[wt,Bt]=q.useState(null),[kt,ot]=q.useState(null),[yt,Ke]=q.useState(null),[An,Ct]=q.useState(null),[yr,jt]=q.useState("all"),[Ot,_r]=q.useState(null),[St,br]=q.useState(null),[Wt,or]=q.useState(!navigator.onLine),[es,Yt]=q.useState(!localStorage.getItem("dataConsentAccepted")),[dt,ft]=q.useState(null),[ms,on]=q.useState(null),[vr,lr]=q.useState(!1);q.useEffect(()=>{(async()=>{CA.isNativePlatform()&&(await l1.setStyle({style:fu.Light}),await o1.hide())})()},[]),q.useEffect(()=>{window.scrollTo(0,0)},[n]);const Ee=(l==null?void 0:l.role)==="admin"&&l.data.id==="demo-academy-id"||((l==null?void 0:l.role)==="student"||(l==null?void 0:l.role)==="staff")&&l.academyId==="DEMO";q.useEffect(()=>{t==="dark"?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[t]);const Vn=()=>{e(oe=>oe==="light"?"dark":"light")},Fn=(oe,ie)=>{o(ie||{}),r(oe)};q.useEffect(()=>{const oe=()=>or(!1),ie=()=>or(!0);return window.addEventListener("online",oe),window.addEventListener("offline",ie),()=>{window.removeEventListener("online",oe),window.removeEventListener("offline",ie)}},[]);const Ln=oe=>{C(oe),c({role:"admin",data:oe}),r("dashboard")};q.useEffect(()=>{if(oc){h(!1),r("login");return}const oe=Cn.onAuthStateChanged(async ie=>{try{if(ie){if(ie.isAnonymous)return;const ge=Xe(Te,"users",ie.uid),_e=await Sn(ge);if(_e.exists()){const Re=_e.data();if(Re.role==="admin"&&Re.academyId){const Ye=Xe(Te,"academies",Re.academyId),rt=await Sn(Ye);if(rt.exists()){const Pt={id:rt.id,...rt.data()};C(Pt),c({role:"admin",data:Pt}),r("dashboard")}else y("Your academy data is missing. Please re-enter your institute's name to restore your account."),r("complete-registration")}else y("Your account is not configured as an admin account."),await Cn.signOut()}else{const Re=sessionStorage.getItem("google_reg_institute_name")||sessionStorage.getItem("registration_institute_name"),Ye=sessionStorage.getItem("google_reg_academy_id")||sessionStorage.getItem("registration_academy_id"),rt=sessionStorage.getItem("google_reg_admin_name")||sessionStorage.getItem("registration_admin_name");if(Re&&Ye&&rt)try{const Pt=await Nm(ie,Re,Ye,rt);alert(`Registration successful! Your Academy ID is ${Pt.academyId}. Please save it for your students and staff to log in.`),Ln(Pt)}catch(Pt){console.error("Error creating academy:",Pt),y(Pt.message||"Failed to create your academy account. This can happen due to permission issues or a duplicate Academy ID. Please check your Firestore security rules and try again."),await Cn.signOut()}finally{sessionStorage.removeItem("google_reg_flow"),sessionStorage.removeItem("google_reg_institute_name"),sessionStorage.removeItem("google_reg_academy_id"),sessionStorage.removeItem("google_reg_admin_name"),sessionStorage.removeItem("registration_institute_name"),sessionStorage.removeItem("registration_academy_id"),sessionStorage.removeItem("registration_admin_name")}else y("Your registration is incomplete. Please enter your institute name to continue."),r("complete-registration")}}else{c(null),C(null);const ge=localStorage.getItem("lastSelectedRole");ge?(i(ge),r("login")):r("role-selection")}}catch(ge){console.error("Critical error in auth state handler:",ge),y("A critical error occurred. Please refresh and try again."),Cn.currentUser&&await Cn.signOut().catch(_e=>console.error("Signout failed during error handling:",_e)),c(null),C(null),r("login")}finally{h(!1)}},ie=>{console.error("Auth state listener error:",ie),br("Authentication service is unavailable. Please check your connection."),h(!1)});return()=>oe()},[]),q.useEffect(()=>{if(!l||oc||Ee){Ee&&(C({id:"demo-academy-id",academyId:"DEMO",name:"Demo Academy",adminUid:"demo-admin-uid",adminEmail:"demo@classcaptain.com",status:"active",subscriptionStatus:"active"}),_(Em),k(c1),D(km),j(d1),F([]),P(u1),ee([]),le(f1),de([]),Ce([]),z([]),fe([]),we([]),je([]),De(h1));return}const oe=l.role==="admin"?l.data.id:l.academyId;if(!oe)return;const ie=[];if(l.role!=="admin"){const Re=Xe(Te,"academies",oe),Ye=si(Re,rt=>{rt.exists()&&C({id:rt.id,...rt.data()})},rt=>{console.error("Error fetching academy details:",rt),br("Failed to connect to the database. Some information may be missing.")});ie.push(Ye)}const ge=["batches","students","staff","fees","transactions","exams","enquiries","studyMaterial","homework","quizzes","leaveRequests","tasks","notices","transportRoutes","staffAttendance"],_e={batches:k,students:_,staff:D,fees:F,transactions:P,exams:ee,enquiries:le,studyMaterial:de,homework:Ce,quizzes:z,leaveRequests:fe,tasks:we,notices:je,transportRoutes:De,staffAttendance:j};if(ge.forEach(Re=>{if(Re==="staff"&&l.role!=="admin")return;const Ye=Bn(Te,`academies/${oe}/${Re}`),rt=si(Ye,Pt=>{const ys=Pt.docs.map(bs=>({id:bs.id,...bs.data()}));_e[Re](ys),br(null)},Pt=>{console.error(`Error fetching ${Re}:`,Pt),br("Failed to connect to the database. Some information may be missing or outdated.")});ie.push(rt)}),l.role==="admin"&&b&&n==="quiz-results"&&An){const Re=Bn(Te,`academies/${b.id}/quizzes/${An}/submissions`),Ye=si(Re,rt=>{const Pt=rt.docs.map(ys=>({id:ys.id,...ys.data()}));Z(Pt)},rt=>console.error("Error fetching quiz submissions:",rt));ie.push(Ye)}else Z([]);return()=>ie.forEach(Re=>Re())},[l,Ee,n,An]),q.useEffect(()=>{if((l==null?void 0:l.role)!=="admin"||!b||Ee){ve({});return}const oe=new Date().toISOString().split("T")[0],ie=N.filter(_e=>_e.isActive&&_e.currentStudents>0);if(ie.length===0){ve({});return}const ge=[];return ie.forEach(_e=>{const Re=Xe(Te,`academies/${b.id}/batches/${_e.id}/attendance`,oe),Ye=si(Re,rt=>{ve(Pt=>({...Pt,[_e.id]:rt.exists()?rt.data():null}))},rt=>{console.error(`Error fetching attendance for batch ${_e.id}:`,rt)});ge.push(Ye)}),()=>{ge.forEach(_e=>_e())}},[l,b,N,Ee]),q.useEffect(()=>{if((l==null?void 0:l.role)!=="admin"||!b||Ee){At(null);return}At("loading");const oe=new Date().toISOString().split("T")[0],ie=Xe(Te,`academies/${b.id}/schedules`,oe),ge=si(ie,_e=>{_e.exists()?At(_e.data()):At(null)},_e=>{console.error("Error fetching today's schedule for notifications:",_e),At(null)});return()=>ge()},[l,b,Ee]),q.useEffect(()=>{if(oc||!b||(l==null?void 0:l.role)!=="admin"||Ee)return;(async()=>{const ie=Lt.now();let ge=!1,_e=b.subscriptionStatus;if((b.subscriptionStatus==="trialing"&&b.trialEndsAt&&b.trialEndsAt<ie||b.subscriptionStatus==="active"&&b.subscriptionEndsAt&&b.subscriptionEndsAt<ie)&&(_e="expired",ge=!0),ge)try{const Re=Xe(Te,"academies",b.id);await qr(Re,{subscriptionStatus:_e})}catch(Re){console.error("Error updating subscription status:",Re)}})()},[b,l,Ee]);const en=q.useMemo(()=>X.filter(oe=>oe.status==="New"),[X]),$t=q.useMemo(()=>ne.filter(oe=>oe.status==="Pending"),[ne]),_n=q.useMemo(()=>(l==null?void 0:l.role)!=="admin"||Ee?[]:N.filter(ie=>ie.isActive&&ie.currentStudents>0).filter(ie=>st[ie.id]===null),[l,N,st,Ee]),ps=q.useMemo(()=>(l==null?void 0:l.role)!=="admin"||Ee||$==="loading"?[]:N.filter(ge=>ge.isActive).length===0?[]:!$||Object.keys($).length===0?[{type:"schedule",data:{message:"No classes have been scheduled for today."},time:new Date}]:[],[l,$,N,Ee]),Br=q.useMemo(()=>{if((l==null?void 0:l.role)!=="staff")return[];const oe=l.data,ie=Object.keys(oe.batchAccess||{}).filter(Re=>{var Ye;return(Ye=oe.batchAccess[Re])==null?void 0:Ye.leaveRequests}),ge=new Set(N.filter(Re=>ie.includes(Re.id)).map(Re=>Re.name)),_e=new Set(E.filter(Re=>Re.batches.some(Ye=>ge.has(Ye))).map(Re=>Re.id));return ne.filter(Re=>Re.status==="Pending"&&Re.userRole==="student"&&_e.has(Re.userId))},[l,ne,N,E]),cr=q.useMemo(()=>(l==null?void 0:l.role)==="admin"?en.length+$t.length+_n.length+ps.length:(l==null?void 0:l.role)==="staff"?Br.length:0,[l,en,$t,Br,_n,ps]),dr=oe=>{y(null),c(oe),oe.role==="admin"&&C(oe.data),r("dashboard")},mn=async()=>{if(m(!1),!Ee)try{await Cn.signOut()}catch(oe){console.error("Logout Error:",oe)}c(null),C(null),localStorage.removeItem("lastSelectedRole"),r("role-selection")},Mr=async oe=>{if(!Cn.currentUser){y("Your session has expired. Please try logging in again."),r("login");return}const ie=oe.replace(/[^a-zA-Z0-9]/g,"").toUpperCase().substring(0,8);let ge=ie,_e=!1,Re=0;for(;!_e&&Re<10;){const Ye=ui(Bn(Te,"academies"),fi("academyId","==",ge));(await Qa(Ye)).empty?_e=!0:(Re++,ge=`${ie}${Re}`)}if(!_e){y("Could not generate a unique Academy ID. Please try another institute name.");return}try{const Ye=await Nm(Cn.currentUser,oe,ge,Cn.currentUser.displayName||"Admin");alert(`Registration complete! Your Academy ID is ${Ye.academyId}.`),Ln(Ye)}catch(Ye){console.error("Error completing registration:",Ye),y(Ye.message||"Failed to complete your registration.")}},qt=(oe,ie)=>async(ge,_e)=>{if(!b||Ee)throw alert("Cannot save data in demo mode."),new Error("Demo mode: cannot save data.");const Re={};for(const rt in ge)Object.prototype.hasOwnProperty.call(ge,rt)&&ge[rt]!==void 0&&(Re[rt]=ge[rt]);const Ye=Bn(Te,`academies/${b.id}/${oe}`);try{_e?await qr(Xe(Ye,_e),Re):await fh(Ye,Re),ie&&r(ie)}catch(rt){throw console.error(`Error saving ${oe}:`,rt),alert(`Failed to save ${oe}.`),rt}},ur=oe=>async ie=>{if(!b||Ee){alert("Cannot delete data in demo mode.");return}if(window.confirm(`Are you sure you want to delete this ${oe.slice(0,-1)}?`))try{await hh(Xe(Te,`academies/${b.id}/${oe}`,ie))}catch(ge){console.error(`Error deleting ${oe}:`,ge),alert(`Failed to delete ${oe}.`)}},xs=async(oe,ie)=>{if(!b||Ee)throw new Error("Cannot save batch.");const ge={...oe,isActive:oe.isActive??!0};try{ie?await qr(Xe(Te,`academies/${b.id}/batches`,ie),ge):await fh(Bn(Te,`academies/${b.id}/batches`),{...ge,currentStudents:0}),r("batches")}catch(_e){throw console.error("Error saving batch:",_e),alert("Failed to save batch."),_e}},na=async(oe,ie)=>{if(!b||Ee)throw new Error("Cannot save student.");const ge={...oe,isActive:!0};try{const _e=pr(Te),Re=Xe(Bn(Te,`academies/${b.id}/students`));return _e.set(Re,ge),N.filter(rt=>oe.batches.includes(rt.name)).forEach(rt=>{_e.update(Xe(Te,`academies/${b.id}/batches`,rt.id),{currentStudents:gh(1)})}),ie&&_e.update(Xe(Te,`academies/${b.id}/enquiries`,ie),{status:"Converted"}),await _e.commit(),{id:Re.id,...ge}}catch(_e){throw console.error("Error saving student:",_e),alert("Failed to save student."),_e}},ra=async oe=>{if(!(!b||Ee||!Le))try{await qr(Xe(Te,`academies/${b.id}/students`,Le),oe),r("active-students")}catch(ie){console.error("Error updating student:",ie),alert("Failed to update student.")}},Ls=async oe=>{if(!b||Ee)return;const ie=E.find(ge=>ge.id===oe);if(ie)try{const ge=pr(Te),_e=Xe(Te,`academies/${b.id}/students`,oe);ge.update(_e,{isActive:!ie.isActive});const Re=ie.isActive?-1:1;N.filter(rt=>ie.batches.includes(rt.name)).forEach(rt=>{ge.update(Xe(Te,`academies/${b.id}/batches`,rt.id),{currentStudents:gh(Re)})}),await ge.commit()}catch(ge){console.error("Error toggling student status:",ge)}},_s=async oe=>{if(!b||Ee)throw{code:"demo-mode",message:"Cannot save payments in demo mode."};try{const ie=pr(Te),ge=Xe(Bn(Te,`academies/${b.id}/fees`)),_e=Xe(Bn(Te,`academies/${b.id}/transactions`)),Re={...oe,paymentDate:Lt.fromDate(new Date(oe.paymentDate)),createdAt:Jr(),transactionId:_e.id};ie.set(ge,Re);const Ye={type:"Income",category:"Tuition Fees",amount:oe.amountPaid,paymentMethod:oe.paymentMode,description:`Fee from ${oe.studentName} (${oe.studentRollNumber}) for ${oe.feeForMonth}`,date:Re.paymentDate,createdAt:Re.createdAt,feeCollectionId:ge.id};ie.set(_e,Ye),await ie.commit()}catch(ie){throw console.error("Error saving fee payment:",ie),ie}},yi=async oe=>{if(!b||Ee)return;const ie=O.find(ge=>ge.id===oe);if(ie)try{const ge=pr(Te);ge.delete(Xe(Te,`academies/${b.id}/fees`,oe)),ie.transactionId&&ge.delete(Xe(Te,`academies/${b.id}/transactions`,ie.transactionId)),await ge.commit()}catch(ge){throw console.error("Error deleting fee collection:",ge),ge}},LA=async(oe,ie)=>{if(!b||Ee)return;const ge=O.find(Ye=>Ye.id===oe);if(!ge)return;const _e=ge.totalAmount-ie.discount,Re={...ie,paymentDate:Lt.fromDate(new Date(ie.paymentDate)),amountPaid:_e};try{const Ye=pr(Te);Ye.update(Xe(Te,`academies/${b.id}/fees`,oe),Re),ge.transactionId&&Ye.update(Xe(Te,`academies/${b.id}/transactions`,ge.transactionId),{amount:_e,paymentMethod:ie.paymentMode,date:Re.paymentDate,description:`Fee from ${ge.studentName} (${ge.studentRollNumber}) for ${ge.feeForMonth} (updated)`}),await Ye.commit()}catch(Ye){throw console.error("Error updating fee:",Ye),Ye}},_A=async oe=>{await qt("staff","staff-options")(oe)},Ms=async oe=>{if(!b||Ee)return;const ie=M.find(ge=>ge.id===oe);if(ie)try{await qr(Xe(Te,`academies/${b.id}/staff`,oe),{isActive:!ie.isActive})}catch(ge){console.error("Error toggling staff status:",ge)}},bi=async(oe,ie)=>{if(!(!b||Ee))try{await qr(Xe(Te,`academies/${b.id}/staff`,oe),{batchAccess:ie}),r("staff-manager")}catch(ge){console.error("Error saving batch access:",ge),alert("Failed to save permissions.")}},vi=async oe=>{if(!(!b||Ee))try{await qr(Xe(Te,"academies",b.id),oe)}catch(ie){throw console.error("Error saving academy details:",ie),alert("Failed to save details."),ie}},Pa=async(oe,ie,ge)=>{if(!b||Ee)throw new Error("Cannot save.");try{const _e=Xe(Te,`academies/${b.id}/schedules`,oe);await hA(_e,{[ie]:ge},{merge:!0})}catch(_e){throw console.error("Error saving schedule:",_e),new Error("Failed to save schedule.")}},Bi=async(oe,ie,ge)=>{if(!b||Ee)throw new Error("Cannot subscribe in demo mode.");try{const _e=new Date,Re=new Date(_e.getFullYear(),_e.getMonth()+ie,_e.getDate()),Ye=pr(Te),rt=Xe(Te,"academies",b.id);Ye.update(rt,{plan:oe,subscriptionStatus:"active",subscriptionEndsAt:Lt.fromDate(Re),trialEndsAt:iA()});const Pt=Xe(Bn(Te,`academies/${b.id}/transactions`)),ys={type:"Income",category:"Subscription",amount:ge.amount/100,paymentMethod:"Card",description:`Subscription payment for ${oe} plan. Payment ID: ${ge.paymentId}`,date:Lt.now(),createdAt:Jr()};Ye.set(Pt,ys),await Ye.commit(),alert("Subscription updated successfully!")}catch(_e){throw console.error("Subscription update failed:",_e),_e}},Ra=qt("transactions"),MA=async(oe,ie)=>await Ra(ie,oe),sa=async oe=>{if(!b||Ee)throw new Error("Cannot delete data in demo mode.");const ie=I.find(ge=>ge.id===oe);if(!ie)throw new Error("Could not find the transaction to delete.");try{const ge=pr(Te),_e=Xe(Te,`academies/${b.id}/transactions`,oe);if(ge.delete(_e),ie.feeCollectionId){const Re=Xe(Te,`academies/${b.id}/fees`,ie.feeCollectionId);ge.delete(Re)}await ge.commit()}catch(ge){throw console.error("Error deleting transaction:",ge),new Error("Failed to delete transaction.")}},DA=async oe=>{const ie=A.examId;await qt("exams","manage-exams")(oe,ie)},Xt=async(oe,ie)=>{if(!(!b||Ee))try{await qr(Xe(Te,`academies/${b.id}/exams`,oe),{resultStatus:ie})}catch(ge){throw console.error("Failed to update exam status:",ge),alert("Failed to update status."),ge}},Ha=async oe=>{const{enquiryId:ie,data:ge}=oe;await qt("enquiries","enquiry-manager")(ge||oe,ie)},Ci=ur("enquiries"),Ni=async oe=>{const ie=A.studyMaterialId;await qt("studyMaterial","study-material")(oe,ie)},Oa=async oe=>{if(!(!b||Ee)&&window.confirm(`Delete "${oe.title}"?`))try{const ie=pr(Te);if(ie.delete(Xe(Te,`academies/${b.id}/studyMaterial`,oe.id)),oe.storagePath){const ge=Ea(ka,oe.storagePath);await Qd(ge)}await ie.commit()}catch(ie){console.error("Error deleting material:",ie),alert("Failed to delete material.")}},PA=async oe=>{const ie=A.homeworkId;await qt("homework","homework")(oe,ie)},Cr=async oe=>{if(!(!b||Ee)&&window.confirm(`Delete "${oe.title}"?`))try{const ie=pr(Te);if(ie.delete(Xe(Te,`academies/${b.id}/homework`,oe.id)),oe.storagePath){const ge=Ea(ka,oe.storagePath);await Qd(ge)}await ie.commit()}catch(ie){console.error("Error deleting homework:",ie),alert("Failed to delete homework.")}},aa=async oe=>{const ie=A.quizId;await qt("quizzes","manage-quizzes")(oe,ie)},Kn=async oe=>{await ur("quizzes")(oe)},Ga=async(oe,ie)=>{if(!b||Ee)return;const ge=(l==null?void 0:l.role)==="admin"?b.adminName:l==null?void 0:l.data.name;try{await qr(Xe(Te,`academies/${b.id}/leaveRequests`,oe),{status:ie,reviewedBy:ge||"Admin",reviewedAt:Jr()})}catch{alert("Failed to update status.")}},Si=async(oe,ie)=>{const ge={...oe,dueDate:Lt.fromDate(new Date(oe.dueDate)),createdAt:ie?void 0:Jr(),status:"Pending"};ie||delete ge.id,await qt("tasks")(ge,ie)},RA=async(oe,ie)=>{await qt("tasks")({status:ie==="Pending"?"Completed":"Pending"},oe)},Ii=async oe=>{if(!b||Ee){alert("Cannot delete data in demo mode.");return}if(window.confirm("Are you sure you want to delete this task?"))try{await hh(Xe(Te,`academies/${b.id}/tasks`,oe))}catch(ie){console.error("Error deleting task:",ie),alert("Failed to delete task.")}},HA=async(oe,ie)=>{const ge={...oe,expiryDate:Lt.fromDate(new Date(oe.expiryDate)),createdAt:ie?void 0:Jr()};await qt("notices")(ge,ie)},Fi=async oe=>{if(!(!b||Ee)&&window.confirm(`Delete "${oe.title}"?`))try{const ie=pr(Te);if(ie.delete(Xe(Te,`academies/${b.id}/notices`,oe.id)),oe.storagePath){const ge=Ea(ka,oe.storagePath);await Qd(ge)}await ie.commit()}catch(ie){console.error("Error deleting notice:",ie),alert("Failed to delete notice.")}},Ei=async(oe,ie)=>{await qt("transportRoutes","transport-options")(oe,ie)},Va=async oe=>{if(!(!b||Ee))try{const ie=pr(Te);ie.delete(Xe(Te,`academies/${b.id}/transportRoutes`,oe)),E.filter(_e=>_e.transportRouteId===oe).forEach(_e=>{ie.update(Xe(Te,`academies/${b.id}/students`,_e.id),{transport:"NO_TRANSPORT_USE",transportRouteId:iA(),transportFee:iA()})}),await ie.commit()}catch(ie){throw console.error("Error deleting route:",ie),ie}},OA=async(oe,ie,ge)=>{if(!b||Ee)return;const _e=Me.find(Re=>Re.id===oe);if(_e)try{const Re=pr(Te);ie.forEach(Ye=>{Re.update(Xe(Te,`academies/${b.id}/students`,Ye),{transport:"USE_TRANSPORT",transportRouteId:oe,transportFee:_e.monthlyFee})}),ge.forEach(Ye=>{Re.update(Xe(Te,`academies/${b.id}/students`,Ye),{transport:"NO_TRANSPORT_USE",transportRouteId:iA(),transportFee:iA()})}),await Re.commit(),r("transport-options")}catch(Re){console.error("Error mapping students:",Re),alert("Failed to update student assignments.")}},GA=async(oe,ie)=>{if(!l||l.role!=="student"||!b)throw new Error("Invalid session");const ge=Q.find(Ye=>Ye.id===oe);if(!ge)throw new Error("Quiz not found");let _e=0;ge.questions.forEach(Ye=>{ie[Ye.id]===Ye.correctAnswerIndex&&(_e+=ge.totalMarks/ge.questions.length)});const Re={studentId:l.data.id,studentName:l.data.name,studentRollNumber:l.data.rollNumber,answers:ie,score:_e,totalMarks:ge.totalMarks,submittedAt:Jr()};await hA(Xe(Te,`academies/${b.id}/quizzes/${ge.id}/submissions`,l.data.id),Re)},VA=async(oe,ie)=>{if(!b||Ee)throw new Error("Cannot save data in demo mode.");let ge=0;if(oe.startTime&&oe.endTime){const Ye=new Date(`1970-01-01T${oe.startTime}`),rt=new Date(`1970-01-01T${oe.endTime}`);rt>Ye&&(ge=(rt.getTime()-Ye.getTime())/6e4)}const _e={...oe,durationMinutes:ge},Re=Bn(Te,`academies/${b.id}/staffAttendance`);try{if(ie)await qr(Xe(Re,ie),_e);else{const Ye=Xe(Re);return await hA(Ye,_e),Ye.id}}catch(Ye){throw console.error("Error saving staff attendance:",Ye),alert("Failed to save staff attendance."),Ye}},ts=ur("staffAttendance");if(oc)return s.jsxs("div",{className:"min-h-screen flex flex-col",children:[s.jsx(nN,{}),s.jsx(vh,{onLogin:dr,onNavigateToRegister:()=>r("register"),externalError:B,clearExternalError:()=>y(null),initialRole:"academy",onGoBack:()=>{}})]});if(d)return s.jsx(g1,{});if(!l)switch(n){case"role-selection":return s.jsx(B1,{onSelectRole:oe=>{localStorage.setItem("lastSelectedRole",oe),i(oe),r("login")},onBack:()=>{window.history.length>1&&window.history.back()}});case"register":return s.jsx(j1,{onNavigateToLogin:()=>r("login")});case"complete-registration":return s.jsx(T1,{onComplete:Mr,onLogout:mn,userEmail:((qa=Cn.currentUser)==null?void 0:qa.email)||"",externalError:B,clearExternalError:()=>y(null)});default:return s.jsx(vh,{onLogin:dr,onNavigateToRegister:()=>r("register"),externalError:B,clearExternalError:()=>y(null),initialRole:a,onGoBack:()=>{localStorage.removeItem("lastSelectedRole"),r("role-selection")}})}if(l.role==="admin"&&(b==null?void 0:b.subscriptionStatus)==="expired")return s.jsx(NN,{onNavigate:r,onLogout:mn,academy:b,onSubscribe:Bi});const nn=(oe,ie)=>ie?oe.find(ge=>ge.id===ie):void 0,Nr=nn(N,et),Sr=nn(E,Le),bn=nn(M,Oe),ki=nn(V,ut),Ka=nn(X,wt)||A.enquiryId&&nn(X,A.enquiryId),ct=nn(ue,yt),ws=nn(Q,An),ia=nn(Me,Ot);nn(ae,kt);const Dr=()=>{const oe=l.role==="student"?l.data:null;switch(n){case"dashboard":return l.role==="admin"?s.jsx(Bh,{onNavigate:r,academy:b,students:E,batches:N,staff:M,transactions:I,onShowDevPopup:ft}):l.role==="student"?s.jsx(Wg,{student:l.data,academy:b,feeCollections:O,batches:N,onNavigate:r,onToggleNav:()=>m(!0),theme:t,onToggleTheme:Vn,onShowDevPopup:ft}):l.role==="staff"?s.jsx($g,{onNavigate:r,academy:b,staff:l.data,onShowDevPopup:ft}):null;case"batches":return s.jsx(q1,{onBack:()=>r("dashboard"),onCreate:()=>r("new-batch"),batches:N,onViewStudents:ie=>{jt(ie),r("active-students")},onEditBatch:ie=>{Ue(ie),r("edit-batch")}});case"new-batch":return s.jsx(J1,{onBack:()=>r("batches"),onSave:xs});case"edit-batch":return Nr&&s.jsx(hN,{onBack:()=>r("batches"),onSave:(ie,ge)=>xs(ge,ie),batch:Nr});case"student-options":return s.jsx($1,{onBack:()=>r("dashboard"),onNavigate:r,onShowDevPopup:ft});case"new-student":return s.jsx(Z1,{onBack:()=>r(Ka?"enquiry-manager":"student-options"),onSave:na,batches:N,academyId:(b==null?void 0:b.academyId)||"DEMO",enquiryData:Ka,students:E});case"active-students":return s.jsx(uy,{onBack:()=>r("student-options"),students:E,batches:N,onToggleStudentStatus:Ls,onEditStudent:ie=>{He(ie),r("edit-student")},onViewStudent:ie=>{He(ie),r("student-details")},initialFilter:yr,staffPermissions:l.role==="staff"?l.data.batchAccess:void 0});case"edit-student":return Sr&&s.jsx(oN,{onBack:()=>r("active-students"),onUpdate:ra,student:Sr,batches:N});case"inactive-students":return s.jsx(dN,{onBack:()=>r("student-options"),students:E,batches:N,onToggleStudentStatus:Ls});case"birthday-list":return s.jsx(fy,{onBack:()=>r("student-options"),students:E});case"registration-form-list":return s.jsx(hy,{onBack:()=>r("student-options"),students:E,onSelectStudent:ie=>{He(ie),r("registration-form-view")}});case"registration-form-view":return Sr&&b&&s.jsx(PC,{onBack:()=>r("registration-form-list"),student:Sr,transportRoutes:Me,academy:b});case"select-batch-attendance":return s.jsx(ny,{onBack:()=>r("dashboard"),batches:N,onSelectBatch:ie=>{Ue(ie),r("take-attendance")},academyId:b.id,staffPermissions:l.role==="staff"?l.data.batchAccess:void 0});case"take-attendance":return Nr&&s.jsx(ly,{onBack:()=>r("select-batch-attendance"),batch:Nr,students:E,academy:b,isDemoMode:Ee,onShowImage:on});case"fees-options":return s.jsx(OC,{onBack:()=>r("dashboard"),onNavigate:r});case"select-batch-for-fees":return s.jsx(VC,{onBack:()=>r("fees-options"),batches:N,onSelectBatch:ie=>{Ue(ie),r("select-student-for-fees")},staffPermissions:l.role==="staff"?l.data.batchAccess:void 0});case"select-student-for-fees":return Nr&&s.jsx(KC,{onBack:()=>r("select-batch-for-fees"),batch:Nr,students:E,onSelectStudent:ie=>{He(ie),r("student-fee-details")}});case"student-fee-details":return Sr&&s.jsx(Cx,{onBack:()=>r("select-student-for-fees"),student:Sr,feeCollections:O,onSavePayment:_s,academy:b});case"fee-collection-report":return s.jsx(YC,{onBack:()=>r("fees-options"),feeCollections:O,onDelete:yi,onUpdate:LA,isDemoMode:Ee});case"fee-dues-list":return s.jsx(eN,{onBack:()=>r("fees-options"),students:E,batches:N,feeCollections:O,academy:b});case"staff-options":return s.jsx(mS,{onBack:()=>r("dashboard"),onNavigate:r});case"new-staff":return s.jsx(fS,{onBack:()=>r("staff-options"),onSave:_A,staff:M});case"staff-manager":return s.jsx(uS,{onBack:()=>r("staff-options"),staff:M,onToggleStatus:Ms,onManageAccess:ie=>{tt(ie),r("staff-batch-access")},onShowDevPopup:ft});case"inactive-staff":return s.jsx(wS,{onBack:()=>r("staff-options"),staff:M,onToggleStatus:Ms});case"staff-batch-access":return bn&&s.jsx(bS,{onBack:()=>r("staff-manager"),staff:bn,batches:N,onSave:bi});case"mark-staff-attendance":return s.jsx(QS,{onBack:()=>r("staff-options"),batches:N,staff:M,academyId:b.id,isDemoMode:Ee,staffAttendance:U,onSave:VA,onDelete:ts});case"settings":return s.jsx(CS,{onBack:()=>r("dashboard"),onNavigate:r,onShowDevPopup:ft});case"custom-sms-settings":return s.jsx(FS,{onBack:()=>r("settings"),academy:b,onSave:vi});case"schedule-classes":return s.jsx(bN,{onBack:()=>r("dashboard"),batches:N,staff:M,academyId:b.id,onSave:Pa,isDemoMode:Ee});case"subscription":return s.jsx(Nx,{onBack:()=>r("dashboard"),academy:b,onSubscribe:Bi});case"income-expenses":return s.jsx(EN,{onBack:()=>r("dashboard"),transactions:I,onSave:Ra,onUpdate:MA,onDelete:sa,isDemoMode:Ee});case"manage-exams":return s.jsx(jN,{onBack:()=>r("dashboard"),exams:V,onNavigate:(ie,ge)=>{ge!=null&&ge.examId&&mt(ge.examId),Fn(ie,ge)},staffPermissions:l.role==="staff"?l.data.batchAccess:void 0,onPublish:Xt});case"create-exam":case"edit-exam":return s.jsx(TN,{onBack:()=>r("manage-exams"),onSave:DA,batches:N,exam:A.examId?nn(V,A.examId):void 0,staffPermissions:l.role==="staff"?l.data.batchAccess:void 0});case"record-marks":return ki&&s.jsx(RN,{onBack:()=>r("manage-exams"),exam:ki,students:E,academy:b,isDemoMode:Ee,onPublish:Xt});case"enquiry-manager":return s.jsx(VN,{onBack:()=>r("dashboard"),enquiries:X,onNavigate:(ie,ge)=>{ge!=null&&ge.enquiryId&&Bt(ge.enquiryId),Fn(ie,ge)},onDelete:Ci,onUpdateStatus:async(ie,ge)=>await Ha({enquiryId:ie,data:ge})});case"new-enquiry":case"edit-enquiry":return s.jsx(zN,{onBack:()=>r("enquiry-manager"),onSave:Ha,batches:N,enquiry:A.enquiryId?nn(X,A.enquiryId):void 0});case"reports-options":return s.jsx(WN,{onBack:()=>r("dashboard"),onNavigate:r,onShowDevPopup:ft});case"attendance-report":return s.jsx(e4,{onBack:()=>r("reports-options"),batches:N,students:E,academyId:b.id,academy:b});case"staff-attendance-report":return s.jsx(LS,{onBack:()=>r("reports-options"),staff:M,staffAttendance:U});case"study-material":return s.jsx(n4,{onBack:()=>r("dashboard"),materials:ae,batches:N,onNavigate:(ie,ge)=>{ge!=null&&ge.studyMaterialId&&ot(ge.studyMaterialId),Fn(ie,ge)},onDelete:Oa});case"upload-study-material":case"edit-study-material":return s.jsx(r4,{onBack:()=>r("study-material"),onSave:Ni,batches:N,academyId:b.id,uploaderName:b.adminName||"Admin",materialToEdit:A.studyMaterialId?nn(ae,A.studyMaterialId):void 0,isDemoMode:Ee});case"homework":return s.jsx(a4,{onBack:()=>r("dashboard"),homework:ue,batches:N,onNavigate:(ie,ge)=>{ge!=null&&ge.homeworkId&&Ke(ge.homeworkId),Fn(ie,ge)},onDelete:Cr});case"assign-homework":case"edit-homework":return s.jsx(i4,{onBack:()=>r("homework"),onSave:PA,batches:N,academyId:b.id,uploaderName:b.adminName||"Admin",homeworkToEdit:A.homeworkId?nn(ue,A.homeworkId):void 0,isDemoMode:Ee});case"homework-submissions":return ct&&s.jsx(A4,{onBack:()=>r("homework"),homework:ct,students:E,academyId:b.id});case"manage-quizzes":return s.jsx(l4,{onBack:()=>r("dashboard"),quizzes:Q,onNavigate:(ie,ge)=>{ge!=null&&ge.quizId&&Ct(ge.quizId),Fn(ie,ge)},onDelete:Kn,staffPermissions:l.role==="staff"?l.data.batchAccess:void 0,onShowDevPopup:ft});case"create-quiz":case"edit-quiz":return s.jsx(d4,{onBack:()=>r("manage-quizzes"),onSave:aa,batches:N,quiz:A.quizId?nn(Q,A.quizId):void 0,staffPermissions:l.role==="staff"?l.data.batchAccess:void 0});case"quiz-results":return ws&&s.jsx(u4,{onBack:()=>r("manage-quizzes"),quiz:ws,submissions:W,students:E});case"leave-manager":return s.jsx(h4,{onBack:()=>r("dashboard"),leaveRequests:ne,students:E,staff:M,currentUser:l,batches:N,onUpdateStatus:Ga});case"todo-task":return s.jsx(x4,{onBack:()=>r("dashboard"),tasks:xe,staff:M,onSaveTask:Si,onToggleTaskStatus:RA,onDeleteTask:Ii,isDemoMode:Ee});case"notice-board":return s.jsx(v4,{onBack:()=>r("dashboard"),notices:Qe,onSaveNotice:HA,onDeleteNotice:Fi,isDemoMode:Ee,academyId:b.id});case"transport-options":return s.jsx(DS,{onBack:()=>r("dashboard"),onCreate:()=>r("new-transport-route"),routes:Me,onNavigate:(ie,ge)=>{ge!=null&&ge.routeId&&_r(ge.routeId),Fn(ie,ge)},onDelete:Va});case"new-transport-route":return s.jsx(RS,{onBack:()=>r("transport-options"),onSave:ie=>Ei(ie)});case"edit-transport-route":return ia&&s.jsx(OS,{onBack:()=>r("transport-options"),onSave:(ie,ge)=>Ei(ge,ie),route:ia});case"map-students-to-route":return ia&&s.jsx(GS,{onBack:()=>r("transport-options"),route:ia,students:E,onSave:OA});case"my-account":return l.role==="admin"?s.jsx(tN,{onBack:()=>r("dashboard"),onLogout:mn,academy:b,onSave:vi}):null;case"notifications":return l.role==="admin"?s.jsx(C4,{onBack:()=>r("dashboard"),enquiries:en,leaveRequests:$t,unmarkedAttendanceBatches:_n,scheduleAlerts:ps,onNavigate:r}):null;case"staff-notifications":return l.role==="staff"?s.jsx(jS,{onBack:()=>r("dashboard"),pendingLeaves:Br,onNavigate:r}):null;case"student-details":return Sr&&s.jsx(rS,{onBack:()=>r("active-students"),student:Sr,feeCollections:O,academyId:b.id,onSavePayment:_s,transportRoutes:Me,onShowImage:on,academy:b});case"fee-status":return oe?s.jsx(j4,{student:oe,feeCollections:O,onBack:()=>r("dashboard")}):null;case"my-academy":return b?s.jsx(Q4,{academy:b,onBack:()=>r("dashboard")}):null;case"attendance":return oe?s.jsx(Tx,{student:oe,academyId:b.id,onBack:()=>r("dashboard")}):null;case"timetable":return oe?s.jsx(L4,{onBack:()=>r("dashboard"),student:oe,academyId:b.id,batches:N}):null;case"student-exams":return oe?s.jsx(M4,{onBack:()=>r("dashboard"),student:oe,academyId:b.id}):null;case"student-study-material":return oe?s.jsx(P4,{onBack:()=>r("dashboard"),materials:ae,student:oe}):null;case"student-homework":return oe?s.jsx(H4,{onBack:()=>r("dashboard"),homework:ue,student:oe,academyId:b.id,batches:N,isDemoMode:Ee}):null;case"student-quizzes":return oe?s.jsx(G4,{onBack:()=>r("dashboard"),quizzes:Q,student:oe,onNavigate:(ie,ge)=>{ge!=null&&ge.quizId&&Ct(ge.quizId),r(ie)},academyId:b.id}):null;case"take-quiz":return oe&&ws&&s.jsx(q4,{onBack:()=>r("student-quizzes"),quiz:ws,onSaveSubmission:GA,studentId:oe.id,academyId:b.id});case"quiz-result":return oe&&ws&&s.jsx(J4,{onBack:()=>r("student-quizzes"),quiz:ws,studentId:oe.id,academyId:b.id});case"my-leave":return s.jsx(Y4,{onBack:()=>r("dashboard"),onNavigate:r,currentUser:l,leaveRequests:ne});case"apply-leave":return s.jsx(Z4,{onBack:()=>r("my-leave"),onSave:qt("leaveRequests"),currentUser:l,academyId:b.id,isDemoMode:Ee});case"student-notice-board":return s.jsx(tS,{onBack:()=>r("dashboard"),notices:Qe});case"student-transport":return oe?s.jsx(VS,{student:oe,transportRoutes:Me,onBack:()=>r("dashboard")}):null;case"class-schedule":return l.role==="staff"?s.jsx(vS,{onBack:()=>r("dashboard"),staff:l.data,academyId:b.id}):null;case"staff-notice-board":return l.role==="staff"?s.jsx(US,{onBack:()=>r("dashboard"),notices:Qe}):null;case"staff-attendance":return l.role==="staff"?s.jsx(_S,{onBack:()=>r("dashboard"),staff:l.data,staffAttendance:U}):null;default:return l.role==="admin"?s.jsx(Bh,{onNavigate:r,academy:b,students:E,batches:N,staff:M,transactions:I,onShowDevPopup:ft}):l.role==="student"?s.jsx(Wg,{student:l.data,academy:b,feeCollections:O,batches:N,onNavigate:r,onToggleNav:()=>m(!0),theme:t,onToggleTheme:Vn,onShowDevPopup:ft}):l.role==="staff"?s.jsx($g,{onNavigate:r,academy:b,staff:l.data,onShowDevPopup:ft}):null}},Ui=({children:oe})=>s.jsxs("div",{className:`min-h-screen font-sans ${t} bg-gray-100 dark:bg-gray-900`,children:[St&&s.jsx(rN,{message:St,onClose:()=>br(null)}),Wt&&s.jsx(aN,{}),(l==null?void 0:l.role)==="admin"&&b&&s.jsxs(s.Fragment,{children:[n==="dashboard"&&s.jsx(L1,{academy:b,onLogout:mn,onToggleNav:()=>m(!0),theme:t,onToggleTheme:Vn,onNavigate:r,notificationCount:cr}),s.jsx(G1,{isOpen:p,onClose:()=>m(!1),onNavigate:r,onLogout:mn,onShowDevPopup:ft}),s.jsx("main",{children:oe}),s.jsx(H1,{onNavigate:r,activePage:n,onOpenChatbot:()=>lr(!0)})]}),(l==null?void 0:l.role)==="student"&&b&&s.jsxs(s.Fragment,{children:[s.jsx(T4,{isOpen:p,onClose:()=>m(!1),onNavigate:r,onLogout:mn}),s.jsx("main",{children:oe})]}),(l==null?void 0:l.role)==="staff"&&b&&s.jsxs(s.Fragment,{children:[n==="dashboard"&&s.jsx(AS,{staffName:l.data.name,academyName:b.name,onLogout:mn,onToggleNav:()=>m(!0),theme:t,onToggleTheme:Vn,onNavigate:r,notificationCount:cr}),s.jsx(lS,{isOpen:p,onClose:()=>m(!1),onNavigate:r,onLogout:mn,staff:l.data,onShowDevPopup:ft}),s.jsx("main",{children:oe})]}),es&&s.jsx(AN,{onAccept:()=>{localStorage.setItem("dataConsentAccepted","true"),Yt(!1)}}),dt&&s.jsx(CU,{featureName:dt,onClose:()=>ft(null)}),ms&&s.jsx(sS,{src:ms,alt:"Full screen view",onClose:()=>on(null)}),"s",vr&&b&&s.jsx(BU,{isOpen:vr,onClose:()=>lr(!1),onNavigate:ie=>{Fn(ie),lr(!1)},students:E,feeCollections:O,batches:N,academyId:b.id})]});return s.jsx(Ui,{children:Dr()})}const Aw=document.getElementById("root");if(!Aw)throw new Error("Could not find root element to mount to");const SU=Jw.createRoot(Aw);SU.render(s.jsx(be.StrictMode,{children:s.jsx(NU,{})}));export{Nh as E,Im as W,_t as _,s1 as b};
